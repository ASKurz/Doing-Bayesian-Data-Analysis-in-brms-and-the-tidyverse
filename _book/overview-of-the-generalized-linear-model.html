<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>15 Overview of the Generalized Linear Model | Doing Bayesian Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="15 Overview of the Generalized Linear Model | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="15 Overview of the Generalized Linear Model | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2022-05-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="stan.html"/>
<link rel="next" href="metric-predicted-variable-on-one-or-two-groups.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-setup"><i class="fa fa-check"></i><strong>R</strong> setup</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#we-have-updates"><i class="fa fa-check"></i>We have updates</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.1.0."><i class="fa fa-check"></i>Version 0.1.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.2.0."><i class="fa fa-check"></i>Version 0.2.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.3.0."><i class="fa fa-check"></i>Version 0.3.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.4.0."><i class="fa fa-check"></i>Version 0.4.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-1.0.0."><i class="fa fa-check"></i>Version 1.0.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#some-minor-issues-remain."><i class="fa fa-check"></i>Some minor issues remain.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thank-yous-are-in-order"><i class="fa fa-check"></i>Thank-you’s are in order</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-citation"><i class="fa fa-check"></i>License and citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html"><i class="fa fa-check"></i><b>1</b> What’s in This Book (Read This First!)</a>
<ul>
<li class="chapter" data-level="1.1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#real-people-can-read-this-book"><i class="fa fa-check"></i><b>1.1</b> Real people can read this book</a></li>
<li class="chapter" data-level="1.2" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-in-this-book"><i class="fa fa-check"></i><b>1.2</b> What’s in this book</a></li>
<li class="chapter" data-level="1.3" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-new-in-the-second-edition"><i class="fa fa-check"></i><b>1.3</b> What’s new in the second edition</a></li>
<li class="chapter" data-level="1.4" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#gimme-feedback-be-polite"><i class="fa fa-check"></i><b>1.4</b> Gimme feedback (be polite)</a></li>
<li class="chapter" data-level="1.5" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#thank-you"><i class="fa fa-check"></i><b>1.5</b> Thank you!</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Introduction: Credibility, Models, and Parameters</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#bayesian-inference-is-reallocation-of-credibility-across-possibilities"><i class="fa fa-check"></i><b>2.1</b> Bayesian inference is reallocation of credibility across possibilities</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#data-are-noisy-and-inferences-are-probabilistic."><i class="fa fa-check"></i><b>2.1.1</b> Data are noisy and inferences are probabilistic.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#possibilities-are-parameter-values-in-descriptive-models"><i class="fa fa-check"></i><b>2.2</b> Possibilities are parameter values in descriptive models</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.3</b> The steps of Bayesian data analysis</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html"><i class="fa fa-check"></i><b>3</b> The R Programming Language</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-software"><i class="fa fa-check"></i><b>3.1</b> Get the software</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-look-at-rstudio."><i class="fa fa-check"></i><b>3.1.1</b> A look at RStudio.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-simple-example-of-r-in-action"><i class="fa fa-check"></i><b>3.2</b> A simple example of R in action</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-programs-used-with-this-book."><i class="fa fa-check"></i><b>3.2.1</b> Get the programs used with this book.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#basic-commands-and-operators-in-r"><i class="fa fa-check"></i><b>3.3</b> Basic commands and operators in R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#getting-help-in-r."><i class="fa fa-check"></i><b>3.3.1</b> Getting help in R.</a></li>
<li class="chapter" data-level="3.3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#arithmetic-and-logical-operators."><i class="fa fa-check"></i><b>3.3.2</b> Arithmetic and logical operators.</a></li>
<li class="chapter" data-level="3.3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#assignment-relational-operators-and-tests-of-equality."><i class="fa fa-check"></i><b>3.3.3</b> Assignment, relational operators, and tests of equality.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-types"><i class="fa fa-check"></i><b>3.4</b> Variable types</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#vector."><i class="fa fa-check"></i><b>3.4.1</b> Vector.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#factor."><i class="fa fa-check"></i><b>3.4.2</b> Factor.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#matrix-and-array."><i class="fa fa-check"></i><b>3.4.3</b> Matrix and array.</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#list-and-data-frame."><i class="fa fa-check"></i><b>3.4.4</b> List and data frame.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#loading-and-saving-data"><i class="fa fa-check"></i><b>3.5</b> Loading and saving data</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#the-read.csv-read_csv-and-read.table-read_table-functions."><i class="fa fa-check"></i><b>3.5.1</b> The <del>read.csv</del> <code>read_csv()</code> and <del>read.table</del> <code>read_table()</code> functions.</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#saving-data-from-r."><i class="fa fa-check"></i><b>3.5.2</b> Saving data from R.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#some-utility-functions"><i class="fa fa-check"></i><b>3.6</b> Some utility functions</a></li>
<li class="chapter" data-level="3.7" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-in-r"><i class="fa fa-check"></i><b>3.7</b> Programming in R</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-names-in-r."><i class="fa fa-check"></i><b>3.7.1</b> Variable names in R.</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#running-a-program."><i class="fa fa-check"></i><b>3.7.2</b> Running a program.</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-a-function."><i class="fa fa-check"></i><b>3.7.3</b> Programming a function.</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conditions-and-loops."><i class="fa fa-check"></i><b>3.7.4</b> Conditions and loops.</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#measuring-processing-time."><i class="fa fa-check"></i><b>3.7.5</b> Measuring processing time.</a></li>
<li class="chapter" data-level="3.7.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#debugging."><i class="fa fa-check"></i><b>3.7.6</b> Debugging.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#graphical-plots-opening-and-saving"><i class="fa fa-check"></i><b>3.8</b> Graphical plots: Opening and saving</a></li>
<li class="chapter" data-level="3.9" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conclusion-brms-related-needs"><i class="fa fa-check"></i><b>3.9</b> <del>Conclusion</del> <strong>brms</strong>-related needs</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html"><i class="fa fa-check"></i><b>4</b> What is This Stuff Called Probability?</a>
<ul>
<li class="chapter" data-level="4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#the-set-of-all-possible-events"><i class="fa fa-check"></i><b>4.1</b> The set of all possible events</a></li>
<li class="chapter" data-level="4.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-outside-or-inside-the-head"><i class="fa fa-check"></i><b>4.2</b> Probability: Outside or inside the head</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#outside-the-head-long-run-relative-frequency."><i class="fa fa-check"></i><b>4.2.1</b> Outside the head: Long-run relative frequency.</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#inside-the-head-subjective-belief."><i class="fa fa-check"></i><b>4.2.2</b> Inside the head: Subjective belief.</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probabilities-assign-numbers-to-possibilities."><i class="fa fa-check"></i><b>4.2.3</b> Probabilities assign numbers to possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Probability distributions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#discrete-distributions-probability-mass."><i class="fa fa-check"></i><b>4.3.1</b> Discrete distributions: Probability mass.</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#continuous-distributions-rendezvous-with-density."><i class="fa fa-check"></i><b>4.3.2</b> Continuous distributions: Rendezvous with density.</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#mean-and-variance-of-a-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Mean and variance of a distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#highest-density-interval-hdi."><i class="fa fa-check"></i><b>4.3.4</b> Highest density interval (HDI).</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#two-way-distributions"><i class="fa fa-check"></i><b>4.4</b> Two-way distributions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#conditional-probability."><i class="fa fa-check"></i><b>4.4.1</b> Conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule</a>
<ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-rule-1"><i class="fa fa-check"></i><b>5.1</b> Bayes’ rule</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#derived-from-definitions-of-conditional-probability."><i class="fa fa-check"></i><b>5.1.1</b> Derived from definitions of conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule.html"><a href="bayes-rule.html#applied-to-parameters-and-data"><i class="fa fa-check"></i><b>5.2</b> Applied to parameters and data</a></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule.html"><a href="bayes-rule.html#complete-examples-estimating-bias-in-a-coin"><i class="fa fa-check"></i><b>5.3</b> Complete examples: Estimating bias in a coin</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-sample-size-on-the-posterior."><i class="fa fa-check"></i><b>5.3.1</b> Influence of sample size on the posterior.</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-prior-on-the-posterior."><i class="fa fa-check"></i><b>5.3.2</b> Influence of prior on the posterior.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule.html"><a href="bayes-rule.html#why-bayesian-inference-can-be-difficult"><i class="fa fa-check"></i><b>5.4</b> Why Bayesian inference can be difficult</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-likelihood-function-the-bernoulli-distribution"><i class="fa fa-check"></i><b>6.1</b> The likelihood function: The Bernoulli distribution</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-description-of-credibilities-the-beta-distribution"><i class="fa fa-check"></i><b>6.2</b> A description of credibilities: The beta distribution</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#specifying-a-beta-prior."><i class="fa fa-check"></i><b>6.2.1</b> Specifying a beta prior.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-posterior-beta"><i class="fa fa-check"></i><b>6.3</b> The posterior beta</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#posterior-is-compromise-of-prior-and-likelihood."><i class="fa fa-check"></i><b>6.3.1</b> Posterior is compromise of prior and likelihood.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.1</b> Prior knowledge expressed as a beta distribution.</a></li>
<li class="chapter" data-level="6.4.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.2</b> Prior knowledge that cannot be expressed as a beta distribution.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#approximating-a-distribution-with-a-large-sample"><i class="fa fa-check"></i><b>7.1</b> Approximating a distribution with a large sample</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-simple-case-of-the-metropolis-algorithm"><i class="fa fa-check"></i><b>7.2</b> A simple case of the Metropolis algorithm</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-politician-stumbles-upon-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.2.1</b> A politician stumbles upon the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-random-walk."><i class="fa fa-check"></i><b>7.2.2</b> A random walk.</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#general-properties-of-a-random-walk."><i class="fa fa-check"></i><b>7.2.3</b> General properties of a random walk.</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#why-we-care."><i class="fa fa-check"></i><b>7.2.4</b> Why we care.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-metropolis-algorithm-more-generally"><i class="fa fa-check"></i><b>7.3</b> The Metropolis algorithm more generally</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithm-applied-to-bernoulli-likelihood-and-beta-prior."><i class="fa fa-check"></i><b>7.3.1</b> Metropolis algorithm applied to Bernoulli likelihood and beta prior.</a></li>
<li class="chapter" data-level="7.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-of-metropolis-algorithm."><i class="fa fa-check"></i><b>7.3.2</b> Summary of Metropolis algorithm.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#toward-gibbs-sampling-estimating-two-coin-biases"><i class="fa fa-check"></i><b>7.4</b> Toward Gibbs sampling: Estimating two coin biases</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#prior-likelihood-and-posterior-for-two-biases."><i class="fa fa-check"></i><b>7.4.1</b> Prior, likelihood and posterior for two biases.</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-exact-formal-analysis."><i class="fa fa-check"></i><b>7.4.2</b> The posterior via exact formal analysis.</a></li>
<li class="chapter" data-level="7.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.4.3</b> The posterior via the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-hamiltonian-monte-carlo-sampling."><i class="fa fa-check"></i><b>7.4.4</b> <del>Gibbs</del> Hamiltonian Monte Carlo sampling.</a></li>
<li class="chapter" data-level="7.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#is-there-a-difference-between-biases"><i class="fa fa-check"></i><b>7.4.5</b> Is there a difference between biases?</a></li>
<li class="chapter" data-level="7.4.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#terminology-mcmc."><i class="fa fa-check"></i><b>7.4.6</b> Terminology: MCMC.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness-accuracy-and-efficiency"><i class="fa fa-check"></i><b>7.5</b> MCMC representativeness, accuracy, and efficiency</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness."><i class="fa fa-check"></i><b>7.5.1</b> MCMC representativeness.</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-accuracy."><i class="fa fa-check"></i><b>7.5.2</b> MCMC accuracy.</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-efficiency."><i class="fa fa-check"></i><b>7.5.3</b> MCMC efficiency.</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-1"><i class="fa fa-check"></i><b>7.6</b> Summary</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#footnote-1"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-brms.html"><a href="jags-brms.html"><i class="fa fa-check"></i><b>8</b> <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="8.1" data-path="jags-brms.html"><a href="jags-brms.html#jags-brms-and-its-relation-to-r"><i class="fa fa-check"></i><b>8.1</b> <del>JAGS</del> brms and its relation to R</a></li>
<li class="chapter" data-level="8.2" data-path="jags-brms.html"><a href="jags-brms.html#a-complete-example"><i class="fa fa-check"></i><b>8.2</b> A complete example</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="jags-brms.html"><a href="jags-brms.html#load-data."><i class="fa fa-check"></i><b>8.2.1</b> Load data.</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-brms.html"><a href="jags-brms.html#specify-model."><i class="fa fa-check"></i><b>8.2.2</b> Specify model.</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-brms.html"><a href="jags-brms.html#initialize-chains."><i class="fa fa-check"></i><b>8.2.3</b> Initialize chains.</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-brms.html"><a href="jags-brms.html#generate-chains."><i class="fa fa-check"></i><b>8.2.4</b> Generate chains.</a></li>
<li class="chapter" data-level="8.2.5" data-path="jags-brms.html"><a href="jags-brms.html#examine-chains."><i class="fa fa-check"></i><b>8.2.5</b> Examine chains.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-brms.html"><a href="jags-brms.html#simplified-scripts-for-frequently-used-analyses"><i class="fa fa-check"></i><b>8.3</b> Simplified scripts for frequently used analyses</a></li>
<li class="chapter" data-level="8.4" data-path="jags-brms.html"><a href="jags-brms.html#example-difference-of-biases"><i class="fa fa-check"></i><b>8.4</b> Example: Difference of biases</a></li>
<li class="chapter" data-level="8.5" data-path="jags-brms.html"><a href="jags-brms.html#sampling-from-the-prior-distribution-in-jags-brms"><i class="fa fa-check"></i><b>8.5</b> Sampling from the prior distribution in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="8.6" data-path="jags-brms.html"><a href="jags-brms.html#probability-distributions-available-in-jags-brms"><i class="fa fa-check"></i><b>8.6</b> Probability distributions available in <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="jags-brms.html"><a href="jags-brms.html#defining-new-likelihood-functions."><i class="fa fa-check"></i><b>8.6.1</b> Defining new likelihood functions.</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="jags-brms.html"><a href="jags-brms.html#faster-sampling-with-parallel-processing-in-runjags-brmsbrm"><i class="fa fa-check"></i><b>8.7</b> Faster sampling with parallel processing in <del>runjags</del> <code>brms::brm()</code></a></li>
<li class="chapter" data-level="8.8" data-path="jags-brms.html"><a href="jags-brms.html#tips-for-expanding-jags-brms-models"><i class="fa fa-check"></i><b>8.8</b> Tips for expanding <del>JAGS</del> brms models</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Hierarchical Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-single-coin-from-a-single-mint"><i class="fa fa-check"></i><b>9.1</b> A single coin from a single mint</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation."><i class="fa fa-check"></i><b>9.1.1</b> Posterior via grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#multiple-coins-from-a-single-mint"><i class="fa fa-check"></i><b>9.2</b> Multiple coins from a single mint</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation.-1"><i class="fa fa-check"></i><b>9.2.1</b> Posterior via grid approximation.</a></li>
<li class="chapter" data-level="9.2.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-realistic-model-with-mcmc."><i class="fa fa-check"></i><b>9.2.2</b> A realistic model with MCMC.</a></li>
<li class="chapter" data-level="9.2.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#doing-it-with-jags-brms."><i class="fa fa-check"></i><b>9.2.3</b> Doing it with <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="9.2.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-therapeutic-touch."><i class="fa fa-check"></i><b>9.2.4</b> Example: Therapeutic touch.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#shrinkage-in-hierarchical-models"><i class="fa fa-check"></i><b>9.3</b> Shrinkage in hierarchical models</a></li>
<li class="chapter" data-level="9.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#speeding-up-jags-brms"><i class="fa fa-check"></i><b>9.4</b> Speeding up <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="9.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#extending-the-hierarchy-subjects-within-categories"><i class="fa fa-check"></i><b>9.5</b> Extending the hierarchy: Subjects within categories</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-batting-abilities-by-position."><i class="fa fa-check"></i><b>9.5.1</b> Example: Baseball batting abilities by position.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html"><i class="fa fa-check"></i><b>10</b> Model Comparison and Hierarchical Modeling</a>
<ul>
<li class="chapter" data-level="10.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#general-formula-and-the-bayes-factor"><i class="fa fa-check"></i><b>10.1</b> General formula and the Bayes factor</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#example-two-factories-of-coins"><i class="fa fa-check"></i><b>10.2</b> Example: Two factories of coins</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-formal-analysis."><i class="fa fa-check"></i><b>10.2.1</b> Solution by formal analysis.</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-grid-approximation."><i class="fa fa-check"></i><b>10.2.2</b> Solution by grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-mcmc"><i class="fa fa-check"></i><b>10.3</b> Solution by MCMC</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#nonhierarchical-mcmc-computation-of-each-models-marginal-likelihood."><i class="fa fa-check"></i><b>10.3.1</b> Nonhierarchical MCMC computation of each model’s marginal likelihood.</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#hierarchical-mcmc-computation-of-relative-model-probability-is-not-available-in-brms-well-cover-information-criteria-instead."><i class="fa fa-check"></i><b>10.3.2</b> Hierarchical MCMC computation <del>of relative model probability</del> is not available in brms: We’ll cover information criteria instead.</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#models-with-different-noise-distributions-in-jags-brms."><i class="fa fa-check"></i><b>10.3.3</b> Models with different “noise” distributions in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#prediction-model-averaging"><i class="fa fa-check"></i><b>10.4</b> Prediction: Model averaging</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#model-complexity-naturally-accounted-for"><i class="fa fa-check"></i><b>10.5</b> Model complexity naturally accounted for</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#caveats-regarding-nested-model-comparison."><i class="fa fa-check"></i><b>10.5.1</b> Caveats regarding nested model comparison.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#extreme-sensitivity-to-prior-distribution"><i class="fa fa-check"></i><b>10.6</b> Extreme sensitivity to prior distribution</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#priors-of-different-models-should-be-equally-informed."><i class="fa fa-check"></i><b>10.6.1</b> Priors of different models should be equally informed.</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#bonus-theres-danger-ahead"><i class="fa fa-check"></i><b>10.7</b> Bonus: There’s danger ahead</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#footnote-2"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>11</b> Null Hypothesis Significance Testing</a>
<ul>
<li class="chapter" data-level="11.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#paved-with-good-intentions"><i class="fa fa-check"></i><b>11.1</b> Paved with good intentions</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#definition-of-p-value."><i class="fa fa-check"></i><b>11.1.1</b> Definition of <span class="math inline">\(p\)</span> value.</a></li>
<li class="chapter" data-level="11.1.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-n."><i class="fa fa-check"></i><b>11.1.2</b> With intention to fix <span class="math inline">\(N\)</span>.</a></li>
<li class="chapter" data-level="11.1.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-z."><i class="fa fa-check"></i><b>11.1.3</b> With intention to fix <span class="math inline">\(z\)</span>.</a></li>
<li class="chapter" data-level="11.1.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-duration."><i class="fa fa-check"></i><b>11.1.4</b> With intention to fix duration.</a></li>
<li class="chapter" data-level="11.1.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-make-multiple-tests."><i class="fa fa-check"></i><b>11.1.5</b> With intention to make multiple tests.</a></li>
<li class="chapter" data-level="11.1.6" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#soul-searching."><i class="fa fa-check"></i><b>11.1.6</b> Soul searching.</a></li>
<li class="chapter" data-level="11.1.7" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis."><i class="fa fa-check"></i><b>11.1.7</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#prior-knowledge"><i class="fa fa-check"></i><b>11.2</b> Prior knowledge</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-analysis."><i class="fa fa-check"></i><b>11.2.1</b> NHST analysis.</a></li>
<li class="chapter" data-level="11.2.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis.-1"><i class="fa fa-check"></i><b>11.2.2</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#confidence-interval-and-highest-density-interval"><i class="fa fa-check"></i><b>11.3</b> Confidence interval and highest density interval</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#ci-depends-on-intention."><i class="fa fa-check"></i><b>11.3.1</b> CI depends on intention.</a></li>
<li class="chapter" data-level="11.3.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-hdi."><i class="fa fa-check"></i><b>11.3.2</b> Bayesian HDI.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#multiple-comparisons"><i class="fa fa-check"></i><b>11.4</b> Multiple comparisons</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-correction-for-experiment-wise-error."><i class="fa fa-check"></i><b>11.4.1</b> NHST correction for experiment wise error.</a></li>
<li class="chapter" data-level="11.4.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#just-one-bayesian-posterior-no-matter-how-you-look-at-it."><i class="fa fa-check"></i><b>11.4.2</b> Just one Bayesian posterior no matter how you look at it.</a></li>
<li class="chapter" data-level="11.4.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#how-bayesian-analysis-mitigates-false-alarms."><i class="fa fa-check"></i><b>11.4.3</b> How Bayesian analysis mitigates false alarms.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#what-a-sampling-distribution-is-good-for"><i class="fa fa-check"></i><b>11.5</b> What a sampling distribution is good for</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#planning-an-experiment."><i class="fa fa-check"></i><b>11.5.1</b> Planning an experiment.</a></li>
<li class="chapter" data-level="11.5.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#exploring-model-predictions-posterior-predictive-check."><i class="fa fa-check"></i><b>11.5.2</b> Exploring model predictions (posterior predictive check).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#footnote-3"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><i class="fa fa-check"></i><b>12</b> Bayesian Approaches to Testing a Point (“Null”) Hypothesis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-estimation-approach"><i class="fa fa-check"></i><b>12.1</b> The estimation approach</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#region-of-practical-equivalence."><i class="fa fa-check"></i><b>12.1.1</b> Region of practical equivalence.</a></li>
<li class="chapter" data-level="12.1.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#some-examples."><i class="fa fa-check"></i><b>12.1.2</b> Some examples.</a></li>
<li class="chapter" data-level="12.1.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#differences-of-correlated-parameters."><i class="fa fa-check"></i><b>12.1.3</b> Differences of correlated parameters.</a></li>
<li class="chapter" data-level="12.1.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#why-hdi-and-not-equal-tailed-interval"><i class="fa fa-check"></i><b>12.1.4</b> Why HDI and not equal-tailed interval?</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-model-comparison-approach"><i class="fa fa-check"></i><b>12.2</b> The model-comparison approach</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#is-a-coin-fair-or-not"><i class="fa fa-check"></i><b>12.2.1</b> Is a coin fair or not?</a></li>
<li class="chapter" data-level="12.2.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#are-different-groups-equal-or-not"><i class="fa fa-check"></i><b>12.2.2</b> Are different groups equal or not?</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#relations-of-parameter-estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.3</b> Relations of parameter estimation and model comparison</a></li>
<li class="chapter" data-level="12.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.4</b> Estimation and model comparison?</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html"><i class="fa fa-check"></i><b>13</b> Goals, Power, and Sample Size</a>
<ul>
<li class="chapter" data-level="13.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-will-to-power"><i class="fa fa-check"></i><b>13.1</b> The will to power</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#goals-and-obstacles."><i class="fa fa-check"></i><b>13.1.1</b> Goals and obstacles.</a></li>
<li class="chapter" data-level="13.1.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power."><i class="fa fa-check"></i><b>13.1.2</b> Power.</a></li>
<li class="chapter" data-level="13.1.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sample-size."><i class="fa fa-check"></i><b>13.1.3</b> Sample size.</a></li>
<li class="chapter" data-level="13.1.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#other-expressions-of-goals."><i class="fa fa-check"></i><b>13.1.4</b> Other expressions of goals.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#computing-power-and-sample-size"><i class="fa fa-check"></i><b>13.2</b> Computing power and sample size</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-to-exclude-a-null-value."><i class="fa fa-check"></i><b>13.2.1</b> When the goal is to exclude a null value.</a></li>
<li class="chapter" data-level="13.2.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#formal-solution-and-implementation-in-r."><i class="fa fa-check"></i><b>13.2.2</b> Formal solution and implementation in R.</a></li>
<li class="chapter" data-level="13.2.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-precision."><i class="fa fa-check"></i><b>13.2.3</b> When the goal is precision.</a></li>
<li class="chapter" data-level="13.2.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#monte-carlo-approximation-of-power."><i class="fa fa-check"></i><b>13.2.4</b> Monte Carlo approximation of power.</a></li>
<li class="chapter" data-level="13.2.5" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-from-idealized-or-actual-data."><i class="fa fa-check"></i><b>13.2.5</b> Power from idealized or actual data.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sequential-testing-and-the-goal-of-precision"><i class="fa fa-check"></i><b>13.3</b> Sequential testing and the goal of precision</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#examples-of-sequential-tests."><i class="fa fa-check"></i><b>13.3.1</b> Examples of sequential tests.</a></li>
<li class="chapter" data-level="13.3.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#average-behavior-of-sequential-tests."><i class="fa fa-check"></i><b>13.3.2</b> Average behavior of sequential tests.</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#discussion"><i class="fa fa-check"></i><b>13.4</b> Discussion</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-and-multiple-comparisons."><i class="fa fa-check"></i><b>13.4.1</b> Power and multiple comparisons.</a></li>
<li class="chapter" data-level="13.4.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-prospective-retrospective-and-replication."><i class="fa fa-check"></i><b>13.4.2</b> Power: prospective, retrospective, and replication.</a></li>
<li class="chapter" data-level="13.4.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-analysis-requires-verisimilitude-of-simulated-data."><i class="fa fa-check"></i><b>13.4.3</b> Power analysis requires verisimilitude of simulated data.</a></li>
<li class="chapter" data-level="13.4.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-importance-of-planning."><i class="fa fa-check"></i><b>13.4.4</b> The importance of planning.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a>
<ul>
<li class="chapter" data-level="14.1" data-path="stan.html"><a href="stan.html#hmc-sampling"><i class="fa fa-check"></i><b>14.1</b> HMC sampling</a></li>
<li class="chapter" data-level="14.2" data-path="stan.html"><a href="stan.html#installing-stan"><i class="fa fa-check"></i><b>14.2</b> Installing Stan</a></li>
<li class="chapter" data-level="14.3" data-path="stan.html"><a href="stan.html#a-complete-example-1"><i class="fa fa-check"></i><b>14.3</b> A Complete example</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="stan.html"><a href="stan.html#reusing-the-compiled-model."><i class="fa fa-check"></i><b>14.3.1</b> Reusing the compiled model.</a></li>
<li class="chapter" data-level="14.3.2" data-path="stan.html"><a href="stan.html#general-structure-of-stan-model-specification."><i class="fa fa-check"></i><b>14.3.2</b> General structure of Stan model specification.</a></li>
<li class="chapter" data-level="14.3.3" data-path="stan.html"><a href="stan.html#think-log-probability-to-think-like-stan."><i class="fa fa-check"></i><b>14.3.3</b> Think log probability to think like Stan.</a></li>
<li class="chapter" data-level="14.3.4" data-path="stan.html"><a href="stan.html#sampling-the-prior-in-stan."><i class="fa fa-check"></i><b>14.3.4</b> Sampling the prior in Stan.</a></li>
<li class="chapter" data-level="14.3.5" data-path="stan.html"><a href="stan.html#simplified-scripts-for-frequently-used-analyses."><i class="fa fa-check"></i><b>14.3.5</b> Simplified scripts for frequently used analyses.</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="stan.html"><a href="stan.html#specify-models-top-down-in-stan"><i class="fa fa-check"></i><b>14.4</b> Specify models top-down in Stan</a></li>
<li class="chapter" data-level="14.5" data-path="stan.html"><a href="stan.html#limitations-and-extras"><i class="fa fa-check"></i><b>14.5</b> Limitations and extras</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#footnote-4"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>15</b> Overview of the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="15.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#types-of-variables"><i class="fa fa-check"></i><b>15.1</b> Types of variables</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#predictor-and-predicted-variables."><i class="fa fa-check"></i><b>15.1.1</b> Predictor and predicted variables.</a></li>
<li class="chapter" data-level="15.1.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#scale-types-metric-ordinal-nominal-and-count."><i class="fa fa-check"></i><b>15.1.2</b> Scale types: metric, ordinal, nominal, and count.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-combination-of-predictors"><i class="fa fa-check"></i><b>15.2</b> Linear combination of predictors</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-function-of-a-single-metric-predictor."><i class="fa fa-check"></i><b>15.2.1</b> Linear function of a single metric predictor.</a></li>
<li class="chapter" data-level="15.2.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#additive-combination-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.2</b> Additive combination of metric predictors.</a></li>
<li class="chapter" data-level="15.2.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nonadditive-interaction-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.3</b> Nonadditive interaction of metric predictors.</a></li>
<li class="chapter" data-level="15.2.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nominal-predictors."><i class="fa fa-check"></i><b>15.2.4</b> Nominal predictors.</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linking-from-combined-predictors-to-noisy-predicted-data"><i class="fa fa-check"></i><b>15.3</b> Linking from combined predictors to noisy predicted data</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predictors-to-predicted-central-tendency."><i class="fa fa-check"></i><b>15.3.1</b> From predictors to predicted central tendency.</a></li>
<li class="chapter" data-level="15.3.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predicted-central-tendency-to-noisy-data."><i class="fa fa-check"></i><b>15.3.2</b> From predicted central tendency to noisy data.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#formal-expression-of-the-glm"><i class="fa fa-check"></i><b>15.4</b> Formal expression of the GLM</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#cases-of-the-glm."><i class="fa fa-check"></i><b>15.4.1</b> Cases of the GLM.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html"><i class="fa fa-check"></i><b>16</b> Metric-Predicted Variable on One or Two Groups</a>
<ul>
<li class="chapter" data-level="16.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#estimating-the-mean-and-standard-deviation-of-a-normal-distribution"><i class="fa fa-check"></i><b>16.1</b> Estimating the mean and standard deviation of a normal distribution</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#solution-by-mathematical-analysis-heads-up-on-precision."><i class="fa fa-check"></i><b>16.1.1</b> <del>Solution by mathematical analysis</del> Heads up on precision.</a></li>
<li class="chapter" data-level="16.1.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#approximation-by-mcmc-in-jags-hmc-in-brms."><i class="fa fa-check"></i><b>16.1.2</b> Approximation by <del>MCMC in JAGS</del> HMC in brms.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#outliers-and-robust-estimation-the-t-distribution"><i class="fa fa-check"></i><b>16.2</b> Outliers and robust estimation: The <span class="math inline">\(t\)</span> distribution</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-jags-brms."><i class="fa fa-check"></i><b>16.2.1</b> Using the <span class="math inline">\(t\)</span> distribution in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="16.2.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-stan."><i class="fa fa-check"></i><b>16.2.2</b> Using the <span class="math inline">\(t\)</span> distribution in Stan.</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#two-groups"><i class="fa fa-check"></i><b>16.3</b> Two groups</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#analysis-by-nhst."><i class="fa fa-check"></i><b>16.3.1</b> Analysis by NHST.</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#other-noise-distributions-and-transforming-data"><i class="fa fa-check"></i><b>16.4</b> Other noise distributions and transforming data</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#session-info-15"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html"><i class="fa fa-check"></i><b>17</b> Metric Predicted Variable with One Metric Predictor</a>
<ul>
<li class="chapter" data-level="17.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#simple-linear-regression"><i class="fa fa-check"></i><b>17.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="17.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Robust linear regression</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-jags-brms."><i class="fa fa-check"></i><b>17.2.1</b> Robust linear regression in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.2.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-stan."><i class="fa fa-check"></i><b>17.2.2</b> Robust linear regression in Stan.</a></li>
<li class="chapter" data-level="17.2.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#stan-or-jags"><i class="fa fa-check"></i><b>17.2.3</b> Stan or JAGS?</a></li>
<li class="chapter" data-level="17.2.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>17.2.4</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#hierarchical-regression-on-individuals-within-groups"><i class="fa fa-check"></i><b>17.3</b> Hierarchical regression on individuals within groups</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>17.3.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.3.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-posterior-distribution-shrinkage-and-prediction."><i class="fa fa-check"></i><b>17.3.2</b> The posterior distribution: Shrinkage and prediction.</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#quadratic-trend-and-weighted-data"><i class="fa fa-check"></i><b>17.4</b> Quadratic trend and weighted data</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#results-and-interpretation."><i class="fa fa-check"></i><b>17.4.1</b> Results and interpretation.</a></li>
<li class="chapter" data-level="17.4.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#further-extensions."><i class="fa fa-check"></i><b>17.4.2</b> Further extensions.</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#procedure-and-perils-for-expanding-a-model"><i class="fa fa-check"></i><b>17.5</b> Procedure and perils for expanding a model</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#session-info-16"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Metric Predicted Variable with Multiple Metric Predictors</a>
<ul>
<li class="chapter" data-level="18.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiple-linear-regression"><i class="fa fa-check"></i><b>18.1</b> Multiple linear regression</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-perils-of-correlated-predictors."><i class="fa fa-check"></i><b>18.1.1</b> The perils of correlated predictors.</a></li>
<li class="chapter" data-level="18.1.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-model-and-implementation."><i class="fa fa-check"></i><b>18.1.2</b> The model and implementation.</a></li>
<li class="chapter" data-level="18.1.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-posterior-distribution."><i class="fa fa-check"></i><b>18.1.3</b> The posterior distribution.</a></li>
<li class="chapter" data-level="18.1.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#redundant-predictors."><i class="fa fa-check"></i><b>18.1.4</b> Redundant predictors.</a></li>
<li class="chapter" data-level="18.1.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#informative-priors-sparse-data-and-correlated-predictors."><i class="fa fa-check"></i><b>18.1.5</b> Informative priors, sparse data, and correlated predictors.</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiplicative-interaction-of-metric-predictors"><i class="fa fa-check"></i><b>18.2</b> Multiplicative interaction of metric predictors</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#an-example."><i class="fa fa-check"></i><b>18.2.1</b> An example.</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#shrinkage-of-regression-coefficients"><i class="fa fa-check"></i><b>18.3</b> Shrinkage of regression coefficients</a></li>
<li class="chapter" data-level="18.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection"><i class="fa fa-check"></i><b>18.4</b> Variable selection</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#inclusion-probability-is-strongly-affected-by-vagueness-of-prior."><i class="fa fa-check"></i><b>18.4.1</b> Inclusion probability is strongly affected by vagueness of prior.</a></li>
<li class="chapter" data-level="18.4.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection-with-hierarchical-shrinkage."><i class="fa fa-check"></i><b>18.4.2</b> Variable selection with hierarchical shrinkage.</a></li>
<li class="chapter" data-level="18.4.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#what-to-report-and-what-to-conclude."><i class="fa fa-check"></i><b>18.4.3</b> What to report and what to conclude.</a></li>
<li class="chapter" data-level="18.4.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-computational-methods."><i class="fa fa-check"></i><b>18.4.4</b> Caution: Computational methods.</a></li>
<li class="chapter" data-level="18.4.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-interaction-variables."><i class="fa fa-check"></i><b>18.4.5</b> Caution: Interaction variables.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#session-info-17"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#footnote-5"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html"><i class="fa fa-check"></i><b>19</b> Metric Predicted Variable with One Nominal Predictor</a>
<ul>
<li class="chapter" data-level="19.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#describing-multiple-groups-of-metric-data"><i class="fa fa-check"></i><b>19.1</b> Describing multiple groups of metric data</a></li>
<li class="chapter" data-level="19.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#traditional-analysis-of-variance"><i class="fa fa-check"></i><b>19.2</b> Traditional analysis of variance</a></li>
<li class="chapter" data-level="19.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#hierarchical-bayesian-approach"><i class="fa fa-check"></i><b>19.3</b> Hierarchical Bayesian approach</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#implementation-in-jags-brms."><i class="fa fa-check"></i><b>19.3.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="19.3.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-and-death."><i class="fa fa-check"></i><b>19.3.2</b> Example: Sex and death.</a></li>
<li class="chapter" data-level="19.3.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#contrasts."><i class="fa fa-check"></i><b>19.3.3</b> Contrasts.</a></li>
<li class="chapter" data-level="19.3.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#multiple-comparisons-and-shrinkage."><i class="fa fa-check"></i><b>19.3.4</b> Multiple comparisons and shrinkage.</a></li>
<li class="chapter" data-level="19.3.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#the-two-group-case."><i class="fa fa-check"></i><b>19.3.5</b> The two-group case.</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#including-a-metric-predictor"><i class="fa fa-check"></i><b>19.4</b> Including a metric predictor</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-death-and-size."><i class="fa fa-check"></i><b>19.4.1</b> Example: Sex, death, and size.</a></li>
<li class="chapter" data-level="19.4.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#analogous-to-traditional-ancova."><i class="fa fa-check"></i><b>19.4.2</b> Analogous to traditional ANCOVA.</a></li>
<li class="chapter" data-level="19.4.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#relation-to-hierarchical-linear-regression."><i class="fa fa-check"></i><b>19.4.3</b> Relation to hierarchical linear regression.</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#heterogeneous-variances-and-robustness-against-outliers"><i class="fa fa-check"></i><b>19.5</b> Heterogeneous variances and robustness against outliers</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-contrast-of-means-with-different-variances."><i class="fa fa-check"></i><b>19.5.1</b> Example: Contrast of means with different variances.</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#exercises-walk-out-an-effect-size"><i class="fa fa-check"></i><b>19.6</b> <del>Exercises</del> Walk out an effect size</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#your-sample-sizes-may-differ."><i class="fa fa-check"></i><b>19.6.1</b> Your sample sizes may differ.</a></li>
<li class="chapter" data-level="19.6.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#populations-and-samples."><i class="fa fa-check"></i><b>19.6.2</b> Populations and samples.</a></li>
<li class="chapter" data-level="19.6.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#report-your-effect-sizes-effectively."><i class="fa fa-check"></i><b>19.6.3</b> Report your effect sizes effectively.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#session-info-18"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Metric Predicted Variable with Multiple Nominal Predictors</a>
<ul>
<li class="chapter" data-level="20.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#describing-groups-of-metric-data-with-multiple-nominal-predictors"><i class="fa fa-check"></i><b>20.1</b> Describing groups of metric data with multiple nominal predictors</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction."><i class="fa fa-check"></i><b>20.1.1</b> Interaction.</a></li>
<li class="chapter" data-level="20.1.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#traditional-anova."><i class="fa fa-check"></i><b>20.1.2</b> Traditional ANOVA.</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#hierarchical-bayesian-approach-1"><i class="fa fa-check"></i><b>20.2</b> Hierarchical Bayesian approach</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>20.2.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="20.2.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#example-its-only-money."><i class="fa fa-check"></i><b>20.2.2</b> Example: It’s only money.</a></li>
<li class="chapter" data-level="20.2.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#main-effect-contrasts."><i class="fa fa-check"></i><b>20.2.3</b> Main effect contrasts.</a></li>
<li class="chapter" data-level="20.2.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction-contrasts-and-simple-effects."><i class="fa fa-check"></i><b>20.2.4</b> Interaction contrasts and simple effects.</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#rescaling-can-change-interactions-homogeneity-and-normality"><i class="fa fa-check"></i><b>20.3</b> Rescaling can change interactions, homogeneity, and normality</a></li>
<li class="chapter" data-level="20.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1"><i class="fa fa-check"></i><b>20.4</b> Heterogeneous variances and robustness against outliers</a></li>
<li class="chapter" data-level="20.5" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#within-subject-designs"><i class="fa fa-check"></i><b>20.5</b> Within-subject designs</a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#why-use-a-within-subject-design-and-why-not"><i class="fa fa-check"></i><b>20.5.1</b> Why use a within-subject design? And why not?</a></li>
<li class="chapter" data-level="20.5.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#split-plot-design."><i class="fa fa-check"></i><b>20.5.2</b> Split-plot design.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#session-info-19"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#footnote-6"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html"><i class="fa fa-check"></i><b>21</b> Dichotomous Predicted Variable</a>
<ul>
<li class="chapter" data-level="21.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-metric-predictors"><i class="fa fa-check"></i><b>21.1</b> Multiple metric predictors</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#the-model-and-implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>21.1.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="21.1.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#example-height-weight-and-gender."><i class="fa fa-check"></i><b>21.1.2</b> Example: Height, weight, and gender.</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interpreting-the-regression-coefficients"><i class="fa fa-check"></i><b>21.2</b> Interpreting the regression coefficients</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#log-odds."><i class="fa fa-check"></i><b>21.2.1</b> Log odds.</a></li>
<li class="chapter" data-level="21.2.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#when-there-are-few-1s-or-0s-in-the-data."><i class="fa fa-check"></i><b>21.2.2</b> When there are few 1’s or 0’s in the data.</a></li>
<li class="chapter" data-level="21.2.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#correlated-predictors."><i class="fa fa-check"></i><b>21.2.3</b> Correlated predictors.</a></li>
<li class="chapter" data-level="21.2.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interaction-of-metric-predictors."><i class="fa fa-check"></i><b>21.2.4</b> Interaction of metric predictors.</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#robust-logistic-regression"><i class="fa fa-check"></i><b>21.3</b> Robust logistic regression</a></li>
<li class="chapter" data-level="21.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#nominal-predictors"><i class="fa fa-check"></i><b>21.4</b> Nominal predictors</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#single-group."><i class="fa fa-check"></i><b>21.4.1</b> Single group.</a></li>
<li class="chapter" data-level="21.4.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-groups."><i class="fa fa-check"></i><b>21.4.2</b> Multiple groups.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#session-info-20"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html"><i class="fa fa-check"></i><b>22</b> Nominal Predicted Variable</a>
<ul>
<li class="chapter" data-level="22.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-regression"><i class="fa fa-check"></i><b>22.1</b> Softmax regression</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-reduces-to-logistic-for-two-outcomes."><i class="fa fa-check"></i><b>22.1.1</b> Softmax reduces to logistic for two outcomes.</a></li>
<li class="chapter" data-level="22.1.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#independence-from-irrelevant-attributes."><i class="fa fa-check"></i><b>22.1.2</b> Independence from irrelevant attributes.</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>22.2</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="22.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#implementation-in-jags-brms"><i class="fa fa-check"></i><b>22.3</b> Implementation in <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-model."><i class="fa fa-check"></i><b>22.3.1</b> Softmax model.</a></li>
<li class="chapter" data-level="22.3.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-model."><i class="fa fa-check"></i><b>22.3.2</b> Conditional logistic model.</a></li>
<li class="chapter" data-level="22.3.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#results-interpreting-the-regression-coefficients."><i class="fa fa-check"></i><b>22.3.3</b> Results: Interpreting the regression coefficients.</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#generalizations-and-variations-of-the-models"><i class="fa fa-check"></i><b>22.4</b> Generalizations and variations of the models</a></li>
<li class="chapter" data-level="" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#session-info-21"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html"><i class="fa fa-check"></i><b>23</b> Ordinal Predicted Variable</a>
<ul>
<li class="chapter" data-level="23.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#modeling-ordinal-data-with-an-underlying-metric-variable"><i class="fa fa-check"></i><b>23.1</b> Modeling ordinal data with an underlying metric variable</a></li>
<li class="chapter" data-level="23.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-a-single-group"><i class="fa fa-check"></i><b>23.2</b> The case of a single group</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-3"><i class="fa fa-check"></i><b>23.2.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.2.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-bayesian-estimation-recovers-true-parameter-values."><i class="fa fa-check"></i><b>23.2.2</b> Examples: Bayesian estimation recovers true parameter values.</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-two-groups"><i class="fa fa-check"></i><b>23.3</b> The case of two groups</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-4"><i class="fa fa-check"></i><b>23.3.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.3.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-not-funny."><i class="fa fa-check"></i><b>23.3.2</b> Examples: Not funny.</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-metric-predictors"><i class="fa fa-check"></i><b>23.4</b> The Case of metric predictors</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-5"><i class="fa fa-check"></i><b>23.4.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="23.4.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-happiness-and-money."><i class="fa fa-check"></i><b>23.4.2</b> Example: Happiness and money.</a></li>
<li class="chapter" data-level="23.4.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-moviesthey-dont-make-em-like-they-used-to."><i class="fa fa-check"></i><b>23.4.3</b> Example: Movies–They don’t make ’em like they used to.</a></li>
<li class="chapter" data-level="23.4.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#why-are-some-thresholds-outside-the-data"><i class="fa fa-check"></i><b>23.4.4</b> Why are some thresholds outside the data?</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#posterior-prediction"><i class="fa fa-check"></i><b>23.5</b> Posterior prediction</a></li>
<li class="chapter" data-level="23.6" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#generalizations-and-extensions"><i class="fa fa-check"></i><b>23.6</b> Generalizations and extensions</a></li>
<li class="chapter" data-level="" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#session-info-22"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html"><i class="fa fa-check"></i><b>24</b> Count Predicted Variable</a>
<ul>
<li class="chapter" data-level="24.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-exponential-model"><i class="fa fa-check"></i><b>24.1</b> Poisson exponential model</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#data-structure."><i class="fa fa-check"></i><b>24.1.1</b> Data structure.</a></li>
<li class="chapter" data-level="24.1.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#exponential-link-function."><i class="fa fa-check"></i><b>24.1.2</b> Exponential link function.</a></li>
<li class="chapter" data-level="24.1.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-noise-distribution."><i class="fa fa-check"></i><b>24.1.3</b> Poisson noise distribution.</a></li>
<li class="chapter" data-level="24.1.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#the-complete-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>24.1.4</b> The complete model and implementation in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-hair-eye-go-again"><i class="fa fa-check"></i><b>24.2</b> Example: Hair eye go again</a></li>
<li class="chapter" data-level="24.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-interaction-contrasts-shrinkage-and-omnibus-test"><i class="fa fa-check"></i><b>24.3</b> Example: Interaction contrasts, shrinkage, and omnibus test</a></li>
<li class="chapter" data-level="24.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#log-linear-models-for-contingency-tables-bonus-alternative-parameterization"><i class="fa fa-check"></i><b>24.4</b> <del>Log-linear models for contingency tables</del> Bonus: Alternative parameterization</a></li>
<li class="chapter" data-level="" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#session-info-23"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html"><i class="fa fa-check"></i><b>25</b> Tools in the Trunk</a>
<ul>
<li class="chapter" data-level="25.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reporting-a-bayesian-analysis"><i class="fa fa-check"></i><b>25.1</b> Reporting a Bayesian analysis</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#essential-points."><i class="fa fa-check"></i><b>25.1.1</b> Essential points.</a></li>
<li class="chapter" data-level="25.1.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#optional-points."><i class="fa fa-check"></i><b>25.1.2</b> Optional points.</a></li>
<li class="chapter" data-level="25.1.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#helpful-points."><i class="fa fa-check"></i><b>25.1.3</b> Helpful points.</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#functions-for-computing-highest-density-intervals"><i class="fa fa-check"></i><b>25.2</b> Functions for computing highest density intervals</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-grid-approximation."><i class="fa fa-check"></i><b>25.2.1</b> R code for computing HDI of a grid approximation.</a></li>
<li class="chapter" data-level="25.2.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#hdi-of-unimodal-distribution-is-shortest-interval."><i class="fa fa-check"></i><b>25.2.2</b> HDI of unimodal distribution is shortest interval.</a></li>
<li class="chapter" data-level="25.2.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-mcmc-sample."><i class="fa fa-check"></i><b>25.2.3</b> R code for computing HDI of a MCMC sample.</a></li>
<li class="chapter" data-level="25.2.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-function."><i class="fa fa-check"></i><b>25.2.4</b> R code for computing HDI of a function.</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reparameterization"><i class="fa fa-check"></i><b>25.3</b> Reparameterization</a></li>
<li class="chapter" data-level="25.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#censored-data-in-jags-brms"><i class="fa fa-check"></i><b>25.4</b> Censored data in <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="25.4.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#right-censoring-when-youre-uncertain-beyond-a-single-threshold."><i class="fa fa-check"></i><b>25.4.1</b> Right censoring: When you’re uncertain beyond a single threshold.</a></li>
<li class="chapter" data-level="25.4.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#interval-censoring-when-your-values-are-somewhere-in-the-middle."><i class="fa fa-check"></i><b>25.4.2</b> Interval censoring: When your values are somewhere in the middle.</a></li>
<li class="chapter" data-level="25.4.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#complex-censoring-when-the-going-gets-tough"><i class="fa fa-check"></i><b>25.4.3</b> Complex censoring: When the going gets tough…</a></li>
<li class="chapter" data-level="25.4.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#bonus-truncation."><i class="fa fa-check"></i><b>25.4.4</b> Bonus: Truncation.</a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#what-next"><i class="fa fa-check"></i><b>25.5</b> What Next?</a></li>
<li class="chapter" data-level="" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#session-info-24"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Doing Bayesian Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="overview-of-the-generalized-linear-model" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">15</span> Overview of the Generalized Linear Model<a href="overview-of-the-generalized-linear-model.html#overview-of-the-generalized-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Along with Kruschke’s text, in this part if the project we’re moving away from simple Bernoulli coin flipping examples to more complicated analyses of the type we’d actually see in applied data analysis. As Kruschke explained, we’ll be using a</p>
<blockquote>
<p>versatile family of models known as the generalized linear model [GLM; <span class="citation"><a href="#ref-nelder1972generalized" role="doc-biblioref">Nelder &amp; Wedderburn</a> (<a href="#ref-nelder1972generalized" role="doc-biblioref">1972</a>)</span>; <span class="citation"><a href="#ref-nelder1972generalized" role="doc-biblioref">Nelder &amp; Wedderburn</a> (<a href="#ref-nelder1972generalized" role="doc-biblioref">1972</a>)</span>]. This family of models comprises the traditional “off the shelf” analyses such as <span class="math inline">\(t\)</span> tests, analysis of variance (ANOVA), multiple linear regression, logistic regression, log-linear models, etc. <span class="citation">(<a href="#ref-kruschkeDoingBayesianData2015" role="doc-biblioref">Kruschke, 2015, p. 420</a>)</span></p>
</blockquote>
<div id="types-of-variables" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> Types of variables<a href="overview-of-the-generalized-linear-model.html#types-of-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>“To understand the GLM and its many specific cases, we must build up a variety of component concepts regarding relationships between variables and how variables are measured in the first place (p. 420).”</p>
<div id="predictor-and-predicted-variables." class="section level3 hasAnchor" number="15.1.1">
<h3><span class="header-section-number">15.1.1</span> Predictor and predicted variables.<a href="overview-of-the-generalized-linear-model.html#predictor-and-predicted-variables." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It’s worth repeating the second paragraph of this subsection in its entirety.</p>
<blockquote>
<p>The key mathematical difference between predictor and predicted variables is that the likelihood function expresses the probability of values of the predicted variable as a function of values of the predictor variable. The likelihood function does not describe the probabilities of values of the predictor variable. The value of the predictor variable comes from outside the system being modeled, whereas the value of the predicted variable depends on the value of the predictor variable. (p. 420)</p>
</blockquote>
<p>This is one of those fine points that can be easy to miss when you’re struggling through the examples in this book or chest-deep in the murky waters of your own real-world data problem. But write this down on a sticky note and put it in your sock drawer or something. There are good reasons to fret about the distributional properties of your predictor variables–rules of thumb about the likelihood aren’t among them.</p>
</div>
<div id="scale-types-metric-ordinal-nominal-and-count." class="section level3 hasAnchor" number="15.1.2">
<h3><span class="header-section-number">15.1.2</span> Scale types: metric, ordinal, nominal, and count.<a href="overview-of-the-generalized-linear-model.html#scale-types-metric-ordinal-nominal-and-count." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I don’t know that I’m interested in detailing the content of this section. But it’s worth while considering what Kruschke wrote in its close.</p>
<blockquote>
<p><strong>Why we care:</strong> We care about the scale type because the likelihood function must specify a probability distribution on the appropriate scale. If the scale has two nominal values, then a Bernoulli likelihood function may be appropriate. If the scale is metric, then a normal distribution may be appropriate as a probability distribution to describe the data. Whenever we are choosing a model for data, we must answer the question, What kind of scale are we dealing with? (p. 423, <strong>emphasis</strong> in the original)</p>
</blockquote>
</div>
</div>
<div id="linear-combination-of-predictors" class="section level2 hasAnchor" number="15.2">
<h2><span class="header-section-number">15.2</span> Linear combination of predictors<a href="overview-of-the-generalized-linear-model.html#linear-combination-of-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>“The core of the GLM is expressing the combined influence of predictors as their weighted sum. The following sections build this idea by scaffolding from the simplest intuitive cases” (p. 423).</p>
<div id="linear-function-of-a-single-metric-predictor." class="section level3 hasAnchor" number="15.2.1">
<h3><span class="header-section-number">15.2.1</span> Linear function of a single metric predictor.<a href="overview-of-the-generalized-linear-model.html#linear-function-of-a-single-metric-predictor." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>“A linear function is the generic, ‘vanilla,’ off-the-shelf dependency that is used in statistical models” (p. 424). Its basic form is</p>
<p><span class="math display">\[y = \beta_0 + \beta_1 x,\]</span></p>
<p>where <span class="math inline">\(y\)</span> is the variable being predicted and <span class="math inline">\(x\)</span> is the predictor. <span class="math inline">\(\beta_0\)</span> is the intercept (i.e., the expected value when <span class="math inline">\(x\)</span> is zero) and <span class="math inline">\(\beta_1\)</span> is the expected increase in <span class="math inline">\(y\)</span> after a one-unit increase in <span class="math inline">\(x\)</span>.</p>
<p>Before we make our version of Figure 15.1, let’s talk about our theme and color palette. In this chapter, we’ll base our overall on <code>ggplot2::theme_linedraw()</code>. We’ll take selections from <code>option = "E"</code> from the <a href="https://github.com/sjmgarnier/viridis"><strong>viridis</strong> package</a> to make our color palette. Based on our <strong>ggplot2</strong> skills from the last few chapters, these moves are pretty mundane. We can go further.</p>
<p>In this chapter, we’ll extend our skillset by practicing how to alter the default settings of our <strong>ggplot2</strong> geoms. If you browse through the content of the text, you’ll see we’ll a lot of the upcomming plots will require lines of various sorts. We’ll make the bulk of those lines with <code>geom_line()</code>, <code>geom_hline()</code>, <code>geom_vline()</code>, and <code>geom_segment()</code>. as a first step, it’d be handy to see how their default aesthetic settings are defined. Here’s how to do that for <code>geom_line()</code>.</p>
<div class="sourceCode" id="cb1373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1373-1"><a href="overview-of-the-generalized-linear-model.html#cb1373-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">:::</span><span class="fu">check_subclass</span>(<span class="st">&quot;line&quot;</span>, <span class="st">&quot;Geom&quot;</span>)<span class="sc">$</span>default_aes</span></code></pre></div>
<pre><code>## Aesthetic mapping: 
## * `colour`   -&gt; &quot;black&quot;
## * `size`     -&gt; 0.5
## * `linetype` -&gt; 1
## * `alpha`    -&gt; NA</code></pre>
<p>We can use the <code>ggplot2::update_geom_defaults()</code> function to change those default settings. Here’s how we might go about increasing the default <code>size</code> and <code>color</code> parameters.</p>
<div class="sourceCode" id="cb1375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1375-1"><a href="overview-of-the-generalized-linear-model.html#cb1375-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1375-2"><a href="overview-of-the-generalized-linear-model.html#cb1375-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1375-3"><a href="overview-of-the-generalized-linear-model.html#cb1375-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1375-4"><a href="overview-of-the-generalized-linear-model.html#cb1375-4" aria-hidden="true" tabindex="-1"></a>default_line <span class="ot">&lt;-</span> ggplot2<span class="sc">:::</span><span class="fu">check_subclass</span>(<span class="st">&quot;line&quot;</span>, <span class="st">&quot;Geom&quot;</span>)<span class="sc">$</span>default_aes</span>
<span id="cb1375-5"><a href="overview-of-the-generalized-linear-model.html#cb1375-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1375-6"><a href="overview-of-the-generalized-linear-model.html#cb1375-6" aria-hidden="true" tabindex="-1"></a><span class="fu">update_geom_defaults</span>(</span>
<span id="cb1375-7"><a href="overview-of-the-generalized-linear-model.html#cb1375-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, </span>
<span id="cb1375-8"><a href="overview-of-the-generalized-linear-model.html#cb1375-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">new =</span> <span class="fu">list</span>(</span>
<span id="cb1375-9"><a href="overview-of-the-generalized-linear-model.html#cb1375-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>)(<span class="dv">9</span>)[<span class="dv">2</span>],</span>
<span id="cb1375-10"><a href="overview-of-the-generalized-linear-model.html#cb1375-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb1375-11"><a href="overview-of-the-generalized-linear-model.html#cb1375-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Now confirm our new defaults.</p>
<div class="sourceCode" id="cb1376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1376-1"><a href="overview-of-the-generalized-linear-model.html#cb1376-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">:::</span><span class="fu">check_subclass</span>(<span class="st">&quot;line&quot;</span>, <span class="st">&quot;Geom&quot;</span>)<span class="sc">$</span>default_aes</span></code></pre></div>
<pre><code>## $colour
## [1] &quot;#05366EFF&quot;
## 
## $size
## [1] 1
## 
## $linetype
## [1] 1
## 
## $alpha
## [1] NA</code></pre>
<p>Critically, notice how we saved the original default settings for <code>geom_line()</code> as <code>default_line</code> <strong>before</strong> we changed them. That way, all we have to do is execute this to change things back to normal.</p>
<div class="sourceCode" id="cb1378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1378-1"><a href="overview-of-the-generalized-linear-model.html#cb1378-1" aria-hidden="true" tabindex="-1"></a><span class="fu">update_geom_defaults</span>(</span>
<span id="cb1378-2"><a href="overview-of-the-generalized-linear-model.html#cb1378-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, </span>
<span id="cb1378-3"><a href="overview-of-the-generalized-linear-model.html#cb1378-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">new =</span> default_line</span>
<span id="cb1378-4"><a href="overview-of-the-generalized-linear-model.html#cb1378-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1378-5"><a href="overview-of-the-generalized-linear-model.html#cb1378-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1378-6"><a href="overview-of-the-generalized-linear-model.html#cb1378-6" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">:::</span><span class="fu">check_subclass</span>(<span class="st">&quot;line&quot;</span>, <span class="st">&quot;Geom&quot;</span>)<span class="sc">$</span>default_aes</span></code></pre></div>
<pre><code>## $colour
## [1] &quot;black&quot;
## 
## $size
## [1] 0.5
## 
## $linetype
## [1] 1
## 
## $alpha
## [1] NA</code></pre>
<p>Now you see how this works, let’s save the default settings for the other three geoms.</p>
<div class="sourceCode" id="cb1380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1380-1"><a href="overview-of-the-generalized-linear-model.html#cb1380-1" aria-hidden="true" tabindex="-1"></a>default_hline <span class="ot">&lt;-</span> ggplot2<span class="sc">:::</span><span class="fu">check_subclass</span>(<span class="st">&quot;vline&quot;</span>, <span class="st">&quot;Geom&quot;</span>)<span class="sc">$</span>default_aes</span>
<span id="cb1380-2"><a href="overview-of-the-generalized-linear-model.html#cb1380-2" aria-hidden="true" tabindex="-1"></a>default_vline <span class="ot">&lt;-</span> ggplot2<span class="sc">:::</span><span class="fu">check_subclass</span>(<span class="st">&quot;hline&quot;</span>, <span class="st">&quot;Geom&quot;</span>)<span class="sc">$</span>default_aes</span>
<span id="cb1380-3"><a href="overview-of-the-generalized-linear-model.html#cb1380-3" aria-hidden="true" tabindex="-1"></a>default_segment <span class="ot">&lt;-</span> ggplot2<span class="sc">:::</span><span class="fu">check_subclass</span>(<span class="st">&quot;segment&quot;</span>, <span class="st">&quot;Geom&quot;</span>)<span class="sc">$</span>default_aes</span></code></pre></div>
<p>Here we’ll update the defaults of all four of our line-oriented geoms and change the settings for our global plot theme.</p>
<div class="sourceCode" id="cb1381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1381-1"><a href="overview-of-the-generalized-linear-model.html#cb1381-1" aria-hidden="true" tabindex="-1"></a><span class="fu">update_geom_defaults</span>(</span>
<span id="cb1381-2"><a href="overview-of-the-generalized-linear-model.html#cb1381-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, </span>
<span id="cb1381-3"><a href="overview-of-the-generalized-linear-model.html#cb1381-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">new =</span> <span class="fu">list</span>(</span>
<span id="cb1381-4"><a href="overview-of-the-generalized-linear-model.html#cb1381-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>)(<span class="dv">9</span>)[<span class="dv">2</span>],</span>
<span id="cb1381-5"><a href="overview-of-the-generalized-linear-model.html#cb1381-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb1381-6"><a href="overview-of-the-generalized-linear-model.html#cb1381-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1381-7"><a href="overview-of-the-generalized-linear-model.html#cb1381-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1381-8"><a href="overview-of-the-generalized-linear-model.html#cb1381-8" aria-hidden="true" tabindex="-1"></a><span class="fu">update_geom_defaults</span>(</span>
<span id="cb1381-9"><a href="overview-of-the-generalized-linear-model.html#cb1381-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">geom =</span> <span class="st">&quot;hline&quot;</span>, </span>
<span id="cb1381-10"><a href="overview-of-the-generalized-linear-model.html#cb1381-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">new =</span> <span class="fu">list</span>(</span>
<span id="cb1381-11"><a href="overview-of-the-generalized-linear-model.html#cb1381-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>)(<span class="dv">9</span>)[<span class="dv">8</span>],</span>
<span id="cb1381-12"><a href="overview-of-the-generalized-linear-model.html#cb1381-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>,</span>
<span id="cb1381-13"><a href="overview-of-the-generalized-linear-model.html#cb1381-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">2</span>)</span>
<span id="cb1381-14"><a href="overview-of-the-generalized-linear-model.html#cb1381-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1381-15"><a href="overview-of-the-generalized-linear-model.html#cb1381-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1381-16"><a href="overview-of-the-generalized-linear-model.html#cb1381-16" aria-hidden="true" tabindex="-1"></a><span class="fu">update_geom_defaults</span>(</span>
<span id="cb1381-17"><a href="overview-of-the-generalized-linear-model.html#cb1381-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">geom =</span> <span class="st">&quot;vline&quot;</span>, </span>
<span id="cb1381-18"><a href="overview-of-the-generalized-linear-model.html#cb1381-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">new =</span> <span class="fu">list</span>(</span>
<span id="cb1381-19"><a href="overview-of-the-generalized-linear-model.html#cb1381-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>)(<span class="dv">9</span>)[<span class="dv">8</span>],</span>
<span id="cb1381-20"><a href="overview-of-the-generalized-linear-model.html#cb1381-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>,</span>
<span id="cb1381-21"><a href="overview-of-the-generalized-linear-model.html#cb1381-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">2</span>)</span>
<span id="cb1381-22"><a href="overview-of-the-generalized-linear-model.html#cb1381-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1381-23"><a href="overview-of-the-generalized-linear-model.html#cb1381-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1381-24"><a href="overview-of-the-generalized-linear-model.html#cb1381-24" aria-hidden="true" tabindex="-1"></a><span class="fu">update_geom_defaults</span>(</span>
<span id="cb1381-25"><a href="overview-of-the-generalized-linear-model.html#cb1381-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">geom =</span> <span class="st">&quot;segment&quot;</span>, </span>
<span id="cb1381-26"><a href="overview-of-the-generalized-linear-model.html#cb1381-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">new =</span> <span class="fu">list</span>(</span>
<span id="cb1381-27"><a href="overview-of-the-generalized-linear-model.html#cb1381-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>)(<span class="dv">9</span>)[<span class="dv">5</span>],</span>
<span id="cb1381-28"><a href="overview-of-the-generalized-linear-model.html#cb1381-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb1381-29"><a href="overview-of-the-generalized-linear-model.html#cb1381-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1381-30"><a href="overview-of-the-generalized-linear-model.html#cb1381-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1381-31"><a href="overview-of-the-generalized-linear-model.html#cb1381-31" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(</span>
<span id="cb1381-32"><a href="overview-of-the-generalized-linear-model.html#cb1381-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb1381-33"><a href="overview-of-the-generalized-linear-model.html#cb1381-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb1381-34"><a href="overview-of-the-generalized-linear-model.html#cb1381-34" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>You can learn more about these methods <a href="https://ggplot2.tidyverse.org/reference/update_defaults.html">here</a> and <a href="https://stackoverflow.com/questions/40307499/resetting-update-geom-defaults-in-ggplot2">here</a>. Let’s see what we’ve done by making the left panel of Figure 15.1.</p>
<div class="sourceCode" id="cb1382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1382-1"><a href="overview-of-the-generalized-linear-model.html#cb1382-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1382-2"><a href="overview-of-the-generalized-linear-model.html#cb1382-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y_1 =</span> <span class="sc">-</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x,</span>
<span id="cb1382-3"><a href="overview-of-the-generalized-linear-model.html#cb1382-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">y_2 =</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x) <span class="sc">%&gt;%</span> </span>
<span id="cb1382-4"><a href="overview-of-the-generalized-linear-model.html#cb1382-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1382-5"><a href="overview-of-the-generalized-linear-model.html#cb1382-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb1382-6"><a href="overview-of-the-generalized-linear-model.html#cb1382-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1382-7"><a href="overview-of-the-generalized-linear-model.html#cb1382-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1382-8"><a href="overview-of-the-generalized-linear-model.html#cb1382-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> y_1)) <span class="sc">+</span></span>
<span id="cb1382-9"><a href="overview-of-the-generalized-linear-model.html#cb1382-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> y_2)) <span class="sc">+</span></span>
<span id="cb1382-10"><a href="overview-of-the-generalized-linear-model.html#cb1382-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">tibble</span>(</span>
<span id="cb1382-11"><a href="overview-of-the-generalized-linear-model.html#cb1382-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="fl">2.25</span>,</span>
<span id="cb1382-12"><a href="overview-of-the-generalized-linear-model.html#cb1382-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb1382-13"><a href="overview-of-the-generalized-linear-model.html#cb1382-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;y = -5 + 2x&quot;</span>, <span class="st">&quot;y = 10 + 2x&quot;</span>)</span>
<span id="cb1382-14"><a href="overview-of-the-generalized-linear-model.html#cb1382-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb1382-15"><a href="overview-of-the-generalized-linear-model.html#cb1382-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">label =</span> label),</span>
<span id="cb1382-16"><a href="overview-of-the-generalized-linear-model.html#cb1382-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb1382-17"><a href="overview-of-the-generalized-linear-model.html#cb1382-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Different Intercepts&quot;</span>,</span>
<span id="cb1382-18"><a href="overview-of-the-generalized-linear-model.html#cb1382-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb1382-19"><a href="overview-of-the-generalized-linear-model.html#cb1382-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">6</span>),</span>
<span id="cb1382-20"><a href="overview-of-the-generalized-linear-model.html#cb1382-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">25</span>))</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-9-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>Did you notice how we followed the form of the basic linear function when we defined the values for <code>y_1</code> and <code>y_2</code>? It’s that simple! Here’s the right panel.</p>
<div class="sourceCode" id="cb1383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1383-1"><a href="overview-of-the-generalized-linear-model.html#cb1383-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1383-2"><a href="overview-of-the-generalized-linear-model.html#cb1383-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y_1 =</span> <span class="dv">10</span> <span class="sc">+</span> <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> x,</span>
<span id="cb1383-3"><a href="overview-of-the-generalized-linear-model.html#cb1383-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">y_2 =</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x) <span class="sc">%&gt;%</span> </span>
<span id="cb1383-4"><a href="overview-of-the-generalized-linear-model.html#cb1383-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1383-5"><a href="overview-of-the-generalized-linear-model.html#cb1383-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb1383-6"><a href="overview-of-the-generalized-linear-model.html#cb1383-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1383-7"><a href="overview-of-the-generalized-linear-model.html#cb1383-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1383-8"><a href="overview-of-the-generalized-linear-model.html#cb1383-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> y_1)) <span class="sc">+</span></span>
<span id="cb1383-9"><a href="overview-of-the-generalized-linear-model.html#cb1383-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> y_2)) <span class="sc">+</span></span>
<span id="cb1383-10"><a href="overview-of-the-generalized-linear-model.html#cb1383-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">tibble</span>(</span>
<span id="cb1383-11"><a href="overview-of-the-generalized-linear-model.html#cb1383-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="dv">4</span>,</span>
<span id="cb1383-12"><a href="overview-of-the-generalized-linear-model.html#cb1383-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="fl">13.75</span>),</span>
<span id="cb1383-13"><a href="overview-of-the-generalized-linear-model.html#cb1383-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;y = 10 + -0.5x&quot;</span>, <span class="st">&quot;y = 10 + 2x&quot;</span>)</span>
<span id="cb1383-14"><a href="overview-of-the-generalized-linear-model.html#cb1383-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb1383-15"><a href="overview-of-the-generalized-linear-model.html#cb1383-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">label =</span> label),</span>
<span id="cb1383-16"><a href="overview-of-the-generalized-linear-model.html#cb1383-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb1383-17"><a href="overview-of-the-generalized-linear-model.html#cb1383-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Different Slopes&quot;</span>,</span>
<span id="cb1383-18"><a href="overview-of-the-generalized-linear-model.html#cb1383-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb1383-19"><a href="overview-of-the-generalized-linear-model.html#cb1383-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">6</span>),</span>
<span id="cb1383-20"><a href="overview-of-the-generalized-linear-model.html#cb1383-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">25</span>))</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-10-1.png" width="288" style="display: block; margin: auto;" /></p>
<blockquote>
<p><strong>Summary of why we care.</strong> The likelihood function includes the form of the dependency of <span class="math inline">\(y\)</span> on <span class="math inline">\(x\)</span>. When <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> are metric variables, the simplest form of dependency, both mathematically and intuitively, is one that preserves proportionality. The mathematical expression of this relation is a so-called linear function. The usual mathematical expression of a line is the <span class="math inline">\(y\)</span>-intercept form, but sometimes a more intuitive expression is the <span class="math inline">\(x\)</span> threshold form. Linear functions form the core of the GLM. (pp. 424–425, <strong>emphasis</strong> in the original)</p>
</blockquote>
</div>
<div id="additive-combination-of-metric-predictors." class="section level3 hasAnchor" number="15.2.2">
<h3><span class="header-section-number">15.2.2</span> Additive combination of metric predictors.<a href="overview-of-the-generalized-linear-model.html#additive-combination-of-metric-predictors." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The linear combination of <span class="math inline">\(K\)</span> predictors has the general form</p>
<p><span class="math display">\[\begin{align*}
y &amp; = \beta_0 + \beta_1 x_1 + \dots + \beta_K x_K \\
  &amp; = \beta_0 + \sum_{k = 1}^K \beta_k x_k.
\end{align*}\]</span></p>
<p>In the special case where <span class="math inline">\(K = 0\)</span>, you have an intercept-only model,</p>
<p><span class="math display">\[y = \beta_0,\]</span></p>
<p>in which <span class="math inline">\(\beta_0\)</span> simply models the mean of <span class="math inline">\(y\)</span>.</p>
<p>We won’t be able to reproduce the wireframe plots of Figure 15.2, exactly. But we can use some <code>geom_raster()</code> tricks from back in <a href="model-comparison-and-hierarchical-modeling.html#model-comparison-and-hierarchical-modeling">Chapter 10</a> to express the third <span class="math inline">\(y\)</span> dimension as fill gradients.</p>
<div class="sourceCode" id="cb1384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1384-1"><a href="overview-of-the-generalized-linear-model.html#cb1384-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">x1 =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb1384-2"><a href="overview-of-the-generalized-linear-model.html#cb1384-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">x2 =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1384-3"><a href="overview-of-the-generalized-linear-model.html#cb1384-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">y[1] ==  0 + 1 * x[1] + 0 * x[2]</span><span class="st">`</span> <span class="ot">=</span>  <span class="dv">0</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="dv">0</span> <span class="sc">*</span> x2,</span>
<span id="cb1384-4"><a href="overview-of-the-generalized-linear-model.html#cb1384-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">y[2] ==  0 + 0 * x[1] + 2 * x[2]</span><span class="st">`</span> <span class="ot">=</span>  <span class="dv">0</span> <span class="sc">+</span> <span class="dv">0</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x2,</span>
<span id="cb1384-5"><a href="overview-of-the-generalized-linear-model.html#cb1384-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">y[3] ==  0 + 1 * x[1] + 2 * x[2]</span><span class="st">`</span> <span class="ot">=</span>  <span class="dv">0</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x2,</span>
<span id="cb1384-6"><a href="overview-of-the-generalized-linear-model.html#cb1384-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">y[4] == 10 + 1 * x[1] + 2 * x[2]</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x2) <span class="sc">%&gt;%</span></span>
<span id="cb1384-7"><a href="overview-of-the-generalized-linear-model.html#cb1384-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(x1, x2),</span>
<span id="cb1384-8"><a href="overview-of-the-generalized-linear-model.html#cb1384-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1384-9"><a href="overview-of-the-generalized-linear-model.html#cb1384-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1384-10"><a href="overview-of-the-generalized-linear-model.html#cb1384-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">fill =</span> y)) <span class="sc">+</span></span>
<span id="cb1384-11"><a href="overview-of-the-generalized-linear-model.html#cb1384-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>() <span class="sc">+</span></span>
<span id="cb1384-12"><a href="overview-of-the-generalized-linear-model.html#cb1384-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>) <span class="sc">+</span></span>
<span id="cb1384-13"><a href="overview-of-the-generalized-linear-model.html#cb1384-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(x[<span class="dv">1</span>]), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb1384-14"><a href="overview-of-the-generalized-linear-model.html#cb1384-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb1384-15"><a href="overview-of-the-generalized-linear-model.html#cb1384-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(x[<span class="dv">2</span>]), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb1384-16"><a href="overview-of-the-generalized-linear-model.html#cb1384-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb1384-17"><a href="overview-of-the-generalized-linear-model.html#cb1384-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb1384-18"><a href="overview-of-the-generalized-linear-model.html#cb1384-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">labeller =</span> label_parsed)</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p>Here we’ve captured some of Kruschke’s grid aesthetic by keeping the <code>by</code> argument within <code>seq()</code> somewhat coarse and omitting the <code>interpolate = T</code> argument from <code>geom_raster()</code>. If you’d prefer smoother fill transitions for the <span class="math inline">\(y\)</span>-values, set <code>by = 0.1</code> and <code>interpolate = T</code>.</p>
</div>
<div id="nonadditive-interaction-of-metric-predictors." class="section level3 hasAnchor" number="15.2.3">
<h3><span class="header-section-number">15.2.3</span> Nonadditive interaction of metric predictors.<a href="overview-of-the-generalized-linear-model.html#nonadditive-interaction-of-metric-predictors." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As it turns out, “the combined influence of two predictors does not have to be additive” (p. 427). Let’s explore what that can look like with our version of Figure 15.3.</p>
<div class="sourceCode" id="cb1385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1385-1"><a href="overview-of-the-generalized-linear-model.html#cb1385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">x1 =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb1385-2"><a href="overview-of-the-generalized-linear-model.html#cb1385-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">x2 =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1385-3"><a href="overview-of-the-generalized-linear-model.html#cb1385-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">y[1] == 0 +  0 * x[1] + 0 * x[2] +  0.2 * x[1] * x[2]</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span> <span class="sc">+</span>  <span class="dv">0</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="dv">0</span> <span class="sc">*</span> x2 <span class="sc">+</span>  <span class="fl">0.2</span> <span class="sc">*</span> x1 <span class="sc">*</span> x2,</span>
<span id="cb1385-4"><a href="overview-of-the-generalized-linear-model.html#cb1385-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">y[2] == 0 +  1 * x[1] + 1 * x[2] +  0   * x[1] * x[2]</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span> <span class="sc">+</span>  <span class="dv">1</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> x2 <span class="sc">+</span>  <span class="dv">0</span>   <span class="sc">*</span> x1 <span class="sc">*</span> x2,</span>
<span id="cb1385-5"><a href="overview-of-the-generalized-linear-model.html#cb1385-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">y[3] == 0 +  1 * x[1] + 1 * x[2] + -0.3 * x[1] * x[2]</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span> <span class="sc">+</span>  <span class="dv">1</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> x2 <span class="sc">+</span> <span class="sc">-</span><span class="fl">0.3</span> <span class="sc">*</span> x1 <span class="sc">*</span> x2,</span>
<span id="cb1385-6"><a href="overview-of-the-generalized-linear-model.html#cb1385-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">y[4] == 0 + -1 * x[1] + 1 * x[2] +  0.2 * x[1] * x[2]</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span> <span class="sc">+</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> x2 <span class="sc">+</span>  <span class="fl">0.2</span> <span class="sc">*</span> x1 <span class="sc">*</span> x2) <span class="sc">%&gt;%</span></span>
<span id="cb1385-7"><a href="overview-of-the-generalized-linear-model.html#cb1385-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(x1, x2),</span>
<span id="cb1385-8"><a href="overview-of-the-generalized-linear-model.html#cb1385-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1385-9"><a href="overview-of-the-generalized-linear-model.html#cb1385-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1385-10"><a href="overview-of-the-generalized-linear-model.html#cb1385-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">fill =</span> y)) <span class="sc">+</span></span>
<span id="cb1385-11"><a href="overview-of-the-generalized-linear-model.html#cb1385-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>() <span class="sc">+</span></span>
<span id="cb1385-12"><a href="overview-of-the-generalized-linear-model.html#cb1385-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>) <span class="sc">+</span></span>
<span id="cb1385-13"><a href="overview-of-the-generalized-linear-model.html#cb1385-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(x[<span class="dv">1</span>]), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb1385-14"><a href="overview-of-the-generalized-linear-model.html#cb1385-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb1385-15"><a href="overview-of-the-generalized-linear-model.html#cb1385-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(x[<span class="dv">2</span>]), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb1385-16"><a href="overview-of-the-generalized-linear-model.html#cb1385-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb1385-17"><a href="overview-of-the-generalized-linear-model.html#cb1385-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb1385-18"><a href="overview-of-the-generalized-linear-model.html#cb1385-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">labeller =</span> label_parsed)</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p>Did you notice all those <code>*</code> operators in the <code>mutate()</code> code? We’re no longer restricting ourselves to additive functions. We’re square in the middle of multiplicative town!</p>
<blockquote>
<p>There is a subtlety in the use of the term “linear” that can sometimes cause confusion in this context. The interactions shown in Figure 15.3 are <em>not</em> linear on the <em>two</em> predictors <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>. But if the product of the two predictors, <span class="math inline">\(x_1 x_2\)</span>, is thought of as a third predictor, then the model <em>is</em> linear on the <em>three</em> predictors, because the predicted value of <span class="math inline">\(y\)</span> is a weighted additive combination of the three predictors. This reconceptualization can be useful for implementing nonlinear interactions in software for linear models, but we will not be making that semantic leap to a third predictor, and instead we will think of a nonadditive combination of two predictors.</p>
<p>A nonadditive interaction of predictors does not have to be multiplicative. Other types of interaction are possible. (p. 428, <em>emphasis</em> in the original)</p>
</blockquote>
<p>In my experience, this “subtlety” is really easy to misunderstand. You might be surprised how often it pops up even among senior scholars. Which is all to say, this stuff is difficult, so give yourself a break.</p>
</div>
<div id="nominal-predictors." class="section level3 hasAnchor" number="15.2.4">
<h3><span class="header-section-number">15.2.4</span> Nominal predictors.<a href="overview-of-the-generalized-linear-model.html#nominal-predictors." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="linear-model-for-a-single-nominal-predictor." class="section level4 hasAnchor" number="15.2.4.1">
<h4><span class="header-section-number">15.2.4.1</span> Linear model for a single nominal predictor.<a href="overview-of-the-generalized-linear-model.html#linear-model-for-a-single-nominal-predictor." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Instead of representing the value of the nominal predictor by a single scalar value <span class="math inline">\(x\)</span>, we will represent the nominal predictor by a vector <span class="math inline">\(\vec{x} = \langle x_{[1]},...,x_{[J]} \rangle\)</span> where <span class="math inline">\(J\)</span> is the number of categories that the predictor has…</p>
<p>We will denote the baseline value of the prediction as <span class="math inline">\(\beta_0\)</span>. The deflection for the <span class="math inline">\(j\)</span>th level of the predictor is denoted <span class="math inline">\(\beta_{[j]}\)</span>. Then the predicted value is</p>
<p><span class="math display">\[\begin{align*}
y &amp; = \beta_0 + \beta_{[1]} x_{[1]} + \dots + \beta_{[J]} x_{[J]} \\
  &amp; = \beta_0 + \vec{\beta} \cdot \vec{x}
\end{align*}\]</span></p>
<p>where the notation <span class="math inline">\(\vec{\beta} \cdot \vec{x}\)</span> is sometimes called the “dot product” of the vectors. (p. 429)</p>
</blockquote>
</div>
<div id="additive-combination-of-nominal-predictors." class="section level4 hasAnchor" number="15.2.4.2">
<h4><span class="header-section-number">15.2.4.2</span> Additive combination of nominal predictors.<a href="overview-of-the-generalized-linear-model.html#additive-combination-of-nominal-predictors." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>When you have two additive nominal predictors, the model follows the form</p>
<p><span class="math display">\[\begin{align*}
y &amp; = \beta_0 + \vec \beta_1 \vec x_1 + \vec \beta_2 \vec x_2 \\
  &amp; = \beta_0 + \sum_{j} \beta_{1[j]} x_{1[j]} + \sum_{k} \beta_{2[k]} x_{2[k]},
\end{align*}\]</span></p>
<p>given the constraints</p>
<p><span class="math display">\[\sum_{j} \beta_{1[j]} = 0 \;\;\; \text{and} \;\;\; \sum_{k} \beta_{2[k]} = 0.\]</span></p>
<p>Both panels in Figure 15.4 are going to require three separate data objects. Here’s the code for the top panel.</p>
<div class="sourceCode" id="cb1386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1386-1"><a href="overview-of-the-generalized-linear-model.html#cb1386-1" aria-hidden="true" tabindex="-1"></a>arrows <span class="ot">&lt;-</span></span>
<span id="cb1386-2"><a href="overview-of-the-generalized-linear-model.html#cb1386-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1.1</span>, <span class="fl">2.1</span>),</span>
<span id="cb1386-3"><a href="overview-of-the-generalized-linear-model.html#cb1386-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.69</span>, <span class="fl">1.69</span>),</span>
<span id="cb1386-4"><a href="overview-of-the-generalized-linear-model.html#cb1386-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="fu">c</span>(<span class="fl">1.69</span>, <span class="fl">1.69</span> <span class="sc">+</span> .<span class="dv">07</span>, <span class="fl">1.69</span> <span class="sc">-</span> .<span class="dv">07</span>))</span>
<span id="cb1386-5"><a href="overview-of-the-generalized-linear-model.html#cb1386-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1386-6"><a href="overview-of-the-generalized-linear-model.html#cb1386-6" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb1386-7"><a href="overview-of-the-generalized-linear-model.html#cb1386-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="fu">c</span>(<span class="fl">0.44</span>, <span class="fl">1.46</span>, <span class="fl">2.51</span>),</span>
<span id="cb1386-8"><a href="overview-of-the-generalized-linear-model.html#cb1386-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="fl">1.68</span>, <span class="fl">1.753</span>, <span class="fl">1.625</span>),</span>
<span id="cb1386-9"><a href="overview-of-the-generalized-linear-model.html#cb1386-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;beta[0] == 1.69&quot;</span>, <span class="st">&quot;beta[&#39;[1]&#39;] == 0.07&quot;</span>, <span class="st">&quot;beta[&#39;[2]&#39;] == -0.07&quot;</span>))</span>
<span id="cb1386-10"><a href="overview-of-the-generalized-linear-model.html#cb1386-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1386-11"><a href="overview-of-the-generalized-linear-model.html#cb1386-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb1386-12"><a href="overview-of-the-generalized-linear-model.html#cb1386-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">1.69</span> <span class="sc">+</span> .<span class="dv">07</span>, <span class="fl">1.69</span> <span class="sc">-</span> .<span class="dv">07</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1386-13"><a href="overview-of-the-generalized-linear-model.html#cb1386-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1386-14"><a href="overview-of-the-generalized-linear-model.html#cb1386-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb1386-15"><a href="overview-of-the-generalized-linear-model.html#cb1386-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb1386-16"><a href="overview-of-the-generalized-linear-model.html#cb1386-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.69</span>) <span class="sc">+</span></span>
<span id="cb1386-17"><a href="overview-of-the-generalized-linear-model.html#cb1386-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> .<span class="dv">075</span>, <span class="at">fill =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>)(<span class="dv">9</span>)[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb1386-18"><a href="overview-of-the-generalized-linear-model.html#cb1386-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> arrows,</span>
<span id="cb1386-19"><a href="overview-of-the-generalized-linear-model.html#cb1386-19" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">xend =</span> x, <span class="at">yend =</span> yend),</span>
<span id="cb1386-20"><a href="overview-of-the-generalized-linear-model.html#cb1386-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span></span>
<span id="cb1386-21"><a href="overview-of-the-generalized-linear-model.html#cb1386-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb1386-22"><a href="overview-of-the-generalized-linear-model.html#cb1386-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb1386-23"><a href="overview-of-the-generalized-linear-model.html#cb1386-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1386-24"><a href="overview-of-the-generalized-linear-model.html#cb1386-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt;1,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,1&gt;&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1386-25"><a href="overview-of-the-generalized-linear-model.html#cb1386-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb1386-26"><a href="overview-of-the-generalized-linear-model.html#cb1386-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">1.75</span>)) <span class="sc">+</span></span>
<span id="cb1386-27"><a href="overview-of-the-generalized-linear-model.html#cb1386-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-13-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Here’s the code for the bottom panel.</p>
<div class="sourceCode" id="cb1387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1387-1"><a href="overview-of-the-generalized-linear-model.html#cb1387-1" aria-hidden="true" tabindex="-1"></a>arrows <span class="ot">&lt;-</span></span>
<span id="cb1387-2"><a href="overview-of-the-generalized-linear-model.html#cb1387-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1.1</span>, <span class="fl">2.1</span>, <span class="fl">3.1</span>, <span class="fl">4.1</span>, <span class="fl">5.1</span>),</span>
<span id="cb1387-3"><a href="overview-of-the-generalized-linear-model.html#cb1387-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">101</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)),</span>
<span id="cb1387-4"><a href="overview-of-the-generalized-linear-model.html#cb1387-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="fu">c</span>(<span class="dv">101</span>, <span class="dv">101</span> <span class="sc">+</span> <span class="dv">4</span>, <span class="dv">101</span> <span class="sc">-</span> <span class="dv">3</span>, <span class="dv">101</span> <span class="sc">-</span> <span class="dv">2</span>, <span class="dv">101</span> <span class="sc">+</span> <span class="dv">6</span>, <span class="dv">101</span> <span class="sc">-</span> <span class="dv">5</span>))</span>
<span id="cb1387-5"><a href="overview-of-the-generalized-linear-model.html#cb1387-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1387-6"><a href="overview-of-the-generalized-linear-model.html#cb1387-6" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb1387-7"><a href="overview-of-the-generalized-linear-model.html#cb1387-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="fu">c</span>(<span class="fl">0.41</span>, <span class="fl">1.36</span>, <span class="fl">2.41</span>, <span class="fl">3.4</span>, <span class="fl">4.35</span>, <span class="fl">5.4</span>),</span>
<span id="cb1387-8"><a href="overview-of-the-generalized-linear-model.html#cb1387-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="fl">100.5</span>, <span class="fl">104.5</span>, <span class="fl">98.5</span>, <span class="fl">99.5</span>, <span class="fl">106.5</span>, <span class="fl">96.5</span>),</span>
<span id="cb1387-9"><a href="overview-of-the-generalized-linear-model.html#cb1387-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;beta[0] == 101&quot;</span>, <span class="st">&quot;beta[&#39;[1]&#39;] == 4&quot;</span>, <span class="st">&quot;beta[&#39;[2]&#39;] == -3&quot;</span>, <span class="st">&quot;beta[&#39;[3]&#39;] == -2&quot;</span>, <span class="st">&quot;beta[&#39;[4]&#39;] == 6&quot;</span>, <span class="st">&quot;beta[&#39;[5]&#39;] == -5&quot;</span>))</span>
<span id="cb1387-10"><a href="overview-of-the-generalized-linear-model.html#cb1387-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1387-11"><a href="overview-of-the-generalized-linear-model.html#cb1387-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb1387-12"><a href="overview-of-the-generalized-linear-model.html#cb1387-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">101</span> <span class="sc">+</span> <span class="dv">4</span>, <span class="dv">101</span> <span class="sc">-</span> <span class="dv">3</span>, <span class="dv">101</span> <span class="sc">-</span> <span class="dv">2</span>, <span class="dv">101</span> <span class="sc">+</span> <span class="dv">6</span>, <span class="dv">101</span> <span class="sc">-</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1387-13"><a href="overview-of-the-generalized-linear-model.html#cb1387-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1387-14"><a href="overview-of-the-generalized-linear-model.html#cb1387-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the plot</span></span>
<span id="cb1387-15"><a href="overview-of-the-generalized-linear-model.html#cb1387-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb1387-16"><a href="overview-of-the-generalized-linear-model.html#cb1387-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">101</span>) <span class="sc">+</span></span>
<span id="cb1387-17"><a href="overview-of-the-generalized-linear-model.html#cb1387-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> .<span class="dv">075</span>, <span class="at">fill =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>)(<span class="dv">9</span>)[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb1387-18"><a href="overview-of-the-generalized-linear-model.html#cb1387-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> arrows,</span>
<span id="cb1387-19"><a href="overview-of-the-generalized-linear-model.html#cb1387-19" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">xend =</span> x, <span class="at">yend =</span> yend),</span>
<span id="cb1387-20"><a href="overview-of-the-generalized-linear-model.html#cb1387-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span></span>
<span id="cb1387-21"><a href="overview-of-the-generalized-linear-model.html#cb1387-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb1387-22"><a href="overview-of-the-generalized-linear-model.html#cb1387-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb1387-23"><a href="overview-of-the-generalized-linear-model.html#cb1387-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1387-24"><a href="overview-of-the-generalized-linear-model.html#cb1387-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb1387-25"><a href="overview-of-the-generalized-linear-model.html#cb1387-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt;1,0,0,0,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,1,0,0,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,0,1,0,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,0,0,1,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,0,0,0,1&gt;&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1387-26"><a href="overview-of-the-generalized-linear-model.html#cb1387-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">5.5</span>),</span>
<span id="cb1387-27"><a href="overview-of-the-generalized-linear-model.html#cb1387-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">90</span>, <span class="fl">106.5</span>)) <span class="sc">+</span></span>
<span id="cb1387-28"><a href="overview-of-the-generalized-linear-model.html#cb1387-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Before we make our versions of the two panels in Figure 15.5, we should note that the values in the prose are at odds with the values implied in the figure. For simplicity, our versions of Figure 15.5 will match up with the values in the original figure, <em>not</em> the prose. For a look at what the figure might have looked like had it been based on the values in the prose, check out Kruschke’s <a href="https://sites.google.com/site/doingbayesiandataanalysis/corrigenda">Corrigenda</a>.</p>
<p>Here’s the code for the left panel of Figure 15.5.</p>
<div class="sourceCode" id="cb1388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1388-1"><a href="overview-of-the-generalized-linear-model.html#cb1388-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb1388-2"><a href="overview-of-the-generalized-linear-model.html#cb1388-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x_1  =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot; &lt;1,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,1&gt; &quot;</span>), <span class="at">times =</span> <span class="dv">4</span>),</span>
<span id="cb1388-3"><a href="overview-of-the-generalized-linear-model.html#cb1388-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">x_2  =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">each =</span> <span class="dv">2</span>), <span class="sc">-</span><span class="fl">0.25</span>, <span class="fl">0.25</span>),</span>
<span id="cb1388-4"><a href="overview-of-the-generalized-linear-model.html#cb1388-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="fl">8.5</span>, <span class="fl">10.5</span>),</span>
<span id="cb1388-5"><a href="overview-of-the-generalized-linear-model.html#cb1388-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;number&quot;</span>, <span class="st">&quot;text&quot;</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">2</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1388-6"><a href="overview-of-the-generalized-linear-model.html#cb1388-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x_1 =</span> <span class="fu">factor</span>(x_1, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot; &lt;1,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,1&gt; &quot;</span>)))</span>
<span id="cb1388-7"><a href="overview-of-the-generalized-linear-model.html#cb1388-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1388-8"><a href="overview-of-the-generalized-linear-model.html#cb1388-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb1388-9"><a href="overview-of-the-generalized-linear-model.html#cb1388-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;number&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1388-10"><a href="overview-of-the-generalized-linear-model.html#cb1388-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1388-11"><a href="overview-of-the-generalized-linear-model.html#cb1388-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_2, <span class="at">y =</span> y, <span class="at">fill =</span> x_1)) <span class="sc">+</span></span>
<span id="cb1388-12"><a href="overview-of-the-generalized-linear-model.html#cb1388-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb1388-13"><a href="overview-of-the-generalized-linear-model.html#cb1388-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;text&quot;</span>),</span>
<span id="cb1388-14"><a href="overview-of-the-generalized-linear-model.html#cb1388-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> x_1, <span class="at">color =</span> x_1)) <span class="sc">+</span></span>
<span id="cb1388-15"><a href="overview-of-the-generalized-linear-model.html#cb1388-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;E&quot;</span>, <span class="at">begin =</span> .<span class="dv">25</span>, <span class="at">end =</span> .<span class="dv">75</span>) <span class="sc">+</span></span>
<span id="cb1388-16"><a href="overview-of-the-generalized-linear-model.html#cb1388-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;E&quot;</span>, <span class="at">begin =</span> .<span class="dv">25</span>, <span class="at">end =</span> .<span class="dv">75</span>) <span class="sc">+</span></span>
<span id="cb1388-17"><a href="overview-of-the-generalized-linear-model.html#cb1388-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt;1,0,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,1,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,0,1&gt;&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1388-18"><a href="overview-of-the-generalized-linear-model.html#cb1388-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))) <span class="sc">+</span></span>
<span id="cb1388-19"><a href="overview-of-the-generalized-linear-model.html#cb1388-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Additive (no interaction)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1388-20"><a href="overview-of-the-generalized-linear-model.html#cb1388-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1388-21"><a href="overview-of-the-generalized-linear-model.html#cb1388-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-15-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Did you notice our <code>filter()</code> trick in the code?</p>
</div>
<div id="nonadditive-interaction-of-nominal-predictors." class="section level4 hasAnchor" number="15.2.4.3">
<h4><span class="header-section-number">15.2.4.3</span> Nonadditive interaction of nominal predictors.<a href="overview-of-the-generalized-linear-model.html#nonadditive-interaction-of-nominal-predictors." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>We need new notation to formalize the nonadditive influence of a combination of nominal values. Just as <span class="math inline">\(\vec x_1\)</span> refers to the value of predictor <span class="math inline">\(1\)</span>, and <span class="math inline">\(\vec x_2\)</span> refers to the value of predictor <span class="math inline">\(2\)</span>, the notation <span class="math inline">\(\vec x_{1 \times 2}\)</span> will refer to a particular <em>combination</em> of values of predictors <span class="math inline">\(1\)</span> and <span class="math inline">\(2\)</span>. If there are <span class="math inline">\(J\)</span> levels of predictor <span class="math inline">\(1\)</span> and <span class="math inline">\(K\)</span> levels of predictor <span class="math inline">\(2\)</span>, then there are <span class="math inline">\(J \times K\)</span> combinations of the two predictors. To indicate a particular combination of levels from predictors <span class="math inline">\(1\)</span> and <span class="math inline">\(2\)</span>, the corresponding component of <span class="math inline">\(\vec x_{1 \times 2}\)</span> is set to <span class="math inline">\(1\)</span> while all other components are set to <span class="math inline">\(0\)</span>. A nonadditive interaction of predictors is formally represented by including a term for the influence of combinations of predictors, beyond the additive influences, as follows: <span class="math inline">\(y = \beta_0 + \vec \beta_1 \cdot \vec x_1 + \vec \beta_2 \cdot \vec x_2 + \vec \beta_{1 \times 2} \cdot \vec x_{1 \times 2}\)</span>. (pp. 432–433, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Now we’re in nonadditive interaction land, here’s the code for the right panel of Figure 15.5.</p>
<div class="sourceCode" id="cb1389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1389-1"><a href="overview-of-the-generalized-linear-model.html#cb1389-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb1389-2"><a href="overview-of-the-generalized-linear-model.html#cb1389-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x_1  =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot; &lt;1,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,1&gt; &quot;</span>), <span class="at">times =</span> <span class="dv">4</span>),</span>
<span id="cb1389-3"><a href="overview-of-the-generalized-linear-model.html#cb1389-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">x_2  =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">each =</span> <span class="dv">2</span>), <span class="sc">-</span><span class="fl">0.25</span>, <span class="fl">0.25</span>),</span>
<span id="cb1389-4"><a href="overview-of-the-generalized-linear-model.html#cb1389-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">7</span>, <span class="fl">8.5</span>, <span class="fl">10.5</span>),</span>
<span id="cb1389-5"><a href="overview-of-the-generalized-linear-model.html#cb1389-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;number&quot;</span>, <span class="st">&quot;text&quot;</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">2</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1389-6"><a href="overview-of-the-generalized-linear-model.html#cb1389-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x_1 =</span> <span class="fu">factor</span>(x_1, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot; &lt;1,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,1&gt; &quot;</span>)))</span>
<span id="cb1389-7"><a href="overview-of-the-generalized-linear-model.html#cb1389-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1389-8"><a href="overview-of-the-generalized-linear-model.html#cb1389-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb1389-9"><a href="overview-of-the-generalized-linear-model.html#cb1389-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;number&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1389-10"><a href="overview-of-the-generalized-linear-model.html#cb1389-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1389-11"><a href="overview-of-the-generalized-linear-model.html#cb1389-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_2, <span class="at">y =</span> y, <span class="at">fill =</span> x_1)) <span class="sc">+</span></span>
<span id="cb1389-12"><a href="overview-of-the-generalized-linear-model.html#cb1389-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb1389-13"><a href="overview-of-the-generalized-linear-model.html#cb1389-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;text&quot;</span>),</span>
<span id="cb1389-14"><a href="overview-of-the-generalized-linear-model.html#cb1389-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> x_1, <span class="at">color =</span> x_1)) <span class="sc">+</span></span>
<span id="cb1389-15"><a href="overview-of-the-generalized-linear-model.html#cb1389-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;E&quot;</span>, <span class="at">begin =</span> .<span class="dv">25</span>, <span class="at">end =</span> .<span class="dv">75</span>) <span class="sc">+</span></span>
<span id="cb1389-16"><a href="overview-of-the-generalized-linear-model.html#cb1389-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="cn">NULL</span>, <span class="at">option =</span> <span class="st">&quot;E&quot;</span>, <span class="at">begin =</span> .<span class="dv">25</span>, <span class="at">end =</span> .<span class="dv">75</span>) <span class="sc">+</span></span>
<span id="cb1389-17"><a href="overview-of-the-generalized-linear-model.html#cb1389-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt;1,0,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,1,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,0,1&gt;&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1389-18"><a href="overview-of-the-generalized-linear-model.html#cb1389-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">*</span> <span class="dv">2</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))) <span class="sc">+</span></span>
<span id="cb1389-19"><a href="overview-of-the-generalized-linear-model.html#cb1389-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Non-Additive Interaction&quot;</span>) <span class="sc">+</span></span>
<span id="cb1389-20"><a href="overview-of-the-generalized-linear-model.html#cb1389-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1389-21"><a href="overview-of-the-generalized-linear-model.html#cb1389-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-16-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>“The main point to understand now is that <em>the term ‘interaction’ refers to a nonadditive influence of the predictors on the predicted, regardless of whether the predictors are measured on a nominal scale or a metric scale</em>” (p. 434, <em>emphasis</em> in the original).</p>
</div>
</div>
</div>
<div id="linking-from-combined-predictors-to-noisy-predicted-data" class="section level2 hasAnchor" number="15.3">
<h2><span class="header-section-number">15.3</span> Linking from combined predictors to noisy predicted data<a href="overview-of-the-generalized-linear-model.html#linking-from-combined-predictors-to-noisy-predicted-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="from-predictors-to-predicted-central-tendency." class="section level3 hasAnchor" number="15.3.1">
<h3><span class="header-section-number">15.3.1</span> From predictors to predicted central tendency.<a href="overview-of-the-generalized-linear-model.html#from-predictors-to-predicted-central-tendency." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>After the predictor variables are combined, they need to be mapped to the predicted variable. This mathematical mapping is called the <em>(inverse) link</em> function, and is denoted by <span class="math inline">\(f()\)</span> in the following equation:</p>
<p><span class="math display">\[y = f(\operatorname{lin}(x))\]</span></p>
<p>Until now, we have been assuming that the link function is merely the identity function, <span class="math inline">\(f(\operatorname{lin}(x)) = \operatorname{lin}(x)\)</span>. (p. 436, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Yet as we’ll see, many models use links other than the identity function.</p>
<div id="the-logistic-function." class="section level4 hasAnchor" number="15.3.1.1">
<h4><span class="header-section-number">15.3.1.1</span> The logistic function.<a href="overview-of-the-generalized-linear-model.html#the-logistic-function." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The logistic link function follows the form</p>
<p><span class="math display">\[y = \operatorname{logistic}(x) = \frac{1}{ \big (1 + \exp (-x) \big )}.\]</span></p>
<p>We can write the logistic function for a univariable metric predictor as</p>
<p><span class="math display">\[y = \operatorname{logistic}(x; \beta_0, \beta_1) = \frac{1}{\big (1 + \exp (-[\beta_0 + \beta_1x]) \big )}.\]</span></p>
<p>And if we prefer to parameterize it in terms of gain <span class="math inline">\(\gamma\)</span> and threshold <span class="math inline">\(\theta\)</span>, it’d be</p>
<p><span class="math display">\[y = \operatorname{logistic}(x; \gamma, \theta) = \frac{1}{ \big (1 + \exp (-\gamma [x - \theta]) \big )}.\]</span></p>
<p>We can make the sexy logistic curves of Figure 15.6 with <code>stat_function()</code>, into which we’ll plug our very own custom <code>make_logistic()</code> function. Here’s the left panel.</p>
<div class="sourceCode" id="cb1390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1390-1"><a href="overview-of-the-generalized-linear-model.html#cb1390-1" aria-hidden="true" tabindex="-1"></a>make_logistic <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma, theta) {</span>
<span id="cb1390-2"><a href="overview-of-the-generalized-linear-model.html#cb1390-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> (x <span class="sc">-</span> theta)))</span>
<span id="cb1390-3"><a href="overview-of-the-generalized-linear-model.html#cb1390-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1390-4"><a href="overview-of-the-generalized-linear-model.html#cb1390-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1390-5"><a href="overview-of-the-generalized-linear-model.html#cb1390-5" aria-hidden="true" tabindex="-1"></a><span class="co"># annotation</span></span>
<span id="cb1390-6"><a href="overview-of-the-generalized-linear-model.html#cb1390-6" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb1390-7"><a href="overview-of-the-generalized-linear-model.html#cb1390-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb1390-8"><a href="overview-of-the-generalized-linear-model.html#cb1390-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(.<span class="dv">9</span>, .<span class="dv">1</span>),</span>
<span id="cb1390-9"><a href="overview-of-the-generalized-linear-model.html#cb1390-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">str_c</span>(<span class="st">&quot;list(gamma == 0.5, theta == &quot;</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>), <span class="st">&quot;)&quot;</span>))</span>
<span id="cb1390-10"><a href="overview-of-the-generalized-linear-model.html#cb1390-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1390-11"><a href="overview-of-the-generalized-linear-model.html#cb1390-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb1390-12"><a href="overview-of-the-generalized-linear-model.html#cb1390-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">11</span>, <span class="dv">11</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1390-13"><a href="overview-of-the-generalized-linear-model.html#cb1390-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb1390-14"><a href="overview-of-the-generalized-linear-model.html#cb1390-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb1390-15"><a href="overview-of-the-generalized-linear-model.html#cb1390-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1390-16"><a href="overview-of-the-generalized-linear-model.html#cb1390-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun  =</span> make_logistic, </span>
<span id="cb1390-17"><a href="overview-of-the-generalized-linear-model.html#cb1390-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">gamma =</span> .<span class="dv">5</span>, <span class="at">theta =</span> <span class="sc">-</span><span class="dv">1</span>), </span>
<span id="cb1390-18"><a href="overview-of-the-generalized-linear-model.html#cb1390-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>)(<span class="dv">9</span>)[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb1390-19"><a href="overview-of-the-generalized-linear-model.html#cb1390-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun  =</span> make_logistic, </span>
<span id="cb1390-20"><a href="overview-of-the-generalized-linear-model.html#cb1390-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">gamma =</span> .<span class="dv">5</span>, <span class="at">theta =</span> <span class="dv">3</span>), </span>
<span id="cb1390-21"><a href="overview-of-the-generalized-linear-model.html#cb1390-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>)(<span class="dv">9</span>)[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb1390-22"><a href="overview-of-the-generalized-linear-model.html#cb1390-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb1390-23"><a href="overview-of-the-generalized-linear-model.html#cb1390-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">label =</span> label),</span>
<span id="cb1390-24"><a href="overview-of-the-generalized-linear-model.html#cb1390-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1390-25"><a href="overview-of-the-generalized-linear-model.html#cb1390-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1390-26"><a href="overview-of-the-generalized-linear-model.html#cb1390-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb1390-27"><a href="overview-of-the-generalized-linear-model.html#cb1390-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Different Thresholds&quot;</span>) </span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-17-1.png" width="312" style="display: block; margin: auto;" /></p>
<p>For kicks, we’ll take a different approach for the right panel. Instead of pumping values through <code>stat_function()</code> within our plot code, we’ll use our <code>make_logistic()</code> function within <code>mutate()</code> before beginning the plot code.</p>
<div class="sourceCode" id="cb1391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1391-1"><a href="overview-of-the-generalized-linear-model.html#cb1391-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the annotation values</span></span>
<span id="cb1391-2"><a href="overview-of-the-generalized-linear-model.html#cb1391-2" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb1391-3"><a href="overview-of-the-generalized-linear-model.html#cb1391-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>),</span>
<span id="cb1391-4"><a href="overview-of-the-generalized-linear-model.html#cb1391-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(.<span class="dv">92</span>, .<span class="dv">4</span>),</span>
<span id="cb1391-5"><a href="overview-of-the-generalized-linear-model.html#cb1391-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">str_c</span>(<span class="st">&quot;list(gamma == &quot;</span>, <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.2</span>), <span class="st">&quot;, theta == 4)&quot;</span>))</span>
<span id="cb1391-6"><a href="overview-of-the-generalized-linear-model.html#cb1391-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1391-7"><a href="overview-of-the-generalized-linear-model.html#cb1391-7" aria-hidden="true" tabindex="-1"></a><span class="co"># make the data</span></span>
<span id="cb1391-8"><a href="overview-of-the-generalized-linear-model.html#cb1391-8" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">gamma =</span> <span class="fu">c</span>(<span class="dv">2</span>, .<span class="dv">2</span>),</span>
<span id="cb1391-9"><a href="overview-of-the-generalized-linear-model.html#cb1391-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">x     =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">11</span>, <span class="at">to =</span> <span class="dv">11</span>, <span class="at">by =</span> <span class="fl">0.2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1391-10"><a href="overview-of-the-generalized-linear-model.html#cb1391-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">make_logistic</span>(x, gamma, <span class="at">theta =</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1391-11"><a href="overview-of-the-generalized-linear-model.html#cb1391-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1391-12"><a href="overview-of-the-generalized-linear-model.html#cb1391-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb1391-13"><a href="overview-of-the-generalized-linear-model.html#cb1391-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb1391-14"><a href="overview-of-the-generalized-linear-model.html#cb1391-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1391-15"><a href="overview-of-the-generalized-linear-model.html#cb1391-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1391-16"><a href="overview-of-the-generalized-linear-model.html#cb1391-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> gamma),</span>
<span id="cb1391-17"><a href="overview-of-the-generalized-linear-model.html#cb1391-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>)(<span class="dv">9</span>)[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb1391-18"><a href="overview-of-the-generalized-linear-model.html#cb1391-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb1391-19"><a href="overview-of-the-generalized-linear-model.html#cb1391-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb1391-20"><a href="overview-of-the-generalized-linear-model.html#cb1391-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1391-21"><a href="overview-of-the-generalized-linear-model.html#cb1391-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1391-22"><a href="overview-of-the-generalized-linear-model.html#cb1391-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb1391-23"><a href="overview-of-the-generalized-linear-model.html#cb1391-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Different Gains&quot;</span>)</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-18-1.png" width="312" style="display: block; margin: auto;" /></p>
<p>I don’t know that one plotting approach is better than the other. It’s good to have options.</p>
<p>To make our two-dimensional version of the wireframe plots of Figure 15.7, we’ll first want to define the <code>logistic()</code> function.</p>
<div class="sourceCode" id="cb1392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1392-1"><a href="overview-of-the-generalized-linear-model.html#cb1392-1" aria-hidden="true" tabindex="-1"></a>logistic <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1392-2"><a href="overview-of-the-generalized-linear-model.html#cb1392-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x))</span>
<span id="cb1392-3"><a href="overview-of-the-generalized-linear-model.html#cb1392-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we’ll just extend the same method we used for Figures 15.2 and 15.3.</p>
<div class="sourceCode" id="cb1393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1393-1"><a href="overview-of-the-generalized-linear-model.html#cb1393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">x1 =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">to =</span> <span class="dv">6</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb1393-2"><a href="overview-of-the-generalized-linear-model.html#cb1393-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">x2 =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">to =</span> <span class="dv">6</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1393-3"><a href="overview-of-the-generalized-linear-model.html#cb1393-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">y[1] == logistic(1 * ( 0    * x[1] + 1    * x[2] -  0))</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">logistic</span>(<span class="dv">1</span> <span class="sc">*</span> ( <span class="dv">0</span>    <span class="sc">*</span> x1 <span class="sc">+</span> <span class="dv">1</span>    <span class="sc">*</span> x2 <span class="sc">-</span>  <span class="dv">0</span>)),</span>
<span id="cb1393-4"><a href="overview-of-the-generalized-linear-model.html#cb1393-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">y[2] == logistic(1 * ( 0.71 * x[1] + 0.71 * x[2] -  0))</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">logistic</span>(<span class="dv">1</span> <span class="sc">*</span> ( <span class="fl">0.71</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="fl">0.71</span> <span class="sc">*</span> x2 <span class="sc">-</span>  <span class="dv">0</span>)),</span>
<span id="cb1393-5"><a href="overview-of-the-generalized-linear-model.html#cb1393-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">y[3] == logistic(2 * ( 0    * x[1] + 1    * x[2] - -3))</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">logistic</span>(<span class="dv">2</span> <span class="sc">*</span> ( <span class="dv">0</span>    <span class="sc">*</span> x1 <span class="sc">+</span> <span class="dv">1</span>    <span class="sc">*</span> x2 <span class="sc">-</span> <span class="sc">-</span><span class="dv">3</span>)),</span>
<span id="cb1393-6"><a href="overview-of-the-generalized-linear-model.html#cb1393-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">y[4] == logistic(2 * (-0.71 * x[1] + 0.71 * x[2] -  3))</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">logistic</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="sc">-</span><span class="fl">0.71</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="fl">0.71</span> <span class="sc">*</span> x2 <span class="sc">-</span>  <span class="dv">3</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb1393-7"><a href="overview-of-the-generalized-linear-model.html#cb1393-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="sc">-</span>x1, <span class="sc">-</span>x2), <span class="at">values_to =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1393-8"><a href="overview-of-the-generalized-linear-model.html#cb1393-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1393-9"><a href="overview-of-the-generalized-linear-model.html#cb1393-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">fill =</span> y)) <span class="sc">+</span></span>
<span id="cb1393-10"><a href="overview-of-the-generalized-linear-model.html#cb1393-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>() <span class="sc">+</span></span>
<span id="cb1393-11"><a href="overview-of-the-generalized-linear-model.html#cb1393-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1393-12"><a href="overview-of-the-generalized-linear-model.html#cb1393-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(x[<span class="dv">1</span>]), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb1393-13"><a href="overview-of-the-generalized-linear-model.html#cb1393-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">to =</span> <span class="dv">6</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb1393-14"><a href="overview-of-the-generalized-linear-model.html#cb1393-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(x[<span class="dv">2</span>]), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb1393-15"><a href="overview-of-the-generalized-linear-model.html#cb1393-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">to =</span> <span class="dv">6</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb1393-16"><a href="overview-of-the-generalized-linear-model.html#cb1393-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">position =</span> <span class="st">&quot;right&quot;</span>) <span class="sc">+</span></span>
<span id="cb1393-17"><a href="overview-of-the-generalized-linear-model.html#cb1393-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb1393-18"><a href="overview-of-the-generalized-linear-model.html#cb1393-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb1393-19"><a href="overview-of-the-generalized-linear-model.html#cb1393-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb1393-20"><a href="overview-of-the-generalized-linear-model.html#cb1393-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">labeller =</span> label_parsed)</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p>“The threshold determines the <em>position</em> of the logistical cliff. In other words, the threshold determines the <span class="math inline">\(x\)</span> values for which <span class="math inline">\(y = 0.5\)</span>… The gain determines the <em>steepness</em> of the logistical cliff” (pp. 437–438, <em>emphasis</em> in the original).</p>
</div>
<div id="the-cumulative-normal-function." class="section level4 hasAnchor" number="15.3.1.2">
<h4><span class="header-section-number">15.3.1.2</span> The cumulative normal function.<a href="overview-of-the-generalized-linear-model.html#the-cumulative-normal-function." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>The cumulative normal is denoted <span class="math inline">\(\Phi (x; \mu, \sigma)\)</span>, where <span class="math inline">\(x\)</span> is a real number and where <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are parameter values, called the mean and standard deviation of the normal distribution. The parameter <span class="math inline">\(\mu\)</span> governs the point at which the cumulative normal, <span class="math inline">\(\Phi(x)\)</span>, equals <span class="math inline">\(0.5\)</span>. In other words, <span class="math inline">\(\mu\)</span> plays the same role as the threshold in the logistic. The parameter <span class="math inline">\(\sigma\)</span> governs the steepness of the cumulative normal function at <span class="math inline">\(x = \mu\)</span>, but inversely, such that a <em>smaller</em> value of <span class="math inline">\(\sigma\)</span> corresponds to a steeper cumulative normal. (p. 440, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Here we plot the standard normal density in the top panel of Figure 15.8.</p>
<div class="sourceCode" id="cb1394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1394-1"><a href="overview-of-the-generalized-linear-model.html#cb1394-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.05</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1394-2"><a href="overview-of-the-generalized-linear-model.html#cb1394-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d =</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1394-3"><a href="overview-of-the-generalized-linear-model.html#cb1394-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1394-4"><a href="overview-of-the-generalized-linear-model.html#cb1394-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> d)) <span class="sc">+</span></span>
<span id="cb1394-5"><a href="overview-of-the-generalized-linear-model.html#cb1394-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">fill =</span> x <span class="sc">&lt;=</span> <span class="dv">1</span>), <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb1394-6"><a href="overview-of-the-generalized-linear-model.html#cb1394-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>)(<span class="dv">9</span>)[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb1394-7"><a href="overview-of-the-generalized-linear-model.html#cb1394-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="fu">alpha</span>(<span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>)(<span class="dv">9</span>)[<span class="dv">2</span>], <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb1394-8"><a href="overview-of-the-generalized-linear-model.html#cb1394-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">p</span>(x)), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))) <span class="sc">+</span></span>
<span id="cb1394-9"><a href="overview-of-the-generalized-linear-model.html#cb1394-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb1394-10"><a href="overview-of-the-generalized-linear-model.html#cb1394-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Normal Density&quot;</span>) </span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-21-1.png" width="312" style="display: block; margin: auto;" /></p>
<p>Here’s the analogous cumulative normal function depicted in the bottom panel of Figure 15.8.</p>
<div class="sourceCode" id="cb1395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1395-1"><a href="overview-of-the-generalized-linear-model.html#cb1395-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.05</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1395-2"><a href="overview-of-the-generalized-linear-model.html#cb1395-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1395-3"><a href="overview-of-the-generalized-linear-model.html#cb1395-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb1395-4"><a href="overview-of-the-generalized-linear-model.html#cb1395-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> pnorm, </span>
<span id="cb1395-5"><a href="overview-of-the-generalized-linear-model.html#cb1395-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), </span>
<span id="cb1395-6"><a href="overview-of-the-generalized-linear-model.html#cb1395-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>)(<span class="dv">9</span>)[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb1395-7"><a href="overview-of-the-generalized-linear-model.html#cb1395-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">xend =</span> <span class="dv">1</span>, </span>
<span id="cb1395-8"><a href="overview-of-the-generalized-linear-model.html#cb1395-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="fu">pnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb1395-9"><a href="overview-of-the-generalized-linear-model.html#cb1395-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span></span>
<span id="cb1395-10"><a href="overview-of-the-generalized-linear-model.html#cb1395-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">Phi</span>(x)), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1395-11"><a href="overview-of-the-generalized-linear-model.html#cb1395-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb1395-12"><a href="overview-of-the-generalized-linear-model.html#cb1395-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Cumulative Normal&quot;</span>)</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-22-1.png" width="312" style="display: block; margin: auto;" /></p>
<blockquote>
<p>Terminology: The inverse of the cumulative normal is called the <em>probit</em> function. [“Probit” stands for “probability unit”; <span class="citation"><a href="#ref-bliss1934method" role="doc-biblioref">Bliss</a> (<a href="#ref-bliss1934method" role="doc-biblioref">1934</a>)</span>]. The probit function maps a value <span class="math inline">\(p\)</span>, for <span class="math inline">\(0.0 \leq p \leq 1.0\)</span>, onto the infinite real line, and a graph of the probit function looks very much like the logit function. (p. 439, <em>emphasis</em> in the original)</p>
</blockquote>
</div>
</div>
<div id="from-predicted-central-tendency-to-noisy-data." class="section level3 hasAnchor" number="15.3.2">
<h3><span class="header-section-number">15.3.2</span> From predicted central tendency to noisy data.<a href="overview-of-the-generalized-linear-model.html#from-predicted-central-tendency-to-noisy-data." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>In the real world, there is always variation in <span class="math inline">\(y\)</span> that we cannot predict from <span class="math inline">\(x\)</span>. This unpredictable “noise” in <span class="math inline">\(y\)</span> might be deterministically caused by sundry factors we have neither measured nor controlled, or the noise might be caused by inherent non-determinism in <span class="math inline">\(y\)</span>. It does not matter either way because in practice the best we can do is predict the <em>probability</em> that <span class="math inline">\(y\)</span> will have any particular value, dependent upon <span class="math inline">\(x\)</span>…</p>
<p>To make this notion of probabilistic tendency precise, we need to specify a probability distribution for <span class="math inline">\(y\)</span> that depends on <span class="math inline">\(f (\operatorname{lin} (x))\)</span>. To keep the notation tractable, first define <span class="math inline">\(\mu = f (\operatorname{lin} (x))\)</span>. The value <span class="math inline">\(\mu\)</span> represents the central tendency of the predicted <span class="math inline">\(y\)</span> values, which might or might not be the mean. With this notation, we then denote the probability distribution of <span class="math inline">\(y\)</span> as some to-be-specified probability density function, abbreviated as “pdf”:</p>
<p><span class="math display">\[y \sim \operatorname{pdf} \big ( \mu, [\text{scale, shape, etc.}] \big )\]</span></p>
<p>As indicated by the bracketed terms after <span class="math inline">\(\mu\)</span>, the pdf might have various additional parameters that control the distribution’s scale (i.e., standard deviation), shape, etc.</p>
<p>The form of the pdf depends on the measurement scale of the predicted variable. (pp. 440–441, <em>emphasis</em> in the original)</p>
</blockquote>
<p>The top panel of Figure 15.9 is tricky. One way to make those multiple densities tipped on their sides is with <code>ggridges::geom_ridgeline()</code> followed by <code>coord_flip()</code>. However, explore a different approach that’ll come in handy in many of the plots we’ll be making in later chapters. The method requires we make a data set with the necessary coordinates for the side-tipped densities. Let’s walk through that step slowly.</p>
<div class="sourceCode" id="cb1396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1396-1"><a href="overview-of-the-generalized-linear-model.html#cb1396-1" aria-hidden="true" tabindex="-1"></a>curves <span class="ot">&lt;-</span></span>
<span id="cb1396-2"><a href="overview-of-the-generalized-linear-model.html#cb1396-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define the 3 x-values we want the Gaussians to originate from</span></span>
<span id="cb1396-3"><a href="overview-of-the-generalized-linear-model.html#cb1396-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="fl">7.5</span>, <span class="at">to =</span> <span class="fl">7.5</span>, <span class="at">length.out =</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1396-4"><a href="overview-of-the-generalized-linear-model.html#cb1396-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1396-5"><a href="overview-of-the-generalized-linear-model.html#cb1396-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use the formula 10 + 2x to compute the expected y-value for x</span></span>
<span id="cb1396-6"><a href="overview-of-the-generalized-linear-model.html#cb1396-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y_mean =</span> <span class="dv">10</span> <span class="sc">+</span> (<span class="dv">2</span> <span class="sc">*</span> x)) <span class="sc">%&gt;%</span></span>
<span id="cb1396-7"><a href="overview-of-the-generalized-linear-model.html#cb1396-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1396-8"><a href="overview-of-the-generalized-linear-model.html#cb1396-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># based on a Gaussian with `mean = y_mean` and `sd = 2`, compute the 99.5% intervals</span></span>
<span id="cb1396-9"><a href="overview-of-the-generalized-linear-model.html#cb1396-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ll =</span> <span class="fu">qnorm</span>(.<span class="dv">0025</span>, <span class="at">mean =</span> y_mean, <span class="at">sd =</span> <span class="dv">2</span>),</span>
<span id="cb1396-10"><a href="overview-of-the-generalized-linear-model.html#cb1396-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">ul =</span> <span class="fu">qnorm</span>(.<span class="dv">9975</span>, <span class="at">mean =</span> y_mean, <span class="at">sd =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1396-11"><a href="overview-of-the-generalized-linear-model.html#cb1396-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1396-12"><a href="overview-of-the-generalized-linear-model.html#cb1396-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># now use those interval bounds to make a sequence of y-values</span></span>
<span id="cb1396-13"><a href="overview-of-the-generalized-linear-model.html#cb1396-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">map2</span>(ll, ul, seq, <span class="at">length.out =</span> <span class="dv">100</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1396-14"><a href="overview-of-the-generalized-linear-model.html#cb1396-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1396-15"><a href="overview-of-the-generalized-linear-model.html#cb1396-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># since that operation returned a nested column, we need to `unnest()`</span></span>
<span id="cb1396-16"><a href="overview-of-the-generalized-linear-model.html#cb1396-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(y) <span class="sc">%&gt;%</span></span>
<span id="cb1396-17"><a href="overview-of-the-generalized-linear-model.html#cb1396-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1396-18"><a href="overview-of-the-generalized-linear-model.html#cb1396-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute the density values</span></span>
<span id="cb1396-19"><a href="overview-of-the-generalized-linear-model.html#cb1396-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">map2_dbl</span>(y, y_mean, dnorm, <span class="at">sd =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1396-20"><a href="overview-of-the-generalized-linear-model.html#cb1396-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1396-21"><a href="overview-of-the-generalized-linear-model.html#cb1396-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># now rescale the density values to be wider.</span></span>
<span id="cb1396-22"><a href="overview-of-the-generalized-linear-model.html#cb1396-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># since we want these to be our x-values, we&#39;ll </span></span>
<span id="cb1396-23"><a href="overview-of-the-generalized-linear-model.html#cb1396-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># just redefine the x column with these results</span></span>
<span id="cb1396-24"><a href="overview-of-the-generalized-linear-model.html#cb1396-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> x <span class="sc">-</span> density <span class="sc">*</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">max</span>(density))</span>
<span id="cb1396-25"><a href="overview-of-the-generalized-linear-model.html#cb1396-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1396-26"><a href="overview-of-the-generalized-linear-model.html#cb1396-26" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(curves)</span></code></pre></div>
<pre><code>## tibble [400 × 6] (S3: tbl_df/tbl/data.frame)
##  $ x      : num [1:400] -7.54 -7.55 -7.55 -7.56 -7.57 ...
##  $ y_mean : num [1:400] -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 ...
##  $ ll     : num [1:400] -10.6 -10.6 -10.6 -10.6 -10.6 ...
##  $ ul     : num [1:400] 0.614 0.614 0.614 0.614 0.614 ...
##  $ y      : num [1:400] -10.6 -10.5 -10.4 -10.3 -10.2 ...
##  $ density: num [1:400] 0.00388 0.00454 0.0053 0.00617 0.00715 ...</code></pre>
<p>In case it’s not clear, we’ll be plotting with the <code>x</code> and <code>y</code> columns. Think of the other columns as showing our work. But now we’ve got those <code>curves</code> data, we’re ready to simulate the points and plot.</p>
<div class="sourceCode" id="cb1398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1398-1"><a href="overview-of-the-generalized-linear-model.html#cb1398-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many points would you like?</span></span>
<span id="cb1398-2"><a href="overview-of-the-generalized-linear-model.html#cb1398-2" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">750</span></span>
<span id="cb1398-3"><a href="overview-of-the-generalized-linear-model.html#cb1398-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1398-4"><a href="overview-of-the-generalized-linear-model.html#cb1398-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the points</span></span>
<span id="cb1398-5"><a href="overview-of-the-generalized-linear-model.html#cb1398-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">runif</span>(<span class="at">n =</span> n_samples, <span class="at">min =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">max =</span> <span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1398-6"><a href="overview-of-the-generalized-linear-model.html#cb1398-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_samples, <span class="at">mean =</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x, <span class="at">sd =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1398-7"><a href="overview-of-the-generalized-linear-model.html#cb1398-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1398-8"><a href="overview-of-the-generalized-linear-model.html#cb1398-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb1398-9"><a href="overview-of-the-generalized-linear-model.html#cb1398-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb1398-10"><a href="overview-of-the-generalized-linear-model.html#cb1398-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1398-11"><a href="overview-of-the-generalized-linear-model.html#cb1398-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1398-12"><a href="overview-of-the-generalized-linear-model.html#cb1398-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1398-13"><a href="overview-of-the-generalized-linear-model.html#cb1398-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">10</span>, <span class="at">slope =</span> <span class="dv">2</span>,</span>
<span id="cb1398-14"><a href="overview-of-the-generalized-linear-model.html#cb1398-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>)(<span class="dv">9</span>)[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb1398-15"><a href="overview-of-the-generalized-linear-model.html#cb1398-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> curves,</span>
<span id="cb1398-16"><a href="overview-of-the-generalized-linear-model.html#cb1398-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">group =</span> y_mean),</span>
<span id="cb1398-17"><a href="overview-of-the-generalized-linear-model.html#cb1398-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>)(<span class="dv">9</span>)[<span class="dv">2</span>], <span class="at">size =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1398-18"><a href="overview-of-the-generalized-linear-model.html#cb1398-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Normal PDF around Linear Function&quot;</span>,</span>
<span id="cb1398-19"><a href="overview-of-the-generalized-linear-model.html#cb1398-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb1398-20"><a href="overview-of-the-generalized-linear-model.html#cb1398-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">30</span>))</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-24-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>We’ll revisit this method in Chapter 17. The wireframe plots at the bottom of Figure 15.9 and in Figure 15.10 are outside of our <strong>ggplot2</strong> purview. However, we can continue on with our approach of expressing the third <span class="math inline">\(y\)</span> dimension as fill gradients. Thus, here’s a version of the bottom of Figure 15.9.</p>
<div class="sourceCode" id="cb1399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1399-1"><a href="overview-of-the-generalized-linear-model.html#cb1399-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many points would you like?</span></span>
<span id="cb1399-2"><a href="overview-of-the-generalized-linear-model.html#cb1399-2" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">750</span></span>
<span id="cb1399-3"><a href="overview-of-the-generalized-linear-model.html#cb1399-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1399-4"><a href="overview-of-the-generalized-linear-model.html#cb1399-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generate and save the points</span></span>
<span id="cb1399-5"><a href="overview-of-the-generalized-linear-model.html#cb1399-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb1399-6"><a href="overview-of-the-generalized-linear-model.html#cb1399-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> </span>
<span id="cb1399-7"><a href="overview-of-the-generalized-linear-model.html#cb1399-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x1 =</span> <span class="fu">runif</span>(<span class="at">n =</span> n_samples, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>),</span>
<span id="cb1399-8"><a href="overview-of-the-generalized-linear-model.html#cb1399-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">x2 =</span> <span class="fu">runif</span>(<span class="at">n =</span> n_samples, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1399-9"><a href="overview-of-the-generalized-linear-model.html#cb1399-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">mean =</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x2, <span class="at">sd =</span> <span class="dv">4</span>))</span>
<span id="cb1399-10"><a href="overview-of-the-generalized-linear-model.html#cb1399-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1399-11"><a href="overview-of-the-generalized-linear-model.html#cb1399-11" aria-hidden="true" tabindex="-1"></a><span class="co"># make the grid</span></span>
<span id="cb1399-12"><a href="overview-of-the-generalized-linear-model.html#cb1399-12" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">x1 =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb1399-13"><a href="overview-of-the-generalized-linear-model.html#cb1399-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">x2 =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1399-14"><a href="overview-of-the-generalized-linear-model.html#cb1399-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x2) <span class="sc">%&gt;%</span></span>
<span id="cb1399-15"><a href="overview-of-the-generalized-linear-model.html#cb1399-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1399-16"><a href="overview-of-the-generalized-linear-model.html#cb1399-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb1399-17"><a href="overview-of-the-generalized-linear-model.html#cb1399-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">fill =</span> y)) <span class="sc">+</span></span>
<span id="cb1399-18"><a href="overview-of-the-generalized-linear-model.html#cb1399-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>() <span class="sc">+</span></span>
<span id="cb1399-19"><a href="overview-of-the-generalized-linear-model.html#cb1399-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> d,</span>
<span id="cb1399-20"><a href="overview-of-the-generalized-linear-model.html#cb1399-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">stroke =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb1399-21"><a href="overview-of-the-generalized-linear-model.html#cb1399-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb1399-22"><a href="overview-of-the-generalized-linear-model.html#cb1399-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb1399-23"><a href="overview-of-the-generalized-linear-model.html#cb1399-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(x[<span class="dv">1</span>]), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1399-24"><a href="overview-of-the-generalized-linear-model.html#cb1399-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(x[<span class="dv">2</span>]), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">*</span> <span class="dv">2</span>,</span>
<span id="cb1399-25"><a href="overview-of-the-generalized-linear-model.html#cb1399-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">position =</span> <span class="st">&quot;right&quot;</span>) <span class="sc">+</span></span>
<span id="cb1399-26"><a href="overview-of-the-generalized-linear-model.html#cb1399-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb1399-27"><a href="overview-of-the-generalized-linear-model.html#cb1399-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="st">&quot;y ~ N(m, sd=4), &quot;</span><span class="sc">*</span>m<span class="sc">==</span><span class="dv">10</span><span class="sc">+</span><span class="dv">1</span><span class="sc">*</span>x[<span class="dv">1</span>]<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>x[<span class="dv">2</span>])) <span class="sc">+</span></span>
<span id="cb1399-28"><a href="overview-of-the-generalized-linear-model.html#cb1399-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;left&quot;</span>)</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-25-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>For Figure 15.10, we can simulate Bernoulli distributed data with the <code>purrr::rbernoulli()</code> function. But since <code>rbernoulli()</code> returns a logical vector of <code>FALSE</code> and <code>TRUE</code> values, we’ll need to transform the results into the <code>0</code>/<code>1</code> metric in a second step.</p>
<div class="sourceCode" id="cb1400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1400-1"><a href="overview-of-the-generalized-linear-model.html#cb1400-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many points would you like?</span></span>
<span id="cb1400-2"><a href="overview-of-the-generalized-linear-model.html#cb1400-2" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">750</span></span>
<span id="cb1400-3"><a href="overview-of-the-generalized-linear-model.html#cb1400-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1400-4"><a href="overview-of-the-generalized-linear-model.html#cb1400-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generate and save the points</span></span>
<span id="cb1400-5"><a href="overview-of-the-generalized-linear-model.html#cb1400-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb1400-6"><a href="overview-of-the-generalized-linear-model.html#cb1400-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> </span>
<span id="cb1400-7"><a href="overview-of-the-generalized-linear-model.html#cb1400-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x1 =</span> <span class="fu">runif</span>(<span class="at">n =</span> n_samples, <span class="at">min =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">max =</span> <span class="dv">6</span>),</span>
<span id="cb1400-8"><a href="overview-of-the-generalized-linear-model.html#cb1400-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">x2 =</span> <span class="fu">runif</span>(<span class="at">n =</span> n_samples, <span class="at">min =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">max =</span> <span class="dv">6</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1400-9"><a href="overview-of-the-generalized-linear-model.html#cb1400-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rbernoulli</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">p =</span> <span class="fu">logistic</span>(<span class="dv">1</span> <span class="sc">*</span> (<span class="fl">0.71</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="fl">0.71</span> <span class="sc">*</span> x2 <span class="sc">-</span> <span class="dv">0</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb1400-10"><a href="overview-of-the-generalized-linear-model.html#cb1400-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">as.double</span>(y))</span>
<span id="cb1400-11"><a href="overview-of-the-generalized-linear-model.html#cb1400-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1400-12"><a href="overview-of-the-generalized-linear-model.html#cb1400-12" aria-hidden="true" tabindex="-1"></a><span class="co"># make the grid</span></span>
<span id="cb1400-13"><a href="overview-of-the-generalized-linear-model.html#cb1400-13" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">x1 =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">to =</span> <span class="dv">6</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb1400-14"><a href="overview-of-the-generalized-linear-model.html#cb1400-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">x2 =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">to =</span> <span class="dv">6</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1400-15"><a href="overview-of-the-generalized-linear-model.html#cb1400-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">logistic</span>(<span class="dv">1</span> <span class="sc">*</span> (<span class="fl">0.71</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="fl">0.71</span> <span class="sc">*</span> x2 <span class="sc">-</span> <span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb1400-16"><a href="overview-of-the-generalized-linear-model.html#cb1400-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1400-17"><a href="overview-of-the-generalized-linear-model.html#cb1400-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb1400-18"><a href="overview-of-the-generalized-linear-model.html#cb1400-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">fill =</span> y)) <span class="sc">+</span></span>
<span id="cb1400-19"><a href="overview-of-the-generalized-linear-model.html#cb1400-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>() <span class="sc">+</span></span>
<span id="cb1400-20"><a href="overview-of-the-generalized-linear-model.html#cb1400-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> d,</span>
<span id="cb1400-21"><a href="overview-of-the-generalized-linear-model.html#cb1400-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> y, <span class="at">color =</span> <span class="fu">factor</span>(y)),</span>
<span id="cb1400-22"><a href="overview-of-the-generalized-linear-model.html#cb1400-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb1400-23"><a href="overview-of-the-generalized-linear-model.html#cb1400-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;black&quot;</span>), <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1400-24"><a href="overview-of-the-generalized-linear-model.html#cb1400-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(p)(y<span class="sc">==</span><span class="dv">1</span>)), <span class="at">option =</span> <span class="st">&quot;E&quot;</span>, <span class="at">limits =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1400-25"><a href="overview-of-the-generalized-linear-model.html#cb1400-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(x[<span class="dv">1</span>]), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">breaks =</span> <span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1400-26"><a href="overview-of-the-generalized-linear-model.html#cb1400-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(x[<span class="dv">2</span>]), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">breaks =</span> <span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">2</span>,</span>
<span id="cb1400-27"><a href="overview-of-the-generalized-linear-model.html#cb1400-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">position =</span> <span class="st">&quot;right&quot;</span>) <span class="sc">+</span></span>
<span id="cb1400-28"><a href="overview-of-the-generalized-linear-model.html#cb1400-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb1400-29"><a href="overview-of-the-generalized-linear-model.html#cb1400-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="st">&quot;y ~ Bernoulli(m), &quot;</span><span class="sc">*</span>m<span class="sc">==</span><span class="fu">logistic</span>(<span class="dv">1</span><span class="sc">*</span>(<span class="fl">0.71</span><span class="sc">*</span>x[<span class="dv">1</span>]<span class="sc">+</span><span class="fl">0.71</span><span class="sc">*</span>x[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb1400-30"><a href="overview-of-the-generalized-linear-model.html#cb1400-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;left&quot;</span>)</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-26-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Because of their use of the logistic function, we typically refer to models of this kind as <em>logistic regression</em>.</p>
</div>
</div>
<div id="formal-expression-of-the-glm" class="section level2 hasAnchor" number="15.4">
<h2><span class="header-section-number">15.4</span> Formal expression of the GLM<a href="overview-of-the-generalized-linear-model.html#formal-expression-of-the-glm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can write the GLM as</p>
<p><span class="math display">\[\begin{align*}
y   &amp; \sim \operatorname{pdf} \big (\mu, [\text{parameters}] \big ), \text{where} \\
\mu &amp; = f \big (\operatorname{lin}(x), [\text{parameters}] \big ).
\end{align*}\]</span></p>
<blockquote>
<p>As has been previously explained, the predictors <span class="math inline">\(x\)</span> are combined in the linear function <span class="math inline">\(\operatorname{lin}(x)\)</span>, and the function <span class="math inline">\(f\)</span> in [the first equation] is called the inverse link function. The data, <span class="math inline">\(y\)</span>, are distributed around the central tendency <span class="math inline">\(\mu\)</span> according to the probability density function labeled “pdf.” (p. 444)</p>
</blockquote>
<div id="cases-of-the-glm." class="section level3 hasAnchor" number="15.4.1">
<h3><span class="header-section-number">15.4.1</span> Cases of the GLM.<a href="overview-of-the-generalized-linear-model.html#cases-of-the-glm." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>When a client brings an application to a [statistical] consultant, one of the first things the consultant does is find out from the client which data are supposed to be predictors and which data are supposed to be predicted, and the measurement scales of the data… When you are considering how to analyze data, your first task is to be your own consultant and find out which data are predictors, which are predicted, and what measurement scales they are. (pp. 445–446)</p>
</blockquote>
<p>Soak this last bit in. It’s gold. I’ve found it to be true in my exchanges with other researchers and with my own data problems, too.</p>
</div>
</div>
<div id="session-info-14" class="section level2 unnumbered hasAnchor">
<h2>Session info<a href="overview-of-the-generalized-linear-model.html#session-info-14" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb1401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1401-1"><a href="overview-of-the-generalized-linear-model.html#cb1401-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.1.2 (2021-11-01)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Catalina 10.15.7
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] viridis_0.6.2     viridisLite_0.4.0 forcats_0.5.1     stringr_1.4.0    
##  [5] dplyr_1.0.8       purrr_0.3.4       readr_2.0.1       tidyr_1.2.0      
##  [9] tibble_3.1.6      ggplot2_3.3.5     tidyverse_1.3.1  
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.8       lubridate_1.7.10 assertthat_0.2.1 digest_0.6.29   
##  [5] utf8_1.2.2       R6_2.5.1         cellranger_1.1.0 backports_1.4.1 
##  [9] reprex_2.0.1     evaluate_0.15    highr_0.9        httr_1.4.2      
## [13] pillar_1.7.0     rlang_1.0.2      readxl_1.3.1     rstudioapi_0.13 
## [17] jquerylib_0.1.4  rmarkdown_2.13   labeling_0.4.2   munsell_0.5.0   
## [21] broom_0.7.12     compiler_4.1.2   modelr_0.1.8     xfun_0.30       
## [25] pkgconfig_2.0.3  htmltools_0.5.2  tidyselect_1.1.2 gridExtra_2.3   
## [29] bookdown_0.26    fansi_1.0.3      crayon_1.5.1     tzdb_0.1.2      
## [33] dbplyr_2.1.1     withr_2.5.0      grid_4.1.2       jsonlite_1.8.0  
## [37] gtable_0.3.0     lifecycle_1.0.1  DBI_1.1.1        magrittr_2.0.3  
## [41] scales_1.1.1     cli_3.2.0        stringi_1.7.6    farver_2.1.0    
## [45] fs_1.5.2         xml2_1.3.2       bslib_0.3.1      ellipsis_0.3.2  
## [49] generics_0.1.2   vctrs_0.4.0      tools_4.1.2      glue_1.6.2      
## [53] hms_1.1.0        fastmap_1.1.0    colorspace_2.0-3 rvest_1.0.1     
## [57] knitr_1.38       haven_2.4.3      sass_0.4.1</code></pre>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-bliss1934method" class="csl-entry">
Bliss, C. I. (1934). The method of probits. <em>Science</em>. <a href="https://doi.org/10.1126/science.79.2037.38">https://doi.org/10.1126/science.79.2037.38</a>
</div>
<div id="ref-kruschkeDoingBayesianData2015" class="csl-entry">
Kruschke, J. K. (2015). <em>Doing <span>Bayesian</span> data analysis: <span>A</span> tutorial with <span>R</span>, <span>JAGS</span>, and <span>Stan</span></em>. <span>Academic Press</span>. <a href="https://sites.google.com/site/doingbayesiandataanalysis/">https://sites.google.com/site/doingbayesiandataanalysis/</a>
</div>
<div id="ref-nelder1972generalized" class="csl-entry">
Nelder, J. A., &amp; Wedderburn, R. W. (1972). Generalized linear models. <em>Journal of the Royal Statistical Society: Series A (General)</em>, <em>135</em>(3), 370–384. <a href="https://doi.org/10.2307/2344614">https://doi.org/10.2307/2344614</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="stan.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="metric-predicted-variable-on-one-or-two-groups.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
