<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Bayesian Approaches to Testing a Point (“Null”) Hypothesis | Doing Bayesian Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in Kruschke’s (2014) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Bayesian Approaches to Testing a Point (“Null”) Hypothesis | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is an attempt to re-express the code in Kruschke’s (2014) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Bayesian Approaches to Testing a Point (“Null”) Hypothesis | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in Kruschke’s (2014) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2019-11-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="null-hypothesis-significance-testing.html">
<link rel="next" href="goals-power-and-sample-size.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caution-work-in-progress"><i class="fa fa-check"></i>Caution: Work in progress</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html"><i class="fa fa-check"></i><b>1</b> What’s in This Book (Read This First!)</a><ul>
<li class="chapter" data-level="1.1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#real-people-can-read-this-book"><i class="fa fa-check"></i><b>1.1</b> Real people can read this book</a></li>
<li class="chapter" data-level="1.2" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-in-this-book"><i class="fa fa-check"></i><b>1.2</b> What’s in this book</a></li>
<li class="chapter" data-level="1.3" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-new-in-the-second-edition"><i class="fa fa-check"></i><b>1.3</b> What’s new in the second edition</a></li>
<li class="chapter" data-level="1.4" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#gimme-feedback-be-polite"><i class="fa fa-check"></i><b>1.4</b> Gimme feedback (be polite)</a></li>
<li class="chapter" data-level="1.5" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#thank-you"><i class="fa fa-check"></i><b>1.5</b> Thank you!</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#reference"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>I THE BASICS: MODELS, PROBABILITY, BAYES’ RULE, AND R</b></span></li>
<li class="chapter" data-level="2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Introduction: Credibility, Models, and Parameters</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#bayesian-inference-is-reallocation-of-credibility-across-possibilities"><i class="fa fa-check"></i><b>2.1</b> Bayesian inference is reallocation of credibility across possibilities</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#data-are-noisy-and-inferences-are-probabilistic."><i class="fa fa-check"></i><b>2.1.1</b> Data are noisy and inferences are probabilistic.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#possibilities-are-parameter-values-in-descriptive-models"><i class="fa fa-check"></i><b>2.2</b> Possibilities are parameter values in descriptive models</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.3</b> The steps of Bayesian data analysis</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#reference-1"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html"><i class="fa fa-check"></i><b>3</b> The R Programming Language</a><ul>
<li class="chapter" data-level="3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-software"><i class="fa fa-check"></i><b>3.1</b> Get the software</a><ul>
<li class="chapter" data-level="3.1.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-look-at-rstudio."><i class="fa fa-check"></i><b>3.1.1</b> A look at RStudio.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-simple-example-of-r-in-action"><i class="fa fa-check"></i><b>3.2</b> A simple example of R in action</a><ul>
<li class="chapter" data-level="3.2.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-programs-used-with-this-book."><i class="fa fa-check"></i><b>3.2.1</b> Get the programs used with this book.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#basic-commands-and-operators-in-r"><i class="fa fa-check"></i><b>3.3</b> Basic commands and operators in R</a><ul>
<li class="chapter" data-level="3.3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#getting-help-in-r."><i class="fa fa-check"></i><b>3.3.1</b> Getting help in R.</a></li>
<li class="chapter" data-level="3.3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#arithmetic-and-logical-operators."><i class="fa fa-check"></i><b>3.3.2</b> Arithmetic and logical operators.</a></li>
<li class="chapter" data-level="3.3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#assignment-relational-operators-and-tests-of-equality."><i class="fa fa-check"></i><b>3.3.3</b> Assignment, relational operators, and tests of equality.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-types"><i class="fa fa-check"></i><b>3.4</b> Variable types</a><ul>
<li class="chapter" data-level="3.4.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#vector."><i class="fa fa-check"></i><b>3.4.1</b> Vector.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#factor."><i class="fa fa-check"></i><b>3.4.2</b> Factor.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#matrix-and-array."><i class="fa fa-check"></i><b>3.4.3</b> Matrix and array.</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#list-and-data-frame."><i class="fa fa-check"></i><b>3.4.4</b> List and data frame.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#loading-and-saving-data"><i class="fa fa-check"></i><b>3.5</b> Loading and saving data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#the-read.csv-read_csv-and-read.table-read_table-functions."><i class="fa fa-check"></i><b>3.5.1</b> The <del>read.csv</del> <code>read_csv()</code> and <del>read.table</del> <code>read_table()</code> functions.</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#saving-data-from-r."><i class="fa fa-check"></i><b>3.5.2</b> Saving data from R.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#some-utility-functions"><i class="fa fa-check"></i><b>3.6</b> Some utility functions</a></li>
<li class="chapter" data-level="3.7" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-in-r"><i class="fa fa-check"></i><b>3.7</b> Programming in R</a><ul>
<li class="chapter" data-level="3.7.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-names-in-r."><i class="fa fa-check"></i><b>3.7.1</b> Variable names in R.</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#running-a-program."><i class="fa fa-check"></i><b>3.7.2</b> Running a program.</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-a-function."><i class="fa fa-check"></i><b>3.7.3</b> Programming a function.</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conditions-and-loops."><i class="fa fa-check"></i><b>3.7.4</b> Conditions and loops.</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#measuring-processing-time."><i class="fa fa-check"></i><b>3.7.5</b> Measuring processing time.</a></li>
<li class="chapter" data-level="3.7.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#debugging."><i class="fa fa-check"></i><b>3.7.6</b> Debugging.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#graphical-plots-opening-and-saving"><i class="fa fa-check"></i><b>3.8</b> Graphical plots: Opening and saving</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#reference-2"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html"><i class="fa fa-check"></i><b>4</b> What is This Stuff Called Probability?</a><ul>
<li class="chapter" data-level="4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#the-set-of-all-possible-events"><i class="fa fa-check"></i><b>4.1</b> The set of all possible events</a></li>
<li class="chapter" data-level="4.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-outside-or-inside-the-head"><i class="fa fa-check"></i><b>4.2</b> Probability: Outside or inside the head</a><ul>
<li class="chapter" data-level="4.2.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#outside-the-head-long-run-relative-frequency."><i class="fa fa-check"></i><b>4.2.1</b> Outside the head: Long-run relative frequency.</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#inside-the-head-subjective-belief."><i class="fa fa-check"></i><b>4.2.2</b> Inside the head: Subjective belief.</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probabilities-assign-numbers-to-possibilities."><i class="fa fa-check"></i><b>4.2.3</b> Probabilities assign numbers to possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Probability distributions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#discrete-distributions-probability-mass."><i class="fa fa-check"></i><b>4.3.1</b> Discrete distributions: Probability mass.</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#continuous-distributions-rendezvous-with-density."><i class="fa fa-check"></i><b>4.3.2</b> Continuous distributions: Rendezvous with density.</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#mean-and-variance-of-a-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Mean and variance of a distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#highest-density-interval-hdi."><i class="fa fa-check"></i><b>4.3.4</b> Highest density interval (HDI).</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#two-way-distributions"><i class="fa fa-check"></i><b>4.4</b> Two-way distributions</a></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#reference-3"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-rule-1"><i class="fa fa-check"></i><b>5.1</b> Bayes’ rule</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#derived-from-definitions-of-conditional-probability."><i class="fa fa-check"></i><b>5.1.1</b> Derived from definitions of conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule.html"><a href="bayes-rule.html#applied-to-parameters-and-data"><i class="fa fa-check"></i><b>5.2</b> Applied to parameters and data</a></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule.html"><a href="bayes-rule.html#complete-examples-estimating-bias-in-a-coin"><i class="fa fa-check"></i><b>5.3</b> Complete examples: Estimating bias in a coin</a><ul>
<li class="chapter" data-level="5.3.1" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-sample-size-on-the-posterior."><i class="fa fa-check"></i><b>5.3.1</b> Influence of sample size on the posterior.</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-prior-on-the-posterior."><i class="fa fa-check"></i><b>5.3.2</b> Influence of prior on the posterior.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule.html"><a href="bayes-rule.html#why-bayesian-inference-can-be-difficult"><i class="fa fa-check"></i><b>5.4</b> Why Bayesian inference can be difficult</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#reference-4"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>II ALL THE FUNDAMENTALS APPLIED TO INFERRING A BINOMIAL PROBABILITY</b></span></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-likelihood-function-the-bernoulli-distribution"><i class="fa fa-check"></i><b>6.1</b> The likelihood function: The Bernoulli distribution</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-description-of-credibilities-the-beta-distribution"><i class="fa fa-check"></i><b>6.2</b> A description of credibilities: The beta distribution</a><ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#specifying-a-beta-prior."><i class="fa fa-check"></i><b>6.2.1</b> Specifying a beta prior.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-posterior-beta"><i class="fa fa-check"></i><b>6.3</b> The posterior beta</a><ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#posterior-is-compromise-of-prior-and-likelihood."><i class="fa fa-check"></i><b>6.3.1</b> Posterior is compromise of prior and likelihood.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a><ul>
<li class="chapter" data-level="6.4.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.1</b> Prior knowledge expressed as a beta distribution.</a></li>
<li class="chapter" data-level="6.4.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.2</b> Prior knowledge that cannot be expressed as a beta distribution.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#reference-5"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo</a><ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#approximating-a-distribution-with-a-large-sample"><i class="fa fa-check"></i><b>7.1</b> Approximating a distribution with a large sample</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-simple-case-of-the-metropolis-algorithm"><i class="fa fa-check"></i><b>7.2</b> A simple case of the Metropolis algorithm</a><ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-politician-stumbles-upon-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.2.1</b> A politician stumbles upon the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-random-walk."><i class="fa fa-check"></i><b>7.2.2</b> A random walk.</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#general-properties-of-a-random-walk."><i class="fa fa-check"></i><b>7.2.3</b> General properties of a random walk.</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#why-we-care."><i class="fa fa-check"></i><b>7.2.4</b> Why we care.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-metropolis-algorithm-more-generally"><i class="fa fa-check"></i><b>7.3</b> The Metropolis algorithm more generally</a><ul>
<li class="chapter" data-level="7.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithm-applied-to-bernoulli-likelihood-and-beta-prior."><i class="fa fa-check"></i><b>7.3.1</b> Metropolis algorithm applied to Bernoulli likelihood and beta prior.</a></li>
<li class="chapter" data-level="7.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-of-metropolis-algorithm."><i class="fa fa-check"></i><b>7.3.2</b> Summary of Metropolis algorithm.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#toward-gibbs-sampling-estimating-two-coin-biases"><i class="fa fa-check"></i><b>7.4</b> Toward Gibbs sampling: Estimating two coin biases</a><ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#prior-likelihood-and-posterior-for-two-biases."><i class="fa fa-check"></i><b>7.4.1</b> Prior, likelihood and posterior for two biases.</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-exact-formal-analysis."><i class="fa fa-check"></i><b>7.4.2</b> The posterior via exact formal analysis.</a></li>
<li class="chapter" data-level="7.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.4.3</b> The posterior via the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-hamiltonian-monte-carlo-sampling."><i class="fa fa-check"></i><b>7.4.4</b> <del>Gibbs</del> Hamiltonian Monte Carlo sampling.</a></li>
<li class="chapter" data-level="7.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#is-there-a-difference-between-biases"><i class="fa fa-check"></i><b>7.4.5</b> Is there a difference between biases?</a></li>
<li class="chapter" data-level="7.4.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#terminology-mcmc."><i class="fa fa-check"></i><b>7.4.6</b> Terminology: MCMC.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness-accuracy-and-efficiency"><i class="fa fa-check"></i><b>7.5</b> MCMC representativeness, accuracy, and efficiency</a><ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness."><i class="fa fa-check"></i><b>7.5.1</b> MCMC representativeness.</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-accuracy."><i class="fa fa-check"></i><b>7.5.2</b> MCMC accuracy.</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-efficiency."><i class="fa fa-check"></i><b>7.5.3</b> MCMC efficiency.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#reference-6"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-brms.html"><a href="jags-brms.html"><i class="fa fa-check"></i><b>8</b> <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.1" data-path="jags-brms.html"><a href="jags-brms.html#jags-brms-and-its-relation-to-r"><i class="fa fa-check"></i><b>8.1</b> <del>JAGS</del> brms and its relation to R</a></li>
<li class="chapter" data-level="8.2" data-path="jags-brms.html"><a href="jags-brms.html#a-complete-example"><i class="fa fa-check"></i><b>8.2</b> A complete example</a><ul>
<li class="chapter" data-level="8.2.1" data-path="jags-brms.html"><a href="jags-brms.html#load-data."><i class="fa fa-check"></i><b>8.2.1</b> Load data.</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-brms.html"><a href="jags-brms.html#specify-model."><i class="fa fa-check"></i><b>8.2.2</b> Specify model.</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-brms.html"><a href="jags-brms.html#initialize-chains."><i class="fa fa-check"></i><b>8.2.3</b> Initialize chains.</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-brms.html"><a href="jags-brms.html#generate-chains."><i class="fa fa-check"></i><b>8.2.4</b> Generate chains.</a></li>
<li class="chapter" data-level="8.2.5" data-path="jags-brms.html"><a href="jags-brms.html#examine-chains."><i class="fa fa-check"></i><b>8.2.5</b> Examine chains.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-brms.html"><a href="jags-brms.html#simplified-scripts-for-frequently-used-analyses"><i class="fa fa-check"></i><b>8.3</b> Simplified scripts for frequently used analyses</a></li>
<li class="chapter" data-level="8.4" data-path="jags-brms.html"><a href="jags-brms.html#example-difference-of-biases"><i class="fa fa-check"></i><b>8.4</b> Example: Difference of biases</a></li>
<li class="chapter" data-level="8.5" data-path="jags-brms.html"><a href="jags-brms.html#sampling-from-the-prior-distribution-in-jags-brms"><i class="fa fa-check"></i><b>8.5</b> Sampling from the prior distribution in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="8.6" data-path="jags-brms.html"><a href="jags-brms.html#probability-distributions-available-in-jags-brms"><i class="fa fa-check"></i><b>8.6</b> Probability distributions available in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.6.1" data-path="jags-brms.html"><a href="jags-brms.html#defining-new-likelihood-functions."><i class="fa fa-check"></i><b>8.6.1</b> Defining new likelihood functions.</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="jags-brms.html"><a href="jags-brms.html#faster-sampling-with-parallel-processing-in-runjags-brmsbrm"><i class="fa fa-check"></i><b>8.7</b> Faster sampling with parallel processing in <del>runjags</del> <code>brms::brm()</code></a></li>
<li class="chapter" data-level="8.8" data-path="jags-brms.html"><a href="jags-brms.html#tips-for-expanding-jags-brms-models"><i class="fa fa-check"></i><b>8.8</b> Tips for expanding <del>JAGS</del> brms models</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#reference-7"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Hierarchical Models</a><ul>
<li class="chapter" data-level="9.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-single-coin-from-a-single-mint"><i class="fa fa-check"></i><b>9.1</b> A single coin from a single mint</a><ul>
<li class="chapter" data-level="9.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation."><i class="fa fa-check"></i><b>9.1.1</b> Posterior via grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#multiple-coins-from-a-single-mint"><i class="fa fa-check"></i><b>9.2</b> Multiple coins from a single mint</a><ul>
<li class="chapter" data-level="9.2.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation.-1"><i class="fa fa-check"></i><b>9.2.1</b> Posterior via grid approximation.</a></li>
<li class="chapter" data-level="9.2.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-realistic-model-with-mcmc."><i class="fa fa-check"></i><b>9.2.2</b> A realistic model with MCMC.</a></li>
<li class="chapter" data-level="9.2.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#doing-it-with-jags-brms."><i class="fa fa-check"></i><b>9.2.3</b> Doing it with <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="9.2.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-therapeutic-touch."><i class="fa fa-check"></i><b>9.2.4</b> Example: Therapeutic touch.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#shrinkage-in-hierarchical-models"><i class="fa fa-check"></i><b>9.3</b> Shrinkage in hierarchical models</a></li>
<li class="chapter" data-level="9.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#speeding-up-jags-brms"><i class="fa fa-check"></i><b>9.4</b> Speeding up <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="9.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#extending-the-hierarchy-subjects-within-categories"><i class="fa fa-check"></i><b>9.5</b> Extending the hierarchy: Subjects within categories</a><ul>
<li class="chapter" data-level="9.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-batting-abilities-by-position."><i class="fa fa-check"></i><b>9.5.1</b> Example: Baseball batting abilities by position.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#reference-8"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html"><i class="fa fa-check"></i><b>10</b> Model Comparison and Hierarchical Modeling</a><ul>
<li class="chapter" data-level="10.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#general-formula-and-the-bayes-factor"><i class="fa fa-check"></i><b>10.1</b> General formula and the Bayes factor</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#example-two-factories-of-coins"><i class="fa fa-check"></i><b>10.2</b> Example: Two factories of coins</a><ul>
<li class="chapter" data-level="10.2.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-formal-analysis."><i class="fa fa-check"></i><b>10.2.1</b> Solution by formal analysis.</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-grid-approximation."><i class="fa fa-check"></i><b>10.2.2</b> Solution by grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-mcmc"><i class="fa fa-check"></i><b>10.3</b> Solution by MCMC</a><ul>
<li class="chapter" data-level="10.3.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#nonhierarchical-mcmc-computation-of-each-models-marginal-likelihood."><i class="fa fa-check"></i><b>10.3.1</b> Nonhierarchical MCMC computation of each model’s marginal likelihood.</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#hierarchical-mcmc-computation-of-relative-model-probability-is-not-available-in-brms-well-cover-information-criteria-instead."><i class="fa fa-check"></i><b>10.3.2</b> Hierarchical MCMC computation <del>of relative model probability</del> is not available in brms: We’ll cover information criteria instead.</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#models-with-different-noise-distributions-in-jags-brms."><i class="fa fa-check"></i><b>10.3.3</b> Models with different “noise” distributions in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#prediction-model-averaging"><i class="fa fa-check"></i><b>10.4</b> Prediction: Model averaging</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#model-complexity-naturally-accounted-for"><i class="fa fa-check"></i><b>10.5</b> Model complexity naturally accounted for</a><ul>
<li class="chapter" data-level="10.5.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#caveats-regarding-nested-model-comparison."><i class="fa fa-check"></i><b>10.5.1</b> Caveats regarding nested model comparison.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#extreme-sensitivity-to-the-prior-distribution"><i class="fa fa-check"></i><b>10.6</b> Extreme sensitivity to the prior distribution</a><ul>
<li class="chapter" data-level="10.6.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#priors-of-different-models-should-be-equally-informed."><i class="fa fa-check"></i><b>10.6.1</b> Priors of different models should be equally informed.</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#bonus-theres-danger-ahead"><i class="fa fa-check"></i><b>10.7</b> Bonus: There’s danger ahead</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#reference-9"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>11</b> Null Hypothesis Significance Testing</a><ul>
<li class="chapter" data-level="11.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#paved-with-good-intentions"><i class="fa fa-check"></i><b>11.1</b> Paved with good intentions</a><ul>
<li class="chapter" data-level="11.1.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#definition-of-p-value."><i class="fa fa-check"></i><b>11.1.1</b> Definition of <span class="math inline">\(p\)</span> value.</a></li>
<li class="chapter" data-level="11.1.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-n."><i class="fa fa-check"></i><b>11.1.2</b> With intention to fix <span class="math inline">\(N\)</span>.</a></li>
<li class="chapter" data-level="11.1.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-z."><i class="fa fa-check"></i><b>11.1.3</b> With intention to fix <span class="math inline">\(z\)</span>.</a></li>
<li class="chapter" data-level="11.1.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-duration."><i class="fa fa-check"></i><b>11.1.4</b> With intention to fix duration.</a></li>
<li class="chapter" data-level="11.1.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-make-multiple-tests."><i class="fa fa-check"></i><b>11.1.5</b> With intention to make multiple tests.</a></li>
<li class="chapter" data-level="11.1.6" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#soul-searching."><i class="fa fa-check"></i><b>11.1.6</b> Soul searching.</a></li>
<li class="chapter" data-level="11.1.7" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis."><i class="fa fa-check"></i><b>11.1.7</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#prior-knowledge"><i class="fa fa-check"></i><b>11.2</b> Prior knowledge</a><ul>
<li class="chapter" data-level="11.2.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-analysis."><i class="fa fa-check"></i><b>11.2.1</b> NHST analysis.</a></li>
<li class="chapter" data-level="11.2.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis.-1"><i class="fa fa-check"></i><b>11.2.2</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#confidence-interval-and-highest-density-interval"><i class="fa fa-check"></i><b>11.3</b> Confidence interval and highest density interval</a><ul>
<li class="chapter" data-level="11.3.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#ci-depends-on-intention."><i class="fa fa-check"></i><b>11.3.1</b> CI depends on intention.</a></li>
<li class="chapter" data-level="11.3.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-hdi."><i class="fa fa-check"></i><b>11.3.2</b> Bayesian HDI.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#multiple-comparisons"><i class="fa fa-check"></i><b>11.4</b> Multiple comparisons</a><ul>
<li class="chapter" data-level="11.4.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-correction-for-experiment-wise-error."><i class="fa fa-check"></i><b>11.4.1</b> NHST correction for experiment wise error.</a></li>
<li class="chapter" data-level="11.4.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#just-one-bayesian-posterior-no-matter-how-you-look-at-it."><i class="fa fa-check"></i><b>11.4.2</b> Just one Bayesian posterior no matter how you look at it.</a></li>
<li class="chapter" data-level="11.4.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#how-bayesian-analysis-mitigates-false-alarms."><i class="fa fa-check"></i><b>11.4.3</b> How Bayesian analysis mitigates false alarms.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#what-a-sampling-distribution-is-good-for"><i class="fa fa-check"></i><b>11.5</b> What a sampling distribution is good for</a><ul>
<li class="chapter" data-level="11.5.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#planning-an-experiment."><i class="fa fa-check"></i><b>11.5.1</b> Planning an experiment.</a></li>
<li class="chapter" data-level="11.5.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#exploring-model-predictions-posterior-predictive-check."><i class="fa fa-check"></i><b>11.5.2</b> Exploring model predictions (posterior predictive check).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#reference-10"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><i class="fa fa-check"></i><b>12</b> Bayesian Approaches to Testing a Point (“Null”) Hypothesis</a><ul>
<li class="chapter" data-level="12.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-estimation-approach"><i class="fa fa-check"></i><b>12.1</b> The estimation approach</a><ul>
<li class="chapter" data-level="12.1.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#region-of-practical-equivalence."><i class="fa fa-check"></i><b>12.1.1</b> Region of practical equivalence.</a></li>
<li class="chapter" data-level="12.1.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#some-examples."><i class="fa fa-check"></i><b>12.1.2</b> Some examples.</a></li>
<li class="chapter" data-level="12.1.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#differences-of-correlated-parameters."><i class="fa fa-check"></i><b>12.1.3</b> Differences of correlated parameters.</a></li>
<li class="chapter" data-level="12.1.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#why-hdi-and-not-equal-tailed-interval"><i class="fa fa-check"></i><b>12.1.4</b> Why HDI and not equal-tailed interval?</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-model-comparison-approach"><i class="fa fa-check"></i><b>12.2</b> The model-comparison approach</a><ul>
<li class="chapter" data-level="12.2.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#is-a-coin-fair-or-not"><i class="fa fa-check"></i><b>12.2.1</b> Is a coin fair or not?</a></li>
<li class="chapter" data-level="12.2.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#bayes-factor-can-accept-null-with-poor-precision."><i class="fa fa-check"></i><b>12.2.2</b> Bayes’ factor can accept null with poor precision.</a></li>
<li class="chapter" data-level="12.2.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#are-different-groups-equal-or-not"><i class="fa fa-check"></i><b>12.2.3</b> Are different groups equal or not?</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#relations-of-parameter-estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.3</b> Relations of parameter estimation and model comparison</a></li>
<li class="chapter" data-level="12.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.4</b> Estimation and model comparison?</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#reference-11"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html"><i class="fa fa-check"></i><b>13</b> Goals, Power, and Sample Size</a><ul>
<li class="chapter" data-level="13.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-will-to-power"><i class="fa fa-check"></i><b>13.1</b> The will to power</a><ul>
<li class="chapter" data-level="13.1.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#goals-and-obstacles."><i class="fa fa-check"></i><b>13.1.1</b> Goals and obstacles.</a></li>
<li class="chapter" data-level="13.1.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power."><i class="fa fa-check"></i><b>13.1.2</b> Power.</a></li>
<li class="chapter" data-level="13.1.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sample-size."><i class="fa fa-check"></i><b>13.1.3</b> Sample size.</a></li>
<li class="chapter" data-level="13.1.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#other-expressions-of-goals."><i class="fa fa-check"></i><b>13.1.4</b> Other expressions of goals.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#computing-power-and-sample-size"><i class="fa fa-check"></i><b>13.2</b> Computing power and sample size</a><ul>
<li class="chapter" data-level="13.2.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-to-exclude-a-null-value."><i class="fa fa-check"></i><b>13.2.1</b> When the goal is to exclude a null value.</a></li>
<li class="chapter" data-level="13.2.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#formal-solution-and-implementation-in-r."><i class="fa fa-check"></i><b>13.2.2</b> Formal solution and implementation in R.</a></li>
<li class="chapter" data-level="13.2.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-precision."><i class="fa fa-check"></i><b>13.2.3</b> When the goal is precision.</a></li>
<li class="chapter" data-level="13.2.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#monte-carlo-approximation-of-power."><i class="fa fa-check"></i><b>13.2.4</b> Monte Carlo approximation of power.</a></li>
<li class="chapter" data-level="13.2.5" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-from-idealized-or-actual-data."><i class="fa fa-check"></i><b>13.2.5</b> Power from idealized or actual data.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sequential-testing-and-the-goal-of-precision"><i class="fa fa-check"></i><b>13.3</b> Sequential testing and the goal of precision</a><ul>
<li class="chapter" data-level="13.3.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#examples-ofsequential-tests."><i class="fa fa-check"></i><b>13.3.1</b> Examples ofsequential tests.</a></li>
<li class="chapter" data-level="13.3.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#more-will-come-soon"><i class="fa fa-check"></i><b>13.3.2</b> More will come soon…</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#reference-12"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a><ul>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#references"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>III THE GENERALIZED LINEAR MODEL</b></span></li>
<li class="chapter" data-level="15" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>15</b> Overview of the Generalized Linear Model</a><ul>
<li class="chapter" data-level="15.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#types-of-variables"><i class="fa fa-check"></i><b>15.1</b> Types of variables</a><ul>
<li class="chapter" data-level="15.1.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#predictor-and-predicted-variables."><i class="fa fa-check"></i><b>15.1.1</b> Predictor and predicted variables.</a></li>
<li class="chapter" data-level="15.1.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#scale-types-metric-ordinal-nominal-and-count."><i class="fa fa-check"></i><b>15.1.2</b> Scale types: metric, ordinal, nominal, and count.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-combination-of-predictors"><i class="fa fa-check"></i><b>15.2</b> Linear combination of predictors</a><ul>
<li class="chapter" data-level="15.2.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-function-of-a-single-metric-predictor."><i class="fa fa-check"></i><b>15.2.1</b> Linear function of a single metric predictor.</a></li>
<li class="chapter" data-level="15.2.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#additive-combination-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.2</b> Additive combination of metric predictors.</a></li>
<li class="chapter" data-level="15.2.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nonadditive-interaction-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.3</b> Nonadditive interaction of metric predictors.</a></li>
<li class="chapter" data-level="15.2.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nominal-predictors."><i class="fa fa-check"></i><b>15.2.4</b> Nominal predictors.</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linking-from-combined-predictors-to-noisy-predicted-data"><i class="fa fa-check"></i><b>15.3</b> Linking from combined predictors to noisy predicted data</a><ul>
<li class="chapter" data-level="15.3.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predictors-to-predicted-central-tendency."><i class="fa fa-check"></i><b>15.3.1</b> From predictors to predicted central tendency.</a></li>
<li class="chapter" data-level="15.3.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predicted-central-tendency-to-noisy-data."><i class="fa fa-check"></i><b>15.3.2</b> From predicted central tendency to noisy data.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#formal-expression-of-the-glm"><i class="fa fa-check"></i><b>15.4</b> Formal expression of the GLM</a><ul>
<li class="chapter" data-level="15.4.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#cases-of-the-glm."><i class="fa fa-check"></i><b>15.4.1</b> Cases of the GLM.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#reference-13"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html"><i class="fa fa-check"></i><b>16</b> Metric-Predicted Variable on One or Two Groups</a><ul>
<li class="chapter" data-level="16.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#estimating-the-mean-and-standard-deviation-of-a-normal-distribution"><i class="fa fa-check"></i><b>16.1</b> Estimating the mean and standard deviation of a normal distribution</a><ul>
<li class="chapter" data-level="16.1.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#solution-by-mathematical-analysis-heads-up-on-precision."><i class="fa fa-check"></i><b>16.1.1</b> <del>Solution by mathematical analysis</del> Heads up on precision.</a></li>
<li class="chapter" data-level="16.1.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#approximation-by-mcmc-in-jags-hmc-in-brms."><i class="fa fa-check"></i><b>16.1.2</b> Approximation by <del>MCMC in JAGS</del> HMC in brms.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#outliers-and-robust-estimation-the-t-distribution"><i class="fa fa-check"></i><b>16.2</b> Outliers and robust estimation: The <span class="math inline">\(t\)</span> distribution</a><ul>
<li class="chapter" data-level="16.2.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-jags-brms."><i class="fa fa-check"></i><b>16.2.1</b> Using the <span class="math inline">\(t\)</span> distribution in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="16.2.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-stan."><i class="fa fa-check"></i><b>16.2.2</b> Using the <span class="math inline">\(t\)</span> distribution in Stan.</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#two-groups"><i class="fa fa-check"></i><b>16.3</b> Two groups</a><ul>
<li class="chapter" data-level="16.3.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#analysis-by-nhst."><i class="fa fa-check"></i><b>16.3.1</b> Analysis by NHST.</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#other-noise-distributions-and-transforming-data"><i class="fa fa-check"></i><b>16.4</b> Other noise distributions and transforming data</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#reference-14"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#session-info-15"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html"><i class="fa fa-check"></i><b>17</b> Metric Predicted Variable with One Metric Predictor</a><ul>
<li class="chapter" data-level="17.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#simple-linear-regression"><i class="fa fa-check"></i><b>17.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="17.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Robust linear regression</a><ul>
<li class="chapter" data-level="17.2.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-jags-brms."><i class="fa fa-check"></i><b>17.2.1</b> Robust linear regression in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.2.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-stan."><i class="fa fa-check"></i><b>17.2.2</b> Robust linear regression in Stan.</a></li>
<li class="chapter" data-level="17.2.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#stan-or-jags"><i class="fa fa-check"></i><b>17.2.3</b> Stan or JAGS?</a></li>
<li class="chapter" data-level="17.2.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>17.2.4</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#hierarchical-regression-on-individuals-within-groups"><i class="fa fa-check"></i><b>17.3</b> Hierarchical regression on individuals within groups</a><ul>
<li class="chapter" data-level="17.3.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>17.3.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.3.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-posterior-distribution-shrinkage-and-prediction."><i class="fa fa-check"></i><b>17.3.2</b> The posterior distribution: Shrinkage and prediction.</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#quadratic-trend-and-weighted-data"><i class="fa fa-check"></i><b>17.4</b> Quadratic trend and weighted data</a><ul>
<li class="chapter" data-level="17.4.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#results-and-interpretation."><i class="fa fa-check"></i><b>17.4.1</b> Results and interpretation.</a></li>
<li class="chapter" data-level="17.4.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#further-extensions."><i class="fa fa-check"></i><b>17.4.2</b> Further extensions.</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#procedure-and-perils-for-expanding-a-model"><i class="fa fa-check"></i><b>17.5</b> Procedure and perils for expanding a model</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#reference-15"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#session-info-16"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Metric Predicted Variable with Multiple Metric Predictors</a><ul>
<li class="chapter" data-level="18.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiple-linear-regression"><i class="fa fa-check"></i><b>18.1</b> Multiple linear regression</a><ul>
<li class="chapter" data-level="18.1.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-perils-of-correlated-predictors."><i class="fa fa-check"></i><b>18.1.1</b> The perils of correlated predictors.</a></li>
<li class="chapter" data-level="18.1.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-model-and-implementation."><i class="fa fa-check"></i><b>18.1.2</b> The model and implementation.</a></li>
<li class="chapter" data-level="18.1.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-posterior-distribution."><i class="fa fa-check"></i><b>18.1.3</b> The posterior distribution.</a></li>
<li class="chapter" data-level="18.1.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#redundant-predictors."><i class="fa fa-check"></i><b>18.1.4</b> Redundant predictors.</a></li>
<li class="chapter" data-level="18.1.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#informative-priors-sparse-data-and-correlated-predictors."><i class="fa fa-check"></i><b>18.1.5</b> Informative priors, sparse data, and correlated predictors.</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiplicative-interaction-of-metric-predictors"><i class="fa fa-check"></i><b>18.2</b> Multiplicative interaction of metric predictors</a><ul>
<li class="chapter" data-level="18.2.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#an-example."><i class="fa fa-check"></i><b>18.2.1</b> An example.</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#shrinkage-of-regression-coefficients"><i class="fa fa-check"></i><b>18.3</b> Shrinkage of regression coefficients</a></li>
<li class="chapter" data-level="18.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection"><i class="fa fa-check"></i><b>18.4</b> Variable selection</a><ul>
<li class="chapter" data-level="18.4.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#inclusion-probability-is-strongly-affected-by-vagueness-of-prior."><i class="fa fa-check"></i><b>18.4.1</b> Inclusion probability is strongly affected by vagueness of prior.</a></li>
<li class="chapter" data-level="18.4.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection-with-hierarchical-shrinkage."><i class="fa fa-check"></i><b>18.4.2</b> Variable selection with hierarchical shrinkage.</a></li>
<li class="chapter" data-level="18.4.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#what-to-report-and-what-to-conclude."><i class="fa fa-check"></i><b>18.4.3</b> What to report and what to conclude.</a></li>
<li class="chapter" data-level="18.4.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-computational-methods."><i class="fa fa-check"></i><b>18.4.4</b> Caution: Computational methods.</a></li>
<li class="chapter" data-level="18.4.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-interaction-variables."><i class="fa fa-check"></i><b>18.4.5</b> Caution: Interaction variables.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#reference-16"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#session-info-17"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html"><i class="fa fa-check"></i><b>19</b> Metric Predicted Variable with One Nominal Predictor</a><ul>
<li class="chapter" data-level="19.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#describing-multiple-groups-of-metric-data"><i class="fa fa-check"></i><b>19.1</b> Describing multiple groups of metric data</a></li>
<li class="chapter" data-level="19.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#traditional-analysis-of-variance"><i class="fa fa-check"></i><b>19.2</b> Traditional analysis of variance</a></li>
<li class="chapter" data-level="19.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#hierarchical-bayesian-approach"><i class="fa fa-check"></i><b>19.3</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="19.3.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#implementation-in-jags-brms."><i class="fa fa-check"></i><b>19.3.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="19.3.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-and-death."><i class="fa fa-check"></i><b>19.3.2</b> Example: Sex and death.</a></li>
<li class="chapter" data-level="19.3.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#contrasts."><i class="fa fa-check"></i><b>19.3.3</b> Contrasts.</a></li>
<li class="chapter" data-level="19.3.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#multiple-comparisons-and-shrinkage."><i class="fa fa-check"></i><b>19.3.4</b> Multiple comparisons and shrinkage.</a></li>
<li class="chapter" data-level="19.3.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#the-two-group-case."><i class="fa fa-check"></i><b>19.3.5</b> The two-group case.</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#including-a-metric-predictor"><i class="fa fa-check"></i><b>19.4</b> Including a metric predictor</a><ul>
<li class="chapter" data-level="19.4.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-death-and-size."><i class="fa fa-check"></i><b>19.4.1</b> Example: Sex, death, and size.</a></li>
<li class="chapter" data-level="19.4.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#analogous-to-traditional-ancova."><i class="fa fa-check"></i><b>19.4.2</b> Analogous to traditional ANCOVA.</a></li>
<li class="chapter" data-level="19.4.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#relation-to-hierarchical-linear-regression."><i class="fa fa-check"></i><b>19.4.3</b> Relation to hierarchical linear regression.</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#heterogeneous-variances-and-robustness-against-outliers"><i class="fa fa-check"></i><b>19.5</b> Heterogeneous variances and robustness against outliers</a><ul>
<li class="chapter" data-level="19.5.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-contrast-of-means-with-different-variances."><i class="fa fa-check"></i><b>19.5.1</b> Example: Contrast of means with different variances.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#reference-17"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#session-info-18"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Metric Predicted Variable with Multiple Nominal Predictors</a><ul>
<li class="chapter" data-level="20.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#describing-groups-of-metric-data-with-multiple-nominal-predictors"><i class="fa fa-check"></i><b>20.1</b> Describing groups of metric data with multiple nominal predictors</a><ul>
<li class="chapter" data-level="20.1.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction."><i class="fa fa-check"></i><b>20.1.1</b> Interaction.</a></li>
<li class="chapter" data-level="20.1.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#traditional-anova."><i class="fa fa-check"></i><b>20.1.2</b> Traditional ANOVA.</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#hierarchical-bayesian-approach-1"><i class="fa fa-check"></i><b>20.2</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="20.2.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>20.2.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="20.2.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#example-its-only-money."><i class="fa fa-check"></i><b>20.2.2</b> Example: It’s only money.</a></li>
<li class="chapter" data-level="20.2.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#main-effect-contrasts."><i class="fa fa-check"></i><b>20.2.3</b> Main effect contrasts.</a></li>
<li class="chapter" data-level="20.2.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction-contrasts-and-simple-effects."><i class="fa fa-check"></i><b>20.2.4</b> Interaction contrasts and simple effects.</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#rescaling-can-change-interactions-homogeneity-and-normality"><i class="fa fa-check"></i><b>20.3</b> Rescaling can change interactions, homogeneity, and normality</a></li>
<li class="chapter" data-level="20.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1"><i class="fa fa-check"></i><b>20.4</b> Heterogeneous variances and robustness against outliers</a></li>
<li class="chapter" data-level="20.5" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#within-subject-designs"><i class="fa fa-check"></i><b>20.5</b> Within-subject designs</a><ul>
<li class="chapter" data-level="20.5.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#why-use-a-within-subject-design-and-why-not"><i class="fa fa-check"></i><b>20.5.1</b> Why use a within-subject design? And why not?</a></li>
<li class="chapter" data-level="20.5.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#split-plot-design."><i class="fa fa-check"></i><b>20.5.2</b> Split-plot design.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#reference-18"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#session-info-19"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html"><i class="fa fa-check"></i><b>21</b> Dichotomous Predicted Variable</a><ul>
<li class="chapter" data-level="21.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-metric-predictors"><i class="fa fa-check"></i><b>21.1</b> Multiple metric predictors</a><ul>
<li class="chapter" data-level="21.1.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#the-model-and-implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>21.1.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="21.1.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#example-height-weight-and-gender."><i class="fa fa-check"></i><b>21.1.2</b> Example: Height, weight, and gender.</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interpreting-the-regression-coefficients"><i class="fa fa-check"></i><b>21.2</b> Interpreting the regression coefficients</a><ul>
<li class="chapter" data-level="21.2.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#log-odds."><i class="fa fa-check"></i><b>21.2.1</b> Log odds.</a></li>
<li class="chapter" data-level="21.2.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#when-there-are-few-1s-or-0s-in-the-data."><i class="fa fa-check"></i><b>21.2.2</b> When there are few 1’s or 0’s in the data.</a></li>
<li class="chapter" data-level="21.2.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#correlated-predictors."><i class="fa fa-check"></i><b>21.2.3</b> Correlated predictors.</a></li>
<li class="chapter" data-level="21.2.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interaction-of-metric-predictors."><i class="fa fa-check"></i><b>21.2.4</b> Interaction of metric predictors.</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#robust-logistic-regression"><i class="fa fa-check"></i><b>21.3</b> Robust logistic regression</a></li>
<li class="chapter" data-level="21.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#nominal-predictors"><i class="fa fa-check"></i><b>21.4</b> Nominal predictors</a><ul>
<li class="chapter" data-level="21.4.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#single-group."><i class="fa fa-check"></i><b>21.4.1</b> Single group.</a></li>
<li class="chapter" data-level="21.4.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-groups."><i class="fa fa-check"></i><b>21.4.2</b> Multiple groups.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#reference-19"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#session-info-20"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Doing Bayesian Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian-approaches-to-testing-a-point-null-hypothesis" class="section level1">
<h1><span class="header-section-number">12</span> Bayesian Approaches to Testing a Point (“Null”) Hypothesis</h1>
<blockquote>
<p>Suppose that you have collected some data, and now you want to answer the question, Is there a non-zero effect or not? Is the coin fair or not? Is there better-than-chance accuracy or not? Is there a difference between groups or not? In the previous chapter, [Kruschke] argued that answering this type of question via null hypothesis significance testing (NHST) has deep problems. This chapter describes Bayesian approaches to the question. (p. 335)</p>
</blockquote>
<div id="the-estimation-approach" class="section level2">
<h2><span class="header-section-number">12.1</span> The estimation approach</h2>
<blockquote>
<p>Throughout this book, we have used Bayesian inference to derive a posterior distribution over a parameter of interest, such as the bias <span class="math inline">\(\theta\)</span> of a coin. We can then use the posterior distribution to discern the credible values of the parameter. If the null value is far from the credible values, then we reject the null value as not credible. But if all the credible values are virtually equivalent to the null value, then we can accept the null value. (p. 336)</p>
</blockquote>
<div id="region-of-practical-equivalence." class="section level3">
<h3><span class="header-section-number">12.1.1</span> Region of practical equivalence.</h3>
<p>Kruschke began: “A <em>region of practical equivalence</em> (ROPE) indicates a small range of parameter values that are considered to be practically equivalent to the null value for purposes of the particular application” (p. 336, <em>emphasis</em> in the original)</p>
<p>Here’s a plot of Kruschke’s initial coin flip ROPE.</p>
<div class="sourceCode" id="cb936"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb936-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb936-2" data-line-number="2"></a>
<a class="sourceLine" id="cb936-3" data-line-number="3"><span class="kw">tibble</span>(<span class="dt">xmin =</span> <span class="fl">.45</span>,</a>
<a class="sourceLine" id="cb936-4" data-line-number="4">       <span class="dt">xmax =</span> <span class="fl">.55</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb936-5" data-line-number="5"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb936-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin =</span> xmin, <span class="dt">xmax =</span> xmax,</a>
<a class="sourceLine" id="cb936-7" data-line-number="7">                <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>),</a>
<a class="sourceLine" id="cb936-8" data-line-number="8">            <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb936-9" data-line-number="9"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">y =</span> <span class="fl">.5</span>, <span class="dt">label =</span> <span class="st">&quot;ROPE&quot;</span>,</a>
<a class="sourceLine" id="cb936-10" data-line-number="10">           <span class="dt">color =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb936-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb936-12" data-line-number="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Kruschke&#39;s coin flip ROPE&quot;</span>,</a>
<a class="sourceLine" id="cb936-13" data-line-number="13">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb936-14" data-line-number="14"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb936-15" data-line-number="15"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-2-1.png" /><!-- --></p>
<p>In the first example (p. 336), we have <span class="math inline">\(z = 325\)</span> heads out of <span class="math inline">\(N = 500\)</span> coin flips. To visualize the analysis, we’ll need the Bernoulli likelihood.</p>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb937-1" data-line-number="1">bernoulli_likelihood &lt;-<span class="st"> </span><span class="cf">function</span>(theta, data) {</a>
<a class="sourceLine" id="cb937-2" data-line-number="2">  n &lt;-<span class="st"> </span><span class="kw">length</span>(data)</a>
<a class="sourceLine" id="cb937-3" data-line-number="3">  z &lt;-<span class="st"> </span><span class="kw">sum</span>(data)</a>
<a class="sourceLine" id="cb937-4" data-line-number="4">  <span class="kw">return</span>(theta<span class="op">^</span>z <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta)<span class="op">^</span>(n <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(data)))</a>
<a class="sourceLine" id="cb937-5" data-line-number="5">  }</a></code></pre></div>
<p>Now we’ll follow the typical steps to combine the prior, which is flat in this case, and the likelihood to get the posterior.</p>
<div class="sourceCode" id="cb938"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb938-1" data-line-number="1"><span class="co"># the data summaries</span></a>
<a class="sourceLine" id="cb938-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb938-3" data-line-number="3">z &lt;-<span class="st"> </span><span class="dv">325</span></a>
<a class="sourceLine" id="cb938-4" data-line-number="4"></a>
<a class="sourceLine" id="cb938-5" data-line-number="5">trial_data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> n <span class="op">-</span><span class="st"> </span>z), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dt">times =</span> z))            <span class="co"># (i.e., data)</span></a>
<a class="sourceLine" id="cb938-6" data-line-number="6"></a>
<a class="sourceLine" id="cb938-7" data-line-number="7">d &lt;-</a>
<a class="sourceLine" id="cb938-8" data-line-number="8"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="fl">1e3</span>)) <span class="op">%&gt;%</span><span class="st">        </span><span class="co"># (i.e., theta)</span></a>
<a class="sourceLine" id="cb938-9" data-line-number="9"><span class="st">  </span><span class="co"># recall Beta(1, 1) is flat</span></a>
<a class="sourceLine" id="cb938-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior      =</span> <span class="kw">dbeta</span>(theta, <span class="dt">shape1 =</span> <span class="dv">1</span>, <span class="dt">shape2 =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st">      </span><span class="co"># (i.e., p(theta))</span></a>
<a class="sourceLine" id="cb938-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">likelihood =</span> <span class="kw">bernoulli_likelihood</span>(<span class="dt">theta =</span> theta,            <span class="co"># (i.e., p(D | theta))</span></a>
<a class="sourceLine" id="cb938-12" data-line-number="12">                                           <span class="dt">data =</span> trial_data)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb938-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">evidence  =</span> <span class="kw">sum</span>(prior <span class="op">*</span><span class="st"> </span>likelihood)) <span class="op">%&gt;%</span><span class="st">                    </span><span class="co"># (i.e., p(D))</span></a>
<a class="sourceLine" id="cb938-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">posterior =</span> likelihood <span class="op">*</span><span class="st"> </span>prior <span class="op">/</span><span class="st"> </span>evidence)                  <span class="co"># (i.e., p(theta | D))</span></a>
<a class="sourceLine" id="cb938-15" data-line-number="15">  </a>
<a class="sourceLine" id="cb938-16" data-line-number="16"><span class="kw">glimpse</span>(d)</a></code></pre></div>
<pre><code>## Observations: 1,000
## Variables: 5
## $ theta      &lt;dbl&gt; 0.000000000, 0.001001001, 0.002002002, 0.003003003, 0.004004004, 0.005005005, …
## $ prior      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ likelihood &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ evidence   &lt;dbl&gt; 1.367061e-139, 1.367061e-139, 1.367061e-139, 1.367061e-139, 1.367061e-139, 1.3…
## $ posterior  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</code></pre>
<p>Now we can plot the results.</p>
<div class="sourceCode" id="cb940"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb940-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> d) <span class="op">+</span></a>
<a class="sourceLine" id="cb940-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="fl">.45</span>,  <span class="dt">xmax =</span> <span class="fl">.55</span>,</a>
<a class="sourceLine" id="cb940-3" data-line-number="3">            <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>,</a>
<a class="sourceLine" id="cb940-4" data-line-number="4">            <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb940-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> posterior),</a>
<a class="sourceLine" id="cb940-6" data-line-number="6">              <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb940-7" data-line-number="7"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">y =</span> <span class="fl">.01</span>, <span class="dt">label =</span> <span class="st">&quot;ROPE&quot;</span>,</a>
<a class="sourceLine" id="cb940-8" data-line-number="8">           <span class="dt">color =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb940-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb940-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Nope, that density ain&#39;t in that ROPE.&quot;</span>,</a>
<a class="sourceLine" id="cb940-11" data-line-number="11">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb940-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-5-1.png" /><!-- --></p>
<p>With the formula by <span class="math inline">\(\operatorname{Beta} (\theta | z + \alpha, N - z + \beta)\)</span>, we can analytically compute the Beta parameters for the posterior.</p>
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb941-1" data-line-number="1">(alpha &lt;-<span class="st"> </span>z <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 326</code></pre>
<div class="sourceCode" id="cb943"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb943-1" data-line-number="1">(beta &lt;-<span class="st"> </span>n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 176</code></pre>
<p>With the <code>hdi_of_icdf()</code> function, we’ll compute the HDIs.</p>
<div class="sourceCode" id="cb945"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb945-1" data-line-number="1">hdi_of_icdf &lt;-<span class="st"> </span><span class="cf">function</span>(name, <span class="dt">width =</span> <span class="fl">.95</span>, <span class="dt">tol =</span> <span class="fl">1e-8</span>, ... ) {</a>
<a class="sourceLine" id="cb945-2" data-line-number="2">  incredible_mass &lt;-<span class="st">  </span><span class="fl">1.0</span> <span class="op">-</span><span class="st"> </span>width</a>
<a class="sourceLine" id="cb945-3" data-line-number="3">  interval_width  &lt;-<span class="st"> </span><span class="cf">function</span>(low_tail_prob, name, width, ...) {</a>
<a class="sourceLine" id="cb945-4" data-line-number="4">    <span class="kw">name</span>(width <span class="op">+</span><span class="st"> </span>low_tail_prob, ...) <span class="op">-</span><span class="st"> </span><span class="kw">name</span>(low_tail_prob, ...)</a>
<a class="sourceLine" id="cb945-5" data-line-number="5">  }</a>
<a class="sourceLine" id="cb945-6" data-line-number="6">  opt_info &lt;-<span class="st"> </span><span class="kw">optimize</span>(interval_width, <span class="kw">c</span>(<span class="dv">0</span>, incredible_mass), </a>
<a class="sourceLine" id="cb945-7" data-line-number="7">                       <span class="dt">name =</span> name, <span class="dt">width =</span> width, </a>
<a class="sourceLine" id="cb945-8" data-line-number="8">                       <span class="dt">tol =</span> tol, ...)</a>
<a class="sourceLine" id="cb945-9" data-line-number="9">  hdi_lower_tail_prob &lt;-<span class="st"> </span>opt_info<span class="op">$</span>minimum</a>
<a class="sourceLine" id="cb945-10" data-line-number="10">  <span class="kw">return</span>(<span class="kw">c</span>(<span class="kw">name</span>(hdi_lower_tail_prob, ...),</a>
<a class="sourceLine" id="cb945-11" data-line-number="11">           <span class="kw">name</span>(width <span class="op">+</span><span class="st"> </span>hdi_lower_tail_prob, ...)))</a>
<a class="sourceLine" id="cb945-12" data-line-number="12">}</a></code></pre></div>
<p>Compute those HDIs and save them as <code>h</code>.</p>
<div class="sourceCode" id="cb946"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb946-1" data-line-number="1">(h &lt;-</a>
<a class="sourceLine" id="cb946-2" data-line-number="2"><span class="st">  </span><span class="kw">hdi_of_icdf</span>(<span class="dt">name   =</span> qbeta,</a>
<a class="sourceLine" id="cb946-3" data-line-number="3">              <span class="dt">shape1 =</span> alpha,</a>
<a class="sourceLine" id="cb946-4" data-line-number="4">              <span class="dt">shape2 =</span> beta)</a>
<a class="sourceLine" id="cb946-5" data-line-number="5">)</a></code></pre></div>
<pre><code>## [1] 0.6075644 0.6909070</code></pre>
<p>Now let’s remake the plot from above, this time with the analytically-derived HDI values.</p>
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb948-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="fl">1e3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb948-2" data-line-number="2"><span class="st">  </span></a>
<a class="sourceLine" id="cb948-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb948-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="fl">.45</span>,  <span class="dt">xmax =</span> <span class="fl">.55</span>,</a>
<a class="sourceLine" id="cb948-5" data-line-number="5">            <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>,</a>
<a class="sourceLine" id="cb948-6" data-line-number="6">            <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb948-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, </a>
<a class="sourceLine" id="cb948-8" data-line-number="8">                  <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> <span class="kw">dbeta</span>(theta, <span class="dt">shape1 =</span> alpha, <span class="dt">shape2 =</span> beta)),</a>
<a class="sourceLine" id="cb948-9" data-line-number="9">              <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">size =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb948-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">x =</span> h[<span class="dv">1</span>], <span class="dt">xend =</span> h[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb948-11" data-line-number="11">               <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">yend =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb948-12" data-line-number="12">               <span class="dt">size =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb948-13" data-line-number="13"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">y =</span> <span class="fl">17.5</span>, <span class="dt">label =</span> <span class="st">&quot;ROPE&quot;</span>,</a>
<a class="sourceLine" id="cb948-14" data-line-number="14">           <span class="dt">color =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb948-15" data-line-number="15"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.65</span>, <span class="dt">y =</span> <span class="dv">4</span>, <span class="dt">label =</span> <span class="st">&quot;95%</span><span class="ch">\n</span><span class="st">HDI&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb948-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb948-17" data-line-number="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;That `hdi_of_icdf()` function really came through, for us.&quot;</span>,</a>
<a class="sourceLine" id="cb948-18" data-line-number="18">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb948-19" data-line-number="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-9-1.png" /><!-- --></p>
<p>In his second example (p. 337), Kruschke considered <span class="math inline">\(z = 490\)</span> heads out of <span class="math inline">\(N = 1000\)</span> flips.</p>
<div class="sourceCode" id="cb949"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb949-1" data-line-number="1"><span class="co"># we need these to compute the likelihood</span></a>
<a class="sourceLine" id="cb949-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb949-3" data-line-number="3">z &lt;-<span class="st"> </span><span class="dv">490</span></a>
<a class="sourceLine" id="cb949-4" data-line-number="4"></a>
<a class="sourceLine" id="cb949-5" data-line-number="5">trial_data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> n <span class="op">-</span><span class="st"> </span>z), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dt">times =</span> z))</a>
<a class="sourceLine" id="cb949-6" data-line-number="6"></a>
<a class="sourceLine" id="cb949-7" data-line-number="7"><span class="kw">tibble</span>(<span class="dt">theta        =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="fl">1e3</span>)) <span class="op">%&gt;%</span><span class="st">         </span><span class="co"># (i.e., theta)</span></a>
<a class="sourceLine" id="cb949-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior      =</span> <span class="kw">dbeta</span>(theta, <span class="dt">shape1 =</span> <span class="dv">1</span>, <span class="dt">shape2 =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st">            </span><span class="co"># (i.e., p(theta))</span></a>
<a class="sourceLine" id="cb949-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">likelihood =</span> <span class="kw">bernoulli_likelihood</span>(<span class="dt">theta =</span> theta,                  <span class="co"># (i.e., p(D | theta))</span></a>
<a class="sourceLine" id="cb949-10" data-line-number="10">                                           <span class="dt">data  =</span> trial_data)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb949-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">posterior  =</span> (likelihood <span class="op">*</span><span class="st"> </span>prior) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(likelihood <span class="op">*</span><span class="st"> </span>prior)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># (i.e., p(theta | D))</span></a>
<a class="sourceLine" id="cb949-12" data-line-number="12"><span class="st">  </span></a>
<a class="sourceLine" id="cb949-13" data-line-number="13"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb949-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="fl">.45</span>,  <span class="dt">xmax =</span> <span class="fl">.55</span>,</a>
<a class="sourceLine" id="cb949-15" data-line-number="15">            <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>,</a>
<a class="sourceLine" id="cb949-16" data-line-number="16">            <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb949-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> posterior),</a>
<a class="sourceLine" id="cb949-18" data-line-number="18">              <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb949-19" data-line-number="19"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb949-20" data-line-number="20"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;This posterior sits right within the ROPE.&quot;</span>,</a>
<a class="sourceLine" id="cb949-21" data-line-number="21">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb949-22" data-line-number="22"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-10-1.png" /><!-- --></p>
<p>Here are the new HDIs.</p>
<div class="sourceCode" id="cb950"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb950-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">name   =</span> qbeta,</a>
<a class="sourceLine" id="cb950-2" data-line-number="2">            <span class="dt">shape1 =</span>     z <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb950-3" data-line-number="3">            <span class="dt">shape2 =</span> n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 0.4590949 0.5209562</code></pre>
<p>Further down the section, Kruschke offered some perspective on the ROPE approach.</p>
<blockquote>
<p>The ROPE limits, by definition, cannot be uniquely “correct,” but instead are established by practical aims, bearing in mind that wider ROPEs yield more decisions to accept the ROPEd value and fewer decision to reject the ROPEd value. In many situations, the exact limit of the ROPE can be left indeterminate or tacit, so that the audience of the analysis can use whatever ROPE is appropriate at the time, as competing theories and measuring devices evolve. When the HDI is far from the ROPEd value, the exact ROPE is inconsequential because the ROPEd value would be rejected for any reasonable ROPE. When the HDI is very narrow and overlaps the target value, the HDI might again fall within any reasonable ROPE, again rendering the exact ROPE inconsequential. When, however, the HDI is only moderately narrow and near the target value, the analysis can report how much of the posterior falls within a ROPE as a function of different ROPE widths…</p>
<p>It is important to be clear that any discrete decision about rejecting or accepting a null value does <em>not</em> exhaustively capture our knowledge about the parameter value. Our knowledge about the parameter value is described by the full posterior distribution. When making a binary decision, we have merely compressed all that rich detail into a single bit of information. The broader goal of Bayesian analysis is conveying an informative summary of the posterior, and where the value of interest falls within that posterior. Reporting the limits of an HDI region is more informative than reporting the declaration of a reject/accept decision. By reporting the HDI and other summary information about the posterior, different readers can apply different ROPEs to decide for themselves whether a parameter is practically equivalent to a null value. The decision procedure is separate from the Bayesian inference. The Bayesian part of the analysis is deriving the posterior distribution. The decision procedure uses the posterior distribution, but does not itself use Bayes’ rule. (pp. 338–339, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Full disclosure: I’m not a fan of the ROPE method. Though we’re following along with the text and covering it, here, I will deemphasize it in later sections.</p>
<p>Kruschke then went on to compare the ROPE with frequentist equivalence tests. This is a part of the literature I have not waded into, yet. It appears psychologist Daniël Lakens and colleagues gave written a bit in the topic, recently. Interested readers might start <a href="https://journals.sagepub.com/doi/full/10.1177/2515245918770963">here</a>, <a href="https://academic.oup.com/psychsocgerontology/advance-article/doi/10.1093/geronb/gby065/5033832">here</a>, or <a href="https://psyarxiv.com/7k6ay/">here</a>.</p>
</div>
<div id="some-examples." class="section level3">
<h3><span class="header-section-number">12.1.2</span> Some examples.</h3>
<p>Kruschke referenced an analysis from way back in Chapter 9. We’ll need to re-fit the model. First we import data.</p>
<div class="sourceCode" id="cb952"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb952-1" data-line-number="1">my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/BattingAverage.csv&quot;</span>)</a>
<a class="sourceLine" id="cb952-2" data-line-number="2"></a>
<a class="sourceLine" id="cb952-3" data-line-number="3"><span class="kw">glimpse</span>(my_data)</a></code></pre></div>
<pre><code>## Observations: 948
## Variables: 6
## $ Player       &lt;chr&gt; &quot;Fernando Abad&quot;, &quot;Bobby Abreu&quot;, &quot;Tony Abreu&quot;, &quot;Dustin Ackley&quot;, &quot;Matt Adams&quot;,…
## $ PriPos       &lt;chr&gt; &quot;Pitcher&quot;, &quot;Left Field&quot;, &quot;2nd Base&quot;, &quot;2nd Base&quot;, &quot;1st Base&quot;, &quot;Pitcher&quot;, &quot;Pit…
## $ Hits         &lt;dbl&gt; 1, 53, 18, 137, 21, 0, 0, 2, 150, 167, 0, 128, 66, 3, 1, 81, 180, 36, 150, 0…
## $ AtBats       &lt;dbl&gt; 7, 219, 70, 607, 86, 1, 1, 20, 549, 576, 1, 525, 275, 12, 8, 384, 629, 158, …
## $ PlayerNumber &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 2…
## $ PriPosNumber &lt;dbl&gt; 1, 7, 4, 4, 3, 1, 1, 3, 3, 4, 1, 5, 4, 2, 7, 4, 6, 8, 9, 1, 2, 5, 1, 1, 7, 2…</code></pre>
<p>Let’s load <strong>brms</strong> and, while we’re at it, <strong>tidybayes</strong>.</p>
<div class="sourceCode" id="cb954"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb954-1" data-line-number="1"><span class="kw">library</span>(brms)</a>
<a class="sourceLine" id="cb954-2" data-line-number="2"><span class="kw">library</span>(tidybayes)</a></code></pre></div>
<p>Fit the model.</p>
<div class="sourceCode" id="cb955"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb955-1" data-line-number="1">fit1 &lt;-</a>
<a class="sourceLine" id="cb955-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb955-3" data-line-number="3">      <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> logit),</a>
<a class="sourceLine" id="cb955-4" data-line-number="4">      Hits <span class="op">|</span><span class="st"> </span><span class="kw">trials</span>(AtBats) <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>PriPos) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>PriPos<span class="op">:</span>Player),</a>
<a class="sourceLine" id="cb955-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb955-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sd)),</a>
<a class="sourceLine" id="cb955-7" data-line-number="7">      <span class="dt">iter =</span> <span class="dv">3500</span>, <span class="dt">warmup =</span> <span class="dv">500</span>, <span class="dt">chains =</span> <span class="dv">3</span>, <span class="dt">cores =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb955-8" data-line-number="8">      <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">.9</span>),</a>
<a class="sourceLine" id="cb955-9" data-line-number="9">      <span class="dt">seed =</span> <span class="dv">12</span>)</a></code></pre></div>
<p>Let’s use <code>coef()</code> to pull the relevant posterior draws.</p>
<div class="sourceCode" id="cb956"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb956-1" data-line-number="1">c &lt;-</a>
<a class="sourceLine" id="cb956-2" data-line-number="2"><span class="st">  </span><span class="kw">coef</span>(fit1, <span class="dt">summary =</span> F)<span class="op">$</span>PriPos <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb956-3" data-line-number="3"><span class="st">  </span><span class="kw">as_tibble</span>()</a>
<a class="sourceLine" id="cb956-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb956-5" data-line-number="5"><span class="kw">str</span>(c)</a></code></pre></div>
<pre><code>## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    9000 obs. of  9 variables:
##  $ 1st Base.Intercept    : num  -1.12 -1.03 -1.01 -1.04 -1.09 ...
##  $ 2nd Base.Intercept    : num  -1.059 -1.072 -1.067 -0.997 -1.169 ...
##  $ 3rd Base.Intercept    : num  -1.01 -1.05 -1.04 -1.06 -1.07 ...
##  $ Catcher.Intercept     : num  -1.17 -1.09 -1.14 -1.14 -1.15 ...
##  $ Center Field.Intercept: num  -1.05 -1.07 -1.06 -1.06 -1.03 ...
##  $ Left Field.Intercept  : num  -1.08 -1.11 -1.06 -1.06 -1.12 ...
##  $ Pitcher.Intercept     : num  -1.86 -1.87 -1.97 -1.94 -1.88 ...
##  $ Right Field.Intercept : num  -1.03 -1.05 -1.08 -1.09 -1.01 ...
##  $ Shortstop.Intercept   : num  -1.16 -1.1 -1.14 -1.1 -1.12 ...</code></pre>
<p>As we pointed out in Chapter 9, keep in mind that <code>coef()</code> returns the values in the logit scale when used for logistic regression models. So we’ll have to use <code>brms::inv_logit_scaled()</code> to convert the estimates to the probability metric. We can make the difference distributions after we’ve converted the estimates.</p>
<div class="sourceCode" id="cb958"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb958-1" data-line-number="1">c_small &lt;-</a>
<a class="sourceLine" id="cb958-2" data-line-number="2"><span class="st">  </span>c <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb958-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate_all</span>(inv_logit_scaled) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb958-4" data-line-number="4"><span class="st">  </span><span class="kw">transmute</span>(<span class="st">`</span><span class="dt">Pitcher - Catcher</span><span class="st">`</span>  =<span class="st"> </span>Pitcher.Intercept <span class="op">-</span><span class="st"> </span>Catcher.Intercept,</a>
<a class="sourceLine" id="cb958-5" data-line-number="5">            <span class="st">`</span><span class="dt">Catcher - 1st Base</span><span class="st">`</span> =<span class="st"> </span>Catcher.Intercept <span class="op">-</span><span class="st"> `</span><span class="dt">1st Base.Intercept</span><span class="st">`</span>)</a>
<a class="sourceLine" id="cb958-6" data-line-number="6"></a>
<a class="sourceLine" id="cb958-7" data-line-number="7"><span class="kw">head</span>(c_small)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   `Pitcher - Catcher` `Catcher - 1st Base`
##                 &lt;dbl&gt;                &lt;dbl&gt;
## 1              -0.102             -0.00921
## 2              -0.117             -0.0131 
## 3              -0.120             -0.0256 
## 4              -0.116             -0.0201 
## 5              -0.109             -0.0110 
## 6              -0.106             -0.0161</code></pre>
<p>After a little wrangling, we’ll be ready to re-plot the relevant parts of Figure 9.14.</p>
<div class="sourceCode" id="cb960"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb960-1" data-line-number="1">c_small <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb960-2" data-line-number="2"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb960-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Pitcher - Catcher&quot;</span>, <span class="st">&quot;Catcher - 1st Base&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb960-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb960-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb960-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="fl">-0.05</span>, <span class="dt">xmax =</span> <span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb960-7" data-line-number="7">            <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>,  <span class="dt">ymax =</span> <span class="ot">Inf</span>,</a>
<a class="sourceLine" id="cb960-8" data-line-number="8">            <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb960-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, </a>
<a class="sourceLine" id="cb960-10" data-line-number="10">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">binwidth =</span> <span class="fl">.003</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb960-11" data-line-number="11"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb960-12" data-line-number="12">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb960-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb960-14" data-line-number="14"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;The ROPE ranges from −0.05 to +0.05&quot;</span>,</a>
<a class="sourceLine" id="cb960-15" data-line-number="15">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb960-16" data-line-number="16"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="kw">c</span>(<span class="op">-</span>.<span class="dv">125</span>, <span class="fl">.125</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb960-17" data-line-number="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb960-18" data-line-number="18">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb960-19" data-line-number="19"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-18-1.png" /><!-- --></p>
<p>In order to re-plot part of Figure 9.15, we’ll need to employ <code>fitted()</code> to snatch the player-specific posteriors.</p>
<div class="sourceCode" id="cb961"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb961-1" data-line-number="1"><span class="co"># this will make life easier. just go with it</span></a>
<a class="sourceLine" id="cb961-2" data-line-number="2">name_list &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ShinSoo Choo&quot;</span>, <span class="st">&quot;Ichiro Suzuki&quot;</span>)</a>
<a class="sourceLine" id="cb961-3" data-line-number="3"></a>
<a class="sourceLine" id="cb961-4" data-line-number="4"><span class="co"># we&#39;ll define the data we&#39;d like to feed into `fitted()`, here</span></a>
<a class="sourceLine" id="cb961-5" data-line-number="5">nd &lt;-</a>
<a class="sourceLine" id="cb961-6" data-line-number="6"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb961-7" data-line-number="7"><span class="st">  </span><span class="kw">filter</span>(Player <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(name_list)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb961-8" data-line-number="8"><span class="st">  </span><span class="co"># these last two lines aren&#39;t typically necessary, but they allow us to </span></a>
<a class="sourceLine" id="cb961-9" data-line-number="9"><span class="st">  </span><span class="co"># arrange the rows in the same order we find the names in Figures 9.15 and 9/16</span></a>
<a class="sourceLine" id="cb961-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Player =</span> <span class="kw">factor</span>(Player, <span class="dt">levels =</span> <span class="kw">c</span>(name_list))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb961-11" data-line-number="11"><span class="st">  </span><span class="kw">arrange</span>(Player)</a>
<a class="sourceLine" id="cb961-12" data-line-number="12"></a>
<a class="sourceLine" id="cb961-13" data-line-number="13">f &lt;-</a>
<a class="sourceLine" id="cb961-14" data-line-number="14"><span class="st">  </span><span class="kw">fitted</span>(fit1, </a>
<a class="sourceLine" id="cb961-15" data-line-number="15">         <span class="dt">newdata =</span> nd,</a>
<a class="sourceLine" id="cb961-16" data-line-number="16">         <span class="dt">scale =</span> <span class="st">&quot;linear&quot;</span>,</a>
<a class="sourceLine" id="cb961-17" data-line-number="17">         <span class="dt">summary =</span> F) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb961-18" data-line-number="18"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb961-19" data-line-number="19"><span class="st">  </span><span class="kw">mutate_all</span>(inv_logit_scaled) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb961-20" data-line-number="20"><span class="st">  </span><span class="kw">set_names</span>(name_list) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb961-21" data-line-number="21"><span class="st">  </span><span class="co"># in this last section, we make our difference distributions </span></a>
<a class="sourceLine" id="cb961-22" data-line-number="22"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">ShinSoo Choo - Ichiro Suzuki</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">ShinSoo Choo</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">Ichiro Suzuki</span><span class="st">`</span>)</a>
<a class="sourceLine" id="cb961-23" data-line-number="23">    </a>
<a class="sourceLine" id="cb961-24" data-line-number="24"><span class="kw">glimpse</span>(f)</a></code></pre></div>
<pre><code>## Observations: 9,000
## Variables: 3
## $ `ShinSoo Choo`                 &lt;dbl&gt; 0.2836534, 0.3041822, 0.2661348, 0.2970897, 0.2443223, 0.2…
## $ `Ichiro Suzuki`                &lt;dbl&gt; 0.2631869, 0.2891847, 0.2999139, 0.2617316, 0.2958017, 0.2…
## $ `ShinSoo Choo - Ichiro Suzuki` &lt;dbl&gt; 0.020466515, 0.014997563, -0.033779074, 0.035358090, -0.05…</code></pre>
<p>Now we’re ready to go.</p>
<div class="sourceCode" id="cb963"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb963-1" data-line-number="1">f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb963-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb963-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="fl">-0.05</span>, <span class="dt">xmax =</span> <span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb963-4" data-line-number="4">            <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>,  <span class="dt">ymax =</span> <span class="ot">Inf</span>,</a>
<a class="sourceLine" id="cb963-5" data-line-number="5">            <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb963-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">ShinSoo Choo - Ichiro Suzuki</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb963-7" data-line-number="7">                 <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, </a>
<a class="sourceLine" id="cb963-8" data-line-number="8">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">binwidth =</span> <span class="fl">.003</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb963-9" data-line-number="9"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">ShinSoo Choo - Ichiro Suzuki</span><span class="st">`</span>, <span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb963-10" data-line-number="10">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb963-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb963-12" data-line-number="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;ShinSoo Choo - Ichiro Suzuki&quot;</span>,</a>
<a class="sourceLine" id="cb963-13" data-line-number="13">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb963-14" data-line-number="14"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="kw">c</span>(<span class="op">-</span>.<span class="dv">125</span>, <span class="fl">.125</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb963-15" data-line-number="15"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-20-1.png" /><!-- --></p>
</div>
<div id="differences-of-correlated-parameters." class="section level3">
<h3><span class="header-section-number">12.1.3</span> Differences of correlated parameters.</h3>
<p>Krushke didn’t explicate where he got the data for Figure 12.1. If we’re willing to presume a multivariate normal distribution, we can get close using the <code>MASS::mvrnorm()</code> function. You can get the basic steps from <a href="https://stats.stackexchange.com/questions/164471/generating-a-simulated-dataset-from-a-correlation-matrix-with-means-and-standard">Sven Hohenstein’s answer to this stats.stacheschange question</a>.</p>
<div class="sourceCode" id="cb964"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb964-1" data-line-number="1"><span class="co"># first we&#39;ll make a correlation matrix</span></a>
<a class="sourceLine" id="cb964-2" data-line-number="2"><span class="co"># a correlation of .9 seems about right</span></a>
<a class="sourceLine" id="cb964-3" data-line-number="3">correlation_matrix &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb964-4" data-line-number="4"><span class="st">  </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">.9</span>, </a>
<a class="sourceLine" id="cb964-5" data-line-number="5">           <span class="fl">.9</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb964-6" data-line-number="6">         <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb964-7" data-line-number="7"></a>
<a class="sourceLine" id="cb964-8" data-line-number="8"><span class="co"># next we&#39;ll specify the means and standard deviations</span></a>
<a class="sourceLine" id="cb964-9" data-line-number="9">mu &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">58</span>, <span class="fl">.42</span>)</a>
<a class="sourceLine" id="cb964-10" data-line-number="10">sd &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">1</span>, <span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb964-11" data-line-number="11"></a>
<a class="sourceLine" id="cb964-12" data-line-number="12"><span class="co"># now we&#39;ll use the correlation matrix and standard deviations to make a covariance matrix</span></a>
<a class="sourceLine" id="cb964-13" data-line-number="13">covariance_matrix &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb964-14" data-line-number="14"><span class="st">  </span>sd <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(sd) <span class="op">*</span><span class="st"> </span>correlation_matrix</a>
<a class="sourceLine" id="cb964-15" data-line-number="15"></a>
<a class="sourceLine" id="cb964-16" data-line-number="16"><span class="co"># after setting our seed, we&#39;re ready to simulate</span></a>
<a class="sourceLine" id="cb964-17" data-line-number="17"><span class="kw">set.seed</span>(<span class="dv">12</span>)</a>
<a class="sourceLine" id="cb964-18" data-line-number="18">d &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb964-19" data-line-number="19"><span class="st">  </span>MASS<span class="op">::</span><span class="kw">mvrnorm</span>(<span class="dt">n  =</span> <span class="dv">1000</span>, </a>
<a class="sourceLine" id="cb964-20" data-line-number="20">                <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb964-21" data-line-number="21">                <span class="dt">Sigma =</span> covariance_matrix) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb964-22" data-line-number="22"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb964-23" data-line-number="23"><span class="st">  </span><span class="kw">set_names</span>(<span class="kw">str_c</span>(<span class="st">&quot;theta[&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="st">&quot;]&quot;</span>))</a></code></pre></div>
<p>Now it only takes some light wrangling to prepare the data to make the three histograms in the left panel of Figure 12.1.</p>
<div class="sourceCode" id="cb965"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb965-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb965-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">theta[1]-theta[2]</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">theta[1]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">theta[2]</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb965-3" data-line-number="3"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb965-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb965-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb965-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, </a>
<a class="sourceLine" id="cb965-7" data-line-number="7">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">30</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb965-8" data-line-number="8"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb965-9" data-line-number="9">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb965-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb965-11" data-line-number="11"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb965-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb965-13" data-line-number="13"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="dt">labeller =</span> label_parsed)</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-22-1.png" /><!-- --></p>
<p>Here’s the scatter plot, showing the correlation. I think we got pretty close!</p>
<div class="sourceCode" id="cb966"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb966-1" data-line-number="1">d <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb966-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">theta[1]</span><span class="st">`</span>, <span class="dt">y =</span> <span class="st">`</span><span class="dt">theta[2]</span><span class="st">`</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb966-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb966-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb966-5" data-line-number="5">             <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>,</a>
<a class="sourceLine" id="cb966-6" data-line-number="6">             <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb966-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_equal</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb966-8" data-line-number="8">              <span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb966-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(theta[<span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb966-10" data-line-number="10">       <span class="dt">y =</span> <span class="kw">expression</span>(theta[<span class="dv">2</span>])) <span class="op">+</span></a>
<a class="sourceLine" id="cb966-11" data-line-number="11"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-23-1.png" /><!-- --></p>
<p>To make the plots in the right panel of Figure 12.1, we just need to convert the correlation from .9 to -.9.</p>
<div class="sourceCode" id="cb967"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb967-1" data-line-number="1"><span class="co"># this time we&#39;ll make the correlations -.9</span></a>
<a class="sourceLine" id="cb967-2" data-line-number="2">correlation_matrix &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb967-3" data-line-number="3"><span class="st">  </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">-.9</span>, </a>
<a class="sourceLine" id="cb967-4" data-line-number="4">           <span class="fl">-.9</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb967-5" data-line-number="5">         <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb967-6" data-line-number="6"></a>
<a class="sourceLine" id="cb967-7" data-line-number="7"><span class="co"># we&#39;ll have to redo the covariance matrix</span></a>
<a class="sourceLine" id="cb967-8" data-line-number="8">covariance_matrix &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb967-9" data-line-number="9"><span class="st">  </span>sd <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(sd) <span class="op">*</span><span class="st"> </span>correlation_matrix</a>
<a class="sourceLine" id="cb967-10" data-line-number="10"></a>
<a class="sourceLine" id="cb967-11" data-line-number="11"><span class="co"># here&#39;s the updated data</span></a>
<a class="sourceLine" id="cb967-12" data-line-number="12"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb967-13" data-line-number="13">d &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">mvrnorm</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">mu =</span> mu, <span class="dt">Sigma =</span> covariance_matrix) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb967-14" data-line-number="14"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb967-15" data-line-number="15"><span class="st">  </span><span class="kw">set_names</span>(<span class="kw">str_c</span>(<span class="st">&quot;theta[&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="st">&quot;]&quot;</span>))</a></code></pre></div>
<p>Here are our right-panel Figure 12.1 histograms.</p>
<div class="sourceCode" id="cb968"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb968-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb968-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">theta[1]-theta[2]</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">theta[1]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">theta[2]</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb968-3" data-line-number="3"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb968-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb968-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb968-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, </a>
<a class="sourceLine" id="cb968-7" data-line-number="7">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">30</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb968-8" data-line-number="8"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb968-9" data-line-number="9">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb968-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb968-11" data-line-number="11"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb968-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb968-13" data-line-number="13"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>,  <span class="dt">labeller =</span> label_parsed)</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-25-1.png" /><!-- --></p>
<p>Behold the second scatter plot.</p>
<div class="sourceCode" id="cb969"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb969-1" data-line-number="1">d <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb969-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">theta[1]</span><span class="st">`</span>, <span class="dt">y =</span> <span class="st">`</span><span class="dt">theta[2]</span><span class="st">`</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb969-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb969-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb969-5" data-line-number="5">             <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>,</a>
<a class="sourceLine" id="cb969-6" data-line-number="6">             <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb969-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_equal</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb969-8" data-line-number="8">              <span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb969-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(theta[<span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb969-10" data-line-number="10">       <span class="dt">y =</span> <span class="kw">expression</span>(theta[<span class="dv">2</span>])) <span class="op">+</span></a>
<a class="sourceLine" id="cb969-11" data-line-number="11"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-26-1.png" /><!-- --></p>
<blockquote>
<p>In summary, the marginal distributions of two parameters do not indicate the relationship between the parameter values. The joint distribution of the two parameters might have positive or negative correlation (or even a non-linear dependency), and therefore the difference of the parameter values should be explicitly examined. (pp. 341–342)</p>
</blockquote>
</div>
<div id="why-hdi-and-not-equal-tailed-interval" class="section level3">
<h3><span class="header-section-number">12.1.4</span> Why HDI and not equal-tailed interval?</h3>
<p>Though Kruschke told us Figure 12.2 was of a gamma distribution, he didn’t tell us the parameters for that particular gamma. After playing around for a bit, it appeared <code>dgamma(x, 2, .2)</code> worked pretty well.</p>
<div class="sourceCode" id="cb970"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb970-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">40</span>, <span class="dt">by =</span> <span class="fl">.1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb970-2" data-line-number="2"><span class="st">  </span></a>
<a class="sourceLine" id="cb970-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb970-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb970-5" data-line-number="5">                  <span class="dt">ymax =</span> <span class="kw">dgamma</span>(x, <span class="dv">2</span>, <span class="fl">.2</span>)),</a>
<a class="sourceLine" id="cb970-6" data-line-number="6">              <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb970-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">35</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb970-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-27-1.png" /><!-- --></p>
<p>If you want to get the quantile-based intervals (i.e., the ETIs), you can plug in the desired quantiles into the <code>qgamma()</code> function.</p>
<div class="sourceCode" id="cb971"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb971-1" data-line-number="1">(ex &lt;-<span class="st"> </span><span class="kw">qgamma</span>(<span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>), <span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">rate =</span> <span class="fl">.2</span>))</a></code></pre></div>
<pre><code>## [1]  1.211046 27.858217</code></pre>
<p>To analytically derive the gamma HDIs, we just use the good old <code>hdi_of_icdf()</code> function.</p>
<div class="sourceCode" id="cb973"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb973-1" data-line-number="1">(hx &lt;-</a>
<a class="sourceLine" id="cb973-2" data-line-number="2"><span class="st">  </span><span class="kw">hdi_of_icdf</span>(<span class="dt">name  =</span> qgamma,</a>
<a class="sourceLine" id="cb973-3" data-line-number="3">              <span class="dt">shape =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb973-4" data-line-number="4">              <span class="dt">rate  =</span> <span class="fl">.2</span>)</a>
<a class="sourceLine" id="cb973-5" data-line-number="5">)</a></code></pre></div>
<pre><code>## [1]  0.2118165 23.8258411</code></pre>
<p>Next you need to determine how high up to go on the y-axis. For the quantile-based intervals, the ETIs, you can use <code>dgamma()</code>. The trick is pump the output of <code>qgamma()</code> into <code>dgamma()</code>.</p>
<div class="sourceCode" id="cb975"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb975-1" data-line-number="1">(</a>
<a class="sourceLine" id="cb975-2" data-line-number="2">  ey &lt;-</a>
<a class="sourceLine" id="cb975-3" data-line-number="3"><span class="st">  </span><span class="kw">qgamma</span>(<span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>), <span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">rate =</span> <span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb975-4" data-line-number="4"><span class="st">  </span><span class="kw">dgamma</span>(<span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">rate =</span> <span class="fl">.2</span>)</a>
<a class="sourceLine" id="cb975-5" data-line-number="5">)</a></code></pre></div>
<pre><code>## [1] 0.038021620 0.004239155</code></pre>
<p>We follow the same basic principle to get the y-axis values for the HDIs.</p>
<div class="sourceCode" id="cb977"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb977-1" data-line-number="1">(</a>
<a class="sourceLine" id="cb977-2" data-line-number="2">  hy &lt;-</a>
<a class="sourceLine" id="cb977-3" data-line-number="3"><span class="st">  </span><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qgamma, <span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">rate =</span> <span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb977-4" data-line-number="4"><span class="st">  </span><span class="kw">dgamma</span>(<span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">rate =</span> <span class="fl">.2</span>)</a>
<a class="sourceLine" id="cb977-5" data-line-number="5">)</a></code></pre></div>
<pre><code>## [1] 0.008121227 0.008121233</code></pre>
<p>Now we’ve computed all those values, we can collect them into a tibble with the necessary coordinates to make the ETI and HDI lines in our plot.</p>
<div class="sourceCode" id="cb979"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb979-1" data-line-number="1">(</a>
<a class="sourceLine" id="cb979-2" data-line-number="2">  lines &lt;-</a>
<a class="sourceLine" id="cb979-3" data-line-number="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">interval =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;eti&quot;</span>, <span class="st">&quot;hdi&quot;</span>), <span class="dt">each =</span> <span class="dv">4</span>),</a>
<a class="sourceLine" id="cb979-4" data-line-number="4">         <span class="dt">x        =</span> <span class="kw">c</span>(ex, hx) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">each =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb979-5" data-line-number="5">         <span class="dt">y        =</span> <span class="kw">c</span>(ey[<span class="dv">1</span>], <span class="dv">0</span>, <span class="dv">0</span>, ey[<span class="dv">2</span>], <span class="dv">0</span>, hy, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb979-6" data-line-number="6">)</a></code></pre></div>
<pre><code>## # A tibble: 8 x 3
##   interval      x       y
##   &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 eti       1.21  0.0380 
## 2 eti       1.21  0      
## 3 eti      27.9   0      
## 4 eti      27.9   0.00424
## 5 hdi       0.212 0      
## 6 hdi       0.212 0.00812
## 7 hdi      23.8   0.00812
## 8 hdi      23.8   0</code></pre>
<p>We’re finally ready to plot a more complete version of Figure 12.2.</p>
<div class="sourceCode" id="cb981"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb981-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">40</span>, <span class="dt">by =</span> <span class="fl">.1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb981-2" data-line-number="2"><span class="st">  </span></a>
<a class="sourceLine" id="cb981-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb981-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> <span class="kw">dgamma</span>(x, <span class="dv">2</span>, <span class="fl">.2</span>)),</a>
<a class="sourceLine" id="cb981-5" data-line-number="5">              <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb981-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> lines,</a>
<a class="sourceLine" id="cb981-7" data-line-number="7">            <span class="kw">aes</span>(<span class="dt">y =</span> y, <span class="dt">color =</span> interval),</a>
<a class="sourceLine" id="cb981-8" data-line-number="8">            <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb981-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb981-10" data-line-number="10">    <span class="dt">x        =</span> <span class="kw">c</span>(<span class="dv">15</span>, <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb981-11" data-line-number="11">    <span class="dt">y        =</span> <span class="kw">c</span>(.<span class="dv">004</span>, <span class="fl">.012</span>),</a>
<a class="sourceLine" id="cb981-12" data-line-number="12">    <span class="dt">label    =</span> <span class="kw">c</span>(<span class="st">&quot;95% ETI&quot;</span>, <span class="st">&quot;95% HDI&quot;</span>),</a>
<a class="sourceLine" id="cb981-13" data-line-number="13">    <span class="dt">interval =</span> <span class="kw">c</span>(<span class="st">&quot;eti&quot;</span>, <span class="st">&quot;hdi&quot;</span>)</a>
<a class="sourceLine" id="cb981-14" data-line-number="14">    ),</a>
<a class="sourceLine" id="cb981-15" data-line-number="15">    <span class="kw">aes</span>(<span class="dt">y =</span> y, <span class="dt">color =</span> interval, <span class="dt">label =</span> label)) <span class="op">+</span></a>
<a class="sourceLine" id="cb981-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb981-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb981-18" data-line-number="18"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">35</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb981-19" data-line-number="19"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Density Value&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb981-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb981-21" data-line-number="21">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-33-1.png" /><!-- --></p>
<p>To repeat, ETIs are the only types of intervals available directly by the <strong>brms</strong> package. When using the default <code>print()</code> or <code>summary()</code> output for a <code>brm()</code> model, the 95% ETIs are displayed in the ‘l-95% CI’ and ‘u-95% CI’ columns.</p>
<div class="sourceCode" id="cb982"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb982-1" data-line-number="1"><span class="kw">print</span>(fit1)</a></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: Hits | trials(AtBats) ~ 1 + (1 | PriPos) + (1 | PriPos:Player) 
##    Data: my_data (Number of observations: 948) 
## Samples: 3 chains, each with iter = 3500; warmup = 500; thin = 1;
##          total post-warmup samples = 9000
## 
## Group-Level Effects: 
## ~PriPos (Number of levels: 9) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)     0.32      0.10     0.19     0.59 1.00     2660     4283
## 
## ~PriPos:Player (Number of levels: 948) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)     0.14      0.01     0.12     0.15 1.00     3695     5911
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -1.17      0.11    -1.40    -0.94 1.00     1507     2262
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>In the output of most other <strong>brms</strong> functions, the 95% ETIs appear in the <code>Q2.5</code> and <code>Q97.5</code> columns. Take <code>fitted()</code>, for example.</p>
<div class="sourceCode" id="cb984"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb984-1" data-line-number="1"><span class="kw">fitted</span>(fit1, </a>
<a class="sourceLine" id="cb984-2" data-line-number="2">       <span class="dt">newdata =</span> nd,</a>
<a class="sourceLine" id="cb984-3" data-line-number="3">       <span class="dt">scale =</span> <span class="st">&quot;linear&quot;</span>)</a></code></pre></div>
<pre><code>##        Estimate  Est.Error      Q2.5      Q97.5
## [1,] -0.9712888 0.07647876 -1.123799 -0.8193551
## [2,] -0.9676824 0.07618627 -1.118517 -0.8174031</code></pre>
<p>But as we just did, above, you can always use the convenience functions from the <strong>tidybayes</strong> package (e.g., <code>mean_hdi()</code>) to get HDIs from a <strong>brms</strong> fit.</p>
<div class="sourceCode" id="cb986"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb986-1" data-line-number="1"><span class="kw">fitted</span>(fit1, </a>
<a class="sourceLine" id="cb986-2" data-line-number="2">       <span class="dt">newdata =</span> nd,</a>
<a class="sourceLine" id="cb986-3" data-line-number="3">       <span class="dt">scale =</span> <span class="st">&quot;linear&quot;</span>,</a>
<a class="sourceLine" id="cb986-4" data-line-number="4">       <span class="dt">summary =</span> F) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb986-5" data-line-number="5"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb986-6" data-line-number="6"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb986-7" data-line-number="7"><span class="st">  </span><span class="kw">group_by</span>(key) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb986-8" data-line-number="8"><span class="st">  </span><span class="kw">mean_hdi</span>(value)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 7
##   key    value .lower .upper .width .point .interval
##   &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 V1    -0.971  -1.13 -0.830   0.95 mean   hdi      
## 2 V2    -0.968  -1.11 -0.813   0.95 mean   hdi</code></pre>
<p>As you may have gathered, Kruschke clearly prefers using HDIs over ETIs. His preference isn’t without controversy. If you’d like to explore the topic further in the form of saucy twitter banter, the inimitable <a href="https://twitter.com/dan_p_simpson">Dan Simpson</a> has just <a href="https://twitter.com/dan_p_simpson/status/1134095728190676992">the thread</a> for you. Here’s <a href="https://discourse.mc-stan.org/t/quantiles-vs-hpdi-from-rstan-summary/9025">the link</a> to the corresponding thread in the Stan discourse forum.</p>
</div>
</div>
<div id="the-model-comparison-approach" class="section level2">
<h2><span class="header-section-number">12.2</span> The model-comparison approach</h2>
<blockquote>
<p>Recall that the motivating issue for this chapter is the question, Is the null value of a parameter credible? The previous section answered the question in terms of parameter estimation. In that approach, we started with a possibly informed prior distribution and examined the posterior distribution.</p>
<p>In this section we take a different approach. Some researchers prefer instead to pose the question in terms of model comparison. In this framing of the question, the focus is not on estimating the magnitude of the parameter. Instead, the focus is on deciding which of two hypothetical prior distributions is least incredible. One prior expresses the hypothesis that the parameter value is exactly the null value. The alternative prior expresses the hypothesis that the parameter could be any value, according to some form of broad distribution. (p. 344)</p>
</blockquote>
<div id="is-a-coin-fair-or-not" class="section level3">
<h3><span class="header-section-number">12.2.1</span> Is a coin fair or not?</h3>
<p>Some (e.g., <a href="http://www.socsci.uci.edu/~mdlee/lee_webb_indivdiffs.pdf">Lee &amp; Webb, 2005</a>; <a href="http://jse.amstat.org/v12n2/zhu.pdf">Zhu &amp; Lu, 2004</a>) have argued the Haldane prior is superior to the uniform <span class="math inline">\(\operatorname{Beta} (1, 1)\)</span> when choosing an uninformative prior for <span class="math inline">\(\theta\)</span>. The Haldane, recall, is <span class="math inline">\(\operatorname{Beta} (\epsilon, \epsilon)\)</span>, where <span class="math inline">\(\epsilon\)</span> is some small value approaching zero (e.g., 0.01). We’ll use our typical steps with the grid aproximation to compute the data for the left column of Figure 12.3 (i.e., the column based on the Haldane prior).</p>
<div class="sourceCode" id="cb988"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb988-1" data-line-number="1"><span class="co"># we need these to compute the likelihood</span></a>
<a class="sourceLine" id="cb988-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">24</span></a>
<a class="sourceLine" id="cb988-3" data-line-number="3">z &lt;-<span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb988-4" data-line-number="4">epsilon &lt;-<span class="st"> </span><span class="fl">.01</span></a>
<a class="sourceLine" id="cb988-5" data-line-number="5"></a>
<a class="sourceLine" id="cb988-6" data-line-number="6">trial_data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> n <span class="op">-</span><span class="st"> </span>z), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dt">times =</span> z))</a>
<a class="sourceLine" id="cb988-7" data-line-number="7"></a>
<a class="sourceLine" id="cb988-8" data-line-number="8">d &lt;-</a>
<a class="sourceLine" id="cb988-9" data-line-number="9"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta      =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">1000</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb988-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior      =</span> <span class="kw">dbeta</span>(<span class="dt">x =</span> theta, <span class="dt">shape1 =</span> epsilon, <span class="dt">shape2 =</span> epsilon)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb988-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">likelihood =</span> <span class="kw">bernoulli_likelihood</span>(<span class="dt">theta =</span> theta,</a>
<a class="sourceLine" id="cb988-12" data-line-number="12">                                           <span class="dt">data =</span> trial_data)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb988-13" data-line-number="13"><span class="st">  </span><span class="co"># we have to slice off the first and last values because they go to infinity on the prior, </span></a>
<a class="sourceLine" id="cb988-14" data-line-number="14"><span class="st">  </span><span class="co"># which creats problems when computing the denominator `sum(likelihood * prior)` (i.e., p(D))</span></a>
<a class="sourceLine" id="cb988-15" data-line-number="15"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">999</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb988-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">posterior  =</span> likelihood <span class="op">*</span><span class="st"> </span>prior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(likelihood <span class="op">*</span><span class="st"> </span>prior))</a>
<a class="sourceLine" id="cb988-17" data-line-number="17"></a>
<a class="sourceLine" id="cb988-18" data-line-number="18"><span class="kw">head</span>(d)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##     theta prior likelihood posterior
##     &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
## 1 0.00100 4.67    9.90e-22  1.61e-15
## 2 0.00200 2.35    1.25e-19  1.02e-13
## 3 0.00300 1.58    2.09e-18  1.15e-12
## 4 0.00400 1.19    1.54e-17  6.39e-12
## 5 0.00501 0.952   7.22e-17  2.40e-11
## 6 0.00601 0.796   2.54e-16  7.07e-11</code></pre>
<p>Here’s the left column of Figure 12.3.</p>
<div class="sourceCode" id="cb990"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb990-1" data-line-number="1">p1 &lt;-</a>
<a class="sourceLine" id="cb990-2" data-line-number="2"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb990-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb990-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> prior),</a>
<a class="sourceLine" id="cb990-5" data-line-number="5">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb990-6" data-line-number="6"><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.1</span>, <span class="dt">y =</span> <span class="dv">4</span>, <span class="dt">size =</span> <span class="fl">3.5</span>, <span class="dt">label =</span> <span class="kw">expression</span>(epsilon <span class="op">==</span><span class="st"> </span><span class="fl">0.01</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb990-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb990-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Prior (beta)&quot;</span>,</a>
<a class="sourceLine" id="cb990-9" data-line-number="9">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb990-10" data-line-number="10">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Beta(&quot;</span>, theta, <span class="st">&quot;|&quot;</span>, epsilon, <span class="st">&quot;, &quot;</span>, epsilon, <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb990-11" data-line-number="11"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb990-12" data-line-number="12"></a>
<a class="sourceLine" id="cb990-13" data-line-number="13">p2 &lt;-</a>
<a class="sourceLine" id="cb990-14" data-line-number="14"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb990-15" data-line-number="15"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb990-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> likelihood),</a>
<a class="sourceLine" id="cb990-17" data-line-number="17">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb990-18" data-line-number="18"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb990-19" data-line-number="19"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Likelihood (Bernoulli)&quot;</span>,</a>
<a class="sourceLine" id="cb990-20" data-line-number="20">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb990-21" data-line-number="21">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;p(D|&quot;</span>, theta, <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb990-22" data-line-number="22"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid  =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb990-23" data-line-number="23">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>())</a>
<a class="sourceLine" id="cb990-24" data-line-number="24"></a>
<a class="sourceLine" id="cb990-25" data-line-number="25">p3 &lt;-</a>
<a class="sourceLine" id="cb990-26" data-line-number="26"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb990-27" data-line-number="27"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb990-28" data-line-number="28"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> posterior),</a>
<a class="sourceLine" id="cb990-29" data-line-number="29">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb990-30" data-line-number="30"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb990-31" data-line-number="31"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Posterior (beta)&quot;</span>,</a>
<a class="sourceLine" id="cb990-32" data-line-number="32">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb990-33" data-line-number="33">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Beta(&quot;</span>, theta, <span class="st">&quot;|7.01, 17.01)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb990-34" data-line-number="34"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb990-35" data-line-number="35"></a>
<a class="sourceLine" id="cb990-36" data-line-number="36"><span class="kw">library</span>(gridExtra)</a>
<a class="sourceLine" id="cb990-37" data-line-number="37"></a>
<a class="sourceLine" id="cb990-38" data-line-number="38"><span class="kw">grid.arrange</span>(p1, p2, p3)</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-38-1.png" /><!-- --></p>
<p>We can calculate the Beta parameters for the posterior using the formula <span class="math inline">\(\operatorname{Beta} (\theta | z + \alpha, N - z + \beta)\)</span>.</p>
<div class="sourceCode" id="cb991"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb991-1" data-line-number="1"><span class="co"># alpha</span></a>
<a class="sourceLine" id="cb991-2" data-line-number="2">z <span class="op">+</span><span class="st"> </span>epsilon</a></code></pre></div>
<pre><code>## [1] 7.01</code></pre>
<div class="sourceCode" id="cb993"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb993-1" data-line-number="1"><span class="co"># beta</span></a>
<a class="sourceLine" id="cb993-2" data-line-number="2">n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>epsilon</a></code></pre></div>
<pre><code>## [1] 17.01</code></pre>
<p>We need updated data for the right column, based on the <span class="math inline">\(\operatorname{Beta} (2, 4)\)</span> prior.</p>
<div class="sourceCode" id="cb995"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb995-1" data-line-number="1">alpha &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb995-2" data-line-number="2">beta  &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb995-3" data-line-number="3"></a>
<a class="sourceLine" id="cb995-4" data-line-number="4">d &lt;-</a>
<a class="sourceLine" id="cb995-5" data-line-number="5"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">1000</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb995-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior =</span> <span class="kw">dbeta</span>(<span class="dt">x =</span> theta, <span class="dt">shape1 =</span> alpha, <span class="dt">shape2 =</span> beta)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb995-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">likelihood =</span> <span class="kw">bernoulli_likelihood</span>(<span class="dt">theta =</span> theta,</a>
<a class="sourceLine" id="cb995-8" data-line-number="8">                                           <span class="dt">data =</span> trial_data)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb995-9" data-line-number="9"><span class="st">  </span><span class="co"># no need to `slice(2:999)` this time</span></a>
<a class="sourceLine" id="cb995-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">posterior =</span> likelihood <span class="op">*</span><span class="st"> </span>prior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(likelihood <span class="op">*</span><span class="st"> </span>prior))</a>
<a class="sourceLine" id="cb995-11" data-line-number="11"></a>
<a class="sourceLine" id="cb995-12" data-line-number="12"><span class="kw">head</span>(d)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##     theta  prior likelihood posterior
##     &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
## 1 0       0        0.        0.      
## 2 0.00100 0.0200   9.90e-22  8.91e-20
## 3 0.00200 0.0398   1.25e-19  2.24e-17
## 4 0.00300 0.0595   2.09e-18  5.62e-16
## 5 0.00400 0.0791   1.54e-17  5.50e-15
## 6 0.00501 0.0986   7.22e-17  3.21e-14</code></pre>
<p>Now here’s the right column of Figure 12.3.</p>
<div class="sourceCode" id="cb997"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb997-1" data-line-number="1">p1 &lt;-</a>
<a class="sourceLine" id="cb997-2" data-line-number="2"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb997-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb997-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> prior),</a>
<a class="sourceLine" id="cb997-5" data-line-number="5">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb997-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb997-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Prior (beta)&quot;</span>,</a>
<a class="sourceLine" id="cb997-8" data-line-number="8">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb997-9" data-line-number="9">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Beta(&quot;</span>, theta, <span class="st">&quot;|2, 4)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb997-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb997-11" data-line-number="11"></a>
<a class="sourceLine" id="cb997-12" data-line-number="12">p2 &lt;-</a>
<a class="sourceLine" id="cb997-13" data-line-number="13"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb997-14" data-line-number="14"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb997-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> likelihood),</a>
<a class="sourceLine" id="cb997-16" data-line-number="16">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb997-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb997-18" data-line-number="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Likelihood (Bernoulli)&quot;</span>,</a>
<a class="sourceLine" id="cb997-19" data-line-number="19">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb997-20" data-line-number="20">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;p(D|&quot;</span>, theta, <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb997-21" data-line-number="21"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid  =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb997-22" data-line-number="22">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>())</a>
<a class="sourceLine" id="cb997-23" data-line-number="23"></a>
<a class="sourceLine" id="cb997-24" data-line-number="24">p3 &lt;-</a>
<a class="sourceLine" id="cb997-25" data-line-number="25"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb997-26" data-line-number="26"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb997-27" data-line-number="27"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> posterior),</a>
<a class="sourceLine" id="cb997-28" data-line-number="28">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb997-29" data-line-number="29"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb997-30" data-line-number="30"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Posterior (beta)&quot;</span>,</a>
<a class="sourceLine" id="cb997-31" data-line-number="31">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb997-32" data-line-number="32">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Beta(&quot;</span>, theta, <span class="st">&quot;|9, 21)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb997-33" data-line-number="33"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb997-34" data-line-number="34"></a>
<a class="sourceLine" id="cb997-35" data-line-number="35"><span class="kw">grid.arrange</span>(p1, p2, p3)</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-41-1.png" /><!-- --></p>
<p>Here are those Beta parameters for that posterior.</p>
<div class="sourceCode" id="cb998"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb998-1" data-line-number="1"><span class="co"># alpha</span></a>
<a class="sourceLine" id="cb998-2" data-line-number="2">z <span class="op">+</span><span class="st"> </span>alpha</a></code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode" id="cb1000"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1000-1" data-line-number="1"><span class="co"># beta</span></a>
<a class="sourceLine" id="cb1000-2" data-line-number="2">n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>beta</a></code></pre></div>
<pre><code>## [1] 21</code></pre>
<p>Following the formula for the null hypothesis,</p>
<p><span class="math display">\[p(z, N|M_\text{null}) = \theta_\text{null}^z(1 - \theta_\text{null})^{(N - z)},\]</span></p>
<p>we can compute the probability of the data given the null hypothesis.</p>
<div class="sourceCode" id="cb1002"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1002-1" data-line-number="1">theta &lt;-<span class="st"> </span><span class="fl">.5</span></a>
<a class="sourceLine" id="cb1002-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1002-3" data-line-number="3">(p_d_null &lt;-<span class="st"> </span>theta <span class="op">^</span><span class="st"> </span>z <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta) <span class="op">^</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span>z))</a></code></pre></div>
<pre><code>## [1] 5.960464e-08</code></pre>
<p>The formula for the marginal likelihood for the alternative hypothesis <span class="math inline">\(M_\text{alt}\)</span> is</p>
<p><span class="math display">\[p(z, N| M_\text{alt}) = \frac{\operatorname{Beta} (z + \alpha_\text{alt}, N - z + \beta_\text{alt})}{\operatorname{Beta} (\alpha_\text{alt}, \beta_\text{alt})}.\]</span></p>
<p>We can make our own <code>p_d()</code> function to compute the probability of the data given alternative hypotheses. Here we’ll simplify the function a bit to extract <code>z</code> and <code>n</code> out of the environment.</p>
<div class="sourceCode" id="cb1004"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1004-1" data-line-number="1">p_d &lt;-<span class="st"> </span><span class="cf">function</span>(a, b) { </a>
<a class="sourceLine" id="cb1004-2" data-line-number="2">  <span class="kw">beta</span>(z <span class="op">+</span><span class="st"> </span>a, n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>b) <span class="op">/</span><span class="st"> </span><span class="kw">beta</span>(a, b) </a>
<a class="sourceLine" id="cb1004-3" data-line-number="3">  }</a></code></pre></div>
<p>With <code>p_d_null</code> and our <code>p_d()</code> function in hand, we can reproduce and extend the results in Kruschke’s Equation 12.4.</p>
<div class="sourceCode" id="cb1005"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1005-1" data-line-number="1"><span class="kw">options</span>(<span class="dt">scipen =</span> <span class="dv">999</span>)</a>
<a class="sourceLine" id="cb1005-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1005-3" data-line-number="3"><span class="kw">tibble</span>(<span class="dt">shape1 =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">.1</span>, <span class="fl">.01</span>, <span class="fl">.001</span>, <span class="fl">.0001</span>, <span class="fl">.00001</span>),</a>
<a class="sourceLine" id="cb1005-4" data-line-number="4">       <span class="dt">shape2 =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="fl">.1</span>, <span class="fl">.01</span>, <span class="fl">.001</span>, <span class="fl">.0001</span>, <span class="fl">.00001</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1005-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p_d  =</span> <span class="kw">p_d</span>(<span class="dt">a =</span> shape1, <span class="dt">b =</span> shape2)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1005-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p_d_null =</span> p_d_null) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1005-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">bf       =</span> p_d <span class="op">/</span><span class="st"> </span>p_d_null) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1005-8" data-line-number="8"><span class="st">  </span><span class="co"># this just reduces the amount of significant digits in the output</span></a>
<a class="sourceLine" id="cb1005-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate_all</span>(round, <span class="dt">digits =</span> <span class="dv">6</span>)</a></code></pre></div>
<pre><code>## # A tibble: 7 x 5
##    shape1  shape2   p_d p_d_null       bf
##     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1 2       4           0        0 3.72    
## 2 1       1           0        0 1.94    
## 3 0.1     0.1         0        0 0.421   
## 4 0.01    0.01        0        0 0.0481  
## 5 0.001   0.001       0        0 0.00488 
## 6 0.0001  0.0001      0        0 0.000489
## 7 0.00001 0.00001     0        0 0.000049</code></pre>
<div class="sourceCode" id="cb1007"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1007-1" data-line-number="1"><span class="kw">options</span>(<span class="dt">scipen =</span> <span class="dv">0</span>)</a></code></pre></div>
<p>Did you notice our use of <code>options(scipen)</code>? With the first line, we turned off scientific notation in the print output. We turned scientific notation back on with the second line. But back to the text,</p>
<blockquote>
<p>for now, notice that when the alternative prior is uniform, with <span class="math inline">\(a_\text{alt} = b_\text{alt} = 1.000\)</span>, the Bayes’ factor shows a (small) preference for the alternative hypothesis, but when the alternative prior approximates the Haldane, the Bayes’ factor shows a strong preference for the null hypothesis. As the alternative prior gets closer to the Haldane limit, the Bayes’ factor changes by orders of magnitude. Thus, as we have seen before (e.g. Section 10.6, p. 292), the Bayes’ factor is <em>very sensitive to the choice of prior distribution</em>. (p. 345, <em>emphasis</em> added)</p>
</blockquote>
<p>On page 346, Kruschke showed some of the 95% HDIs for the marginal distributions of the various <span class="math inline">\(M_\text{alt}\)</span>s. We could compute those one at a time with <code>hdi_of_icdf()</code>. But why not work in bulk? Like we did in Chapter 10, let’s make a custom variant <code>hdi_of_qbeta()</code>, which will be more useful within the context of <code>map2()</code>.</p>
<div class="sourceCode" id="cb1008"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1008-1" data-line-number="1">hdi_of_qbeta &lt;-<span class="st"> </span><span class="cf">function</span>(shape1, shape2) {</a>
<a class="sourceLine" id="cb1008-2" data-line-number="2">  <span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</a>
<a class="sourceLine" id="cb1008-3" data-line-number="3">              <span class="dt">shape1 =</span> shape1,</a>
<a class="sourceLine" id="cb1008-4" data-line-number="4">              <span class="dt">shape2 =</span> shape2) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1008-5" data-line-number="5"><span class="st">    </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1008-6" data-line-number="6"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">level =</span> <span class="kw">c</span>(<span class="st">&quot;ll&quot;</span>, <span class="st">&quot;ul&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1008-7" data-line-number="7"><span class="st">    </span><span class="kw">spread</span>(<span class="dt">key =</span> level, <span class="dt">value =</span> <span class="st">&quot;.&quot;</span>)</a>
<a class="sourceLine" id="cb1008-8" data-line-number="8">}</a></code></pre></div>
<p>Compute the HDIs.</p>
<div class="sourceCode" id="cb1009"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1009-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">shape1 =</span>     z <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">.1</span>, <span class="fl">.01</span>, <span class="fl">.001</span>, <span class="fl">.0001</span>, <span class="fl">.00001</span>),</a>
<a class="sourceLine" id="cb1009-2" data-line-number="2">       <span class="dt">shape2 =</span> n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="fl">.1</span>, <span class="fl">.01</span>, <span class="fl">.001</span>, <span class="fl">.0001</span>, <span class="fl">.00001</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1009-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">h    =</span> <span class="kw">map2</span>(shape1, shape2, hdi_of_qbeta)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1009-4" data-line-number="4"><span class="st">  </span><span class="kw">unnest</span>(h) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1009-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="kw">ends_with</span>(<span class="st">&quot;l&quot;</span>)), <span class="dt">.funs =</span> <span class="op">~</span><span class="kw">round</span>(., <span class="dt">digits =</span> <span class="dv">4</span>))</a></code></pre></div>
<pre><code>## # A tibble: 7 x 4
##   shape1 shape2    ll    ul
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1   9      21   0.145 0.462
## 2   8      18   0.141 0.483
## 3   7.1    17.1 0.124 0.472
## 4   7.01   17.0 0.122 0.471
## 5   7.00   17.0 0.122 0.471
## 6   7.00   17.0 0.122 0.471
## 7   7.00   17.0 0.122 0.471</code></pre>
<p>As Kruschke mused,</p>
<blockquote>
<p>if we consider the posterior distribution instead of the Bayes’ factor, we see that the posterior distribution on <span class="math inline">\(\theta\)</span> within the alternative model is only slightly affected by the prior… In all cases, the 95% HDI excludes the null value, although a wide ROPE might overlap the HDI. Thus, the explicit estimation of the bias parameter robustly indicates that the null value should be rejected, but perhaps only marginally. This contrasts with the Bayes’ factor, model-comparison approach, which rejected the null or accepted the null depending on the alternative prior.</p>
</blockquote>
<p>Further,</p>
<blockquote>
<p>of the Bayes’ factors in Equation 12.4, which is most appropriate? If your analysis is driven by the urge for a default, uninformed alternative prior, then the prior that best approximates the Haldane is most appropriate. Following from that, we should strongly prefer the null hypothesis to the Haldane alternative. While this is mathematically correct, it is meaningless for an applied setting because the Haldane alternative represents nothing remotely resembling a credible alternative hypothesis. The Haldane prior sets prior probabilities of virtually zero at all values of <span class="math inline">\(\theta\)</span> except <span class="math inline">\(\theta = 0\)</span> and <span class="math inline">\(\theta = 1\)</span>. There are very few applied settings where such a U-shaped prior represents a genuinely meaningful theory. (p. 346).</p>
</blockquote>
</div>
<div id="bayes-factor-can-accept-null-with-poor-precision." class="section level3">
<h3><span class="header-section-number">12.2.2</span> Bayes’ factor can accept null with poor precision.</h3>
<p>Here are the steps to make the left column of Figure 12.4 (i.e., the column based on very weak data and the Haldane prior).</p>
<div class="sourceCode" id="cb1011"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1011-1" data-line-number="1"><span class="co"># we need these to compute the likelihood</span></a>
<a class="sourceLine" id="cb1011-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1011-3" data-line-number="3">z &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1011-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1011-5" data-line-number="5">trial_data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> n <span class="op">-</span><span class="st"> </span>z), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dt">times =</span> z))</a>
<a class="sourceLine" id="cb1011-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1011-7" data-line-number="7">d &lt;-</a>
<a class="sourceLine" id="cb1011-8" data-line-number="8"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta      =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">1000</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1011-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior      =</span> <span class="kw">dbeta</span>(<span class="dt">x =</span> theta, <span class="dt">shape1 =</span> epsilon, <span class="dt">shape2 =</span> epsilon)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1011-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">likelihood =</span> <span class="kw">bernoulli_likelihood</span>(<span class="dt">theta =</span> theta,</a>
<a class="sourceLine" id="cb1011-11" data-line-number="11">                                           <span class="dt">data =</span> trial_data)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1011-12" data-line-number="12"><span class="st">  </span><span class="co"># like before, we have to slice off the first and last values because they go to infinity on the</span></a>
<a class="sourceLine" id="cb1011-13" data-line-number="13"><span class="st">  </span><span class="co"># prior, which creats problems when computing the denominator `sum(likelihood * prior)` (i.e., p(D))</span></a>
<a class="sourceLine" id="cb1011-14" data-line-number="14"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">999</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1011-15" data-line-number="15"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">posterior  =</span> likelihood <span class="op">*</span><span class="st"> </span>prior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(likelihood <span class="op">*</span><span class="st"> </span>prior))</a>
<a class="sourceLine" id="cb1011-16" data-line-number="16"></a>
<a class="sourceLine" id="cb1011-17" data-line-number="17">p1 &lt;-</a>
<a class="sourceLine" id="cb1011-18" data-line-number="18"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1011-19" data-line-number="19"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1011-20" data-line-number="20"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> prior),</a>
<a class="sourceLine" id="cb1011-21" data-line-number="21">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1011-22" data-line-number="22"><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.1</span>, <span class="dt">y =</span> <span class="dv">4</span>, <span class="dt">size =</span> <span class="fl">3.5</span>, <span class="dt">label =</span> <span class="kw">expression</span>(epsilon <span class="op">==</span><span class="st"> </span><span class="fl">0.01</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1011-23" data-line-number="23"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1011-24" data-line-number="24"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Prior (beta)&quot;</span>,</a>
<a class="sourceLine" id="cb1011-25" data-line-number="25">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb1011-26" data-line-number="26">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Beta(&quot;</span>, theta, <span class="st">&quot;|&quot;</span>, epsilon, <span class="st">&quot;, &quot;</span>, epsilon, <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1011-27" data-line-number="27"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb1011-28" data-line-number="28"></a>
<a class="sourceLine" id="cb1011-29" data-line-number="29">p2 &lt;-</a>
<a class="sourceLine" id="cb1011-30" data-line-number="30"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1011-31" data-line-number="31"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1011-32" data-line-number="32"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> likelihood),</a>
<a class="sourceLine" id="cb1011-33" data-line-number="33">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1011-34" data-line-number="34"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1011-35" data-line-number="35"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Likelihood (Bernoulli)&quot;</span>,</a>
<a class="sourceLine" id="cb1011-36" data-line-number="36">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb1011-37" data-line-number="37">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;p(D|&quot;</span>, theta, <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1011-38" data-line-number="38"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid  =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb1011-39" data-line-number="39">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>())</a>
<a class="sourceLine" id="cb1011-40" data-line-number="40"></a>
<a class="sourceLine" id="cb1011-41" data-line-number="41">p3 &lt;-</a>
<a class="sourceLine" id="cb1011-42" data-line-number="42"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1011-43" data-line-number="43"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1011-44" data-line-number="44"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> posterior),</a>
<a class="sourceLine" id="cb1011-45" data-line-number="45">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1011-46" data-line-number="46"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1011-47" data-line-number="47"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Posterior (beta)&quot;</span>,</a>
<a class="sourceLine" id="cb1011-48" data-line-number="48">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb1011-49" data-line-number="49">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Beta(&quot;</span>, theta, <span class="st">&quot;|7.01, 17.01)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1011-50" data-line-number="50"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb1011-51" data-line-number="51"></a>
<a class="sourceLine" id="cb1011-52" data-line-number="52"><span class="kw">grid.arrange</span>(p1, p2, p3)</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-48-1.png" /><!-- --></p>
<p>That is one flat posterior! Here are the shape parameters and the HDIs.</p>
<div class="sourceCode" id="cb1012"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1012-1" data-line-number="1">(alpha &lt;-<span class="st"> </span>z <span class="op">+</span><span class="st"> </span>epsilon)</a></code></pre></div>
<pre><code>## [1] 1.01</code></pre>
<div class="sourceCode" id="cb1014"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1014-1" data-line-number="1">(beta &lt;-<span class="st"> </span>n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>epsilon)</a></code></pre></div>
<pre><code>## [1] 1.01</code></pre>
<div class="sourceCode" id="cb1016"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1016-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">name   =</span> qbeta,</a>
<a class="sourceLine" id="cb1016-2" data-line-number="2">            <span class="dt">shape1 =</span> alpha,</a>
<a class="sourceLine" id="cb1016-3" data-line-number="3">            <span class="dt">shape2 =</span> beta) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1016-4" data-line-number="4"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.026 0.974</code></pre>
<p>How do we compute the BF?</p>
<div class="sourceCode" id="cb1018"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1018-1" data-line-number="1">theta &lt;-<span class="st"> </span><span class="fl">.5</span></a>
<a class="sourceLine" id="cb1018-2" data-line-number="2">a &lt;-<span class="st"> </span>epsilon</a>
<a class="sourceLine" id="cb1018-3" data-line-number="3">b &lt;-<span class="st"> </span>epsilon</a>
<a class="sourceLine" id="cb1018-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1018-5" data-line-number="5"><span class="co"># pD_{null}                            pD_{alternative}</span></a>
<a class="sourceLine" id="cb1018-6" data-line-number="6">(theta <span class="op">^</span><span class="st"> </span>z <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta) <span class="op">^</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span>z)) <span class="op">/</span><span class="st"> </span>(<span class="kw">beta</span>(z <span class="op">+</span><span class="st"> </span>a, n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>b) <span class="op">/</span><span class="st"> </span><span class="kw">beta</span>(a, b))</a></code></pre></div>
<pre><code>## [1] 51</code></pre>
<p>Just like in the text, “the Bayes’ factor is 51.0 in favor of the null hypothesis” (p. 347)!</p>
<p>Here are the steps to make the right column of Figure 12.4, which is based on stronger data and a flat <span class="math inline">\(\operatorname{Beta} (1, 1)\)</span> prior.</p>
<div class="sourceCode" id="cb1020"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1020-1" data-line-number="1"><span class="co"># we need these to compute the likelihood</span></a>
<a class="sourceLine" id="cb1020-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">14</span></a>
<a class="sourceLine" id="cb1020-3" data-line-number="3">z &lt;-<span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb1020-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1020-5" data-line-number="5">trial_data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> n <span class="op">-</span><span class="st"> </span>z), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dt">times =</span> z))</a>
<a class="sourceLine" id="cb1020-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1020-7" data-line-number="7">d &lt;-</a>
<a class="sourceLine" id="cb1020-8" data-line-number="8"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta      =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="fl">1e3</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1020-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior      =</span> <span class="kw">dbeta</span>(<span class="dt">x =</span> theta, <span class="dt">shape1 =</span> alpha, <span class="dt">shape2 =</span> beta)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1020-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">likelihood =</span> <span class="kw">bernoulli_likelihood</span>(<span class="dt">theta =</span> theta,</a>
<a class="sourceLine" id="cb1020-11" data-line-number="11">                                           <span class="dt">data =</span> trial_data)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1020-12" data-line-number="12"><span class="st">  </span><span class="co"># no need to `slice(2:999)` this time</span></a>
<a class="sourceLine" id="cb1020-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">posterior  =</span> likelihood <span class="op">*</span><span class="st"> </span>prior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(likelihood <span class="op">*</span><span class="st"> </span>prior))</a>
<a class="sourceLine" id="cb1020-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1020-15" data-line-number="15">p1 &lt;-</a>
<a class="sourceLine" id="cb1020-16" data-line-number="16"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1020-17" data-line-number="17"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1020-18" data-line-number="18"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> prior),</a>
<a class="sourceLine" id="cb1020-19" data-line-number="19">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1020-20" data-line-number="20"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1020-21" data-line-number="21"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Prior (beta)&quot;</span>,</a>
<a class="sourceLine" id="cb1020-22" data-line-number="22">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb1020-23" data-line-number="23">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Beta(&quot;</span>, theta, <span class="st">&quot;|1, 1)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1020-24" data-line-number="24"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb1020-25" data-line-number="25"></a>
<a class="sourceLine" id="cb1020-26" data-line-number="26">p2 &lt;-</a>
<a class="sourceLine" id="cb1020-27" data-line-number="27"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1020-28" data-line-number="28"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1020-29" data-line-number="29"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> likelihood),</a>
<a class="sourceLine" id="cb1020-30" data-line-number="30">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1020-31" data-line-number="31"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1020-32" data-line-number="32"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Likelihood (Bernoulli)&quot;</span>,</a>
<a class="sourceLine" id="cb1020-33" data-line-number="33">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb1020-34" data-line-number="34">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;p(D|&quot;</span>, theta, <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1020-35" data-line-number="35"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid  =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb1020-36" data-line-number="36">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>())</a>
<a class="sourceLine" id="cb1020-37" data-line-number="37"></a>
<a class="sourceLine" id="cb1020-38" data-line-number="38">p3 &lt;-</a>
<a class="sourceLine" id="cb1020-39" data-line-number="39"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1020-40" data-line-number="40"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1020-41" data-line-number="41"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> posterior),</a>
<a class="sourceLine" id="cb1020-42" data-line-number="42">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1020-43" data-line-number="43"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1020-44" data-line-number="44"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Posterior (beta)&quot;</span>,</a>
<a class="sourceLine" id="cb1020-45" data-line-number="45">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb1020-46" data-line-number="46">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Beta(&quot;</span>, theta, <span class="st">&quot;|8, 8)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1020-47" data-line-number="47"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb1020-48" data-line-number="48"></a>
<a class="sourceLine" id="cb1020-49" data-line-number="49"><span class="kw">grid.arrange</span>(p1, p2, p3)</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-51-1.png" /><!-- --></p>
<p>Here are the updated shape parameters and the HDIs.</p>
<div class="sourceCode" id="cb1021"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1021-1" data-line-number="1">(alpha &lt;-<span class="st"> </span>z <span class="op">+</span><span class="st"> </span>epsilon)</a></code></pre></div>
<pre><code>## [1] 7.01</code></pre>
<div class="sourceCode" id="cb1023"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1023-1" data-line-number="1">(beta &lt;-<span class="st"> </span>n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>epsilon)</a></code></pre></div>
<pre><code>## [1] 7.01</code></pre>
<div class="sourceCode" id="cb1025"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1025-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">name   =</span> qbeta,</a>
<a class="sourceLine" id="cb1025-2" data-line-number="2">            <span class="dt">shape1 =</span> alpha,</a>
<a class="sourceLine" id="cb1025-3" data-line-number="3">            <span class="dt">shape2 =</span> beta) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1025-4" data-line-number="4"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.252 0.748</code></pre>
<p>Those HDIs are still pretty wide, but much less so than before. Let’s compute the BF.</p>
<div class="sourceCode" id="cb1027"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1027-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1027-2" data-line-number="2">b &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1027-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1027-4" data-line-number="4"><span class="co"># pD_{null}                            pD_{alternative}</span></a>
<a class="sourceLine" id="cb1027-5" data-line-number="5">(theta <span class="op">^</span><span class="st"> </span>z <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta) <span class="op">^</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span>z)) <span class="op">/</span><span class="st"> </span>(<span class="kw">beta</span>(z <span class="op">+</span><span class="st"> </span>a, n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>b) <span class="op">/</span><span class="st"> </span><span class="kw">beta</span>(a, b))</a></code></pre></div>
<pre><code>## [1] 3.14209</code></pre>
<p>A BF of 3.14 in favor of the null is lackluster evidence. And happily so given the breadth of the HDIs.</p>
<p>Kruschke discussed how we’d need <span class="math inline">\(z = 1200\)</span> and <span class="math inline">\(N = 2400\)</span> before the posterior HDIs would fit within a narrow ROPE like .48 and .52. Here’s what that would look like based on the priors from Figure 12.4.</p>
<div class="sourceCode" id="cb1029"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1029-1" data-line-number="1">z &lt;-<span class="st"> </span><span class="dv">1200</span></a>
<a class="sourceLine" id="cb1029-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">2400</span></a>
<a class="sourceLine" id="cb1029-3" data-line-number="3">alpha &lt;-<span class="st">     </span>z <span class="op">+</span><span class="st"> </span>epsilon</a>
<a class="sourceLine" id="cb1029-4" data-line-number="4">beta  &lt;-<span class="st"> </span>n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>epsilon</a>
<a class="sourceLine" id="cb1029-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1029-6" data-line-number="6">d &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="fl">1e3</span>))</a>
<a class="sourceLine" id="cb1029-7" data-line-number="7">  </a>
<a class="sourceLine" id="cb1029-8" data-line-number="8"><span class="co"># the Haldane-based plot</span></a>
<a class="sourceLine" id="cb1029-9" data-line-number="9">p1 &lt;-</a>
<a class="sourceLine" id="cb1029-10" data-line-number="10"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1029-11" data-line-number="11"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1029-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="fl">.48</span>,  <span class="dt">xmax =</span> <span class="fl">.52</span>,</a>
<a class="sourceLine" id="cb1029-13" data-line-number="13">            <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>,</a>
<a class="sourceLine" id="cb1029-14" data-line-number="14">            <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1029-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> <span class="kw">dbeta</span>(theta, <span class="dt">shape1 =</span> alpha, <span class="dt">shape2 =</span> beta)),</a>
<a class="sourceLine" id="cb1029-16" data-line-number="16">              <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">size =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1029-17" data-line-number="17"><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.01</span>, <span class="dt">y =</span> <span class="dv">35</span>, <span class="dt">size =</span> <span class="fl">3.5</span>, <span class="dt">label =</span> <span class="kw">expression</span>(epsilon <span class="op">==</span><span class="st"> </span><span class="fl">0.01</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1029-18" data-line-number="18"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1029-19" data-line-number="19"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;This posterior used the Haldane prior.&quot;</span>,</a>
<a class="sourceLine" id="cb1029-20" data-line-number="20">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1029-21" data-line-number="21"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb1029-22" data-line-number="22"></a>
<a class="sourceLine" id="cb1029-23" data-line-number="23"><span class="co"># redefine the Beta parameters</span></a>
<a class="sourceLine" id="cb1029-24" data-line-number="24">alpha &lt;-<span class="st">     </span>z <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1029-25" data-line-number="25">beta  &lt;-<span class="st"> </span>n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1029-26" data-line-number="26"></a>
<a class="sourceLine" id="cb1029-27" data-line-number="27"><span class="co"># the Beta(1, 1)-based plot</span></a>
<a class="sourceLine" id="cb1029-28" data-line-number="28">p2 &lt;-</a>
<a class="sourceLine" id="cb1029-29" data-line-number="29"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1029-30" data-line-number="30"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1029-31" data-line-number="31"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> <span class="fl">.48</span>,  <span class="dt">xmax =</span> <span class="fl">.52</span>,</a>
<a class="sourceLine" id="cb1029-32" data-line-number="32">            <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>,</a>
<a class="sourceLine" id="cb1029-33" data-line-number="33">            <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1029-34" data-line-number="34"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> <span class="kw">dbeta</span>(theta, <span class="dt">shape1 =</span> alpha, <span class="dt">shape2 =</span> beta)),</a>
<a class="sourceLine" id="cb1029-35" data-line-number="35">              <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">size =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1029-36" data-line-number="36"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1029-37" data-line-number="37"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;This time we used the flat Beta (1, 1).&quot;</span>,</a>
<a class="sourceLine" id="cb1029-38" data-line-number="38">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1029-39" data-line-number="39"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb1029-40" data-line-number="40"></a>
<a class="sourceLine" id="cb1029-41" data-line-number="41"><span class="kw">grid.arrange</span>(p1, p2)</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-54-1.png" /><!-- --></p>
<blockquote>
<p>There is no way around this inconvenient statistical reality: high precision demands a large sample size (and a measurement device with minimal possible noise). But when we are trying to accept a specific value of <span class="math inline">\(\theta\)</span>, is seems logically appropriate that we should have a reasonably precise estimate indicating that specific value. (p. 348)</p>
</blockquote>
</div>
<div id="are-different-groups-equal-or-not" class="section level3">
<h3><span class="header-section-number">12.2.3</span> Are different groups equal or not?</h3>
<blockquote>
<p>Researchers often want to ask the question, Are the groups different or not?</p>
<p>As a concrete example, suppose we conduct an experiment about the effect of background music on the ability to remember. As a simple test of memory, each person tries to memorize the same list of 20 words (such as “chair,” “shark,” “radio,” etc.). They see each word for a specific time, and then, after a brief retention interval, recall as many words as they can. (p. 348)</p>
</blockquote>
<p>If you look in Kruschke’s <code>OneOddGroupModelComp2E.R</code> file, you can get his simulation code. Here we’ve dramatically simplified it. This attempt does not exactly reproduce what his script did, but it gets it in spirit.</p>
<div class="sourceCode" id="cb1030"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1030-1" data-line-number="1"><span class="co"># For each subject, specify the condition s/he was in,</span></a>
<a class="sourceLine" id="cb1030-2" data-line-number="2"><span class="co"># the number of trials s/he experienced, and the number correct.</span></a>
<a class="sourceLine" id="cb1030-3" data-line-number="3">n_g &lt;-<span class="st"> </span><span class="dv">20</span>  <span class="co"># number of subjects per group</span></a>
<a class="sourceLine" id="cb1030-4" data-line-number="4">n_t &lt;-<span class="st"> </span><span class="dv">20</span>  <span class="co"># number of trials per subject</span></a>
<a class="sourceLine" id="cb1030-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1030-6" data-line-number="6"><span class="kw">set.seed</span>(<span class="dv">12</span>)</a>
<a class="sourceLine" id="cb1030-7" data-line-number="7">my_data &lt;-</a>
<a class="sourceLine" id="cb1030-8" data-line-number="8"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">condition =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Das Kruschke&quot;</span>, <span class="st">&quot;Mozart&quot;</span>, <span class="st">&quot;Bach&quot;</span>, <span class="st">&quot;Beethoven&quot;</span>), <span class="dt">each =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb1030-9" data-line-number="9">         <span class="dt">id  =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">80</span>,</a>
<a class="sourceLine" id="cb1030-10" data-line-number="10">         <span class="dt">n_g =</span> n_g,</a>
<a class="sourceLine" id="cb1030-11" data-line-number="11">         <span class="dt">n_t =</span> n_t,</a>
<a class="sourceLine" id="cb1030-12" data-line-number="12">         <span class="dt">group_means =</span> <span class="kw">rep</span>(<span class="kw">c</span>(.<span class="dv">40</span>, <span class="fl">.50</span>, <span class="fl">.51</span>, <span class="fl">.52</span>), <span class="dt">each =</span> <span class="dv">20</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1030-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_recalled  =</span> <span class="kw">rbinom</span>(n_g, n_t, group_means))</a>
<a class="sourceLine" id="cb1030-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1030-15" data-line-number="15"><span class="kw">head</span>(my_data)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 6
##   condition       id   n_g   n_t group_means n_recalled
##   &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;      &lt;int&gt;
## 1 Das Kruschke     1    20    20         0.4          5
## 2 Das Kruschke     2    20    20         0.4         10
## 3 Das Kruschke     3    20    20         0.4         11
## 4 Das Kruschke     4    20    20         0.4          7
## 5 Das Kruschke     5    20    20         0.4          6
## 6 Das Kruschke     6    20    20         0.4          4</code></pre>
<p>Here are the means for <code>n_recalled</code>, by <code>condition</code>.</p>
<div class="sourceCode" id="cb1032"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1032-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1032-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(condition) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1032-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_n_recalled =</span> <span class="kw">mean</span>(n_recalled))</a></code></pre></div>
<pre><code>## # A tibble: 4 x 2
##   condition    mean_n_recalled
##   &lt;chr&gt;                  &lt;dbl&gt;
## 1 Bach                   10.1 
## 2 Beethoven              10.0 
## 3 Das Kruschke            7.05
## 4 Mozart                 10.2</code></pre>
<div id="model-specification-in-jags-brms." class="section level4">
<h4><span class="header-section-number">12.2.3.1</span> Model specification in <del>JAGS</del> brms.</h4>
<p>Recall that although <strong>brms</strong> does accommodate models based on the Bernoulli likelihood, it doesn’t do so when the data are aggregated. With our aggregate Bernoulli data, we’ll have to use the conventional binomial likelihood, instead. We’ll compute two models. Our full model will be</p>
<p><span class="math display">\[\begin{align*}
\text{n_recalled}_{ij}            &amp; \sim \operatorname{Binomial}(n = 20, \theta_{j}), \text{where} \\
\operatorname{logit}(\theta_j) &amp; = \beta_{0_j}.
\end{align*}\]</span></p>
<p>In our equation, <span class="math inline">\(\beta_{0_j}\)</span> is the group-specific intercept within the logistic regression model. We’ll use the <span class="math inline">\(N(0, 1.5)\)</span> prior for the intercept. Though it appears strongly regularizing in the log-odds space, it’s quite flat on the <span class="math inline">\(\theta\)</span> space. If we wanted to be more conservative in the <span class="math inline">\(\theta\)</span> space, we might use something more like <span class="math inline">\(N(0, 1)\)</span>.</p>
<div class="sourceCode" id="cb1034"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1034-1" data-line-number="1">fit2 &lt;-</a>
<a class="sourceLine" id="cb1034-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data, </a>
<a class="sourceLine" id="cb1034-3" data-line-number="3">      <span class="dt">family =</span> binomial,</a>
<a class="sourceLine" id="cb1034-4" data-line-number="4">      n_recalled <span class="op">|</span><span class="st"> </span><span class="kw">trials</span>(<span class="dv">20</span>) <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>condition,</a>
<a class="sourceLine" id="cb1034-5" data-line-number="5">      <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb1034-6" data-line-number="6">      <span class="dt">iter =</span> <span class="dv">2000</span>, <span class="dt">warmup =</span> <span class="dv">500</span>, <span class="dt">cores =</span> <span class="dv">4</span>, <span class="dt">chains =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1034-7" data-line-number="7">      <span class="dt">seed =</span> <span class="dv">12</span>)</a></code></pre></div>
<p>Here’s the summary for the full model.</p>
<div class="sourceCode" id="cb1035"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1035-1" data-line-number="1"><span class="kw">print</span>(fit2)</a></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: n_recalled | trials(20) ~ 0 + condition 
##    Data: my_data (Number of observations: 80) 
## Samples: 4 chains, each with iter = 2000; warmup = 500; thin = 1;
##          total post-warmup samples = 6000
## 
## Population-Level Effects: 
##                      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## conditionBach            0.02      0.10    -0.18     0.21 1.00     7204     4765
## conditionBeethoven       0.01      0.10    -0.18     0.20 1.00     5452     4360
## conditionDasKruschke    -0.61      0.10    -0.82    -0.41 1.00     5981     3557
## conditionMozart          0.05      0.10    -0.14     0.25 1.00     6573     4540
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Do keep in mind that our results will differ from Kruschke’s because of two factors. First, we simulated slightly different data. In the limit, I suspect our data simulation approaches would converge. But we’re far from the limit. Second, we used a different likelihood to model the data, which resulted in slightly different priors. Yet even with those substantial limitations, our results are pretty close.</p>
<p>To make the top portion of Figure 12.5, we’ll need to extract the <code>condition</code>-specific parameters. For that, we’ll employ <code>fixef()</code> and then wrangle a bit.</p>
<div class="sourceCode" id="cb1037"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1037-1" data-line-number="1">post &lt;-</a>
<a class="sourceLine" id="cb1037-2" data-line-number="2"><span class="st">  </span><span class="kw">fixef</span>(fit2, <span class="dt">summary =</span> F) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1037-3" data-line-number="3"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1037-4" data-line-number="4"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">theta_1 =</span> conditionDasKruschke, </a>
<a class="sourceLine" id="cb1037-5" data-line-number="5">            <span class="dt">theta_2 =</span> conditionMozart, </a>
<a class="sourceLine" id="cb1037-6" data-line-number="6">            <span class="dt">theta_3 =</span> conditionBach, </a>
<a class="sourceLine" id="cb1037-7" data-line-number="7">            <span class="dt">theta_4 =</span> conditionBeethoven) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1037-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate_all</span>(inv_logit_scaled) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1037-9" data-line-number="9"><span class="st">  </span><span class="kw">transmute</span>(<span class="st">`</span><span class="dt">theta[1]-theta[2]</span><span class="st">`</span> =<span class="st"> </span>theta_<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1037-10" data-line-number="10">            <span class="st">`</span><span class="dt">theta[1]-theta[3]</span><span class="st">`</span> =<span class="st"> </span>theta_<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1037-11" data-line-number="11">            <span class="st">`</span><span class="dt">theta[1]-theta[4]</span><span class="st">`</span> =<span class="st"> </span>theta_<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1037-12" data-line-number="12">            <span class="st">`</span><span class="dt">theta[2]-theta[3]</span><span class="st">`</span> =<span class="st"> </span>theta_<span class="dv">2</span> <span class="op">-</span><span class="st"> </span>theta_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1037-13" data-line-number="13">            <span class="st">`</span><span class="dt">theta[2]-theta[4]</span><span class="st">`</span> =<span class="st"> </span>theta_<span class="dv">2</span> <span class="op">-</span><span class="st"> </span>theta_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1037-14" data-line-number="14">            <span class="st">`</span><span class="dt">theta[3]-theta[4]</span><span class="st">`</span> =<span class="st"> </span>theta_<span class="dv">3</span> <span class="op">-</span><span class="st"> </span>theta_<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1037-15" data-line-number="15"></a>
<a class="sourceLine" id="cb1037-16" data-line-number="16"><span class="kw">glimpse</span>(post)</a></code></pre></div>
<pre><code>## Observations: 6,000
## Variables: 6
## $ `theta[1]-theta[2]` &lt;dbl&gt; -0.16238871, -0.15526376, -0.14950457, -0.19457511, -0.15670728, -0.1…
## $ `theta[1]-theta[3]` &lt;dbl&gt; -0.13276798, -0.13755633, -0.15991185, -0.22713044, -0.09358645, -0.1…
## $ `theta[1]-theta[4]` &lt;dbl&gt; -0.10759498, -0.14192878, -0.12375515, -0.18351134, -0.14406561, -0.1…
## $ `theta[2]-theta[3]` &lt;dbl&gt; 0.029620731, 0.017707439, -0.010407282, -0.032555331, 0.063120830, 0.…
## $ `theta[2]-theta[4]` &lt;dbl&gt; 0.0547937243, 0.0133349807, 0.0257494209, 0.0110637702, 0.0126416747,…
## $ `theta[3]-theta[4]` &lt;dbl&gt; 0.025172993, -0.004372458, 0.036156703, 0.043619101, -0.050479156, -0…</code></pre>
<p>Now we have the wrangled data, we’re ready to <code>gather()</code> them and plot the top of Figure 12.5.</p>
<div class="sourceCode" id="cb1039"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1039-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1039-2" data-line-number="2"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1039-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1039-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1039-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1039-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1039-7" data-line-number="7">                 <span class="dt">binwidth =</span> <span class="fl">.01</span>, <span class="dt">size =</span> <span class="fl">.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1039-8" data-line-number="8"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1039-9" data-line-number="9">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1039-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1039-11" data-line-number="11"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">25</span>, <span class="fl">.25</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1039-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb1039-13" data-line-number="13"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">labeller =</span> label_parsed)</a></code></pre></div>
<p><img src="12_files/figure-gfm/unnamed-chunk-59-1.png" /><!-- --></p>
<p>Also, do note we’re working with the <span class="math inline">\(\theta\)</span> parameters in our aggregated binomial models, rather than <span class="math inline">\(\omega\)</span>s.</p>
<p>Here’s how you’d get the eact mode and HDI summaries.</p>
<div class="sourceCode" id="cb1040"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1040-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1040-2" data-line-number="2"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1040-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(key) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1040-4" data-line-number="4"><span class="st">  </span><span class="kw">mode_hdi</span>(value) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1040-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate_if</span>(is.double, round, <span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 7
##   key                value .lower .upper .width .point .interval
##   &lt;chr&gt;              &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 theta[1]-theta[2] -0.157 -0.227 -0.091   0.95 mode   hdi      
## 2 theta[1]-theta[3] -0.145 -0.219 -0.085   0.95 mode   hdi      
## 3 theta[1]-theta[4] -0.157 -0.213 -0.082   0.95 mode   hdi      
## 4 theta[2]-theta[3]  0.012 -0.062  0.079   0.95 mode   hdi      
## 5 theta[2]-theta[4]  0.007 -0.058  0.079   0.95 mode   hdi      
## 6 theta[3]-theta[4]  0.004 -0.064  0.069   0.95 mode   hdi</code></pre>
<p>If we wanted to know what proportion of the difference distributions were greater than 0, we could do something like this.</p>
<div class="sourceCode" id="cb1042"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1042-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1042-2" data-line-number="2"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1042-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(key) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1042-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">p =</span> <span class="kw">mean</span>(value <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1042-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate_if</span>(is.double, round, <span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   key                   p
##   &lt;chr&gt;             &lt;dbl&gt;
## 1 theta[1]-theta[2] 0    
## 2 theta[1]-theta[3] 0    
## 3 theta[1]-theta[4] 0    
## 4 theta[2]-theta[3] 0.585
## 5 theta[2]-theta[4] 0.611
## 6 theta[3]-theta[4] 0.526</code></pre>
<p>I got this idea from the great <a href="https://twitter.com/tjmahr">Tristan Mahr</a>, who <a href="https://twitter.com/tjmahr/status/1097980989387755521">pointed out</a> that conditional tests like <code>value &gt; 0</code> compute a vector of <code>TRUE</code> and <code>FALSE</code> values. By nesting that within <code>mean()</code>, you end up with the proportion of those values that are <code>TRUE</code>.</p>
<p>With our Stan/<strong>brms</strong> method, we don’t have an analogue to the lower portion of Figure 12.5 because we are not fitting the full and restricted models within a single run. Thus, there’s no plot to show the chains traversing from <span class="math inline">\(M_\text{full}\)</span> to <span class="math inline">\(M_\text{restricted}\)</span>. Rather, our <code>fit2</code> was just of <span class="math inline">\(M_\text{full}\)</span>. Now we’ll fit <span class="math inline">\(M_\text{restricted}\)</span>, which we’ll save as <code>fit3</code>.</p>
<div class="sourceCode" id="cb1044"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1044-1" data-line-number="1">fit3 &lt;-</a>
<a class="sourceLine" id="cb1044-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data, </a>
<a class="sourceLine" id="cb1044-3" data-line-number="3">      <span class="dt">family =</span> binomial,</a>
<a class="sourceLine" id="cb1044-4" data-line-number="4">      n_recalled <span class="op">|</span><span class="st"> </span><span class="kw">trials</span>(<span class="dv">20</span>) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1044-5" data-line-number="5">      <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1044-6" data-line-number="6">      <span class="dt">iter =</span> <span class="dv">2000</span>, <span class="dt">warmup =</span> <span class="dv">500</span>, <span class="dt">cores =</span> <span class="dv">4</span>, <span class="dt">chains =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1044-7" data-line-number="7">      <span class="dt">seed =</span> <span class="dv">12</span>)</a></code></pre></div>
<p>Here we’ll compare the two models with the LOO.</p>
<div class="sourceCode" id="cb1045"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1045-1" data-line-number="1">fit2 &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(fit2, <span class="st">&quot;loo&quot;</span>)</a>
<a class="sourceLine" id="cb1045-2" data-line-number="2">fit3 &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(fit3, <span class="st">&quot;loo&quot;</span>)</a>
<a class="sourceLine" id="cb1045-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1045-4" data-line-number="4"><span class="kw">loo_compare</span>(fit2, fit3) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1045-5" data-line-number="5"><span class="st">  </span><span class="kw">print</span>(<span class="dt">simplify =</span> F)</a></code></pre></div>
<pre><code>##      elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic  se_looic
## fit2    0.0       0.0  -172.4      4.4         3.3    0.4    344.8    8.8  
## fit3  -12.0       5.5  -184.4      6.9         1.2    0.2    368.8   13.8</code></pre>
<p>The LOO comparison suggests <code>fit2</code>, the full model with the <code>condition</code>-specific intercepts, is an improvement over the restricted one-intercept-only model. We can also compare the models with their weights via the <code>model_weights()</code> function. Here we’ll use <code>weights = &quot;loo&quot;</code> criterion.</p>
<div class="sourceCode" id="cb1047"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1047-1" data-line-number="1"><span class="kw">model_weights</span>(fit2, fit3, <span class="dt">weights =</span> <span class="st">&quot;loo&quot;</span>)</a></code></pre></div>
<pre><code>##         fit2         fit3 
## 9.999937e-01 6.343732e-06</code></pre>
<p>Recall that within a given comparison, the weights sum to 1, with better fitting models tending closer to 1 than the other(s). In this case, almost all the weight went to the <span class="math inline">\(M_\text{full}\)</span>, <code>fit2</code>.</p>
</div>
<div id="bonus-hypothesis-testing-in-brms." class="section level4">
<h4><span class="header-section-number">12.2.3.2</span> Bonus: Hypothesis testing in brms.</h4>
<p>Disclaimer: I’m not a fan of hypothesis texting within the Bayesian framework. So I generally don’t use these methods. However, it’d seem negligent not to at least mention the convenience function designed for that purpose in <strong>brms</strong>: the <code>hypothesis()</code> function. From the <code>hypothesis</code> section in the <a href="https://cran.r-project.org/web/packages/brms/brms.pdf"><strong>brms</strong> reference manual (version 2.10.0)</a> we read:</p>
<blockquote>
<p>Among others, <code>hypothesis</code> computes an evidence ratio (<code>Evid.Ratio</code>) for each hypothesis. For a one-sided hypothesis, this is just the posterior probability (<code>Post.Prob</code>) under the hypothesis against its alternative. That is, when the hypothesis is of the form <code>a &gt; b</code>, the evidence ratio is the ratio of the posterior probability of <code>a &gt; b</code> and the posterior probability of <code>a &lt; b</code>. In this example, values greater than one indicate that the evidence in favor of <code>a &gt; b</code> is larger than evidence in favor of <code>a &lt; b</code>. For an two-sided (point) hypothesis, the evidence ratio is a Bayes factor between the hypothesis and its alternative computed via the Savage-Dickey density ratio method. That is the posterior density at the point of interest divided by the prior density at that point. Values greater than one indicate that evidence in favor of the point hypothesis has increased after seeing the data. In order to calculate this Bayes factor, all parameters related to the hypothesis must have proper priors and argument <code>sample_prior</code> of function brm must be set to <code>&quot;yes&quot;</code>. Otherwise Evid.Ratio (and Post.Prob) will be <code>NA</code>. Please note that, for technical reasons, we cannot sample from priors of certain parameters classes. Most notably, these include overall intercept parameters (prior class <code>&quot;Intercept&quot;</code>) as well as group-level coefficients. When interpreting Bayes factors, make sure that your priors are reasonable and carefully chosen, as the result will depend heavily on the priors. In particular, avoid using default priors.</p>
</blockquote>
<p>Following the <code>a &lt; b</code> format, let’s say we wanted to test the hypothesis <span class="math inline">\(\theta_\text{Das Kruschke} &lt; \theta_\text{Bach}\)</span>, based on <code>fit2</code>. If we convert the relevant parameters from the log-odds metric to the probability scale with <code>inv_logit_scaled()</code>, we can specify that hypothesis as a string and place it into the <code>hypothesis()</code> function.</p>
<div class="sourceCode" id="cb1049"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1049-1" data-line-number="1"><span class="kw">hypothesis</span>(fit2, </a>
<a class="sourceLine" id="cb1049-2" data-line-number="2">           <span class="st">&quot;inv_logit_scaled(conditionDasKruschke) &lt; inv_logit_scaled(conditionBach)&quot;</span>)</a></code></pre></div>
<pre><code>## Hypothesis Tests for class b:
##                 Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
## 1 (inv_logit_scaled... &lt; 0    -0.15      0.03    -0.21     -0.1        Inf         1    *
## ---
## &#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
## &#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
## for two-sided hypotheses, the value tested against lies outside the 95%-CI.
## Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<p>In the <code>Estimate</code> through <code>CI.Upper</code> columns, we got the typical <strong>brms</strong> summary statistics for model parameters. Those CIs, recall, are ETIs rather than HDIs. To interpret the rest, we read further from the <a href="https://cran.r-project.org/web/packages/brms/brms.pdf"><strong>brms</strong> reference manual</a> that</p>
<blockquote>
<p>the <code>Evid.Ratio</code> may sometimes be <code>0</code> or <code>Inf</code> implying very small or large evidence, respectively, in favor of the tested hypothesis. For one-sided hypotheses pairs, this basically means that all posterior samples are on the same side of the value dividing the two hypotheses. In that sense, instead of <code>0</code> or <code>Inf</code>, you may rather read it as Evid.Ratio smaller <code>1 / S</code> or greater <code>S</code>, respectively, where <code>S</code> denotes the number of posterior samples used in the computations.</p>
<p>The argument alpha specifies the size of the credible interval (i.e., Bayesian confidence interval). For instance, if we tested a two-sided hypothesis and set <code>alpha = 0.05</code> (5%) an, the credible interval will contain <code>1 -alpha = 0.95</code> (95%) of the posterior values. Hence, <code>alpha*100</code>% of the posterior values will lie outside of the credible interval. Although this allows testing of hypotheses in a similar manner as in the frequentist null-hypothesis testing framework, we strongly argue against
using arbitrary cutoffs (e.g., <code>p &lt; .05</code>) to determine the ‘existence’ of an effect.</p>
</blockquote>
<p>In this case, the entire posterior distribution (i.e., all the iterations of the chains) was below zero and we ended up with an <code>Evid.Ratio = Inf</code>. Our Bayes factor blew up. If we’d like to test a point null hypothesis, we might reformat the equation to <span class="math inline">\(\theta_\text{Das Kruschke} = \theta_\text{Bach}\)</span>.</p>
<div class="sourceCode" id="cb1051"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1051-1" data-line-number="1"><span class="kw">hypothesis</span>(fit2, </a>
<a class="sourceLine" id="cb1051-2" data-line-number="2">           <span class="st">&quot;inv_logit_scaled(conditionDasKruschke) = inv_logit_scaled(conditionBach)&quot;</span>)</a></code></pre></div>
<pre><code>## Hypothesis Tests for class b:
##                 Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
## 1 (inv_logit_scaled... = 0    -0.15      0.03    -0.22    -0.09         NA        NA    *
## ---
## &#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
## &#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
## for two-sided hypotheses, the value tested against lies outside the 95%-CI.
## Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<p>Here we no longer get summary information in the <code>Evid.Ratio</code> and <code>Post.Prob</code> columns. But we do get that posterior summary information and we also get that little <code>*</code> symbol in the <code>Star</code> column, which was based on the brms default <code>alpha = 0.05</code>.</p>
<p>Let’s see what happens when we test a different kind of directional hypothesis, <span class="math inline">\(\theta_\text{Motzart} - \theta_\text{Bach} &gt; 0\)</span>.</p>
<div class="sourceCode" id="cb1053"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1053-1" data-line-number="1"><span class="kw">hypothesis</span>(fit2, </a>
<a class="sourceLine" id="cb1053-2" data-line-number="2">           <span class="st">&quot;inv_logit_scaled(conditionMozart) - inv_logit_scaled(conditionBach) &gt; 0&quot;</span>)</a></code></pre></div>
<pre><code>## Hypothesis Tests for class b:
##                 Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
## 1 (inv_logit_scaled... &gt; 0     0.01      0.04    -0.05     0.07       1.41      0.59     
## ---
## &#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
## &#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
## for two-sided hypotheses, the value tested against lies outside the 95%-CI.
## Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<p>Here we get an underwhelming BF of 1.47. The posterior probability that hypothesis versus its logical alternative is .6. Notice we no longer have a <code>*</code> in the <code>Star</code> column.</p>
</div>
</div>
</div>
<div id="relations-of-parameter-estimation-and-model-comparison" class="section level2">
<h2><span class="header-section-number">12.3</span> Relations of parameter estimation and model comparison</h2>
<p>Back to the text, Kruschke wrapped up this section by explaining</p>
<blockquote>
<p>the model comparison focuses on the null value and whether its local probability increases from prior to posterior. The parameter estimation considers the entire posterior distribution, including the uncertainty (i.e., HDI) of the parameter estimate relative to the ROPE.</p>
<p>The derivation of the Bayes’ factor by considering the null value in parameter estimation is known as the Savage-Dickey method. A lucid explanation is provided by <a href="https://www.ejwagenmakers.com/2010/WagenmakersEtAlCogPsy2010.pdf">Wagenmakers, Lodewyckx, Kuriyal, and Grasman (2010)</a>, who also provide some historical references and applications to MCMC analysis of hierarchical models. (pp. 353–354)</p>
</blockquote>
<p>Hey, we just read about that Savage-Dickey method when learning about the <code>brms::hypothesis()</code> function!</p>
</div>
<div id="estimation-and-model-comparison" class="section level2">
<h2><span class="header-section-number">12.4</span> Estimation and model comparison?</h2>
<p>I’ll leave you to decide. Here’s Kruschke to close us out: “As mentioned above, neither method for null value assessment (parameter estimation or model comparison) is uniquely ‘correct.’ The two approaches merely pose the question of the null value in different ways” (p. 354)</p>
</div>
<div id="reference-11" class="section level2 unnumbered">
<h2>Reference</h2>
<p><a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke, J. K. (2015). <em>Doing Bayesian data analysis, Second Edition: A tutorial with R, JAGS, and Stan.</em> Burlington, MA: Academic Press/Elsevier.</a></p>
</div>
<div id="session-info-11" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb1055"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1055-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.0 (2019-04-26)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS High Sierra 10.13.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] gridExtra_2.3   tidybayes_1.1.0 brms_2.10.3     Rcpp_1.0.2      forcats_0.4.0   stringr_1.4.0  
##  [7] dplyr_0.8.3     purrr_0.3.3     readr_1.3.1     tidyr_1.0.0     tibble_2.1.3    ggplot2_3.2.1  
## [13] tidyverse_1.2.1
## 
## loaded via a namespace (and not attached):
##   [1] colorspace_1.4-1          ellipsis_0.3.0            ggridges_0.5.1           
##   [4] rsconnect_0.8.15          ggstance_0.3.2            markdown_1.1             
##   [7] base64enc_0.1-3           rstudioapi_0.10           rstan_2.19.2             
##  [10] svUnit_0.7-12             DT_0.9                    fansi_0.4.0              
##  [13] lubridate_1.7.4           xml2_1.2.0                bridgesampling_0.7-2     
##  [16] knitr_1.23                shinythemes_1.1.2         zeallot_0.1.0            
##  [19] bayesplot_1.7.0           jsonlite_1.6              broom_0.5.2              
##  [22] shiny_1.3.2               compiler_3.6.0            httr_1.4.0               
##  [25] backports_1.1.5           assertthat_0.2.1          Matrix_1.2-17            
##  [28] lazyeval_0.2.2            cli_1.1.0                 later_1.0.0              
##  [31] htmltools_0.4.0           prettyunits_1.0.2         tools_3.6.0              
##  [34] igraph_1.2.4.1            coda_0.19-3               gtable_0.3.0             
##  [37] glue_1.3.1.9000           reshape2_1.4.3            cellranger_1.1.0         
##  [40] vctrs_0.2.0               nlme_3.1-139              crosstalk_1.0.0          
##  [43] xfun_0.10                 ps_1.3.0                  rvest_0.3.4              
##  [46] mime_0.7                  miniUI_0.1.1.1            lifecycle_0.1.0          
##  [49] gtools_3.8.1              MASS_7.3-51.4             zoo_1.8-6                
##  [52] scales_1.0.0              colourpicker_1.0          hms_0.4.2                
##  [55] promises_1.1.0            Brobdingnag_1.2-6         parallel_3.6.0           
##  [58] inline_0.3.15             shinystan_2.5.0           yaml_2.2.0               
##  [61] loo_2.1.0                 StanHeaders_2.19.0        stringi_1.4.3            
##  [64] dygraphs_1.1.1.6          pkgbuild_1.0.5            rlang_0.4.1              
##  [67] pkgconfig_2.0.3           matrixStats_0.55.0        HDInterval_0.2.0         
##  [70] evaluate_0.14             lattice_0.20-38           rstantools_2.0.0         
##  [73] htmlwidgets_1.5           labeling_0.3              tidyselect_0.2.5         
##  [76] processx_3.4.1            plyr_1.8.4                magrittr_1.5             
##  [79] R6_2.4.0                  generics_0.0.2            pillar_1.4.2             
##  [82] haven_2.1.0               withr_2.1.2               xts_0.11-2               
##  [85] abind_1.4-5               modelr_0.1.4              crayon_1.3.4             
##  [88] arrayhelpers_1.0-20160527 utf8_1.1.4                rmarkdown_1.13           
##  [91] grid_3.6.0                readxl_1.3.1              callr_3.3.2              
##  [94] threejs_0.3.1             digest_0.6.21             xtable_1.8-4             
##  [97] httpuv_1.5.2              stats4_3.6.0              munsell_0.5.0            
## [100] shinyjs_1.0</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="null-hypothesis-significance-testing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="goals-power-and-sample-size.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
