<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>19 Metric Predicted Variable with One Nominal Predictor | Doing Bayesian Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="19 Metric Predicted Variable with One Nominal Predictor | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="19 Metric Predicted Variable with One Nominal Predictor | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2023-01-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="metric-predicted-variable-with-multiple-metric-predictors.html"/>
<link rel="next" href="metric-predicted-variable-with-multiple-nominal-predictors.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-setup"><i class="fa fa-check"></i><strong>R</strong> setup</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#we-have-updates"><i class="fa fa-check"></i>We have updates</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.1.0."><i class="fa fa-check"></i>Version 0.1.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.2.0."><i class="fa fa-check"></i>Version 0.2.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.3.0."><i class="fa fa-check"></i>Version 0.3.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.4.0."><i class="fa fa-check"></i>Version 0.4.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-1.0.0."><i class="fa fa-check"></i>Version 1.0.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-1.0.1."><i class="fa fa-check"></i>Version 1.0.1.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#some-minor-issues-remain."><i class="fa fa-check"></i>Some minor issues remain.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thank-yous-are-in-order"><i class="fa fa-check"></i>Thank-you’s are in order</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-citation"><i class="fa fa-check"></i>License and citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html"><i class="fa fa-check"></i><b>1</b> What’s in This Book (Read This First!)</a>
<ul>
<li class="chapter" data-level="1.1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#real-people-can-read-this-book"><i class="fa fa-check"></i><b>1.1</b> Real people can read this book</a></li>
<li class="chapter" data-level="1.2" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-in-this-book"><i class="fa fa-check"></i><b>1.2</b> What’s in this book</a></li>
<li class="chapter" data-level="1.3" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-new-in-the-second-edition"><i class="fa fa-check"></i><b>1.3</b> What’s new in the second edition</a></li>
<li class="chapter" data-level="1.4" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#gimme-feedback-be-polite"><i class="fa fa-check"></i><b>1.4</b> Gimme feedback (be polite)</a></li>
<li class="chapter" data-level="1.5" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#thank-you"><i class="fa fa-check"></i><b>1.5</b> Thank you!</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Introduction: Credibility, Models, and Parameters</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#bayesian-inference-is-reallocation-of-credibility-across-possibilities"><i class="fa fa-check"></i><b>2.1</b> Bayesian inference is reallocation of credibility across possibilities</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#data-are-noisy-and-inferences-are-probabilistic."><i class="fa fa-check"></i><b>2.1.1</b> Data are noisy and inferences are probabilistic.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#possibilities-are-parameter-values-in-descriptive-models"><i class="fa fa-check"></i><b>2.2</b> Possibilities are parameter values in descriptive models</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.3</b> The steps of Bayesian data analysis</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html"><i class="fa fa-check"></i><b>3</b> The R Programming Language</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-software"><i class="fa fa-check"></i><b>3.1</b> Get the software</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-look-at-rstudio."><i class="fa fa-check"></i><b>3.1.1</b> A look at RStudio.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-simple-example-of-r-in-action"><i class="fa fa-check"></i><b>3.2</b> A simple example of R in action</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-programs-used-with-this-book."><i class="fa fa-check"></i><b>3.2.1</b> Get the programs used with this book.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#basic-commands-and-operators-in-r"><i class="fa fa-check"></i><b>3.3</b> Basic commands and operators in R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#getting-help-in-r."><i class="fa fa-check"></i><b>3.3.1</b> Getting help in R.</a></li>
<li class="chapter" data-level="3.3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#arithmetic-and-logical-operators."><i class="fa fa-check"></i><b>3.3.2</b> Arithmetic and logical operators.</a></li>
<li class="chapter" data-level="3.3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#assignment-relational-operators-and-tests-of-equality."><i class="fa fa-check"></i><b>3.3.3</b> Assignment, relational operators, and tests of equality.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-types"><i class="fa fa-check"></i><b>3.4</b> Variable types</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#vector."><i class="fa fa-check"></i><b>3.4.1</b> Vector.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#factor."><i class="fa fa-check"></i><b>3.4.2</b> Factor.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#matrix-and-array."><i class="fa fa-check"></i><b>3.4.3</b> Matrix and array.</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#list-and-data-frame."><i class="fa fa-check"></i><b>3.4.4</b> List and data frame.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#loading-and-saving-data"><i class="fa fa-check"></i><b>3.5</b> Loading and saving data</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#the-read.csv-read_csv-and-read.table-read_table-functions."><i class="fa fa-check"></i><b>3.5.1</b> The <del>read.csv</del> <code>read_csv()</code> and <del>read.table</del> <code>read_table()</code> functions.</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#saving-data-from-r."><i class="fa fa-check"></i><b>3.5.2</b> Saving data from R.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#some-utility-functions"><i class="fa fa-check"></i><b>3.6</b> Some utility functions</a></li>
<li class="chapter" data-level="3.7" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-in-r"><i class="fa fa-check"></i><b>3.7</b> Programming in R</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-names-in-r."><i class="fa fa-check"></i><b>3.7.1</b> Variable names in R.</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#running-a-program."><i class="fa fa-check"></i><b>3.7.2</b> Running a program.</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-a-function."><i class="fa fa-check"></i><b>3.7.3</b> Programming a function.</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conditions-and-loops."><i class="fa fa-check"></i><b>3.7.4</b> Conditions and loops.</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#measuring-processing-time."><i class="fa fa-check"></i><b>3.7.5</b> Measuring processing time.</a></li>
<li class="chapter" data-level="3.7.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#debugging."><i class="fa fa-check"></i><b>3.7.6</b> Debugging.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#graphical-plots-opening-and-saving"><i class="fa fa-check"></i><b>3.8</b> Graphical plots: Opening and saving</a></li>
<li class="chapter" data-level="3.9" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conclusion-brms-related-needs"><i class="fa fa-check"></i><b>3.9</b> <del>Conclusion</del> <strong>brms</strong>-related needs</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html"><i class="fa fa-check"></i><b>4</b> What is This Stuff Called Probability?</a>
<ul>
<li class="chapter" data-level="4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#the-set-of-all-possible-events"><i class="fa fa-check"></i><b>4.1</b> The set of all possible events</a></li>
<li class="chapter" data-level="4.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-outside-or-inside-the-head"><i class="fa fa-check"></i><b>4.2</b> Probability: Outside or inside the head</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#outside-the-head-long-run-relative-frequency."><i class="fa fa-check"></i><b>4.2.1</b> Outside the head: Long-run relative frequency.</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#inside-the-head-subjective-belief."><i class="fa fa-check"></i><b>4.2.2</b> Inside the head: Subjective belief.</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probabilities-assign-numbers-to-possibilities."><i class="fa fa-check"></i><b>4.2.3</b> Probabilities assign numbers to possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Probability distributions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#discrete-distributions-probability-mass."><i class="fa fa-check"></i><b>4.3.1</b> Discrete distributions: Probability mass.</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#continuous-distributions-rendezvous-with-density."><i class="fa fa-check"></i><b>4.3.2</b> Continuous distributions: Rendezvous with density.</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#mean-and-variance-of-a-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Mean and variance of a distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#highest-density-interval-hdi."><i class="fa fa-check"></i><b>4.3.4</b> Highest density interval (HDI).</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#two-way-distributions"><i class="fa fa-check"></i><b>4.4</b> Two-way distributions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#conditional-probability."><i class="fa fa-check"></i><b>4.4.1</b> Conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule</a>
<ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-rule-1"><i class="fa fa-check"></i><b>5.1</b> Bayes’ rule</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#derived-from-definitions-of-conditional-probability."><i class="fa fa-check"></i><b>5.1.1</b> Derived from definitions of conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule.html"><a href="bayes-rule.html#applied-to-parameters-and-data"><i class="fa fa-check"></i><b>5.2</b> Applied to parameters and data</a></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule.html"><a href="bayes-rule.html#complete-examples-estimating-bias-in-a-coin"><i class="fa fa-check"></i><b>5.3</b> Complete examples: Estimating bias in a coin</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-sample-size-on-the-posterior."><i class="fa fa-check"></i><b>5.3.1</b> Influence of sample size on the posterior.</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-prior-on-the-posterior."><i class="fa fa-check"></i><b>5.3.2</b> Influence of prior on the posterior.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule.html"><a href="bayes-rule.html#why-bayesian-inference-can-be-difficult"><i class="fa fa-check"></i><b>5.4</b> Why Bayesian inference can be difficult</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-likelihood-function-the-bernoulli-distribution"><i class="fa fa-check"></i><b>6.1</b> The likelihood function: The Bernoulli distribution</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-description-of-credibilities-the-beta-distribution"><i class="fa fa-check"></i><b>6.2</b> A description of credibilities: The beta distribution</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#specifying-a-beta-prior."><i class="fa fa-check"></i><b>6.2.1</b> Specifying a beta prior.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-posterior-beta"><i class="fa fa-check"></i><b>6.3</b> The posterior beta</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#posterior-is-compromise-of-prior-and-likelihood."><i class="fa fa-check"></i><b>6.3.1</b> Posterior is compromise of prior and likelihood.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.1</b> Prior knowledge expressed as a beta distribution.</a></li>
<li class="chapter" data-level="6.4.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.2</b> Prior knowledge that cannot be expressed as a beta distribution.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#approximating-a-distribution-with-a-large-sample"><i class="fa fa-check"></i><b>7.1</b> Approximating a distribution with a large sample</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-simple-case-of-the-metropolis-algorithm"><i class="fa fa-check"></i><b>7.2</b> A simple case of the Metropolis algorithm</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-politician-stumbles-upon-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.2.1</b> A politician stumbles upon the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-random-walk."><i class="fa fa-check"></i><b>7.2.2</b> A random walk.</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#general-properties-of-a-random-walk."><i class="fa fa-check"></i><b>7.2.3</b> General properties of a random walk.</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#why-we-care."><i class="fa fa-check"></i><b>7.2.4</b> Why we care.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-metropolis-algorithm-more-generally"><i class="fa fa-check"></i><b>7.3</b> The Metropolis algorithm more generally</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithm-applied-to-bernoulli-likelihood-and-beta-prior."><i class="fa fa-check"></i><b>7.3.1</b> Metropolis algorithm applied to Bernoulli likelihood and beta prior.</a></li>
<li class="chapter" data-level="7.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-of-metropolis-algorithm."><i class="fa fa-check"></i><b>7.3.2</b> Summary of Metropolis algorithm.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#toward-gibbs-sampling-estimating-two-coin-biases"><i class="fa fa-check"></i><b>7.4</b> Toward Gibbs sampling: Estimating two coin biases</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#prior-likelihood-and-posterior-for-two-biases."><i class="fa fa-check"></i><b>7.4.1</b> Prior, likelihood and posterior for two biases.</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-exact-formal-analysis."><i class="fa fa-check"></i><b>7.4.2</b> The posterior via exact formal analysis.</a></li>
<li class="chapter" data-level="7.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.4.3</b> The posterior via the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-hamiltonian-monte-carlo-sampling."><i class="fa fa-check"></i><b>7.4.4</b> <del>Gibbs</del> Hamiltonian Monte Carlo sampling.</a></li>
<li class="chapter" data-level="7.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#is-there-a-difference-between-biases"><i class="fa fa-check"></i><b>7.4.5</b> Is there a difference between biases?</a></li>
<li class="chapter" data-level="7.4.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#terminology-mcmc."><i class="fa fa-check"></i><b>7.4.6</b> Terminology: MCMC.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness-accuracy-and-efficiency"><i class="fa fa-check"></i><b>7.5</b> MCMC representativeness, accuracy, and efficiency</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness."><i class="fa fa-check"></i><b>7.5.1</b> MCMC representativeness.</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-accuracy."><i class="fa fa-check"></i><b>7.5.2</b> MCMC accuracy.</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-efficiency."><i class="fa fa-check"></i><b>7.5.3</b> MCMC efficiency.</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-1"><i class="fa fa-check"></i><b>7.6</b> Summary</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#footnote-1"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-brms.html"><a href="jags-brms.html"><i class="fa fa-check"></i><b>8</b> <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="8.1" data-path="jags-brms.html"><a href="jags-brms.html#jags-brms-and-its-relation-to-r"><i class="fa fa-check"></i><b>8.1</b> <del>JAGS</del> brms and its relation to R</a></li>
<li class="chapter" data-level="8.2" data-path="jags-brms.html"><a href="jags-brms.html#a-complete-example"><i class="fa fa-check"></i><b>8.2</b> A complete example</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="jags-brms.html"><a href="jags-brms.html#load-data."><i class="fa fa-check"></i><b>8.2.1</b> Load data.</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-brms.html"><a href="jags-brms.html#specify-model."><i class="fa fa-check"></i><b>8.2.2</b> Specify model.</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-brms.html"><a href="jags-brms.html#initialize-chains."><i class="fa fa-check"></i><b>8.2.3</b> Initialize chains.</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-brms.html"><a href="jags-brms.html#generate-chains."><i class="fa fa-check"></i><b>8.2.4</b> Generate chains.</a></li>
<li class="chapter" data-level="8.2.5" data-path="jags-brms.html"><a href="jags-brms.html#examine-chains."><i class="fa fa-check"></i><b>8.2.5</b> Examine chains.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-brms.html"><a href="jags-brms.html#simplified-scripts-for-frequently-used-analyses"><i class="fa fa-check"></i><b>8.3</b> Simplified scripts for frequently used analyses</a></li>
<li class="chapter" data-level="8.4" data-path="jags-brms.html"><a href="jags-brms.html#example-difference-of-biases"><i class="fa fa-check"></i><b>8.4</b> Example: Difference of biases</a></li>
<li class="chapter" data-level="8.5" data-path="jags-brms.html"><a href="jags-brms.html#sampling-from-the-prior-distribution-in-jags-brms"><i class="fa fa-check"></i><b>8.5</b> Sampling from the prior distribution in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="8.6" data-path="jags-brms.html"><a href="jags-brms.html#probability-distributions-available-in-jags-brms"><i class="fa fa-check"></i><b>8.6</b> Probability distributions available in <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="jags-brms.html"><a href="jags-brms.html#defining-new-likelihood-functions."><i class="fa fa-check"></i><b>8.6.1</b> Defining new likelihood functions.</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="jags-brms.html"><a href="jags-brms.html#faster-sampling-with-parallel-processing-in-runjags-brmsbrm"><i class="fa fa-check"></i><b>8.7</b> Faster sampling with parallel processing in <del>runjags</del> <code>brms::brm()</code></a></li>
<li class="chapter" data-level="8.8" data-path="jags-brms.html"><a href="jags-brms.html#tips-for-expanding-jags-brms-models"><i class="fa fa-check"></i><b>8.8</b> Tips for expanding <del>JAGS</del> brms models</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Hierarchical Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-single-coin-from-a-single-mint"><i class="fa fa-check"></i><b>9.1</b> A single coin from a single mint</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation."><i class="fa fa-check"></i><b>9.1.1</b> Posterior via grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#multiple-coins-from-a-single-mint"><i class="fa fa-check"></i><b>9.2</b> Multiple coins from a single mint</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation.-1"><i class="fa fa-check"></i><b>9.2.1</b> Posterior via grid approximation.</a></li>
<li class="chapter" data-level="9.2.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-realistic-model-with-mcmc."><i class="fa fa-check"></i><b>9.2.2</b> A realistic model with MCMC.</a></li>
<li class="chapter" data-level="9.2.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#doing-it-with-jags-brms."><i class="fa fa-check"></i><b>9.2.3</b> Doing it with <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="9.2.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-therapeutic-touch."><i class="fa fa-check"></i><b>9.2.4</b> Example: Therapeutic touch.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#shrinkage-in-hierarchical-models"><i class="fa fa-check"></i><b>9.3</b> Shrinkage in hierarchical models</a></li>
<li class="chapter" data-level="9.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#speeding-up-jags-brms"><i class="fa fa-check"></i><b>9.4</b> Speeding up <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="9.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#extending-the-hierarchy-subjects-within-categories"><i class="fa fa-check"></i><b>9.5</b> Extending the hierarchy: Subjects within categories</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-batting-abilities-by-position."><i class="fa fa-check"></i><b>9.5.1</b> Example: Baseball batting abilities by position.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html"><i class="fa fa-check"></i><b>10</b> Model Comparison and Hierarchical Modeling</a>
<ul>
<li class="chapter" data-level="10.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#general-formula-and-the-bayes-factor"><i class="fa fa-check"></i><b>10.1</b> General formula and the Bayes factor</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#example-two-factories-of-coins"><i class="fa fa-check"></i><b>10.2</b> Example: Two factories of coins</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-formal-analysis."><i class="fa fa-check"></i><b>10.2.1</b> Solution by formal analysis.</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-grid-approximation."><i class="fa fa-check"></i><b>10.2.2</b> Solution by grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-mcmc"><i class="fa fa-check"></i><b>10.3</b> Solution by MCMC</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#nonhierarchical-mcmc-computation-of-each-models-marginal-likelihood."><i class="fa fa-check"></i><b>10.3.1</b> Nonhierarchical MCMC computation of each model’s marginal likelihood.</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#hierarchical-mcmc-computation-of-relative-model-probability-is-not-available-in-brms-well-cover-information-criteria-instead."><i class="fa fa-check"></i><b>10.3.2</b> Hierarchical MCMC computation <del>of relative model probability</del> is not available in brms: We’ll cover information criteria instead.</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#models-with-different-noise-distributions-in-jags-brms."><i class="fa fa-check"></i><b>10.3.3</b> Models with different “noise” distributions in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#prediction-model-averaging"><i class="fa fa-check"></i><b>10.4</b> Prediction: Model averaging</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#model-complexity-naturally-accounted-for"><i class="fa fa-check"></i><b>10.5</b> Model complexity naturally accounted for</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#caveats-regarding-nested-model-comparison."><i class="fa fa-check"></i><b>10.5.1</b> Caveats regarding nested model comparison.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#extreme-sensitivity-to-prior-distribution"><i class="fa fa-check"></i><b>10.6</b> Extreme sensitivity to prior distribution</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#priors-of-different-models-should-be-equally-informed."><i class="fa fa-check"></i><b>10.6.1</b> Priors of different models should be equally informed.</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#bonus-theres-danger-ahead"><i class="fa fa-check"></i><b>10.7</b> Bonus: There’s danger ahead</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#footnote-2"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>11</b> Null Hypothesis Significance Testing</a>
<ul>
<li class="chapter" data-level="11.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#paved-with-good-intentions"><i class="fa fa-check"></i><b>11.1</b> Paved with good intentions</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#definition-of-p-value."><i class="fa fa-check"></i><b>11.1.1</b> Definition of <span class="math inline">\(p\)</span> value.</a></li>
<li class="chapter" data-level="11.1.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-n."><i class="fa fa-check"></i><b>11.1.2</b> With intention to fix <span class="math inline">\(N\)</span>.</a></li>
<li class="chapter" data-level="11.1.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-z."><i class="fa fa-check"></i><b>11.1.3</b> With intention to fix <span class="math inline">\(z\)</span>.</a></li>
<li class="chapter" data-level="11.1.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-duration."><i class="fa fa-check"></i><b>11.1.4</b> With intention to fix duration.</a></li>
<li class="chapter" data-level="11.1.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-make-multiple-tests."><i class="fa fa-check"></i><b>11.1.5</b> With intention to make multiple tests.</a></li>
<li class="chapter" data-level="11.1.6" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#soul-searching."><i class="fa fa-check"></i><b>11.1.6</b> Soul searching.</a></li>
<li class="chapter" data-level="11.1.7" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis."><i class="fa fa-check"></i><b>11.1.7</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#prior-knowledge"><i class="fa fa-check"></i><b>11.2</b> Prior knowledge</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-analysis."><i class="fa fa-check"></i><b>11.2.1</b> NHST analysis.</a></li>
<li class="chapter" data-level="11.2.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis.-1"><i class="fa fa-check"></i><b>11.2.2</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#confidence-interval-and-highest-density-interval"><i class="fa fa-check"></i><b>11.3</b> Confidence interval and highest density interval</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#ci-depends-on-intention."><i class="fa fa-check"></i><b>11.3.1</b> CI depends on intention.</a></li>
<li class="chapter" data-level="11.3.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-hdi."><i class="fa fa-check"></i><b>11.3.2</b> Bayesian HDI.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#multiple-comparisons"><i class="fa fa-check"></i><b>11.4</b> Multiple comparisons</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-correction-for-experiment-wise-error."><i class="fa fa-check"></i><b>11.4.1</b> NHST correction for experiment wise error.</a></li>
<li class="chapter" data-level="11.4.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#just-one-bayesian-posterior-no-matter-how-you-look-at-it."><i class="fa fa-check"></i><b>11.4.2</b> Just one Bayesian posterior no matter how you look at it.</a></li>
<li class="chapter" data-level="11.4.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#how-bayesian-analysis-mitigates-false-alarms."><i class="fa fa-check"></i><b>11.4.3</b> How Bayesian analysis mitigates false alarms.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#what-a-sampling-distribution-is-good-for"><i class="fa fa-check"></i><b>11.5</b> What a sampling distribution is good for</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#planning-an-experiment."><i class="fa fa-check"></i><b>11.5.1</b> Planning an experiment.</a></li>
<li class="chapter" data-level="11.5.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#exploring-model-predictions-posterior-predictive-check."><i class="fa fa-check"></i><b>11.5.2</b> Exploring model predictions (posterior predictive check).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#footnote-3"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><i class="fa fa-check"></i><b>12</b> Bayesian Approaches to Testing a Point (“Null”) Hypothesis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-estimation-approach"><i class="fa fa-check"></i><b>12.1</b> The estimation approach</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#region-of-practical-equivalence."><i class="fa fa-check"></i><b>12.1.1</b> Region of practical equivalence.</a></li>
<li class="chapter" data-level="12.1.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#some-examples."><i class="fa fa-check"></i><b>12.1.2</b> Some examples.</a></li>
<li class="chapter" data-level="12.1.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#differences-of-correlated-parameters."><i class="fa fa-check"></i><b>12.1.3</b> Differences of correlated parameters.</a></li>
<li class="chapter" data-level="12.1.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#why-hdi-and-not-equal-tailed-interval"><i class="fa fa-check"></i><b>12.1.4</b> Why HDI and not equal-tailed interval?</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-model-comparison-approach"><i class="fa fa-check"></i><b>12.2</b> The model-comparison approach</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#is-a-coin-fair-or-not"><i class="fa fa-check"></i><b>12.2.1</b> Is a coin fair or not?</a></li>
<li class="chapter" data-level="12.2.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#are-different-groups-equal-or-not"><i class="fa fa-check"></i><b>12.2.2</b> Are different groups equal or not?</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#relations-of-parameter-estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.3</b> Relations of parameter estimation and model comparison</a></li>
<li class="chapter" data-level="12.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.4</b> Estimation and model comparison?</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html"><i class="fa fa-check"></i><b>13</b> Goals, Power, and Sample Size</a>
<ul>
<li class="chapter" data-level="13.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-will-to-power"><i class="fa fa-check"></i><b>13.1</b> The will to power</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#goals-and-obstacles."><i class="fa fa-check"></i><b>13.1.1</b> Goals and obstacles.</a></li>
<li class="chapter" data-level="13.1.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power."><i class="fa fa-check"></i><b>13.1.2</b> Power.</a></li>
<li class="chapter" data-level="13.1.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sample-size."><i class="fa fa-check"></i><b>13.1.3</b> Sample size.</a></li>
<li class="chapter" data-level="13.1.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#other-expressions-of-goals."><i class="fa fa-check"></i><b>13.1.4</b> Other expressions of goals.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#computing-power-and-sample-size"><i class="fa fa-check"></i><b>13.2</b> Computing power and sample size</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-to-exclude-a-null-value."><i class="fa fa-check"></i><b>13.2.1</b> When the goal is to exclude a null value.</a></li>
<li class="chapter" data-level="13.2.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#formal-solution-and-implementation-in-r."><i class="fa fa-check"></i><b>13.2.2</b> Formal solution and implementation in R.</a></li>
<li class="chapter" data-level="13.2.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-precision."><i class="fa fa-check"></i><b>13.2.3</b> When the goal is precision.</a></li>
<li class="chapter" data-level="13.2.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#monte-carlo-approximation-of-power."><i class="fa fa-check"></i><b>13.2.4</b> Monte Carlo approximation of power.</a></li>
<li class="chapter" data-level="13.2.5" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-from-idealized-or-actual-data."><i class="fa fa-check"></i><b>13.2.5</b> Power from idealized or actual data.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sequential-testing-and-the-goal-of-precision"><i class="fa fa-check"></i><b>13.3</b> Sequential testing and the goal of precision</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#examples-of-sequential-tests."><i class="fa fa-check"></i><b>13.3.1</b> Examples of sequential tests.</a></li>
<li class="chapter" data-level="13.3.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#average-behavior-of-sequential-tests."><i class="fa fa-check"></i><b>13.3.2</b> Average behavior of sequential tests.</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#discussion"><i class="fa fa-check"></i><b>13.4</b> Discussion</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-and-multiple-comparisons."><i class="fa fa-check"></i><b>13.4.1</b> Power and multiple comparisons.</a></li>
<li class="chapter" data-level="13.4.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-prospective-retrospective-and-replication."><i class="fa fa-check"></i><b>13.4.2</b> Power: prospective, retrospective, and replication.</a></li>
<li class="chapter" data-level="13.4.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-analysis-requires-verisimilitude-of-simulated-data."><i class="fa fa-check"></i><b>13.4.3</b> Power analysis requires verisimilitude of simulated data.</a></li>
<li class="chapter" data-level="13.4.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-importance-of-planning."><i class="fa fa-check"></i><b>13.4.4</b> The importance of planning.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a>
<ul>
<li class="chapter" data-level="14.1" data-path="stan.html"><a href="stan.html#hmc-sampling"><i class="fa fa-check"></i><b>14.1</b> HMC sampling</a></li>
<li class="chapter" data-level="14.2" data-path="stan.html"><a href="stan.html#installing-stan"><i class="fa fa-check"></i><b>14.2</b> Installing Stan</a></li>
<li class="chapter" data-level="14.3" data-path="stan.html"><a href="stan.html#a-complete-example-1"><i class="fa fa-check"></i><b>14.3</b> A Complete example</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="stan.html"><a href="stan.html#reusing-the-compiled-model."><i class="fa fa-check"></i><b>14.3.1</b> Reusing the compiled model.</a></li>
<li class="chapter" data-level="14.3.2" data-path="stan.html"><a href="stan.html#general-structure-of-stan-model-specification."><i class="fa fa-check"></i><b>14.3.2</b> General structure of Stan model specification.</a></li>
<li class="chapter" data-level="14.3.3" data-path="stan.html"><a href="stan.html#think-log-probability-to-think-like-stan."><i class="fa fa-check"></i><b>14.3.3</b> Think log probability to think like Stan.</a></li>
<li class="chapter" data-level="14.3.4" data-path="stan.html"><a href="stan.html#sampling-the-prior-in-stan."><i class="fa fa-check"></i><b>14.3.4</b> Sampling the prior in Stan.</a></li>
<li class="chapter" data-level="14.3.5" data-path="stan.html"><a href="stan.html#simplified-scripts-for-frequently-used-analyses."><i class="fa fa-check"></i><b>14.3.5</b> Simplified scripts for frequently used analyses.</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="stan.html"><a href="stan.html#specify-models-top-down-in-stan"><i class="fa fa-check"></i><b>14.4</b> Specify models top-down in Stan</a></li>
<li class="chapter" data-level="14.5" data-path="stan.html"><a href="stan.html#limitations-and-extras"><i class="fa fa-check"></i><b>14.5</b> Limitations and extras</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#footnote-4"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>15</b> Overview of the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="15.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#types-of-variables"><i class="fa fa-check"></i><b>15.1</b> Types of variables</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#predictor-and-predicted-variables."><i class="fa fa-check"></i><b>15.1.1</b> Predictor and predicted variables.</a></li>
<li class="chapter" data-level="15.1.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#scale-types-metric-ordinal-nominal-and-count."><i class="fa fa-check"></i><b>15.1.2</b> Scale types: metric, ordinal, nominal, and count.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-combination-of-predictors"><i class="fa fa-check"></i><b>15.2</b> Linear combination of predictors</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-function-of-a-single-metric-predictor."><i class="fa fa-check"></i><b>15.2.1</b> Linear function of a single metric predictor.</a></li>
<li class="chapter" data-level="15.2.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#additive-combination-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.2</b> Additive combination of metric predictors.</a></li>
<li class="chapter" data-level="15.2.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nonadditive-interaction-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.3</b> Nonadditive interaction of metric predictors.</a></li>
<li class="chapter" data-level="15.2.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nominal-predictors."><i class="fa fa-check"></i><b>15.2.4</b> Nominal predictors.</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linking-from-combined-predictors-to-noisy-predicted-data"><i class="fa fa-check"></i><b>15.3</b> Linking from combined predictors to noisy predicted data</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predictors-to-predicted-central-tendency."><i class="fa fa-check"></i><b>15.3.1</b> From predictors to predicted central tendency.</a></li>
<li class="chapter" data-level="15.3.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predicted-central-tendency-to-noisy-data."><i class="fa fa-check"></i><b>15.3.2</b> From predicted central tendency to noisy data.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#formal-expression-of-the-glm"><i class="fa fa-check"></i><b>15.4</b> Formal expression of the GLM</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#cases-of-the-glm."><i class="fa fa-check"></i><b>15.4.1</b> Cases of the GLM.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html"><i class="fa fa-check"></i><b>16</b> Metric-Predicted Variable on One or Two Groups</a>
<ul>
<li class="chapter" data-level="16.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#estimating-the-mean-and-standard-deviation-of-a-normal-distribution"><i class="fa fa-check"></i><b>16.1</b> Estimating the mean and standard deviation of a normal distribution</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#solution-by-mathematical-analysis-heads-up-on-precision."><i class="fa fa-check"></i><b>16.1.1</b> <del>Solution by mathematical analysis</del> Heads up on precision.</a></li>
<li class="chapter" data-level="16.1.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#approximation-by-mcmc-in-jags-hmc-in-brms."><i class="fa fa-check"></i><b>16.1.2</b> Approximation by <del>MCMC in JAGS</del> HMC in brms.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#outliers-and-robust-estimation-the-t-distribution"><i class="fa fa-check"></i><b>16.2</b> Outliers and robust estimation: The <span class="math inline">\(t\)</span> distribution</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-jags-brms."><i class="fa fa-check"></i><b>16.2.1</b> Using the <span class="math inline">\(t\)</span> distribution in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="16.2.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-stan."><i class="fa fa-check"></i><b>16.2.2</b> Using the <span class="math inline">\(t\)</span> distribution in Stan.</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#two-groups"><i class="fa fa-check"></i><b>16.3</b> Two groups</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#analysis-by-nhst."><i class="fa fa-check"></i><b>16.3.1</b> Analysis by NHST.</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#other-noise-distributions-and-transforming-data"><i class="fa fa-check"></i><b>16.4</b> Other noise distributions and transforming data</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#session-info-15"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html"><i class="fa fa-check"></i><b>17</b> Metric Predicted Variable with One Metric Predictor</a>
<ul>
<li class="chapter" data-level="17.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#simple-linear-regression"><i class="fa fa-check"></i><b>17.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="17.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Robust linear regression</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-jags-brms."><i class="fa fa-check"></i><b>17.2.1</b> Robust linear regression in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.2.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-stan."><i class="fa fa-check"></i><b>17.2.2</b> Robust linear regression in Stan.</a></li>
<li class="chapter" data-level="17.2.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#stan-or-jags"><i class="fa fa-check"></i><b>17.2.3</b> Stan or JAGS?</a></li>
<li class="chapter" data-level="17.2.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>17.2.4</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#hierarchical-regression-on-individuals-within-groups"><i class="fa fa-check"></i><b>17.3</b> Hierarchical regression on individuals within groups</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>17.3.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.3.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-posterior-distribution-shrinkage-and-prediction."><i class="fa fa-check"></i><b>17.3.2</b> The posterior distribution: Shrinkage and prediction.</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#quadratic-trend-and-weighted-data"><i class="fa fa-check"></i><b>17.4</b> Quadratic trend and weighted data</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#results-and-interpretation."><i class="fa fa-check"></i><b>17.4.1</b> Results and interpretation.</a></li>
<li class="chapter" data-level="17.4.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#further-extensions."><i class="fa fa-check"></i><b>17.4.2</b> Further extensions.</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#procedure-and-perils-for-expanding-a-model"><i class="fa fa-check"></i><b>17.5</b> Procedure and perils for expanding a model</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#session-info-16"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Metric Predicted Variable with Multiple Metric Predictors</a>
<ul>
<li class="chapter" data-level="18.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiple-linear-regression"><i class="fa fa-check"></i><b>18.1</b> Multiple linear regression</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-perils-of-correlated-predictors."><i class="fa fa-check"></i><b>18.1.1</b> The perils of correlated predictors.</a></li>
<li class="chapter" data-level="18.1.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-model-and-implementation."><i class="fa fa-check"></i><b>18.1.2</b> The model and implementation.</a></li>
<li class="chapter" data-level="18.1.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-posterior-distribution."><i class="fa fa-check"></i><b>18.1.3</b> The posterior distribution.</a></li>
<li class="chapter" data-level="18.1.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#redundant-predictors."><i class="fa fa-check"></i><b>18.1.4</b> Redundant predictors.</a></li>
<li class="chapter" data-level="18.1.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#informative-priors-sparse-data-and-correlated-predictors."><i class="fa fa-check"></i><b>18.1.5</b> Informative priors, sparse data, and correlated predictors.</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiplicative-interaction-of-metric-predictors"><i class="fa fa-check"></i><b>18.2</b> Multiplicative interaction of metric predictors</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#an-example."><i class="fa fa-check"></i><b>18.2.1</b> An example.</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#shrinkage-of-regression-coefficients"><i class="fa fa-check"></i><b>18.3</b> Shrinkage of regression coefficients</a></li>
<li class="chapter" data-level="18.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection"><i class="fa fa-check"></i><b>18.4</b> Variable selection</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#inclusion-probability-is-strongly-affected-by-vagueness-of-prior."><i class="fa fa-check"></i><b>18.4.1</b> Inclusion probability is strongly affected by vagueness of prior.</a></li>
<li class="chapter" data-level="18.4.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection-with-hierarchical-shrinkage."><i class="fa fa-check"></i><b>18.4.2</b> Variable selection with hierarchical shrinkage.</a></li>
<li class="chapter" data-level="18.4.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#what-to-report-and-what-to-conclude."><i class="fa fa-check"></i><b>18.4.3</b> What to report and what to conclude.</a></li>
<li class="chapter" data-level="18.4.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-computational-methods."><i class="fa fa-check"></i><b>18.4.4</b> Caution: Computational methods.</a></li>
<li class="chapter" data-level="18.4.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-interaction-variables."><i class="fa fa-check"></i><b>18.4.5</b> Caution: Interaction variables.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#session-info-17"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#footnote-5"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html"><i class="fa fa-check"></i><b>19</b> Metric Predicted Variable with One Nominal Predictor</a>
<ul>
<li class="chapter" data-level="19.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#describing-multiple-groups-of-metric-data"><i class="fa fa-check"></i><b>19.1</b> Describing multiple groups of metric data</a></li>
<li class="chapter" data-level="19.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#traditional-analysis-of-variance"><i class="fa fa-check"></i><b>19.2</b> Traditional analysis of variance</a></li>
<li class="chapter" data-level="19.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#hierarchical-bayesian-approach"><i class="fa fa-check"></i><b>19.3</b> Hierarchical Bayesian approach</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#implementation-in-jags-brms."><i class="fa fa-check"></i><b>19.3.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="19.3.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-and-death."><i class="fa fa-check"></i><b>19.3.2</b> Example: Sex and death.</a></li>
<li class="chapter" data-level="19.3.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#contrasts."><i class="fa fa-check"></i><b>19.3.3</b> Contrasts.</a></li>
<li class="chapter" data-level="19.3.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#multiple-comparisons-and-shrinkage."><i class="fa fa-check"></i><b>19.3.4</b> Multiple comparisons and shrinkage.</a></li>
<li class="chapter" data-level="19.3.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#the-two-group-case."><i class="fa fa-check"></i><b>19.3.5</b> The two-group case.</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#including-a-metric-predictor"><i class="fa fa-check"></i><b>19.4</b> Including a metric predictor</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-death-and-size."><i class="fa fa-check"></i><b>19.4.1</b> Example: Sex, death, and size.</a></li>
<li class="chapter" data-level="19.4.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#analogous-to-traditional-ancova."><i class="fa fa-check"></i><b>19.4.2</b> Analogous to traditional ANCOVA.</a></li>
<li class="chapter" data-level="19.4.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#relation-to-hierarchical-linear-regression."><i class="fa fa-check"></i><b>19.4.3</b> Relation to hierarchical linear regression.</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#heterogeneous-variances-and-robustness-against-outliers"><i class="fa fa-check"></i><b>19.5</b> Heterogeneous variances and robustness against outliers</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-contrast-of-means-with-different-variances."><i class="fa fa-check"></i><b>19.5.1</b> Example: Contrast of means with different variances.</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#exercises-walk-out-an-effect-size"><i class="fa fa-check"></i><b>19.6</b> <del>Exercises</del> Walk out an effect size</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#your-sample-sizes-may-differ."><i class="fa fa-check"></i><b>19.6.1</b> Your sample sizes may differ.</a></li>
<li class="chapter" data-level="19.6.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#populations-and-samples."><i class="fa fa-check"></i><b>19.6.2</b> Populations and samples.</a></li>
<li class="chapter" data-level="19.6.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#report-your-effect-sizes-effectively."><i class="fa fa-check"></i><b>19.6.3</b> Report your effect sizes effectively.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#session-info-18"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Metric Predicted Variable with Multiple Nominal Predictors</a>
<ul>
<li class="chapter" data-level="20.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#describing-groups-of-metric-data-with-multiple-nominal-predictors"><i class="fa fa-check"></i><b>20.1</b> Describing groups of metric data with multiple nominal predictors</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction."><i class="fa fa-check"></i><b>20.1.1</b> Interaction.</a></li>
<li class="chapter" data-level="20.1.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#traditional-anova."><i class="fa fa-check"></i><b>20.1.2</b> Traditional ANOVA.</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#hierarchical-bayesian-approach-1"><i class="fa fa-check"></i><b>20.2</b> Hierarchical Bayesian approach</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>20.2.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="20.2.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#example-its-only-money."><i class="fa fa-check"></i><b>20.2.2</b> Example: It’s only money.</a></li>
<li class="chapter" data-level="20.2.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#main-effect-contrasts."><i class="fa fa-check"></i><b>20.2.3</b> Main effect contrasts.</a></li>
<li class="chapter" data-level="20.2.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction-contrasts-and-simple-effects."><i class="fa fa-check"></i><b>20.2.4</b> Interaction contrasts and simple effects.</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#rescaling-can-change-interactions-homogeneity-and-normality"><i class="fa fa-check"></i><b>20.3</b> Rescaling can change interactions, homogeneity, and normality</a></li>
<li class="chapter" data-level="20.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1"><i class="fa fa-check"></i><b>20.4</b> Heterogeneous variances and robustness against outliers</a></li>
<li class="chapter" data-level="20.5" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#within-subject-designs"><i class="fa fa-check"></i><b>20.5</b> Within-subject designs</a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#why-use-a-within-subject-design-and-why-not"><i class="fa fa-check"></i><b>20.5.1</b> Why use a within-subject design? And why not?</a></li>
<li class="chapter" data-level="20.5.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#split-plot-design."><i class="fa fa-check"></i><b>20.5.2</b> Split-plot design.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#session-info-19"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#footnote-6"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html"><i class="fa fa-check"></i><b>21</b> Dichotomous Predicted Variable</a>
<ul>
<li class="chapter" data-level="21.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-metric-predictors"><i class="fa fa-check"></i><b>21.1</b> Multiple metric predictors</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#the-model-and-implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>21.1.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="21.1.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#example-height-weight-and-gender."><i class="fa fa-check"></i><b>21.1.2</b> Example: Height, weight, and gender.</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interpreting-the-regression-coefficients"><i class="fa fa-check"></i><b>21.2</b> Interpreting the regression coefficients</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#log-odds."><i class="fa fa-check"></i><b>21.2.1</b> Log odds.</a></li>
<li class="chapter" data-level="21.2.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#when-there-are-few-1s-or-0s-in-the-data."><i class="fa fa-check"></i><b>21.2.2</b> When there are few 1’s or 0’s in the data.</a></li>
<li class="chapter" data-level="21.2.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#correlated-predictors."><i class="fa fa-check"></i><b>21.2.3</b> Correlated predictors.</a></li>
<li class="chapter" data-level="21.2.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interaction-of-metric-predictors."><i class="fa fa-check"></i><b>21.2.4</b> Interaction of metric predictors.</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#robust-logistic-regression"><i class="fa fa-check"></i><b>21.3</b> Robust logistic regression</a></li>
<li class="chapter" data-level="21.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#nominal-predictors"><i class="fa fa-check"></i><b>21.4</b> Nominal predictors</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#single-group."><i class="fa fa-check"></i><b>21.4.1</b> Single group.</a></li>
<li class="chapter" data-level="21.4.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-groups."><i class="fa fa-check"></i><b>21.4.2</b> Multiple groups.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#session-info-20"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html"><i class="fa fa-check"></i><b>22</b> Nominal Predicted Variable</a>
<ul>
<li class="chapter" data-level="22.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-regression"><i class="fa fa-check"></i><b>22.1</b> Softmax regression</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-reduces-to-logistic-for-two-outcomes."><i class="fa fa-check"></i><b>22.1.1</b> Softmax reduces to logistic for two outcomes.</a></li>
<li class="chapter" data-level="22.1.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#independence-from-irrelevant-attributes."><i class="fa fa-check"></i><b>22.1.2</b> Independence from irrelevant attributes.</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>22.2</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="22.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#implementation-in-jags-brms"><i class="fa fa-check"></i><b>22.3</b> Implementation in <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-model."><i class="fa fa-check"></i><b>22.3.1</b> Softmax model.</a></li>
<li class="chapter" data-level="22.3.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-model."><i class="fa fa-check"></i><b>22.3.2</b> Conditional logistic model.</a></li>
<li class="chapter" data-level="22.3.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#results-interpreting-the-regression-coefficients."><i class="fa fa-check"></i><b>22.3.3</b> Results: Interpreting the regression coefficients.</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#generalizations-and-variations-of-the-models"><i class="fa fa-check"></i><b>22.4</b> Generalizations and variations of the models</a></li>
<li class="chapter" data-level="" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#session-info-21"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html"><i class="fa fa-check"></i><b>23</b> Ordinal Predicted Variable</a>
<ul>
<li class="chapter" data-level="23.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#modeling-ordinal-data-with-an-underlying-metric-variable"><i class="fa fa-check"></i><b>23.1</b> Modeling ordinal data with an underlying metric variable</a></li>
<li class="chapter" data-level="23.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-a-single-group"><i class="fa fa-check"></i><b>23.2</b> The case of a single group</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-3"><i class="fa fa-check"></i><b>23.2.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.2.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-bayesian-estimation-recovers-true-parameter-values."><i class="fa fa-check"></i><b>23.2.2</b> Examples: Bayesian estimation recovers true parameter values.</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-two-groups"><i class="fa fa-check"></i><b>23.3</b> The case of two groups</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-4"><i class="fa fa-check"></i><b>23.3.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.3.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-not-funny."><i class="fa fa-check"></i><b>23.3.2</b> Examples: Not funny.</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-metric-predictors"><i class="fa fa-check"></i><b>23.4</b> The Case of metric predictors</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-5"><i class="fa fa-check"></i><b>23.4.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="23.4.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-happiness-and-money."><i class="fa fa-check"></i><b>23.4.2</b> Example: Happiness and money.</a></li>
<li class="chapter" data-level="23.4.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-moviesthey-dont-make-em-like-they-used-to."><i class="fa fa-check"></i><b>23.4.3</b> Example: Movies–They don’t make ’em like they used to.</a></li>
<li class="chapter" data-level="23.4.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#why-are-some-thresholds-outside-the-data"><i class="fa fa-check"></i><b>23.4.4</b> Why are some thresholds outside the data?</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#posterior-prediction"><i class="fa fa-check"></i><b>23.5</b> Posterior prediction</a></li>
<li class="chapter" data-level="23.6" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#generalizations-and-extensions"><i class="fa fa-check"></i><b>23.6</b> Generalizations and extensions</a></li>
<li class="chapter" data-level="" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#session-info-22"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html"><i class="fa fa-check"></i><b>24</b> Count Predicted Variable</a>
<ul>
<li class="chapter" data-level="24.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-exponential-model"><i class="fa fa-check"></i><b>24.1</b> Poisson exponential model</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#data-structure."><i class="fa fa-check"></i><b>24.1.1</b> Data structure.</a></li>
<li class="chapter" data-level="24.1.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#exponential-link-function."><i class="fa fa-check"></i><b>24.1.2</b> Exponential link function.</a></li>
<li class="chapter" data-level="24.1.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-noise-distribution."><i class="fa fa-check"></i><b>24.1.3</b> Poisson noise distribution.</a></li>
<li class="chapter" data-level="24.1.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#the-complete-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>24.1.4</b> The complete model and implementation in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-hair-eye-go-again"><i class="fa fa-check"></i><b>24.2</b> Example: Hair eye go again</a></li>
<li class="chapter" data-level="24.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-interaction-contrasts-shrinkage-and-omnibus-test"><i class="fa fa-check"></i><b>24.3</b> Example: Interaction contrasts, shrinkage, and omnibus test</a></li>
<li class="chapter" data-level="24.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#log-linear-models-for-contingency-tables-bonus-alternative-parameterization"><i class="fa fa-check"></i><b>24.4</b> <del>Log-linear models for contingency tables</del> Bonus: Alternative parameterization</a></li>
<li class="chapter" data-level="" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#session-info-23"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html"><i class="fa fa-check"></i><b>25</b> Tools in the Trunk</a>
<ul>
<li class="chapter" data-level="25.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reporting-a-bayesian-analysis"><i class="fa fa-check"></i><b>25.1</b> Reporting a Bayesian analysis</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#essential-points."><i class="fa fa-check"></i><b>25.1.1</b> Essential points.</a></li>
<li class="chapter" data-level="25.1.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#optional-points."><i class="fa fa-check"></i><b>25.1.2</b> Optional points.</a></li>
<li class="chapter" data-level="25.1.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#helpful-points."><i class="fa fa-check"></i><b>25.1.3</b> Helpful points.</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#functions-for-computing-highest-density-intervals"><i class="fa fa-check"></i><b>25.2</b> Functions for computing highest density intervals</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-grid-approximation."><i class="fa fa-check"></i><b>25.2.1</b> R code for computing HDI of a grid approximation.</a></li>
<li class="chapter" data-level="25.2.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#hdi-of-unimodal-distribution-is-shortest-interval."><i class="fa fa-check"></i><b>25.2.2</b> HDI of unimodal distribution is shortest interval.</a></li>
<li class="chapter" data-level="25.2.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-mcmc-sample."><i class="fa fa-check"></i><b>25.2.3</b> R code for computing HDI of a MCMC sample.</a></li>
<li class="chapter" data-level="25.2.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-function."><i class="fa fa-check"></i><b>25.2.4</b> R code for computing HDI of a function.</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reparameterization"><i class="fa fa-check"></i><b>25.3</b> Reparameterization</a></li>
<li class="chapter" data-level="25.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#censored-data-in-jags-brms"><i class="fa fa-check"></i><b>25.4</b> Censored data in <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="25.4.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#right-censoring-when-youre-uncertain-beyond-a-single-threshold."><i class="fa fa-check"></i><b>25.4.1</b> Right censoring: When you’re uncertain beyond a single threshold.</a></li>
<li class="chapter" data-level="25.4.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#interval-censoring-when-your-values-are-somewhere-in-the-middle."><i class="fa fa-check"></i><b>25.4.2</b> Interval censoring: When your values are somewhere in the middle.</a></li>
<li class="chapter" data-level="25.4.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#complex-censoring-when-the-going-gets-tough"><i class="fa fa-check"></i><b>25.4.3</b> Complex censoring: When the going gets tough…</a></li>
<li class="chapter" data-level="25.4.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#bonus-truncation."><i class="fa fa-check"></i><b>25.4.4</b> Bonus: Truncation.</a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#what-next"><i class="fa fa-check"></i><b>25.5</b> What Next?</a></li>
<li class="chapter" data-level="" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#session-info-24"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Doing Bayesian Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="metric-predicted-variable-with-one-nominal-predictor" class="section level1 hasAnchor" number="19">
<h1><span class="header-section-number">19</span> Metric Predicted Variable with One Nominal Predictor<a href="metric-predicted-variable-with-one-nominal-predictor.html#metric-predicted-variable-with-one-nominal-predictor" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>This chapter considers data structures that consist of a metric predicted variable and a nominal predictor…. This type of data structure can arise from experiments or from observational studies. In experiments, the researcher assigns the categories (at random) to the experimental subjects. In observational studies, both the nominal predictor value and the metric predicted value are generated by processes outside the direct control of the researcher. In either case, the same mathematical description can be applied to the data (although causality is best inferred from experimental intervention).</p>
<p>The traditional treatment of this sort of data structure is called single-factor analysis of variance (ANOVA), or sometimes one-way ANOVA. Our Bayesian approach will be a hierarchical generalization of the traditional ANOVA model. The chapter will also consider the situation in which there is also a metric predictor that accompanies the primary nominal predictor. The metric predictor is sometimes called a covariate, and the traditional treatment of this data structure is called analysis of covariance (ANCOVA). The chapter also considers generalizations of the traditional models, because it is straight forward in Bayesian software to implement heavy-tailed distributions to accommodate outliers, along with hierarchical structure to accommodate heterogeneous variances in the different groups, etc. <span class="citation">(<a href="#ref-kruschkeDoingBayesianData2015" role="doc-biblioref">Kruschke, 2015, pp. 553–554</a>)</span></p>
</blockquote>
<div id="describing-multiple-groups-of-metric-data" class="section level2 hasAnchor" number="19.1">
<h2><span class="header-section-number">19.1</span> Describing multiple groups of metric data<a href="metric-predicted-variable-with-one-nominal-predictor.html#describing-multiple-groups-of-metric-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>Figure 19.1 illustrates the conventional description of grouped metric data. Each group is represented as a position on the horizontal axis. The vertical axis represents the variable to be predicted by group membership. The data are assumed to be normally distributed within groups, with equal standard deviation in all groups. The group means are deflections from overall baseline, such that the deflections sum to zero. Figure 19.1 provides a specific numerical example, with data that were randomly generated from the model. (p. 554)</p>
</blockquote>
<p>We’ll want a custom data-generating function for our primary group data.</p>
<div class="sourceCode" id="cb1799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1799-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1799-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1799-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-3" aria-hidden="true" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>(seed, mean) {</span>
<span id="cb1799-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb1799-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span>(n, <span class="at">mean =</span> grand_mean <span class="sc">+</span> mean, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb1799-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1799-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1799-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-8" aria-hidden="true" tabindex="-1"></a>n          <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb1799-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-9" aria-hidden="true" tabindex="-1"></a>grand_mean <span class="ot">&lt;-</span> <span class="dv">101</span></span>
<span id="cb1799-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1799-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-11" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb1799-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">group     =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb1799-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">deviation =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">6</span>, <span class="sc">-</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1799-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d =</span> <span class="fu">map2</span>(group, deviation, generate_data)) <span class="sc">%&gt;%</span> </span>
<span id="cb1799-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(d) <span class="sc">%&gt;%</span> </span>
<span id="cb1799-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iteration =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">times =</span> <span class="dv">5</span>))</span>
<span id="cb1799-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1799-18"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1799-18" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(d)</span></code></pre></div>
<pre><code>## Rows: 100
## Columns: 4
## $ group     &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2,…
## $ deviation &lt;dbl&gt; 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, -5, -5, -5, -5, -5, …
## $ d         &lt;dbl&gt; 103.74709, 105.36729, 103.32874, 108.19056, 105.65902, 103.35906, 105.97486, 106…
## $ iteration &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 1, 2, 3, …</code></pre>
<p>Here we’ll make a tibble containing the necessary data for the rotated Gaussians. As far as I can tell, Kruschke’s Gaussians only span to the bounds of percentile-based 98% intervals. We partition off those bounds for each <code>group</code> by the <code>ll</code> and <code>ul</code> columns in the first <code>mutate()</code> function. In the second <code>mutate()</code>, we expand the dataset to include a sequence of 100 values between those lower- and upper-limit points. In the third <code>mutate()</code>, we feed those points into the <code>dnorm()</code> function, with group-specific means and a common <code>sd</code>.</p>
<div class="sourceCode" id="cb1801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1801-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1801-1" aria-hidden="true" tabindex="-1"></a>densities <span class="ot">&lt;-</span></span>
<span id="cb1801-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1801-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1801-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1801-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(group, deviation) <span class="sc">%&gt;%</span> </span>
<span id="cb1801-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1801-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ll =</span> <span class="fu">qnorm</span>(.<span class="dv">01</span>, <span class="at">mean =</span> grand_mean <span class="sc">+</span> deviation, <span class="at">sd =</span> <span class="dv">2</span>),</span>
<span id="cb1801-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1801-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">ul =</span> <span class="fu">qnorm</span>(.<span class="dv">99</span>, <span class="at">mean =</span> grand_mean <span class="sc">+</span> deviation, <span class="at">sd =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1801-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1801-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d =</span> <span class="fu">map2</span>(ll, ul, seq, <span class="at">length.out =</span> <span class="dv">100</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1801-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1801-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">map2</span>(d, grand_mean <span class="sc">+</span> deviation, dnorm, <span class="at">sd =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1801-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1801-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(d, density))</span>
<span id="cb1801-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1801-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1801-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1801-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(densities)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 6
##   group deviation    ll    ul     d density
##   &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1     1         4  100.  110.  100.  0.0133
## 2     1         4  100.  110.  100.  0.0148
## 3     1         4  100.  110.  101.  0.0165
## 4     1         4  100.  110.  101.  0.0183
## 5     1         4  100.  110.  101.  0.0203
## 6     1         4  100.  110.  101.  0.0224</code></pre>
<p>We’ll need two more supplementary tibbles to add the flourishes to the plot. The <code>arrow</code> tibble will specify our light-gray arrows. The <code>text</code> tibble will contain our annotation information.</p>
<div class="sourceCode" id="cb1803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1803-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1803-1" aria-hidden="true" tabindex="-1"></a>arrow <span class="ot">&lt;-</span></span>
<span id="cb1803-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1803-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">d         =</span> grand_mean,</span>
<span id="cb1803-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1803-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">group     =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb1803-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1803-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">deviation =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">6</span>, <span class="sc">-</span><span class="dv">3</span>),</span>
<span id="cb1803-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1803-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">offset    =</span> .<span class="dv">1</span>)</span>
<span id="cb1803-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1803-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1803-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1803-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(arrow)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##       d group deviation offset
##   &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;  &lt;dbl&gt;
## 1   101     1         4    0.1
## 2   101     2        -5    0.1
## 3   101     3        -2    0.1
## 4   101     4         6    0.1
## 5   101     5        -3    0.1</code></pre>
<div class="sourceCode" id="cb1805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1805-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1805-1" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb1805-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1805-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">d         =</span> grand_mean,</span>
<span id="cb1805-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1805-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">group     =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb1805-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1805-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">deviation =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">6</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">10</span>),</span>
<span id="cb1805-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1805-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">offset    =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">0</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">1</span>)),</span>
<span id="cb1805-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1805-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">angle     =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">0</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">1</span>)),</span>
<span id="cb1805-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1805-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">label     =</span> <span class="fu">c</span>(<span class="st">&quot;beta[0]==101&quot;</span>, <span class="st">&quot;beta[&#39;[1]&#39;]==4&quot;</span>,<span class="st">&quot;beta[&#39;[2]&#39;]==-5&quot;</span>, <span class="st">&quot;beta[&#39;[3]&#39;]==-2&quot;</span>, <span class="st">&quot;beta[&#39;[4]&#39;]==6&quot;</span>, <span class="st">&quot;beta[&#39;[5]&#39;]==3&quot;</span>, <span class="st">&quot;sigma[&#39;all&#39;]==2&quot;</span>))</span>
<span id="cb1805-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1805-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1805-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1805-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(text)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 6
##       d group deviation offset angle label          
##   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;          
## 1   101     0         0   0.25    90 beta[0]==101   
## 2   101     1         4   0.25    90 beta[&#39;[1]&#39;]==4 
## 3   101     2        -5   0.25    90 beta[&#39;[2]&#39;]==-5
## 4   101     3        -2   0.25    90 beta[&#39;[3]&#39;]==-2
## 5   101     4         6   0.25    90 beta[&#39;[4]&#39;]==6 
## 6   101     5        -3   0.25    90 beta[&#39;[5]&#39;]==3</code></pre>
<p>We’re almost ready to plot. Before we do, let’s talk color and theme. For this chapter, we’ll take our color palette from the <a href="https://CRAN.R-project.org/package=palettetown"><strong>palettetown</strong> package</a> <span class="citation">(<a href="#ref-R-palettetown" role="doc-biblioref">Lucas, 2016</a>)</span>, which provides an array of color palettes inspired by <a href="https://www.pokemon.com/us/">Pokémon</a>. Our color palette will be #17, which is based on <a href="https://www.pokemon.com/us/pokedex/pidgeotto">Pidgeotto</a>.</p>
<div class="sourceCode" id="cb1807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1807-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1807-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palettetown)</span>
<span id="cb1807-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1807-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1807-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1807-3" aria-hidden="true" tabindex="-1"></a>scales<span class="sc">::</span><span class="fu">show_col</span>(<span class="fu">pokepal</span>(<span class="at">pokemon =</span> <span class="dv">17</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1808-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1808-1" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">pokepal</span>(<span class="at">pokemon =</span> <span class="dv">17</span>)</span>
<span id="cb1808-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1808-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1808-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1808-3" aria-hidden="true" tabindex="-1"></a>pp</span></code></pre></div>
<pre><code>##  [1] &quot;#785848&quot; &quot;#E0B048&quot; &quot;#D03018&quot; &quot;#202020&quot; &quot;#A87858&quot; &quot;#F8E858&quot; &quot;#583828&quot; &quot;#E86040&quot; &quot;#F0F0A0&quot;
## [10] &quot;#F8A870&quot; &quot;#C89878&quot; &quot;#F8F8F8&quot; &quot;#A0A0A0&quot;</code></pre>
<p>Our overall plot theme will be based on the default <code>theme_grey()</code> with a good number of adjustments.</p>
<div class="sourceCode" id="cb1810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1810-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1810-1" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(</span>
<span id="cb1810-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1810-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_grey</span>() <span class="sc">+</span></span>
<span id="cb1810-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1810-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> pp[<span class="dv">4</span>]),</span>
<span id="cb1810-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1810-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> pp[<span class="dv">4</span>]),</span>
<span id="cb1810-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1810-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> pp[<span class="dv">4</span>]),</span>
<span id="cb1810-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1810-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1810-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1810-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.box.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1810-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1810-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>]),</span>
<span id="cb1810-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1810-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>], <span class="at">color =</span> pp[<span class="dv">9</span>]),</span>
<span id="cb1810-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1810-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1810-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1810-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> pp[<span class="dv">12</span>], <span class="at">color =</span> pp[<span class="dv">12</span>]),</span>
<span id="cb1810-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1810-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="fu">alpha</span>(pp[<span class="dv">2</span>], <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), <span class="at">color =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb1810-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1810-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> pp[<span class="dv">4</span>]))</span>
<span id="cb1810-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1810-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Now make Figure 19.1.</p>
<div class="sourceCode" id="cb1811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1811-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb1811-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1811-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-3" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb1811-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> group, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb1811-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> grand_mean, <span class="at">color =</span> pp[<span class="dv">12</span>]) <span class="sc">+</span></span>
<span id="cb1811-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> .<span class="dv">05</span>, <span class="at">alpha =</span> <span class="dv">4</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">color =</span> pp[<span class="dv">10</span>]) <span class="sc">+</span></span>
<span id="cb1811-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the Gaussians</span></span>
<span id="cb1811-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ridgeline</span>(<span class="at">data =</span> densities,</span>
<span id="cb1811-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-9" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">height =</span> <span class="sc">-</span>density),</span>
<span id="cb1811-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">min_height =</span> <span class="cn">NA</span>, <span class="at">scale =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">size =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>,</span>
<span id="cb1811-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">color =</span> pp[<span class="dv">7</span>]) <span class="sc">+</span></span>
<span id="cb1811-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the small arrows</span></span>
<span id="cb1811-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> arrow,</span>
<span id="cb1811-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-14" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">xend =</span> d <span class="sc">+</span> deviation,</span>
<span id="cb1811-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> group <span class="sc">+</span> offset, <span class="at">yend =</span> group <span class="sc">+</span> offset),</span>
<span id="cb1811-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> pp[<span class="dv">5</span>], <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb1811-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(.<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span></span>
<span id="cb1811-18"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the large arrow on the left</span></span>
<span id="cb1811-19"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">80</span>, <span class="at">xend =</span> grand_mean,</span>
<span id="cb1811-20"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">0</span>),</span>
<span id="cb1811-21"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> pp[<span class="dv">5</span>], <span class="at">size =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>,</span>
<span id="cb1811-22"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(.<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span></span>
<span id="cb1811-23"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the text</span></span>
<span id="cb1811-24"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb1811-25"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-25" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> grand_mean <span class="sc">+</span> deviation, <span class="at">y =</span> group <span class="sc">+</span> offset,</span>
<span id="cb1811-26"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> label, <span class="at">angle =</span> angle), </span>
<span id="cb1811-27"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1811-28"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb1811-29"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt;1,0,0,0,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,1,0,0,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,0,1,0,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,0,0,1,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,0,0,0,1&gt;&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1811-30"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1811-31"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">112</span>),</span>
<span id="cb1811-32"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1811-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">5.5</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;" /></p>
<blockquote>
<p>The descriptive model presented in Figure 19.1 is the traditional one used by classical ANOVA (which is described a bit more in the next section). More general models are straight forward to implement in Bayesian software. For example, outliers could be accommodated by using heavy-tailed noise distributions (such as a <span class="math inline">\(t\)</span> distribution) instead of a normal distribution, and different groups could be given different standard deviations. (p. 556)</p>
</blockquote>
</div>
<div id="traditional-analysis-of-variance" class="section level2 hasAnchor" number="19.2">
<h2><span class="header-section-number">19.2</span> Traditional analysis of variance<a href="metric-predicted-variable-with-one-nominal-predictor.html#traditional-analysis-of-variance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>The terminology, “analysis of variance,” comes from a decomposition of overall data variance into within-group variance and between-group variance <span class="citation">(<a href="#ref-fisherStatisticalMethodsResearch1925" role="doc-biblioref">Fisher, 1925</a>)</span>. Algebraically, the sum of squared deviations of the scores from their overall mean equals the sum of squared deviations of the scores from their respective group means plus the sum of squared deviations of the group means from the overall mean. In other words, the total variance can be partitioned into within-group variance plus between-group variance. Because one definition of the word “analysis” is separation into constituent parts, the term ANOVA accurately describes the underlying algebra in the traditional methods. That algebraic relation is not used in the hierarchical Bayesian approach presented here. The Bayesian method can estimate component variances, however. Therefore, the Bayesian approach is not ANOVA, but is analogous to ANOVA. (p. 556)</p>
</blockquote>
</div>
<div id="hierarchical-bayesian-approach" class="section level2 hasAnchor" number="19.3">
<h2><span class="header-section-number">19.3</span> Hierarchical Bayesian approach<a href="metric-predicted-variable-with-one-nominal-predictor.html#hierarchical-bayesian-approach" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>“Our goal is to estimate its parameters in a Bayesian framework. Therefore, all the parameters need to be given a meaningfully structured prior distribution” (p. 557). However, our approach will depart a little from the one in the text. All our parameters will <strong>not</strong> “have generic noncommittal prior distributions” (p. 557). Most importantly, we will not follow the example in <span class="citation">(<a href="#ref-gelmanPriorDistributionsVariance2006" role="doc-biblioref">Gelman, 2006</a>)</span> of putting a broad uniform prior on <span class="math inline">\(\sigma_y\)</span>. Rather, we will continue using the half-Gaussian prior, as <a href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations">recommended by the Stan team</a>. However, we will follow Kruschke’s lead for the overall intercept and use a Gaussian prior “made broad on the scale of the data” (p. 557). And like Kruschke, we will estimate <span class="math inline">\(\sigma_\beta\)</span> from the data. To further get a sense of this, let’s make our version of the hierarchical model diagram of Figure 19.2.</p>
<div class="sourceCode" id="cb1812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1812-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1812-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1812-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-3" aria-hidden="true" tabindex="-1"></a><span class="co"># bracket</span></span>
<span id="cb1812-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1812-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> .<span class="dv">99</span>,</span>
<span id="cb1812-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> .<span class="dv">5</span>,</span>
<span id="cb1812-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;{_}&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1812-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1812-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1812-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">color =</span> pp[<span class="dv">8</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1812-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1812-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1812-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1812-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1812-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  plain arrow</span></span>
<span id="cb1812-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-16" aria-hidden="true" tabindex="-1"></a><span class="co"># save our custom arrow settings</span></span>
<span id="cb1812-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-17" aria-hidden="true" tabindex="-1"></a>my_arrow <span class="ot">&lt;-</span> <span class="fu">arrow</span>(<span class="at">angle =</span> <span class="dv">20</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.35</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">type =</span> <span class="st">&quot;closed&quot;</span>)</span>
<span id="cb1812-18"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-18" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1812-19"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> .<span class="dv">72</span>,</span>
<span id="cb1812-20"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="dv">1</span>,</span>
<span id="cb1812-21"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> .<span class="dv">68</span>,</span>
<span id="cb1812-22"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> .<span class="dv">25</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1812-23"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1812-24"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb1812-25"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1812-26"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1812-27"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1812-28"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1812-29"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1812-30"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-30" aria-hidden="true" tabindex="-1"></a><span class="co"># normal density</span></span>
<span id="cb1812-31"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-31" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb1812-32"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1812-33"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1812-34"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1812-35"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1812-36"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1812-37"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1812-38"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1812-39"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1812-40"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.45</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1812-41"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb1812-42"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;italic(M)[0]&quot;</span>, <span class="st">&quot;italic(S)[0]&quot;</span>), </span>
<span id="cb1812-43"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1812-44"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1812-45"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1812-46"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1812-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]))</span></code></pre></div>
<pre><code>## Warning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.
## ℹ Please use the `linewidth` argument instead.</code></pre>
<div class="sourceCode" id="cb1814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1814-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-1" aria-hidden="true" tabindex="-1"></a><span class="co"># second normal density</span></span>
<span id="cb1814-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-2" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb1814-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1814-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1814-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1814-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1814-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1814-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1814-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1814-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1814-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.45</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1814-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb1814-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;sigma[beta]&quot;</span>), </span>
<span id="cb1814-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1814-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1814-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1814-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]))</span>
<span id="cb1814-18"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1814-19"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-19" aria-hidden="true" tabindex="-1"></a><span class="co"># two annotated arrows</span></span>
<span id="cb1814-20"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-20" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span></span>
<span id="cb1814-21"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">16</span>, .<span class="dv">81</span>),</span>
<span id="cb1814-22"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1814-23"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">47</span>, .<span class="dv">77</span>),</span>
<span id="cb1814-24"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1814-25"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb1814-26"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1814-27"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1814-28"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1814-29"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">25</span>, .<span class="dv">74</span>, .<span class="dv">83</span>), <span class="at">y =</span> .<span class="dv">5</span>,</span>
<span id="cb1814-30"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(j)&quot;</span>),</span>
<span id="cb1814-31"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">7</span>), </span>
<span id="cb1814-32"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1814-33"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1814-34"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1814-35"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1814-36"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-36" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood formula</span></span>
<span id="cb1814-37"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-37" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span></span>
<span id="cb1814-38"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> .<span class="dv">99</span>,</span>
<span id="cb1814-39"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb1814-40"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;beta[0]+sum()[italic(j)]*beta[&#39;[&#39;*italic(j)*&#39;]&#39;]*italic(x)[&#39;[&#39;*italic(j)*&#39;]&#39;](italic(i))&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1814-41"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-41" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1814-42"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1814-43"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1814-44"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1814-45"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1814-46"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1814-47"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1814-48"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-48" aria-hidden="true" tabindex="-1"></a><span class="co"># half-normal density</span></span>
<span id="cb1814-49"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-49" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span></span>
<span id="cb1814-50"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1814-51"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1814-52"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1814-53"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1814-54"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1814-55"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;half-normal&quot;</span>,</span>
<span id="cb1814-56"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-56" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1814-57"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1814-58"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-58" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1814-59"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-59" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;0*&#39;,&#39;*~italic(S)[sigma]&quot;</span>, </span>
<span id="cb1814-60"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-60" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1814-61"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1814-62"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1814-63"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]))</span>
<span id="cb1814-64"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1814-65"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-65" aria-hidden="true" tabindex="-1"></a><span class="co"># annotated arrow</span></span>
<span id="cb1814-66"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-66" aria-hidden="true" tabindex="-1"></a>p8 <span class="ot">&lt;-</span></span>
<span id="cb1814-67"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">38</span>,</span>
<span id="cb1814-68"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-68" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> .<span class="dv">65</span>,</span>
<span id="cb1814-69"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-69" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;&#39;=&#39;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1814-70"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1814-71"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1814-72"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1814-73"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">5</span>, <span class="at">xend =</span> .<span class="dv">5</span>,</span>
<span id="cb1814-74"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-74" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> .<span class="dv">25</span>, </span>
<span id="cb1814-75"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-75" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> my_arrow, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1814-76"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1814-77"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1814-78"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1814-79"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-79" aria-hidden="true" tabindex="-1"></a><span class="co"># the third normal density</span></span>
<span id="cb1814-80"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-80" aria-hidden="true" tabindex="-1"></a>p9 <span class="ot">&lt;-</span></span>
<span id="cb1814-81"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1814-82"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1814-83"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1814-84"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1814-85"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-85" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1814-86"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-86" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1814-87"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-87" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1814-88"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1814-89"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-89" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.45</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1814-90"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-90" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb1814-91"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-91" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;mu[italic(i)]&quot;</span>, <span class="st">&quot;sigma[italic(y)]&quot;</span>), </span>
<span id="cb1814-92"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-92" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1814-93"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1814-94"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1814-95"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]))</span>
<span id="cb1814-96"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1814-97"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-97" aria-hidden="true" tabindex="-1"></a><span class="co"># another annotated arrow</span></span>
<span id="cb1814-98"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-98" aria-hidden="true" tabindex="-1"></a>p10 <span class="ot">&lt;-</span></span>
<span id="cb1814-99"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">55</span>,</span>
<span id="cb1814-100"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-100" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> .<span class="dv">6</span>,</span>
<span id="cb1814-101"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-101" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;&#39;~&#39;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1814-102"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1814-103"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1814-104"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1814-105"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">82</span>, <span class="at">xend =</span> .<span class="dv">38</span>,</span>
<span id="cb1814-106"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-106" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> .<span class="dv">2</span>, </span>
<span id="cb1814-107"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-107" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> my_arrow, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1814-108"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1814-109"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1814-110"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1814-111"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-111" aria-hidden="true" tabindex="-1"></a><span class="co"># the final annotated arrow</span></span>
<span id="cb1814-112"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-112" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span></span>
<span id="cb1814-113"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="fu">c</span>(.<span class="dv">375</span>, .<span class="dv">625</span>),</span>
<span id="cb1814-114"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-114" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb1814-115"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-115" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(i)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1814-116"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-116" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1814-117"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1814-118"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>), </span>
<span id="cb1814-119"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-119" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1814-120"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">5</span>, <span class="at">xend =</span> .<span class="dv">5</span>,</span>
<span id="cb1814-121"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-121" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> <span class="dv">0</span>, </span>
<span id="cb1814-122"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-122" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> my_arrow, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1814-123"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1814-124"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1814-125"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1814-126"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-126" aria-hidden="true" tabindex="-1"></a><span class="co"># some text</span></span>
<span id="cb1814-127"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-127" aria-hidden="true" tabindex="-1"></a>p12 <span class="ot">&lt;-</span></span>
<span id="cb1814-128"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">5</span>,</span>
<span id="cb1814-129"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-129" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> .<span class="dv">5</span>,</span>
<span id="cb1814-130"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-130" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;italic(y[i])&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1814-131"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-131" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1814-132"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1814-133"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1814-134"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1814-135"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1814-136"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1814-137"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1814-138"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-138" aria-hidden="true" tabindex="-1"></a><span class="co"># define the layout</span></span>
<span id="cb1814-139"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-139" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1814-140"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">6</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1814-141"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">b =</span> <span class="dv">3</span>, <span class="at">l =</span> <span class="dv">6</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1814-142"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">3</span>),</span>
<span id="cb1814-143"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1814-144"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">6</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1814-145"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">5</span>, <span class="at">b =</span> <span class="dv">6</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1814-146"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">6</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">9</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb1814-147"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">9</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1814-148"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">8</span>, <span class="at">b =</span> <span class="dv">9</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1814-149"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">8</span>, <span class="at">b =</span> <span class="dv">9</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb1814-150"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">11</span>, <span class="at">b =</span> <span class="dv">11</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1814-151"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">12</span>, <span class="at">b =</span> <span class="dv">12</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>)</span>
<span id="cb1814-152"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-152" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1814-153"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1814-154"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-154" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot!</span></span>
<span id="cb1814-155"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-155" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p6 <span class="sc">+</span> p5 <span class="sc">+</span> p7 <span class="sc">+</span> p9 <span class="sc">+</span> p8 <span class="sc">+</span> p10 <span class="sc">+</span> p11 <span class="sc">+</span> p12) <span class="sc">+</span> </span>
<span id="cb1814-156"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout) <span class="sc">&amp;</span></span>
<span id="cb1814-157"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb1814-158"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1814-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>, <span class="fl">5.5</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-8-1.png" width="624" style="display: block; margin: auto;" /></p>
<p>Later on in the text, Kruschke opined:</p>
<blockquote>
<p>A crucial pre-requisite for estimating <span class="math inline">\(\sigma_\beta\)</span> from all the groups is an assumption that all the groups are representative and informative for the estimate. It only makes sense to influence the estimate of one group with data from the other groups if the groups can be meaningfully described as representative of a shared higher-level distribution. (p. 559)</p>
</blockquote>
<p>Although I agree with him in spirit, this doesn’t appear to strictly be the case. As odd and paradoxical as this sounds, partial pooling can be of use even when the some of the cases are of a different kind. For more on the topic, see Efron and Morris’s classic <span class="citation">(<a href="#ref-efronSteinParadoxStatistics1977" role="doc-biblioref">1977</a>)</span> paper, <a href="http://statweb.stanford.edu/~ckirby/brad/other/Article1977.pdf"><em>Stein’s paradox in statistics</em></a>, and <a href="https://solomonkurz.netlify.com/post/stein-s-paradox-and-what-partial-pooling-can-do-for-you/">my blog post</a> walking out one of their examples in <strong>brms</strong>.</p>
<div id="implementation-in-jags-brms." class="section level3 hasAnchor" number="19.3.1">
<h3><span class="header-section-number">19.3.1</span> Implementation in <del>JAGS</del> brms.<a href="metric-predicted-variable-with-one-nominal-predictor.html#implementation-in-jags-brms." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>brms</strong> setup, of course, differs a bit from JAGS.</p>
<div class="sourceCode" id="cb1815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1815-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1815-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> </span>
<span id="cb1815-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1815-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data, </span>
<span id="cb1815-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1815-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1815-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1815-4" aria-hidden="true" tabindex="-1"></a>      y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> categirical_variable),</span>
<span id="cb1815-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1815-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, x), <span class="at">class =</span> Intercept),</span>
<span id="cb1815-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1815-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, x), <span class="at">class =</span> b),</span>
<span id="cb1815-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1815-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, x), <span class="at">class =</span> sd),</span>
<span id="cb1815-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1815-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, x), <span class="at">class =</span> sigma)))</span></code></pre></div>
<p>The noise standard deviation <span class="math inline">\(\sigma_y\)</span> is depicted in the prior statement including the argument <code>class = sigma</code>. The grand mean is depicted by the first <code>1</code> in the model formula and its prior is indicated by the <code>class = Intercept</code> argument. We indicate we’d like group-based deviations from the grand mean with the <code>(1 | categirical_variable)</code> syntax, where the <code>1</code> on the left side of the bar indicates we’d like our intercepts to vary by group and the <code>categirical_variable</code> part simply represents the name of a given categorical variable we’d like those intercepts to vary by. The <strong>brms</strong> default is to do this with deviance scores, the mean for which will be zero. Although it’s not obvious in the formula syntax, the model presumes the group-based deviations are normally distributed with a mean of zero and a standard deviation, which Kruschke termed <span class="math inline">\(\sigma_\beta\)</span>. There is no prior for the mean. It’s set at zero. But there is a prior for <span class="math inline">\(\sigma_\beta\)</span>, which is denoted by the argument <code>class = sd</code>. We, of course, are not using a uniform prior on any of our variance parameters. But in order to be weakly informative, we will use the half-Cauchy. Recall that since the <strong>brms</strong> default is to set the lower bound for any variance parameter to 0, there’s no need to worry about doing so ourselves. So even though the syntax only indicates <code>cauchy</code>, it’s understood to mean Cauchy with a lower bound at zero; since the mean is usually 0, that makes is a half-Cauchy.</p>
<p>Kruschke set the upper bound for his <span class="math inline">\(\sigma_y\)</span> to 10 times the standard deviation of the criterion variable. The tails of the half-Cauchy are sufficiently fat that, in practice, I’ve found it doesn’t matter much what you set the <span class="math inline">\(\textit{SD}\)</span> of its prior to. One is often a sensible default for reasonably-scaled data. But if we want to take a more principled approach, we can set it to the size of the criterion’s <span class="math inline">\(\textit{SD}\)</span> or perhaps even 10 times that value.</p>
<p>Kruschke suggested using a gamma on <span class="math inline">\(\sigma_\beta\)</span>, which is a sensible alternative to half-Cauchy often used within the Stan universe. Especially in situations in which you would like to (a) keep the variance parameter above zero, but (b) still allow it to be arbitrarily close to zero, and also (c) let the likelihood dominate the posterior, the Stan team recommends the <span class="math inline">\(\operatorname{Gamma}(2, 0)\)</span> prior, based on the paper by Chung and colleagues <span class="citation">(<a href="#ref-chungNondegeneratePenalizedLikelihood2013" role="doc-biblioref">2013</a>, click <a href="http://www.stat.columbia.edu/~gelman/research/published/chung_etal_Pmetrika2013.pdf" role="doc-biblioref">here</a>)</span>. But you should note that I don’t mean a literal 0 for the second parameter in the gamma distribution, but rather some small value like 0.1 or so. This is all clarified in <span class="citation">Chung et al. (<a href="#ref-chungNondegeneratePenalizedLikelihood2013" role="doc-biblioref">2013</a>)</span>. Here’s what <span class="math inline">\(\operatorname{Gamma}(2, 0.1)\)</span> looks like.</p>
<div class="sourceCode" id="cb1816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1816-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1816-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">110</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1816-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1816-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1816-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1816-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">dgamma</span>(x, <span class="dv">2</span>, <span class="fl">0.1</span>))) <span class="sc">+</span></span>
<span id="cb1816-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1816-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">10</span>]) <span class="sc">+</span></span>
<span id="cb1816-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1816-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, </span>
<span id="cb1816-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1816-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">14.25</span>, <span class="at">y =</span> <span class="fl">0.015</span>, <span class="at">label =</span> <span class="st">&quot;&#39;Gamma&#39;*(2*&#39;, &#39;*0.1)&quot;</span>, </span>
<span id="cb1816-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1816-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">parse =</span> T, <span class="at">color =</span> pp[<span class="dv">1</span>], <span class="at">size =</span> <span class="fl">4.25</span>) <span class="sc">+</span></span>
<span id="cb1816-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1816-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">110</span>)) <span class="sc">+</span></span>
<span id="cb1816-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1816-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>)))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>If you’d like that prior be even less informative, just reduce it to like <span class="math inline">\(\operatorname{Gamma}(2, 0.01)\)</span> or so. Kruschke goes further to recommend “the shape and rate parameters of the gamma distribution are set so its mode is <code>sd(y)/2</code> and its standard deviation is <code>2*sd(y)</code>, using the function <code>gammaShRaFromModeSD</code> explained in <a href="hierarchical-models.html#a-realistic-model-with-mcmc.">Section 9.2.2</a>.” (pp. 560–561). Let’s make that function.</p>
<div class="sourceCode" id="cb1817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1817-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1817-1" aria-hidden="true" tabindex="-1"></a>gamma_a_b_from_omega_sigma <span class="ot">&lt;-</span> <span class="cf">function</span>(mode, sd) {</span>
<span id="cb1817-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1817-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1817-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1817-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (mode <span class="sc">&lt;=</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">&quot;mode must be &gt; 0&quot;</span>)</span>
<span id="cb1817-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1817-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (sd   <span class="sc">&lt;=</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">&quot;sd must be &gt; 0&quot;</span>)</span>
<span id="cb1817-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1817-5" aria-hidden="true" tabindex="-1"></a>  rate <span class="ot">&lt;-</span> (mode <span class="sc">+</span> <span class="fu">sqrt</span>(mode<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sd<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sd<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1817-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1817-6" aria-hidden="true" tabindex="-1"></a>  shape <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> mode <span class="sc">*</span> rate</span>
<span id="cb1817-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1817-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">shape =</span> shape, <span class="at">rate =</span> rate))</span>
<span id="cb1817-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1817-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1817-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1817-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>So in the case of standardized data where <code>sd(1)</code> = 1, we’d use our <code>gamma_a_b_from_omega_sigma()</code> function like so.</p>
<div class="sourceCode" id="cb1818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1818-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1818-1" aria-hidden="true" tabindex="-1"></a>sd_y  <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb1818-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1818-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1818-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1818-3" aria-hidden="true" tabindex="-1"></a>omega <span class="ot">&lt;-</span> sd_y <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb1818-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1818-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> sd_y</span>
<span id="cb1818-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1818-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1818-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1818-6" aria-hidden="true" tabindex="-1"></a>(s_r <span class="ot">&lt;-</span> <span class="fu">gamma_a_b_from_omega_sigma</span>(<span class="at">mode =</span> omega, <span class="at">sd =</span> sigma))</span></code></pre></div>
<pre><code>## $shape
## [1] 1.283196
## 
## $rate
## [1] 0.5663911</code></pre>
<p>And that produces the following gamma distribution.</p>
<div class="sourceCode" id="cb1820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1820-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1820-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">21</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1820-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1820-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1820-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1820-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">dgamma</span>(x, s_r<span class="sc">$</span>shape, s_r<span class="sc">$</span>rate))) <span class="sc">+</span></span>
<span id="cb1820-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1820-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">8</span>]) <span class="sc">+</span></span>
<span id="cb1820-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1820-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, </span>
<span id="cb1820-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1820-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">2.75</span>, <span class="at">y =</span> <span class="fl">0.02</span>, <span class="at">label =</span> <span class="st">&quot;&#39;Gamma&#39;*(1.283196*&#39;, &#39;*0.5663911)&quot;</span>, </span>
<span id="cb1820-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1820-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">parse =</span> T, <span class="at">color =</span> pp[<span class="dv">7</span>], <span class="at">size =</span> <span class="fl">2.75</span>) <span class="sc">+</span></span>
<span id="cb1820-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1820-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb1820-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1820-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>)))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-13-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In the parameter space that matters, from zero to one, that gamma is pretty noninformative. It peaks between the two, slopes very gently rightward, but has the nice steep slope on the left keeping the estimates off the zero boundary. And even though that right slope is very gentle given the scale of the data, it’s aggressive enough that it should keep the MCMC chains from spending a lot of time in ridiculous parts of the parameter space. I.e., when working with finite numbers of iterations, we want our MCMC chains wasting exactly zero iterations investigating what the density might be for <span class="math inline">\(\sigma_\beta \approx 1e10\)</span> for standardized data.</p>
</div>
<div id="example-sex-and-death." class="section level3 hasAnchor" number="19.3.2">
<h3><span class="header-section-number">19.3.2</span> Example: Sex and death.<a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-and-death." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s load and <code>glimpse()</code> at Hanley and Shapiro’s <span class="citation">(<a href="#ref-hanleySexualActivityLifespan1994" role="doc-biblioref">1994</a>)</span> fruit-fly data.</p>
<div class="sourceCode" id="cb1821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1821-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1821-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data.R/FruitflyDataReduced.csv&quot;</span>)</span>
<span id="cb1821-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1821-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1821-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1821-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(my_data)</span></code></pre></div>
<pre><code>## Rows: 125
## Columns: 3
## $ Longevity       &lt;dbl&gt; 35, 37, 49, 46, 63, 39, 46, 56, 63, 65, 56, 65, 70, 63, 65, 70, 77, 81, 86…
## $ CompanionNumber &lt;chr&gt; &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant…
## $ Thorax          &lt;dbl&gt; 0.64, 0.68, 0.68, 0.72, 0.72, 0.76, 0.76, 0.76, 0.76, 0.76, 0.80, 0.80, 0.…</code></pre>
<p>We can use <code>geom_density_ridges()</code> to help get a sense of how our criterion <code>Longevity</code> is distributed across groups of <code>CompanionNumber</code>.</p>
<div class="sourceCode" id="cb1823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1823-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1823-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1823-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1823-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CompanionNumber) <span class="sc">%&gt;%</span> </span>
<span id="cb1823-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1823-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group_mean =</span> <span class="fu">mean</span>(Longevity)) <span class="sc">%&gt;%</span> </span>
<span id="cb1823-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1823-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1823-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1823-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CompanionNumber =</span> <span class="fu">fct_reorder</span>(CompanionNumber, group_mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb1823-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1823-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1823-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1823-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Longevity, <span class="at">y =</span> CompanionNumber, <span class="at">fill =</span> group_mean)) <span class="sc">+</span></span>
<span id="cb1823-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1823-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">scale =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">size =</span> .<span class="dv">2</span>, <span class="at">color =</span> pp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1823-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1823-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> pp[<span class="dv">4</span>], <span class="at">high =</span> pp[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb1823-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1823-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>)), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb1823-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1823-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>))) <span class="sc">+</span></span>
<span id="cb1823-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1823-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1823-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1823-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1823-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1823-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-15-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Let’s fire up <strong>brms</strong>.</p>
<div class="sourceCode" id="cb1824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1824-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1824-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span></code></pre></div>
<p>We’ll want to do the preparatory work to define our <code>stanvars</code>.</p>
<div class="sourceCode" id="cb1825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1825-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1825-1" aria-hidden="true" tabindex="-1"></a>(mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(my_data<span class="sc">$</span>Longevity))</span></code></pre></div>
<pre><code>## [1] 57.44</code></pre>
<div class="sourceCode" id="cb1827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1827-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1827-1" aria-hidden="true" tabindex="-1"></a>(sd_y <span class="ot">&lt;-</span> <span class="fu">sd</span>(my_data<span class="sc">$</span>Longevity))</span></code></pre></div>
<pre><code>## [1] 17.56389</code></pre>
<div class="sourceCode" id="cb1829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1829-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1829-1" aria-hidden="true" tabindex="-1"></a>omega <span class="ot">&lt;-</span> sd_y <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb1829-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1829-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> sd_y</span>
<span id="cb1829-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1829-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1829-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1829-4" aria-hidden="true" tabindex="-1"></a>(s_r <span class="ot">&lt;-</span> <span class="fu">gamma_a_b_from_omega_sigma</span>(<span class="at">mode =</span> omega, <span class="at">sd =</span> sigma))</span></code></pre></div>
<pre><code>## $shape
## [1] 1.283196
## 
## $rate
## [1] 0.03224747</code></pre>
<p>With the prep work is done, here are our <code>stanvars</code>.</p>
<div class="sourceCode" id="cb1831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1831-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1831-1" aria-hidden="true" tabindex="-1"></a>stanvars <span class="ot">&lt;-</span> </span>
<span id="cb1831-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1831-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(mean_y,    <span class="at">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1831-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1831-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(sd_y,      <span class="at">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb1831-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1831-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>shape, <span class="at">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">+</span></span>
<span id="cb1831-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1831-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>rate,  <span class="at">name =</span> <span class="st">&quot;beta&quot;</span>)</span></code></pre></div>
<p>Now fit the model, our hierarchical Bayesian alternative to an ANOVA.</p>
<div class="sourceCode" id="cb1832"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1832-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1832-1" aria-hidden="true" tabindex="-1"></a>fit19<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb1832-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1832-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1832-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1832-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1832-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1832-4" aria-hidden="true" tabindex="-1"></a>      Longevity <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> CompanionNumber),</span>
<span id="cb1832-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1832-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1832-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1832-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">gamma</span>(alpha, beta), <span class="at">class =</span> sd),</span>
<span id="cb1832-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1832-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb1832-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1832-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1832-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1832-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">19</span>,</span>
<span id="cb1832-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1832-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>),</span>
<span id="cb1832-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1832-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars,</span>
<span id="cb1832-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1832-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit19.01&quot;</span>)</span></code></pre></div>
<p>Much like Kruschke’s JAGS chains, our <strong>brms</strong> chains are well behaved, but only after fiddling with the <code>adapt_delta</code> setting.</p>
<div class="sourceCode" id="cb1833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1833-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1833-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb1833-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1833-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1833-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1833-3" aria-hidden="true" tabindex="-1"></a><span class="fu">color_scheme_set</span>(<span class="at">scheme =</span> pp[<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">4</span>)])</span>
<span id="cb1833-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1833-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1833-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1833-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit19<span class="fl">.1</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-19-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Also like Kruschke, our chains appear moderately autocorrelated.</p>
<div class="sourceCode" id="cb1834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1834-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1834-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the posterior draws</span></span>
<span id="cb1834-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1834-2" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit19<span class="fl">.1</span>)</span>
<span id="cb1834-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1834-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1834-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1834-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb1834-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1834-5" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb1834-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1834-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chain =</span> .chain) <span class="sc">%&gt;%</span> </span>
<span id="cb1834-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1834-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mcmc_acf</span>(<span class="at">pars =</span> <span class="fu">vars</span>(b_Intercept<span class="sc">:</span>sigma), <span class="at">lags =</span> <span class="dv">10</span>)</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Here’s the model summary.</p>
<div class="sourceCode" id="cb1835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1835-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1835-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit19<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Longevity ~ 1 + (1 | CompanionNumber) 
##    Data: my_data (Number of observations: 125) 
##   Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup draws = 12000
## 
## Group-Level Effects: 
## ~CompanionNumber (Number of levels: 5) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)    14.92      7.57     6.27    35.82 1.00     2515     3486
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    57.33      7.59    41.70    72.92 1.00     2250     2245
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    14.88      0.95    13.18    16.86 1.00     6571     6625
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>With the <code>ranef()</code> function, we can get the summaries of the group-specific deflections.</p>
<div class="sourceCode" id="cb1837"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1837-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1837-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ranef</span>(fit19<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>## $CompanionNumber
## , , Intercept
## 
##              Estimate Est.Error       Q2.5     Q97.5
## None0       5.8334936  7.942217  -9.693236 22.207219
## Pregnant1   7.0048914  7.901202  -9.030515 23.002838
## Pregnant8   5.6482612  7.906738 -10.335139 21.786660
## Virgin1    -0.5423866  7.836639 -16.720255 14.976009
## Virgin8   -17.4580865  7.947826 -33.885667 -2.249241</code></pre>
<p>And with the <code>coef()</code> function, we can get those same group-level summaries in a non-deflection metric.</p>
<div class="sourceCode" id="cb1839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1839-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1839-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit19<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>## $CompanionNumber
## , , Intercept
## 
##           Estimate Est.Error     Q2.5    Q97.5
## None0     63.16238  2.933578 57.39000 68.96544
## Pregnant1 64.33378  2.951117 58.50962 70.17887
## Pregnant8 62.97715  2.921190 57.26046 68.76300
## Virgin1   56.78650  2.896133 51.16755 62.52056
## Virgin8   39.87080  3.032215 33.83380 45.73514</code></pre>
<p>Those are all estimates of the group-specific means. Since it wasn’t modeled, all have the same parameter estimates for <span class="math inline">\(\sigma_y\)</span>.</p>
<div class="sourceCode" id="cb1841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1841-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1841-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit19<span class="fl">.1</span>)[<span class="st">&quot;sigma&quot;</span>, ]</span></code></pre></div>
<pre><code>##   Estimate  Est.Error       Q2.5      Q97.5 
## 14.8816737  0.9459512 13.1836374 16.8615943</code></pre>
<p>To prepare for our version of the top panel of Figure 19.3, we’ll use <code>slice_sample()</code> to randomly sample from the posterior draws, saving the subset as <code>draws_20</code>.</p>
<div class="sourceCode" id="cb1843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1843-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1843-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many random draws from the posterior would you like?</span></span>
<span id="cb1843-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1843-2" aria-hidden="true" tabindex="-1"></a>n_draws <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb1843-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1843-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1843-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1843-4" aria-hidden="true" tabindex="-1"></a><span class="co"># subset</span></span>
<span id="cb1843-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1843-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">19</span>)</span>
<span id="cb1843-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1843-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1843-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1843-7" aria-hidden="true" tabindex="-1"></a>draws_20 <span class="ot">&lt;-</span></span>
<span id="cb1843-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1843-8" aria-hidden="true" tabindex="-1"></a>  draws <span class="sc">%&gt;%</span> </span>
<span id="cb1843-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1843-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> n_draws, <span class="at">replace =</span> F)</span>
<span id="cb1843-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1843-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1843-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1843-11" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(draws_20)</span></code></pre></div>
<pre><code>## Rows: 20
## Columns: 13
## $ b_Intercept                              &lt;dbl&gt; 59.79337, 68.08343, 65.87654, 49.78539, 61.36588,…
## $ sd_CompanionNumber__Intercept            &lt;dbl&gt; 9.746157, 21.206450, 12.517377, 22.193778, 13.077…
## $ sigma                                    &lt;dbl&gt; 13.96830, 14.94739, 15.45839, 14.55226, 15.96590,…
## $ `r_CompanionNumber[None0,Intercept]`     &lt;dbl&gt; 0.5159277, -5.8309287, -2.9403040, 12.0782556, 2.…
## $ `r_CompanionNumber[Pregnant1,Intercept]` &lt;dbl&gt; 4.9800818, -1.4330721, -3.5383401, 10.5176174, 2.…
## $ `r_CompanionNumber[Pregnant8,Intercept]` &lt;dbl&gt; 6.158075, -7.063172, -1.633937, 10.781149, 1.1145…
## $ `r_CompanionNumber[Virgin1,Intercept]`   &lt;dbl&gt; -2.6577022, -12.3264394, -5.4096473, 7.5111997, -…
## $ `r_CompanionNumber[Virgin8,Intercept]`   &lt;dbl&gt; -17.697159, -28.331720, -21.037003, -13.096651, -…
## $ lprior                                   &lt;dbl&gt; -13.17332, -13.38440, -13.27956, -13.37765, -13.3…
## $ lp__                                     &lt;dbl&gt; -528.6157, -525.9077, -529.4408, -526.6029, -528.…
## $ .chain                                   &lt;int&gt; 3, 4, 2, 3, 1, 2, 2, 4, 1, 4, 4, 4, 2, 4, 2, 2, 3…
## $ .iteration                               &lt;int&gt; 1677, 910, 1483, 1557, 2745, 1803, 2677, 1255, 26…
## $ .draw                                    &lt;int&gt; 7677, 9910, 4483, 7557, 2745, 4803, 5677, 10255, …</code></pre>
<p>Before we make our version of the top panel, let’s make a corresponding plot of the fixed intercept, the grand mean. The most important lines in the code, below are the ones where we used <code>stat_function()</code> within <code>mapply()</code>.</p>
<div class="sourceCode" id="cb1845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1845-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">150</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1845-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1845-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb1845-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mapply</span>(<span class="cf">function</span>(mean, sd) {</span>
<span id="cb1845-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun   =</span> dnorm, </span>
<span id="cb1845-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">args  =</span> <span class="fu">list</span>(<span class="at">mean =</span> mean, <span class="at">sd =</span> sd), </span>
<span id="cb1845-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, </span>
<span id="cb1845-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size  =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,</span>
<span id="cb1845-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> pp[<span class="dv">4</span>])</span>
<span id="cb1845-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-10" aria-hidden="true" tabindex="-1"></a>    }, </span>
<span id="cb1845-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># enter means and standard deviations here</span></span>
<span id="cb1845-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> draws_20 <span class="sc">%&gt;%</span> <span class="fu">pull</span>(b_Intercept),</span>
<span id="cb1845-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd   =</span> draws_20 <span class="sc">%&gt;%</span> <span class="fu">pull</span>(sigma)</span>
<span id="cb1845-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb1845-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> my_data, <span class="fu">aes</span>(<span class="at">x =</span> Longevity, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.001</span>),</span>
<span id="cb1845-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">height =</span> .<span class="dv">001</span>, </span>
<span id="cb1845-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span> pp[<span class="dv">10</span>]) <span class="sc">+</span></span>
<span id="cb1845-18"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;Longevity&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">25</span>,</span>
<span id="cb1845-19"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))) <span class="sc">+</span></span>
<span id="cb1845-20"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1845-21"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Posterior Predictive Distribution&quot;</span>,</span>
<span id="cb1845-22"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;The jittered dots are the ungrouped Longevity data. The</span><span class="sc">\n</span><span class="st">Gaussians are posterior draws depicting the overall</span><span class="sc">\n</span><span class="st">distribution, the grand mean.&quot;</span>) <span class="sc">+</span></span>
<span id="cb1845-23"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1845-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">110</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-26-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Unfortunately, we can’t extend our <code>mapply(stat_function())</code> method to the group-level estimates. To my knowledge, there isn’t a way to show the group estimates at different spots along the y-axis. And our <code>mapply(stat_function())</code> approach has other limitations, too. Happily, we have some great alternatives. To use them, we’ll need a little help from <strong>tidybayes</strong>.</p>
<div class="sourceCode" id="cb1846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1846-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1846-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span></code></pre></div>
<p>For the first part, we’ll take <code>tidybayes::add_epred_draws()</code> for a whirl.</p>
<div class="sourceCode" id="cb1847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1847-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1847-1" aria-hidden="true" tabindex="-1"></a>densities <span class="ot">&lt;-</span></span>
<span id="cb1847-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1847-2" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1847-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1847-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(CompanionNumber) <span class="sc">%&gt;%</span> </span>
<span id="cb1847-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1847-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_epred_draws</span>(fit19<span class="fl">.1</span>, <span class="at">ndraws =</span> <span class="dv">20</span>, <span class="at">seed =</span> <span class="dv">19</span>, <span class="at">dpar =</span> <span class="fu">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>))</span>
<span id="cb1847-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1847-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1847-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1847-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(densities)</span></code></pre></div>
<pre><code>## Rows: 100
## Columns: 8
## Groups: CompanionNumber, .row [5]
## $ CompanionNumber &lt;chr&gt; &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant…
## $ .row            &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2,…
## $ .chain          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration      &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw           &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 1, …
## $ .epred          &lt;dbl&gt; 63.46305, 61.49345, 68.17744, 62.48045, 61.84531, 63.64695, 64.24260, 60.6…
## $ mu              &lt;dbl&gt; 63.46305, 61.49345, 68.17744, 62.48045, 61.84531, 63.64695, 64.24260, 60.6…
## $ sigma           &lt;dbl&gt; 13.93148, 13.77736, 13.20789, 15.96590, 14.70948, 14.86626, 15.45839, 14.8…</code></pre>
<p>With the first two lines, we made a <span class="math inline">\(5 \times 1\)</span> tibble containing the five levels of the experimental grouping variable, <code>CompanionNumber</code>. The <code>add_epred_draws()</code> function comes from <strong>tidybayes</strong> <span class="citation">(see the <a href="https://mjskay.github.io/tidybayes/articles/tidy-brms.html#posterior-fits" role="doc-biblioref">Posterior fits</a> section of <a href="#ref-kayExtractingVisualizingTidy2021" role="doc-biblioref">Kay, 2021</a>)</span>. The first argument of the <code>add_epred_draws()</code> is <code>newdata</code>, which works much like it does in <code>brms::fitted()</code>; it took our <span class="math inline">\(5 \times 1\)</span> tibble. The next argument took our <strong>brms</strong> model fit, <code>fit19.1</code>. With the <code>ndraws</code> argument, we indicated we just wanted 20 random draws from the posterior. The <code>seed</code> argument makes those random draws reproducible. With <code>dpar</code>, we requested distributional regression parameters in the output. In our case, those were the <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> values for each level of <code>CompanionNumber</code>. Since we took 20 draws across 5 groups, we ended up with a 100-row tibble.</p>
<p>The next steps are a direct extension of the method we used to make our Gaussians for our version of Figure 19.1.</p>
<div class="sourceCode" id="cb1849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1849-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1849-1" aria-hidden="true" tabindex="-1"></a>densities <span class="ot">&lt;-</span></span>
<span id="cb1849-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1849-2" aria-hidden="true" tabindex="-1"></a>  densities <span class="sc">%&gt;%</span> </span>
<span id="cb1849-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1849-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ll =</span> <span class="fu">qnorm</span>(.<span class="dv">025</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma),</span>
<span id="cb1849-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1849-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">ul =</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb1849-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1849-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Longevity =</span> <span class="fu">map2</span>(ll, ul, seq, <span class="at">length.out =</span> <span class="dv">100</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1849-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1849-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(Longevity) <span class="sc">%&gt;%</span> </span>
<span id="cb1849-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1849-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dnorm</span>(Longevity, mu, sigma))</span>
<span id="cb1849-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1849-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1849-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1849-9" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(densities)</span></code></pre></div>
<pre><code>## Rows: 10,000
## Columns: 12
## Groups: CompanionNumber, .row [5]
## $ CompanionNumber &lt;chr&gt; &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant…
## $ .row            &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ .chain          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration      &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw           &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ .epred          &lt;dbl&gt; 63.46305, 63.46305, 63.46305, 63.46305, 63.46305, 63.46305, 63.46305, 63.4…
## $ mu              &lt;dbl&gt; 63.46305, 63.46305, 63.46305, 63.46305, 63.46305, 63.46305, 63.46305, 63.4…
## $ sigma           &lt;dbl&gt; 13.93148, 13.93148, 13.93148, 13.93148, 13.93148, 13.93148, 13.93148, 13.9…
## $ ll              &lt;dbl&gt; 36.15784, 36.15784, 36.15784, 36.15784, 36.15784, 36.15784, 36.15784, 36.1…
## $ ul              &lt;dbl&gt; 90.76826, 90.76826, 90.76826, 90.76826, 90.76826, 90.76826, 90.76826, 90.7…
## $ Longevity       &lt;dbl&gt; 36.15784, 36.70947, 37.26109, 37.81271, 38.36433, 38.91595, 39.46757, 40.0…
## $ density         &lt;dbl&gt; 0.004195179, 0.004530160, 0.004884226, 0.005257716, 0.005650899, 0.0060639…</code></pre>
<p>If you look at the code we used to make <code>ll</code> and <code>ul</code>, you’ll see we used 95% intervals, this time. Our second <code>mutate()</code> function is basically the same. After unnesting the tibble, we just needed to plug in the <code>Longevity</code>, <code>mu</code>, and <code>sigma</code> values into the <code>dnorm()</code> function to compute the corresponding density values.</p>
<div class="sourceCode" id="cb1851"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1851-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1851-1" aria-hidden="true" tabindex="-1"></a>densities <span class="sc">%&gt;%</span> </span>
<span id="cb1851-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1851-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Longevity, <span class="at">y =</span> CompanionNumber)) <span class="sc">+</span></span>
<span id="cb1851-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1851-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here we make our density lines</span></span>
<span id="cb1851-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1851-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ridgeline</span>(<span class="fu">aes</span>(<span class="at">height =</span> density, <span class="at">group =</span> <span class="fu">interaction</span>(CompanionNumber, .draw)),</span>
<span id="cb1851-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1851-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="fu">adjustcolor</span>(pp[<span class="dv">4</span>], <span class="at">alpha.f =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb1851-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1851-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">scale =</span> <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1851-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1851-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the original data with little jitter thrown in</span></span>
<span id="cb1851-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1851-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1851-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1851-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">height =</span> .<span class="dv">04</span>, <span class="at">alpha =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span> pp[<span class="dv">10</span>]) <span class="sc">+</span></span>
<span id="cb1851-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1851-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pretty much everything below this line is aesthetic fluff</span></span>
<span id="cb1851-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1851-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">25</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">110</span>), </span>
<span id="cb1851-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1851-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))) <span class="sc">+</span></span>
<span id="cb1851-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1851-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Data with Posterior Predictive Distrib.&quot;</span>, </span>
<span id="cb1851-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1851-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1851-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1851-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.25</span>, <span class="fl">5.25</span>)) <span class="sc">+</span></span>
<span id="cb1851-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1851-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1851-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1851-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-30-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Do be aware that when you use this method, you may have to fiddle around with the <code>geom_ridgeline()</code> <code>scale</code> argument to get the Gaussian’s heights on reasonable-looking relative heights. Stick in different numbers to get a sense of what I mean. I also find that I’m often not a fan of the way the spacing on the y axis ends up with default <code>geom_ridgeline()</code>. It’s easy to overcome this with a little <code>ylim</code> fiddling.</p>
<p>To return to the more substantive interpretation, the top panel of</p>
<blockquote>
<p>Figure 19.3 suggests that the normal distributions with homogeneous variances appear to be reasonable descriptions of the data. There are no dramatic outliers relative to the posterior predicted curves, and the spread of the data within each group appears to be reasonably matched by the width of the posterior normal curves. (Be careful when making visual assessments of homogeneity of variance because the visual spread of the data depends on the sample size; for a reminder see the [see the right panel of Figure 17.1, p. 478].) The range of credible group means, indicated by the peaks of the normal curves, suggests that the group Virgin8 is clearly lower than the others, and the group Virgin1 might be lower than the controls. To find out for sure, we need to examine the differences of group means, which we do in the next section. (p. 564)</p>
</blockquote>
<p>For clarity, the “see the right panel of Figure 17.1, p. 478” part was changed following Kruschke’s <a href="https://sites.google.com/site/doingbayesiandataanalysis/corrigenda">Corrigenda</a>.</p>
</div>
<div id="contrasts." class="section level3 hasAnchor" number="19.3.3">
<h3><span class="header-section-number">19.3.3</span> Contrasts.<a href="metric-predicted-variable-with-one-nominal-predictor.html#contrasts." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>It is straight forward to examine the posterior distribution of credible differences. Every step in the MCMC chain provides a combination of group means that are jointly credible, given the data. Therefore, every step in the MCMC chain provides a credible difference between groups…</p>
<p>To construct the credible differences of group <span class="math inline">\(1\)</span> and group <span class="math inline">\(2\)</span>, at every step in the MCMC chain we compute</p>
<p><span class="math display">\[\begin{align*}
\mu_1 - \mu_2 &amp; =  (\beta_0 + \beta_1) - (\beta_0 + \beta_2) \\
              &amp; =  (+1) \cdot \beta_1 + (-1) \cdot \beta_2
\end{align*}\]</span></p>
<p>In other words, the baseline cancels out of the calculation, and the difference is a sum of weighted group deflections. Notice that the weights sum to zero. To construct the credible differences of the average of groups <span class="math inline">\(1\)</span>-<span class="math inline">\(3\)</span> and the average of groups <span class="math inline">\(4\)</span>-<span class="math inline">\(5\)</span>, at every step in the MCMC chain we compute</p>
<p><span class="math display">\[\begin{align*}
\small{(\mu_1 + \mu_2 + \mu_3) / 3 - (\mu_4 + \mu_5) / 2} &amp; = \small{((\beta_0 + \beta_1)  + (\beta_0 + \beta_2)  + (\beta_0 + \beta_3) ) / 3 - ((\beta_0 + \beta_4) + (\beta_0 + \beta_5) ) / 2} \\
&amp; = \small{(\beta_1 + \beta_2 + \beta_3) / 3 - (\beta_4 + \beta_5) / 2} \\
&amp; = \small{(+ 1/3) \cdot \beta_1 + (+ 1/3) \cdot \beta_2 + (+ 1/3) \cdot \beta_3 + (- 1/2) \cdot \beta_4 + (- 1/2) \cdot \beta_5}
\end{align*}\]</span></p>
<p>Again, the difference is a sum of weighted group deflections. The coefficients on the group deflections have the properties that they sum to zero, with the positive coefficients summing to <span class="math inline">\(+1\)</span> and the negative coefficients summing to <span class="math inline">\(−1\)</span>. Such a combination is called a contrast. The differences can also be expressed in terms of effect size, by dividing the difference by <span class="math inline">\(\sigma_y\)</span> at each step in the chain. (pp. 565–566)</p>
</blockquote>
<p>To warm up, here’s how to compute the first contrast shown in the lower portion of Kruschke’s Figure 19.3–the contrast between the two pregnant conditions and the none-control condition.</p>
<div class="sourceCode" id="cb1852"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1852-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1852-1" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb1852-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1852-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">c =</span> (<span class="st">`</span><span class="at">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">r_CompanionNumber[Pregnant8,Intercept]</span><span class="st">`</span>) <span class="sc">/</span> <span class="dv">2</span> <span class="sc">-</span> <span class="st">`</span><span class="at">r_CompanionNumber[None0,Intercept]</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1852-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1852-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1852-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1852-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> c, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1852-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1852-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1852-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1852-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_color =</span> pp[<span class="dv">5</span>], <span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1852-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1852-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1852-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1852-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Pregnant1.Pregnant8 vs None0&quot;</span>,</span>
<span id="cb1852-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1852-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(Difference<span class="sc">~</span>(mu[<span class="dv">1</span>]<span class="sc">+</span>mu[<span class="dv">2</span>])<span class="sc">/</span><span class="dv">2</span><span class="sc">-</span>mu[<span class="dv">3</span>]))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-31-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>Up to this point, our primary mode of showing marginal posterior distributions has either been minute variations on Kruschke’s typical histogram approach or with densities. We’ll use those again in the future, too. In this chapter and the next, we’ll veer a little further from the source material and depict our marginal posteriors with dot plots and their very close relatives, quantile plots. In the dot plot, above, each of the 4,000 posterior draws is depicted by one of the stacked brown dots. To stack the dots in neat columns like that, <strong>tidybayes</strong> has to round a little. Though we lose something in the numeric precision, we gain a lot in interpretability. We’ll have more to say in just a moment.</p>
<p>In case you were curious, here are the HMC-based posterior mode and 95% HDIs.</p>
<div class="sourceCode" id="cb1853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1853-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1853-1" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb1853-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1853-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">difference =</span> (<span class="st">`</span><span class="at">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">r_CompanionNumber[Pregnant8,Intercept]</span><span class="st">`</span>) <span class="sc">/</span> <span class="dv">2</span> <span class="sc">-</span> <span class="st">`</span><span class="at">r_CompanionNumber[None0,Intercept]</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1853-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1853-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1853-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1853-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mode_hdi</span>(difference)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   difference .lower .upper .width .point .interval
##        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1     0.0876  -6.69   7.25   0.95 mode   hdi</code></pre>
<p>Little difference, there. Now let’s quantify the same contrast as a standardized mean difference effect size.</p>
<div class="sourceCode" id="cb1855"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1855-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1855-1" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb1855-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1855-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">es =</span> ((<span class="st">`</span><span class="at">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">r_CompanionNumber[Pregnant8,Intercept]</span><span class="st">`</span>) <span class="sc">/</span> <span class="dv">2</span> <span class="sc">-</span> <span class="st">`</span><span class="at">r_CompanionNumber[None0,Intercept]</span><span class="st">`</span>) <span class="sc">/</span> sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb1855-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1855-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1855-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1855-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> es, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1855-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1855-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1855-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1855-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">color =</span> pp[<span class="dv">4</span>], </span>
<span id="cb1855-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1855-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1855-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1855-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1855-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1855-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Pregnant1.Pregnant8 vs None0&quot;</span>,</span>
<span id="cb1855-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1855-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(Effect<span class="sc">~</span>Size<span class="sc">~</span>(Difference<span class="sc">/</span>sigma[<span class="fu">italic</span>(y)])))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-33-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>From a standardized-mean-difference perspective, that’s tiny. Also note that because our model <code>fit19.1</code> did not allow the standard deviation parameter <span class="math inline">\(\sigma_y\)</span> to vary across groups, <span class="math inline">\(\sigma_y\)</span> is effectively a pooled standard deviation (<span class="math inline">\(\sigma_p\)</span>).</p>
<p>Did you notice the <code>quantiles = 100</code> argument within <code>stat_dotsinterval()</code>? Instead of a dot plot with 4,000 tiny little dots, that argument converted the output to a quantile plot. The 4,000 posterior draws are now summarized by 100 dots, each of which represents <span class="math inline">\(1\%\)</span> of the total sample <span class="citation">Fernandes et al. (<a href="#ref-fernandesUncertaintyDisplaysUsing2018" role="doc-biblioref">2018</a>)</span>. This quantile dot-plot method will be our main approach for the rest of the chapter.</p>
<p>Okay, now let’s do the rest in bulk. First we’ll do the difference scores.</p>
<div class="sourceCode" id="cb1856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1856-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-1" aria-hidden="true" tabindex="-1"></a>differences <span class="ot">&lt;-</span></span>
<span id="cb1856-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-2" aria-hidden="true" tabindex="-1"></a>  draws <span class="sc">%&gt;%</span> </span>
<span id="cb1856-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="st">`</span><span class="at">Pregnant1.Pregnant8.None0 vs Virgin1</span><span class="st">`</span> <span class="ot">=</span> (<span class="st">`</span><span class="at">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">r_CompanionNumber[Pregnant8,Intercept]</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">r_CompanionNumber[None0,Intercept]</span><span class="st">`</span>) <span class="sc">/</span> <span class="dv">3</span> <span class="sc">-</span> <span class="st">`</span><span class="at">r_CompanionNumber[Virgin1,Intercept]</span><span class="st">`</span>,</span>
<span id="cb1856-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-4" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1856-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Virgin1 vs Virgin8</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">r_CompanionNumber[Virgin1,Intercept]</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">r_CompanionNumber[Virgin8,Intercept]</span><span class="st">`</span>,</span>
<span id="cb1856-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-6" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1856-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Pregnant1.Pregnant8.None0 vs Virgin1.Virgin8</span><span class="st">`</span> <span class="ot">=</span> (<span class="st">`</span><span class="at">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">r_CompanionNumber[Pregnant8,Intercept]</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">r_CompanionNumber[None0,Intercept]</span><span class="st">`</span>) <span class="sc">/</span> <span class="dv">3</span> <span class="sc">-</span> (<span class="st">`</span><span class="at">r_CompanionNumber[Virgin1,Intercept]</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">r_CompanionNumber[Virgin8,Intercept]</span><span class="st">`</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb1856-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1856-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-9" aria-hidden="true" tabindex="-1"></a>differences <span class="sc">%&gt;%</span> </span>
<span id="cb1856-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1856-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1856-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1856-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1856-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">color =</span> pp[<span class="dv">4</span>], </span>
<span id="cb1856-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1856-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1856-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Difference&quot;</span>) <span class="sc">+</span></span>
<span id="cb1856-18"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1856-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-34-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Because we save our data wrangling labor from above as <code>differences</code>, it won’t take much more effort to compute and plot the corresponding effect sizes as displayed in the bottom row of Figure 19.3.</p>
<div class="sourceCode" id="cb1857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1857-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1857-1" aria-hidden="true" tabindex="-1"></a>differences <span class="sc">%&gt;%</span> </span>
<span id="cb1857-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1857-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="at">.funs =</span> <span class="sc">~</span> . <span class="sc">/</span> draws<span class="sc">$</span>sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb1857-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1857-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1857-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1857-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1857-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1857-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1857-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1857-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1857-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1857-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">color =</span> pp[<span class="dv">4</span>], </span>
<span id="cb1857-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1857-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1857-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1857-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1857-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1857-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Effect Size (Standardized mean difference)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1857-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1857-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>)</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-35-1.png" width="768" style="display: block; margin: auto;" /></p>
<blockquote>
<p>In traditional ANOVA, analysts often perform a so-called omnibus test that asks whether it is plausible that all the groups are simultaneously exactly equal. I find that the omnibus test is rarely meaningful, however…. In the hierarchical Bayesian estimation used here, there is no direct equivalent to an omnibus test in ANOVA, and the emphasis is on examining all the meaningful contrasts. (p. 567)</p>
</blockquote>
<p>Speaking of all meaningful contrasts, if you’d like to make all pairwise comparisons in a hierarchical model of this form, <strong>tidybayes</strong> offers a convenient way to do so <span class="citation">(see the <a href="https://mjskay.github.io/tidybayes/articles/tidy-brms.html#comparing-levels-of-a-factor" role="doc-biblioref">Comparing levels of a factor</a> section of <a href="#ref-kayExtractingVisualizingTidy2021" role="doc-biblioref">Kay, 2021</a>)</span>. Here we’ll demonstrate with <code>stat_dotsinterval()</code>.</p>
<div class="sourceCode" id="cb1858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1858-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1858-1" aria-hidden="true" tabindex="-1"></a>fit19<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb1858-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1858-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># these two lines are where the magic is at</span></span>
<span id="cb1858-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1858-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread_draws</span>(r_CompanionNumber[CompanionNumber,]) <span class="sc">%&gt;%</span></span>
<span id="cb1858-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1858-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compare_levels</span>(r_CompanionNumber, <span class="at">by =</span> CompanionNumber) <span class="sc">%&gt;%</span></span>
<span id="cb1858-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1858-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1858-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1858-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> r_CompanionNumber, <span class="at">y =</span> CompanionNumber)) <span class="sc">+</span></span>
<span id="cb1858-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1858-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> pp[<span class="dv">12</span>]) <span class="sc">+</span></span>
<span id="cb1858-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1858-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1858-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1858-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">color =</span> pp[<span class="dv">4</span>], </span>
<span id="cb1858-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1858-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1858-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1858-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Contrast&quot;</span>,</span>
<span id="cb1858-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1858-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1858-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1858-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">10.5</span>)) <span class="sc">+</span></span>
<span id="cb1858-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1858-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-36-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>But back to that omnibus test notion. If you really wanted to, I suppose one rough analogue would be to use information criteria to compare the hierarchical model to one that includes a single intercept with no group-level deflections. Here’s what the simpler model would look like.</p>
<div class="sourceCode" id="cb1859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1859-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1859-1" aria-hidden="true" tabindex="-1"></a>fit19<span class="fl">.2</span> <span class="ot">&lt;-</span></span>
<span id="cb1859-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1859-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1859-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1859-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1859-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1859-4" aria-hidden="true" tabindex="-1"></a>      Longevity <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb1859-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1859-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1859-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1859-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb1859-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1859-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1859-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1859-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">19</span>,</span>
<span id="cb1859-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1859-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars,</span>
<span id="cb1859-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1859-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit19.02&quot;</span>)</span></code></pre></div>
<p>Check the model summary.</p>
<div class="sourceCode" id="cb1860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1860-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1860-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit19<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Longevity ~ 1 
##    Data: my_data (Number of observations: 125) 
##   Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup draws = 12000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    57.46      1.58    54.38    60.51 1.00     9769     8125
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    17.66      1.15    15.60    20.14 1.00    10864     7660
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Here are their LOO values and their difference score.</p>
<div class="sourceCode" id="cb1862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1862-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1862-1" aria-hidden="true" tabindex="-1"></a>fit19<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit19<span class="fl">.1</span>, <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>)</span>
<span id="cb1862-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1862-2" aria-hidden="true" tabindex="-1"></a>fit19<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit19<span class="fl">.2</span>, <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>)</span>
<span id="cb1862-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1862-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1862-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1862-4" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit19<span class="fl">.1</span>, fit19<span class="fl">.2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1862-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1862-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic  se_looic
## fit19.1    0.0       0.0  -517.7      7.0         5.5    0.6   1035.4   13.9  
## fit19.2  -19.3       5.3  -537.0      7.1         1.8    0.3   1074.1   14.2</code></pre>
<p>The hierarchical model has a better LOO. Here are the stacking-based model weights.</p>
<div class="sourceCode" id="cb1864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1864-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1864-1" aria-hidden="true" tabindex="-1"></a>(mw <span class="ot">&lt;-</span> <span class="fu">model_weights</span>(fit19<span class="fl">.1</span>, fit19<span class="fl">.2</span>))</span></code></pre></div>
<pre><code>##      fit19.1      fit19.2 
## 9.999984e-01 1.583495e-06</code></pre>
<p>If you don’t like scientific notation, just <code>round()</code>.</p>
<div class="sourceCode" id="cb1866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1866-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1866-1" aria-hidden="true" tabindex="-1"></a>mw <span class="sc">%&gt;%</span> </span>
<span id="cb1866-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1866-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## fit19.1 fit19.2 
##       1       0</code></pre>
<p>Yep, in complimenting the LOO difference, virtually all the stacking weight went to the hierarchical model. You might think of this another way. The conceptual question we’re asking is: <em>Does it make sense to say that the</em> <span class="math inline">\(\sigma_\beta\)</span> <em>parameter is zero? Is zero a credible value?</em> We’ll, I suppose we could just look at the posterior to assess for that.</p>
<div class="sourceCode" id="cb1868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1868-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1868-1" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb1868-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1868-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sd_CompanionNumber__Intercept, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1868-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1868-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1868-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1868-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">color =</span> pp[<span class="dv">4</span>], </span>
<span id="cb1868-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1868-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1868-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1868-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1868-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1868-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb1868-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1868-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">expression</span>(<span class="st">&quot;Behold the fit19.1 posterior for &quot;</span><span class="sc">*</span>sigma[beta]<span class="sc">*</span><span class="st">&quot;.&quot;</span>),</span>
<span id="cb1868-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1868-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;This parameter&#39;s many things, but zero isn&#39;t one of them.&quot;</span>,</span>
<span id="cb1868-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1868-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-41-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Yeah, zero and other values close to zero don’t look credible for that parameter. 95% of the mass is between 5 and 30, with the bulk hovering around 10. We don’t need an <span class="math inline">\(F\)</span>-test or even a LOO model comparison to see the writing on wall.</p>
</div>
<div id="multiple-comparisons-and-shrinkage." class="section level3 hasAnchor" number="19.3.4">
<h3><span class="header-section-number">19.3.4</span> Multiple comparisons and shrinkage.<a href="metric-predicted-variable-with-one-nominal-predictor.html#multiple-comparisons-and-shrinkage." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>The previous section suggested that an analyst should investigate all contrasts of interest. This recommendation can be thought to conflict with traditional advice in the context on null hypothesis significance testing, which instead recommends that a minimal number of comparisons should be conducted in order to maximize the power of each test while keeping the overall false alarm rate capped at 5% (or whatever maximum is desired)…. Instead, a Bayesian analysis can mitigate false alarms by incorporating prior knowledge into the model. In particular, hierarchical structure (which is an expression of prior knowledge) produces shrinkage of estimates, and shrinkage can help rein in estimates of spurious outlying data. For example, in the posterior distribution from the fruit fly data, the modal values of the posterior group means have a range of <span class="math inline">\(23.2\)</span>. The sample means of the groups have a range of <span class="math inline">\(26.1\)</span>. Thus, there is some shrinkage in the estimated means. The amount of shrinkage is dictated only by the data and by the prior structure, not by the intended tests. (p. 568)</p>
</blockquote>
<p>We may as well compute those ranges by hand. Here’s the range of the observed data.</p>
<div class="sourceCode" id="cb1869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1869-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1869-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1869-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1869-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CompanionNumber) <span class="sc">%&gt;%</span> </span>
<span id="cb1869-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1869-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean  =</span> <span class="fu">mean</span>(Longevity)) <span class="sc">%&gt;%</span> </span>
<span id="cb1869-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1869-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">range =</span> <span class="fu">max</span>(mean) <span class="sc">-</span> <span class="fu">min</span>(mean))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   range
##   &lt;dbl&gt;
## 1  26.1</code></pre>
<p>For our hierarchical model <code>fit19.1</code>, the posterior means are rank ordered in the same way as the empirical data.</p>
<div class="sourceCode" id="cb1871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1871-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1871-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit19<span class="fl">.1</span>)<span class="sc">$</span>CompanionNumber[, , <span class="st">&quot;Intercept&quot;</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb1871-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1871-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1871-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1871-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;companion_number&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1871-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1871-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb1871-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1871-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##   companion_number Estimate Est.Error Q2.5 Q97.5
## 1          Virgin8     39.9       3.0 33.8  45.7
## 2          Virgin1     56.8       2.9 51.2  62.5
## 3        Pregnant8     63.0       2.9 57.3  68.8
## 4            None0     63.2       2.9 57.4  69.0
## 5        Pregnant1     64.3       3.0 58.5  70.2</code></pre>
<p>If we compute the range by a difference of the point estimates of the highest and lowest posterior means, we can get a quick number.</p>
<div class="sourceCode" id="cb1873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1873-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1873-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit19<span class="fl">.1</span>)<span class="sc">$</span>CompanionNumber[, , <span class="st">&quot;Intercept&quot;</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb1873-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1873-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1873-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1873-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">range =</span> <span class="fu">max</span>(Estimate) <span class="sc">-</span> <span class="fu">min</span>(Estimate))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   range
##   &lt;dbl&gt;
## 1  24.5</code></pre>
<p>Note that wasn’t fully Bayesian of us. Those means and their difference carry uncertainty and that uncertainty can be fully expressed if we use all the posterior draws (i.e., use <code>summary = F</code> and wrangle).</p>
<div class="sourceCode" id="cb1875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1875-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1875-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit19<span class="fl">.1</span>, <span class="at">summary =</span> F)<span class="sc">$</span>CompanionNumber[, , <span class="st">&quot;Intercept&quot;</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb1875-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1875-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1875-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1875-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">range =</span> Pregnant1 <span class="sc">-</span> Virgin8) <span class="sc">%&gt;%</span> </span>
<span id="cb1875-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1875-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mode_hdi</span>(range)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   range .lower .upper .width .point .interval
##   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1  23.5   16.0   32.8   0.95 mode   hdi</code></pre>
<p>Happily, the central tendency of the range is near equivalent with both methods, but now we have 95% intervals, too. Do note how wide they are. This is why we work with the full set of posterior draws.</p>
</div>
<div id="the-two-group-case." class="section level3 hasAnchor" number="19.3.5">
<h3><span class="header-section-number">19.3.5</span> The two-group case.<a href="metric-predicted-variable-with-one-nominal-predictor.html#the-two-group-case." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>A special case of our current scenario is when there are only two groups. The model of the present section could, in principle, be applied to the two-group case, but the hierarchical structure would do little good because there is virtually no shrinkage when there are so few groups (and the top-level prior on <span class="math inline">\(\sigma_\beta\)</span> is broad as assumed here). (p. 568)</p>
</blockquote>
<p>For kicks and giggles, let’s practice. Since <code>Pregnant1</code> and <code>Virgin8</code> had the highest and lowest empirical means—making them the groups best suited to define our range, we’ll use them to fit the 2-group hierarchical model. To fit it with haste, just use <code>update()</code>.</p>
<div class="sourceCode" id="cb1877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1877-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1877-1" aria-hidden="true" tabindex="-1"></a>fit19<span class="fl">.3</span> <span class="ot">&lt;-</span></span>
<span id="cb1877-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1877-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(fit19<span class="fl">.1</span>,</span>
<span id="cb1877-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1877-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1877-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1877-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">filter</span>(CompanionNumber <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Pregnant1&quot;</span>, <span class="st">&quot;Virgin8&quot;</span>)),</span>
<span id="cb1877-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1877-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">seed =</span> <span class="dv">19</span>,</span>
<span id="cb1877-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1877-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">file =</span> <span class="st">&quot;fits/fit19.03&quot;</span>)</span></code></pre></div>
<pre><code>## The desired updates require recompiling the model</code></pre>
<p>Even with just two groups, there were no gross issues with fitting the model.</p>
<div class="sourceCode" id="cb1879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1879-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1879-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit19<span class="fl">.3</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Longevity ~ 1 + (1 | CompanionNumber) 
##    Data: my_data %&gt;% filter(CompanionNumber %in% c(&quot;Pregnan (Number of observations: 50) 
##   Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup draws = 12000
## 
## Group-Level Effects: 
## ~CompanionNumber (Number of levels: 2) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)    32.27     22.75     8.34    92.69 1.00     2934     4189
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    52.43     23.66     3.31   104.56 1.00     2939     3057
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    14.23      1.47    11.70    17.50 1.00     6194     5825
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>If you compare the posteriors for <span class="math inline">\(\sigma_\beta\)</span> across the two models, you’ll see how the one for <code>fit19.3</code> is substantially larger.</p>
<div class="sourceCode" id="cb1881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1881-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1881-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit19<span class="fl">.1</span>)[<span class="st">&quot;sd_CompanionNumber__Intercept&quot;</span>, ]</span></code></pre></div>
<pre><code>##  Estimate Est.Error      Q2.5     Q97.5 
## 14.915311  7.568772  6.268457 35.819113</code></pre>
<div class="sourceCode" id="cb1883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1883-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1883-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit19<span class="fl">.3</span>)[<span class="st">&quot;sd_CompanionNumber__Intercept&quot;</span>, ]</span></code></pre></div>
<pre><code>##  Estimate Est.Error      Q2.5     Q97.5 
## 32.268681 22.754157  8.342271 92.686976</code></pre>
<p>Here that is in a coefficient plot using <code>tidybayes::stat_interval()</code>.</p>
<div class="sourceCode" id="cb1885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1885-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1885-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">as_draws_df</span>(fit19<span class="fl">.1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(sd_CompanionNumber__Intercept),</span>
<span id="cb1885-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1885-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">as_draws_df</span>(fit19<span class="fl">.3</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(sd_CompanionNumber__Intercept)) <span class="sc">%&gt;%</span> </span>
<span id="cb1885-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1885-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;fit19.1&quot;</span>, <span class="st">&quot;fit19.3&quot;</span>), <span class="at">each =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1885-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1885-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1885-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1885-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sd_CompanionNumber__Intercept, <span class="at">y =</span> fit)) <span class="sc">+</span></span>
<span id="cb1885-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1885-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_interval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">8</span>, .<span class="dv">95</span>)) <span class="sc">+</span></span>
<span id="cb1885-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1885-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> pp[<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">5</span>, <span class="dv">7</span>)], </span>
<span id="cb1885-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1885-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;95%&quot;</span>, <span class="st">&quot;80%&quot;</span>, <span class="st">&quot;50%&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1885-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1885-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(sigma[beta]), </span>
<span id="cb1885-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1885-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))) <span class="sc">+</span></span>
<span id="cb1885-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1885-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1885-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1885-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.45</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-48-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>This all implies less shrinkage and a larger range.</p>
<div class="sourceCode" id="cb1886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1886-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1886-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit19<span class="fl">.3</span>, <span class="at">summary =</span> F)<span class="sc">$</span>CompanionNumber[, , <span class="st">&quot;Intercept&quot;</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb1886-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1886-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1886-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1886-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">range =</span> Pregnant1 <span class="sc">-</span> Virgin8) <span class="sc">%&gt;%</span> </span>
<span id="cb1886-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1886-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mode_hdi</span>(range)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   range .lower .upper .width .point .interval
##   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1  25.5   17.5   33.3   0.95 mode   hdi</code></pre>
<p>And indeed, the range between the two groups is larger. Now the posterior mode for their difference has almost converged to that of the raw data. Kruschke then went on to recommend using a single-level model in such situations, instead.</p>
<blockquote>
<p>That is why the two-group model in <a href="metric-predicted-variable-on-one-or-two-groups.html#two-groups">Section 16.3</a> did not use hierarchical structure, as illustrated in Figure 16.11 (p. 468). That model also used a <span class="math inline">\(t\)</span> distribution to accommodate outliers in the data, and that model allowed for heterogeneous variances across groups. Thus, for two groups, it is more appropriate to use the model of Section 16.3. The hierarchical multi-group model is generalized to accommodate outliers and heterogeneous variances in <a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1">Section 19.5</a>. (p. 568)</p>
</blockquote>
<p>As a refresher, here’s what the <strong>brms</strong> code for that Chapter 16 model looked like.</p>
<div class="sourceCode" id="cb1888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1888-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1888-1" aria-hidden="true" tabindex="-1"></a>fit16<span class="fl">.3</span> <span class="ot">&lt;-</span></span>
<span id="cb1888-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1888-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1888-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1888-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> student,</span>
<span id="cb1888-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1888-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bf</span>(Score <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Group, </span>
<span id="cb1888-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1888-5" aria-hidden="true" tabindex="-1"></a>         sigma <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Group),</span>
<span id="cb1888-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1888-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">100</span>), <span class="at">class =</span> b),</span>
<span id="cb1888-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1888-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fu">log</span>(sd_y)), <span class="at">class =</span> b, <span class="at">dpar =</span> sigma),</span>
<span id="cb1888-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1888-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(one_over_twentynine), <span class="at">class =</span> nu)),</span>
<span id="cb1888-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1888-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1888-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1888-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars,</span>
<span id="cb1888-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1888-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">16</span>,</span>
<span id="cb1888-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1888-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit16.03&quot;</span>)</span></code></pre></div>
<p>Let’s adjust it for our data. Since we have a reduced data set, we’ll need to re-compute our <code>stanvars</code> values, which were based on the raw data.</p>
<div class="sourceCode" id="cb1889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1889-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1889-1" aria-hidden="true" tabindex="-1"></a><span class="co"># it&#39;s easier to just make a reduced data set</span></span>
<span id="cb1889-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1889-2" aria-hidden="true" tabindex="-1"></a>my_small_data <span class="ot">&lt;-</span></span>
<span id="cb1889-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1889-3" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1889-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1889-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CompanionNumber <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Pregnant1&quot;</span>, <span class="st">&quot;Virgin8&quot;</span>))</span>
<span id="cb1889-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1889-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1889-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1889-6" aria-hidden="true" tabindex="-1"></a>(mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(my_small_data<span class="sc">$</span>Longevity))</span></code></pre></div>
<pre><code>## [1] 51.76</code></pre>
<div class="sourceCode" id="cb1891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1891-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1891-1" aria-hidden="true" tabindex="-1"></a>(sd_y <span class="ot">&lt;-</span> <span class="fu">sd</span>(my_small_data<span class="sc">$</span>Longevity))</span></code></pre></div>
<pre><code>## [1] 19.11145</code></pre>
<div class="sourceCode" id="cb1893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1893-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1893-1" aria-hidden="true" tabindex="-1"></a>omega <span class="ot">&lt;-</span> sd_y <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb1893-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1893-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> sd_y</span>
<span id="cb1893-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1893-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1893-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1893-4" aria-hidden="true" tabindex="-1"></a>(s_r <span class="ot">&lt;-</span> <span class="fu">gamma_a_b_from_omega_sigma</span>(<span class="at">mode =</span> omega, <span class="at">sd =</span> sigma))</span></code></pre></div>
<pre><code>## $shape
## [1] 1.283196
## 
## $rate
## [1] 0.02963623</code></pre>
<p>Here we update <code>stanvars</code>.</p>
<div class="sourceCode" id="cb1895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1895-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1895-1" aria-hidden="true" tabindex="-1"></a>stanvars <span class="ot">&lt;-</span> </span>
<span id="cb1895-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1895-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(mean_y,    <span class="at">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1895-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1895-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(sd_y,      <span class="at">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb1895-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1895-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>shape, <span class="at">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">+</span></span>
<span id="cb1895-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1895-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>rate,  <span class="at">name =</span> <span class="st">&quot;beta&quot;</span>) <span class="sc">+</span></span>
<span id="cb1895-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1895-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">29</span>,      <span class="at">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>)</span></code></pre></div>
<p>Note that our priors, here, are something of a blend of those from Chapter 16 and those from our hierarchical model, <code>fit19.1</code>.</p>
<div class="sourceCode" id="cb1896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1896-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1896-1" aria-hidden="true" tabindex="-1"></a>fit19<span class="fl">.4</span> <span class="ot">&lt;-</span></span>
<span id="cb1896-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1896-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_small_data,</span>
<span id="cb1896-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1896-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> student,</span>
<span id="cb1896-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1896-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bf</span>(Longevity <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> CompanionNumber, </span>
<span id="cb1896-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1896-5" aria-hidden="true" tabindex="-1"></a>         sigma <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> CompanionNumber),</span>
<span id="cb1896-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1896-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">10</span>), <span class="at">class =</span> b),</span>
<span id="cb1896-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1896-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fu">log</span>(sd_y)), <span class="at">class =</span> b, <span class="at">dpar =</span> sigma),</span>
<span id="cb1896-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1896-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(one_over_twentynine), <span class="at">class =</span> nu)),</span>
<span id="cb1896-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1896-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1896-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1896-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">19</span>,</span>
<span id="cb1896-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1896-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars,</span>
<span id="cb1896-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1896-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit19.04&quot;</span>)</span></code></pre></div>
<p>Here’s the model summary.</p>
<div class="sourceCode" id="cb1897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1897-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1897-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit19<span class="fl">.4</span>)</span></code></pre></div>
<pre><code>##  Family: student 
##   Links: mu = identity; sigma = log; nu = identity 
## Formula: Longevity ~ 0 + CompanionNumber 
##          sigma ~ 0 + CompanionNumber
##    Data: my_small_data (Number of observations: 50) 
##   Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup draws = 12000
## 
## Population-Level Effects: 
##                                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## CompanionNumberPregnant1          64.66      3.29    58.12    71.07 1.00    12528     8120
## CompanionNumberVirgin8            38.79      2.54    33.79    43.71 1.00    12367     8561
## sigma_CompanionNumberPregnant1     2.74      0.15     2.44     3.05 1.00    13120     9473
## sigma_CompanionNumberVirgin8       2.48      0.16     2.18     2.80 1.00    14053     9013
## 
## Family Specific Parameters: 
##    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## nu    39.41     30.75     5.96   120.03 1.00    12705     8742
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Man, look at those <code>Bulk_ESS</code> values! As it turns out, they can be <a href="https://andrewgelman.com/2018/01/18/measuring-speed-stan-incorrectly-faster-thought-cases-due-antithetical-sampling/">greater than the number of post-warmup samples</a>. And here’s the range in posterior means.</p>
<div class="sourceCode" id="cb1899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1899-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1899-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(fit19<span class="fl">.4</span>, <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb1899-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1899-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1899-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1899-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">range =</span> CompanionNumberPregnant1 <span class="sc">-</span> CompanionNumberVirgin8) <span class="sc">%&gt;%</span> </span>
<span id="cb1899-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1899-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mode_hdi</span>(range)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   range .lower .upper .width .point .interval
##   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1  25.6   17.9   34.1   0.95 mode   hdi</code></pre>
<p>The results are pretty much the same as that of the two-group hierarchical model, maybe a touch larger. Yep, Kruschke was right. Hierarchical models with two groups and permissive priors on <span class="math inline">\(\sigma_\beta\)</span> don’t shrink the estimates to the grand mean all that much.</p>
</div>
</div>
<div id="including-a-metric-predictor" class="section level2 hasAnchor" number="19.4">
<h2><span class="header-section-number">19.4</span> Including a metric predictor<a href="metric-predicted-variable-with-one-nominal-predictor.html#including-a-metric-predictor" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>“In Figure 19.3, the data within each group have a large standard deviation. For example, longevities in the Virgin8 group range from <span class="math inline">\(20\)</span> to <span class="math inline">\(60\)</span> days” (p. 568). Turns out Kruschke’s slightly wrong on this. Probably just a typo.</p>
<div class="sourceCode" id="cb1901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1901-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1901-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1901-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1901-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CompanionNumber) <span class="sc">%&gt;%</span> </span>
<span id="cb1901-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1901-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">min   =</span> <span class="fu">min</span>(Longevity),</span>
<span id="cb1901-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1901-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">max   =</span> <span class="fu">max</span>(Longevity),</span>
<span id="cb1901-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1901-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">range =</span> <span class="fu">max</span>(Longevity) <span class="sc">-</span> <span class="fu">min</span>(Longevity))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   CompanionNumber   min   max range
##   &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 None0              37    96    59
## 2 Pregnant1          42    97    55
## 3 Pregnant8          35    86    51
## 4 Virgin1            21    81    60
## 5 Virgin8            16    60    44</code></pre>
<p>But you get the point. For each group, there was quite a range. We might add predictors to the model to help account for those ranges.</p>
<blockquote>
<p>The additional metric predictor is sometimes called a covariate. In the experimental setting, the focus of interest is usually on the nominal predictor (i.e., the experimental treatments), and the covariate is typically thought of as an ancillary predictor to help isolate the effect of the nominal predictor. But mathematically the nominal and metric predictors have equal status in the model. Let’s denote the value of the metric covariate for subject <span class="math inline">\(i\)</span> as <span class="math inline">\(x_\text{cov}(i)\)</span>. Then the expected value of the predicted variable for subject <span class="math inline">\(i\)</span> is</p>
<p><span class="math display">\[\mu (i) = \beta_0 + \sum_j \beta_{[j]} x_{[j]} (i) + \beta_\text{cov}  x_\text{cov}(i)\]</span></p>
<p>with the usual sum-to-zero constraint on the deflections of the nominal predictor stated in Equation 19.2. In words, Equation 19.5 says that the predicted value for subject <span class="math inline">\(i\)</span> is a baseline plus a deflection due to the group of <span class="math inline">\(i\)</span> plus a shift due to the value of <span class="math inline">\(i\)</span> on the covariate. (p. 569)</p>
</blockquote>
<p>And the <span class="math inline">\(j\)</span> subscript, recall, denotes group membership. In this context, it often</p>
<blockquote>
<p>makes sense to set the intercept as the mean of predicted values if the covariate is re-centered at its mean value, which is denoted <span class="math inline">\(\overline x_\text{cov}\)</span>. Therefore Equation 19.5 is algebraically reformulated to make the baseline respect those constraints…. The first equation below is simply Equation 19.5 with <span class="math inline">\(x_\text{cov}\)</span> recentered on its mean, <span class="math inline">\(\overline x_\text{cov}\)</span>. The second line below merely algebraically rearranges the terms so that the nominal deflections sum to zero and the constants are combined into the overall baseline:</p>
<p><span class="math display">\[\begin{align*}
\mu &amp; = \alpha_0 + \sum_j \alpha_{[j]} x_{[j]} + \alpha_\text{cov} (x_\text{cov} - \overline{x}_\text{cov}) \\
    &amp; = \underbrace{\alpha_0 + \overline{\alpha} - \alpha_\text{cov} \overline{x}_\text{cov}}_{\beta_0} + \sum_j \underbrace{(\alpha_{[j]} - \overline{\alpha})}_{\beta_[j]} x_{[j]} + \underbrace{\alpha_\text{cov}}_{\beta_{\text{cov}}} x_\text{cov} \\
&amp; \text{where } \overline{\alpha} = \frac{1}{J} \sum^J_{j = 1} \alpha_{[j]}
\end{align*}\]</span>
(pp. 569–570)</p>
</blockquote>
<p>We have a visual depiction of all this in the hierarchical model diagram of Figure 19.4.</p>
<div class="sourceCode" id="cb1903"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1903-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bracket</span></span>
<span id="cb1903-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1903-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> .<span class="dv">99</span>,</span>
<span id="cb1903-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> .<span class="dv">5</span>,</span>
<span id="cb1903-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;{_}&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1903-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1903-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1903-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">color =</span> pp[<span class="dv">8</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1903-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1903-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1903-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1903-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1903-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  plain arrow</span></span>
<span id="cb1903-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-14" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1903-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> .<span class="dv">71</span>,</span>
<span id="cb1903-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="dv">1</span>,</span>
<span id="cb1903-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> .<span class="dv">68</span>,</span>
<span id="cb1903-18"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> .<span class="dv">25</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1903-19"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1903-20"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb1903-21"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1903-22"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1903-23"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1903-24"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1903-25"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1903-26"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-26" aria-hidden="true" tabindex="-1"></a><span class="co"># normal density</span></span>
<span id="cb1903-27"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-27" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb1903-28"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1903-29"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1903-30"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1903-31"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1903-32"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1903-33"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1903-34"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1903-35"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1903-36"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.45</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1903-37"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb1903-38"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;italic(M)[0]&quot;</span>, <span class="st">&quot;italic(S)[0]&quot;</span>), </span>
<span id="cb1903-39"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1903-40"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1903-41"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1903-42"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]))</span>
<span id="cb1903-43"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1903-44"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-44" aria-hidden="true" tabindex="-1"></a><span class="co"># second normal density</span></span>
<span id="cb1903-45"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-45" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb1903-46"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1903-47"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1903-48"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1903-49"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1903-50"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1903-51"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1903-52"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1903-53"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1903-54"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.45</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1903-55"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb1903-56"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-56" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;sigma[beta]&quot;</span>), </span>
<span id="cb1903-57"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-57" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1903-58"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1903-59"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1903-60"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]))</span>
<span id="cb1903-61"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1903-62"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-62" aria-hidden="true" tabindex="-1"></a><span class="co"># third density</span></span>
<span id="cb1903-63"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-63" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span></span>
<span id="cb1903-64"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1903-65"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1903-66"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1903-67"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1903-68"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-68" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1903-69"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-69" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1903-70"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-70" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1903-71"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1903-72"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-72" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.45</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1903-73"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-73" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb1903-74"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-74" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;italic(M)[italic(c)]&quot;</span>, <span class="st">&quot;italic(S)[italic(c)]&quot;</span>), </span>
<span id="cb1903-75"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-75" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1903-76"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1903-77"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1903-78"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]))</span>
<span id="cb1903-79"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1903-80"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-80" aria-hidden="true" tabindex="-1"></a><span class="co"># three annotated arrows</span></span>
<span id="cb1903-81"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-81" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span></span>
<span id="cb1903-82"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">09</span>, .<span class="dv">49</span>, .<span class="dv">9</span>),</span>
<span id="cb1903-83"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-83" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1903-84"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-84" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">20</span>, .<span class="dv">40</span>, .<span class="dv">64</span>),</span>
<span id="cb1903-85"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-85" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1903-86"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb1903-87"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-87" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1903-88"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1903-89"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1903-90"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-90" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">11</span>, .<span class="dv">42</span>, .<span class="dv">47</span>, .<span class="dv">74</span>), <span class="at">y =</span> .<span class="dv">5</span>,</span>
<span id="cb1903-91"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-91" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(j)&quot;</span>, <span class="st">&quot;&#39;~&#39;&quot;</span>),</span>
<span id="cb1903-92"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-92" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">10</span>), </span>
<span id="cb1903-93"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-93" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1903-94"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1903-95"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1903-96"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1903-97"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-97" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood formula</span></span>
<span id="cb1903-98"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-98" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span></span>
<span id="cb1903-99"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> .<span class="dv">99</span>,</span>
<span id="cb1903-100"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-100" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb1903-101"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-101" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;beta[0]+sum()[italic(j)]*beta[&#39;[&#39;*italic(j)*&#39;]&#39;]*italic(x)[&#39;[&#39;*italic(j)*&#39;]&#39;](italic(i))+beta[italic(cov)]*italic(x)[italic(cov)](italic(i))&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1903-102"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-102" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1903-103"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1903-104"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1903-105"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1903-106"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1903-107"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1903-108"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1903-109"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-109" aria-hidden="true" tabindex="-1"></a><span class="co"># half-normal density</span></span>
<span id="cb1903-110"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-110" aria-hidden="true" tabindex="-1"></a>p8 <span class="ot">&lt;-</span></span>
<span id="cb1903-111"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1903-112"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1903-113"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1903-114"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1903-115"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-115" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1903-116"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-116" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;half-normal&quot;</span>,</span>
<span id="cb1903-117"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-117" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1903-118"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1903-119"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-119" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1903-120"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-120" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;0*&#39;,&#39;*~italic(S)[sigma]&quot;</span>, </span>
<span id="cb1903-121"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-121" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1903-122"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1903-123"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1903-124"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]))</span>
<span id="cb1903-125"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1903-126"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-126" aria-hidden="true" tabindex="-1"></a><span class="co"># annotated arrow</span></span>
<span id="cb1903-127"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-127" aria-hidden="true" tabindex="-1"></a>p9 <span class="ot">&lt;-</span></span>
<span id="cb1903-128"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">38</span>,</span>
<span id="cb1903-129"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-129" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> .<span class="dv">65</span>,</span>
<span id="cb1903-130"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-130" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;&#39;=&#39;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1903-131"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-131" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1903-132"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1903-133"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1903-134"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">5</span>, <span class="at">xend =</span> .<span class="dv">5</span>,</span>
<span id="cb1903-135"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-135" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> .<span class="dv">25</span>, </span>
<span id="cb1903-136"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-136" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> my_arrow, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1903-137"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1903-138"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1903-139"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1903-140"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-140" aria-hidden="true" tabindex="-1"></a><span class="co"># the fourth normal density</span></span>
<span id="cb1903-141"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-141" aria-hidden="true" tabindex="-1"></a>p10 <span class="ot">&lt;-</span></span>
<span id="cb1903-142"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1903-143"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1903-144"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1903-145"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1903-146"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-146" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1903-147"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-147" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1903-148"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-148" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1903-149"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1903-150"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-150" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.45</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1903-151"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-151" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb1903-152"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-152" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;mu[italic(i)]&quot;</span>, <span class="st">&quot;sigma[italic(y)]&quot;</span>), </span>
<span id="cb1903-153"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-153" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1903-154"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1903-155"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1903-156"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]))</span>
<span id="cb1903-157"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1903-158"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-158" aria-hidden="true" tabindex="-1"></a><span class="co"># another annotated arrow</span></span>
<span id="cb1903-159"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-159" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span></span>
<span id="cb1903-160"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">5</span>,</span>
<span id="cb1903-161"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-161" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> .<span class="dv">6</span>,</span>
<span id="cb1903-162"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-162" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;&#39;~&#39;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1903-163"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-163" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1903-164"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1903-165"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1903-166"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">85</span>, <span class="at">xend =</span> .<span class="dv">27</span>,</span>
<span id="cb1903-167"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-167" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> .<span class="dv">2</span>, </span>
<span id="cb1903-168"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-168" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> my_arrow, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1903-169"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1903-170"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1903-171"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1903-172"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-172" aria-hidden="true" tabindex="-1"></a><span class="co"># the final annotated arrow</span></span>
<span id="cb1903-173"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-173" aria-hidden="true" tabindex="-1"></a>p12 <span class="ot">&lt;-</span></span>
<span id="cb1903-174"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="fu">c</span>(.<span class="dv">375</span>, .<span class="dv">625</span>),</span>
<span id="cb1903-175"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-175" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb1903-176"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-176" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(i)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1903-177"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-177" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1903-178"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1903-179"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>), </span>
<span id="cb1903-180"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-180" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1903-181"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">5</span>, <span class="at">xend =</span> .<span class="dv">5</span>,</span>
<span id="cb1903-182"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-182" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> <span class="dv">0</span>, </span>
<span id="cb1903-183"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-183" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> my_arrow, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1903-184"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1903-185"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1903-186"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1903-187"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-187" aria-hidden="true" tabindex="-1"></a><span class="co"># some text</span></span>
<span id="cb1903-188"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-188" aria-hidden="true" tabindex="-1"></a>p13 <span class="ot">&lt;-</span></span>
<span id="cb1903-189"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">5</span>,</span>
<span id="cb1903-190"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-190" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> .<span class="dv">5</span>,</span>
<span id="cb1903-191"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-191" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;italic(y[i])&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1903-192"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-192" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1903-193"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1903-194"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1903-195"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1903-196"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1903-197"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1903-198"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1903-199"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-199" aria-hidden="true" tabindex="-1"></a><span class="co"># define the layout</span></span>
<span id="cb1903-200"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-200" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1903-201"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">6</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1903-202"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">b =</span> <span class="dv">3</span>, <span class="at">l =</span> <span class="dv">6</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1903-203"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">3</span>),</span>
<span id="cb1903-204"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1903-205"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">9</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb1903-206"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">6</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb1903-207"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">5</span>, <span class="at">b =</span> <span class="dv">6</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb1903-208"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">6</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">11</span>, <span class="at">r =</span> <span class="dv">13</span>),</span>
<span id="cb1903-209"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">9</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1903-210"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">8</span>, <span class="at">b =</span> <span class="dv">9</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1903-211"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">8</span>, <span class="at">b =</span> <span class="dv">9</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">13</span>),</span>
<span id="cb1903-212"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">11</span>, <span class="at">b =</span> <span class="dv">11</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1903-213"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">12</span>, <span class="at">b =</span> <span class="dv">12</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>)</span>
<span id="cb1903-214"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-214" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1903-215"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1903-216"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-216" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot!</span></span>
<span id="cb1903-217"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-217" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p5 <span class="sc">+</span> p7 <span class="sc">+</span> p6 <span class="sc">+</span> p8 <span class="sc">+</span> p10 <span class="sc">+</span> p9 <span class="sc">+</span> p11 <span class="sc">+</span> p12 <span class="sc">+</span> p13) <span class="sc">+</span> </span>
<span id="cb1903-218"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout) <span class="sc">&amp;</span></span>
<span id="cb1903-219"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb1903-220"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1903-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>, <span class="fl">5.5</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-56-1.png" width="720" style="display: block; margin: auto;" /></p>
<div id="example-sex-death-and-size." class="section level3 hasAnchor" number="19.4.1">
<h3><span class="header-section-number">19.4.1</span> Example: Sex, death, and size.<a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-death-and-size." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Kruschke recalled <code>fit19.1</code>’s estimate for <span class="math inline">\(\sigma_y\)</span> had a posterior mode around 14.8. Let’s confirm with a plot.</p>
<div class="sourceCode" id="cb1904"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1904-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1904-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit19<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1904-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1904-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sigma, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1904-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1904-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1904-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1904-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">color =</span> pp[<span class="dv">4</span>], </span>
<span id="cb1904-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1904-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1904-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1904-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1904-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1904-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(sigma[<span class="fu">italic</span>(y)])) <span class="sc">+</span></span>
<span id="cb1904-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1904-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-57-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Yep, that looks about right. That large of a difference in days would indeed make it difficult to detect between-group differences if those differences were typically on the scale of just a few days. Since <code>Thorax</code> is moderately correlated with <code>Longevity</code>, including <code>Thorax</code> in the statistical model should help shrink that <span class="math inline">\(\sigma_y\)</span> estimate, making it easier to compare group means. Following the sensibilities from the equations just above, here we’ll mean-center our covariate, first.</p>
<div class="sourceCode" id="cb1905"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1905-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1905-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span></span>
<span id="cb1905-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1905-2" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1905-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1905-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">thorax_c =</span> Thorax <span class="sc">-</span> <span class="fu">mean</span>(Thorax))</span>
<span id="cb1905-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1905-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1905-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1905-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   Longevity CompanionNumber Thorax thorax_c
##       &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;    &lt;dbl&gt;
## 1        35 Pregnant8         0.64  -0.181 
## 2        37 Pregnant8         0.68  -0.141 
## 3        49 Pregnant8         0.68  -0.141 
## 4        46 Pregnant8         0.72  -0.101 
## 5        63 Pregnant8         0.72  -0.101 
## 6        39 Pregnant8         0.76  -0.0610</code></pre>
<p>Our model code follows the structure of that in Kruschke’s <code>Jags-Ymet-Xnom1met1-MnormalHom-Example.R</code> and <code>Jags-Ymet-Xnom1met1-MnormalHom.R</code> files. As a preparatory step, we redefine the values necessary for <code>stanvars</code>.</p>
<div class="sourceCode" id="cb1907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1907-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1907-1" aria-hidden="true" tabindex="-1"></a>(mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(my_data<span class="sc">$</span>Longevity))</span></code></pre></div>
<pre><code>## [1] 57.44</code></pre>
<div class="sourceCode" id="cb1909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1909-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1909-1" aria-hidden="true" tabindex="-1"></a>(sd_y <span class="ot">&lt;-</span> <span class="fu">sd</span>(my_data<span class="sc">$</span>Longevity))</span></code></pre></div>
<pre><code>## [1] 17.56389</code></pre>
<div class="sourceCode" id="cb1911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1911-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1911-1" aria-hidden="true" tabindex="-1"></a>(sd_thorax_c <span class="ot">&lt;-</span> <span class="fu">sd</span>(my_data<span class="sc">$</span>thorax_c))</span></code></pre></div>
<pre><code>## [1] 0.07745367</code></pre>
<div class="sourceCode" id="cb1913"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1913-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1913-1" aria-hidden="true" tabindex="-1"></a>omega <span class="ot">&lt;-</span> sd_y <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb1913-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1913-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> sd_y</span>
<span id="cb1913-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1913-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1913-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1913-4" aria-hidden="true" tabindex="-1"></a>(s_r <span class="ot">&lt;-</span> <span class="fu">gamma_a_b_from_omega_sigma</span>(<span class="at">mode =</span> omega, <span class="at">sd =</span> sigma))</span></code></pre></div>
<pre><code>## $shape
## [1] 1.283196
## 
## $rate
## [1] 0.03224747</code></pre>
<div class="sourceCode" id="cb1915"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1915-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1915-1" aria-hidden="true" tabindex="-1"></a>stanvars <span class="ot">&lt;-</span> </span>
<span id="cb1915-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1915-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(mean_y,      <span class="at">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1915-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1915-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(sd_y,        <span class="at">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb1915-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1915-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(sd_thorax_c, <span class="at">name =</span> <span class="st">&quot;sd_thorax_c&quot;</span>) <span class="sc">+</span></span>
<span id="cb1915-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1915-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>shape,   <span class="at">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">+</span></span>
<span id="cb1915-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1915-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>rate,    <span class="at">name =</span> <span class="st">&quot;beta&quot;</span>)</span></code></pre></div>
<p>Now we’re ready to fit the <code>brm()</code> model, our hierarchical alternative to ANCOVA.</p>
<div class="sourceCode" id="cb1916"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1916-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1916-1" aria-hidden="true" tabindex="-1"></a>fit19<span class="fl">.5</span> <span class="ot">&lt;-</span></span>
<span id="cb1916-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1916-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1916-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1916-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1916-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1916-4" aria-hidden="true" tabindex="-1"></a>      Longevity <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> thorax_c <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> CompanionNumber),</span>
<span id="cb1916-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1916-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1916-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1916-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="sc">*</span> sd_y <span class="sc">/</span> sd_thorax_c), <span class="at">class =</span> b),</span>
<span id="cb1916-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1916-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">gamma</span>(alpha, beta), <span class="at">class =</span> sd),</span>
<span id="cb1916-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1916-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb1916-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1916-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1916-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1916-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">19</span>,</span>
<span id="cb1916-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1916-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>),</span>
<span id="cb1916-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1916-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars,</span>
<span id="cb1916-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1916-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit19.05&quot;</span>)</span></code></pre></div>
<p>Here’s the model summary.</p>
<div class="sourceCode" id="cb1917"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1917-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1917-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit19<span class="fl">.5</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Longevity ~ 1 + thorax_c + (1 | CompanionNumber) 
##    Data: my_data (Number of observations: 125) 
##   Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup draws = 12000
## 
## Group-Level Effects: 
## ~CompanionNumber (Number of levels: 5) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)    14.04      7.33     6.05    33.04 1.00     2607     3631
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    57.53      7.10    43.16    71.89 1.00     2459     3023
## thorax_c    136.36     12.68   111.54   160.94 1.00     7527     6492
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    10.60      0.69     9.36    12.05 1.00     7211     6816
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Let’s see if that <span class="math inline">\(\sigma_y\)</span> posterior shrank.</p>
<div class="sourceCode" id="cb1919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1919-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1919-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit19<span class="fl">.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1919-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1919-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sigma, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1919-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1919-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1919-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1919-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">color =</span> pp[<span class="dv">4</span>], </span>
<span id="cb1919-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1919-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1919-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1919-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1919-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1919-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(sigma[<span class="fu">italic</span>(y)]))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-61-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Yep, sure did! Now our between-group comparisons should be more precise. Heck, if we wanted to we could even make a difference plot.</p>
<div class="sourceCode" id="cb1920"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1920-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1920-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">sigma1 =</span> <span class="fu">as_draws_df</span>(fit19<span class="fl">.1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(sigma),</span>
<span id="cb1920-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1920-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">sigma5 =</span> <span class="fu">as_draws_df</span>(fit19<span class="fl">.5</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb1920-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1920-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">dif =</span> sigma1 <span class="sc">-</span> sigma5) <span class="sc">%&gt;%</span> </span>
<span id="cb1920-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1920-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1920-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1920-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> dif, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1920-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1920-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1920-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1920-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">color =</span> pp[<span class="dv">4</span>], </span>
<span id="cb1920-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1920-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1920-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1920-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1920-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1920-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;This is a difference distribution&quot;</span>,</span>
<span id="cb1920-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1920-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(sigma[<span class="fu">italic</span>(y)][<span class="st">&quot; | fit19.1&quot;</span>]<span class="sc">-</span>sigma[<span class="fu">italic</span>(y)][<span class="st">&quot; | fit19.5&quot;</span>]))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-62-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>If you want a quick and dirty plot of the relation between <code>thorax_c</code> and <code>Longevity</code>, you might employ <code>brms::conditional_effects()</code>.</p>
<div class="sourceCode" id="cb1921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1921-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1921-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(fit19<span class="fl">.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1921-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1921-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">line_args =</span> <span class="fu">list</span>(<span class="at">color =</span> pp[<span class="dv">5</span>], <span class="at">fill =</span> pp[<span class="dv">11</span>]))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-63-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>But to make plots like the ones at the top of Figure 19.5, we’ll have to work a little harder. First, we need some intermediary values marking off the three values along the <code>Thorax</code>-axis Kruschke singled out in his top panel plots. As far as I can tell, they were the <code>min()</code>, the <code>max()</code>, and their <code>mean()</code>.</p>
<div class="sourceCode" id="cb1922"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1922-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1922-1" aria-hidden="true" tabindex="-1"></a>(r <span class="ot">&lt;-</span> <span class="fu">range</span>(my_data<span class="sc">$</span>Thorax))</span></code></pre></div>
<pre><code>## [1] 0.64 0.94</code></pre>
<div class="sourceCode" id="cb1924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1924-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1924-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(r)</span></code></pre></div>
<pre><code>## [1] 0.79</code></pre>
<p>Next, we’ll make the data necessary for our side-tipped Gaussians. For kicks and giggles, we’ll choose 80 draws instead of 20. But do note how we used our <code>r</code> values, from above, to specify both <code>Thorax</code> and <code>thorax_c</code> values in addition to the <code>CompanionNumber</code> categories for the <code>newdata</code> argument. Otherwise, this workflow is very much the same as in previous plots.</p>
<div class="sourceCode" id="cb1926"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1926-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1926-1" aria-hidden="true" tabindex="-1"></a>n_draws <span class="ot">&lt;-</span> <span class="dv">80</span></span>
<span id="cb1926-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1926-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1926-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1926-3" aria-hidden="true" tabindex="-1"></a>densities <span class="ot">&lt;-</span></span>
<span id="cb1926-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1926-4" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1926-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1926-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(CompanionNumber) <span class="sc">%&gt;%</span> </span>
<span id="cb1926-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1926-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(CompanionNumber, <span class="at">Thorax =</span> <span class="fu">c</span>(r[<span class="dv">1</span>], <span class="fu">mean</span>(r), r[<span class="dv">2</span>])) <span class="sc">%&gt;%</span> </span>
<span id="cb1926-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1926-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">thorax_c  =</span> Thorax <span class="sc">-</span> <span class="fu">mean</span>(my_data<span class="sc">$</span>Thorax)) <span class="sc">%&gt;%</span> </span>
<span id="cb1926-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1926-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_epred_draws</span>(fit19<span class="fl">.5</span>, <span class="at">ndraws =</span> n_draws, <span class="at">seed =</span> <span class="dv">19</span>, <span class="at">dpar =</span> <span class="fu">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1926-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1926-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ll =</span> <span class="fu">qnorm</span>(.<span class="dv">025</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma),</span>
<span id="cb1926-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1926-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">ul =</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb1926-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1926-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Longevity =</span> <span class="fu">map2</span>(ll, ul, seq, <span class="at">length.out =</span> <span class="dv">100</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1926-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1926-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(Longevity) <span class="sc">%&gt;%</span> </span>
<span id="cb1926-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1926-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dnorm</span>(Longevity, mu, sigma))</span>
<span id="cb1926-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1926-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1926-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1926-15" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(densities)</span></code></pre></div>
<pre><code>## Rows: 120,000
## Columns: 14
## Groups: CompanionNumber, Thorax, thorax_c, .row [15]
## $ CompanionNumber &lt;chr&gt; &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;N…
## $ Thorax          &lt;dbl&gt; 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.…
## $ thorax_c        &lt;dbl&gt; -0.18096, -0.18096, -0.18096, -0.18096, -0.18096, -0.18096, -0.18096, -0.1…
## $ .row            &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ .chain          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration      &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw           &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ .epred          &lt;dbl&gt; 36.23788, 36.23788, 36.23788, 36.23788, 36.23788, 36.23788, 36.23788, 36.2…
## $ mu              &lt;dbl&gt; 36.23788, 36.23788, 36.23788, 36.23788, 36.23788, 36.23788, 36.23788, 36.2…
## $ sigma           &lt;dbl&gt; 10.73103, 10.73103, 10.73103, 10.73103, 10.73103, 10.73103, 10.73103, 10.7…
## $ ll              &lt;dbl&gt; 15.20545, 15.20545, 15.20545, 15.20545, 15.20545, 15.20545, 15.20545, 15.2…
## $ ul              &lt;dbl&gt; 57.27032, 57.27032, 57.27032, 57.27032, 57.27032, 57.27032, 57.27032, 57.2…
## $ Longevity       &lt;dbl&gt; 15.20545, 15.63034, 16.05524, 16.48014, 16.90504, 17.32994, 17.75483, 18.1…
## $ density         &lt;dbl&gt; 0.005446361, 0.005881248, 0.006340911, 0.006825791, 0.007336239, 0.0078725…</code></pre>
<p>Here, we’ll use a simplified workflow to extract the <code>fitted()</code> values in order to make the regression lines. Since these are straight lines, all we need are two values for each draw, one at the extremes of the <code>Thorax</code> axis.</p>
<div class="sourceCode" id="cb1928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1928-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1928-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb1928-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1928-2" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1928-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1928-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(CompanionNumber) <span class="sc">%&gt;%</span> </span>
<span id="cb1928-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1928-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(CompanionNumber, <span class="at">Thorax =</span> <span class="fu">c</span>(r[<span class="dv">1</span>], <span class="fu">mean</span>(r), r[<span class="dv">2</span>])) <span class="sc">%&gt;%</span> </span>
<span id="cb1928-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1928-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">thorax_c =</span> Thorax <span class="sc">-</span> <span class="fu">mean</span>(my_data<span class="sc">$</span>Thorax)) <span class="sc">%&gt;%</span> </span>
<span id="cb1928-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1928-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_epred_draws</span>(fit19<span class="fl">.5</span>, <span class="at">ndraws =</span> n_draws, <span class="at">seed =</span> <span class="dv">19</span>, <span class="at">value =</span> <span class="st">&quot;Longevity&quot;</span>)</span>
<span id="cb1928-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1928-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1928-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1928-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(f)</span></code></pre></div>
<pre><code>## Rows: 1,200
## Columns: 8
## Groups: CompanionNumber, Thorax, thorax_c, .row [15]
## $ CompanionNumber &lt;chr&gt; &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;N…
## $ Thorax          &lt;dbl&gt; 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.…
## $ thorax_c        &lt;dbl&gt; -0.18096, -0.18096, -0.18096, -0.18096, -0.18096, -0.18096, -0.18096, -0.1…
## $ .row            &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ .chain          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration      &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw           &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21,…
## $ Longevity       &lt;dbl&gt; 36.23788, 35.72981, 36.47699, 38.54599, 32.58731, 40.84551, 34.12519, 35.5…</code></pre>
<p>Now we’re ready to make our plots for the top row of Figure 19.3.</p>
<div class="sourceCode" id="cb1930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1930-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-1" aria-hidden="true" tabindex="-1"></a>densities <span class="sc">%&gt;%</span> </span>
<span id="cb1930-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Longevity, <span class="at">y =</span> Thorax)) <span class="sc">+</span></span>
<span id="cb1930-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the Gaussians</span></span>
<span id="cb1930-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ridgeline</span>(<span class="fu">aes</span>(<span class="at">height =</span> <span class="sc">-</span>density, <span class="at">group =</span> <span class="fu">interaction</span>(Thorax, .draw)),</span>
<span id="cb1930-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">scale =</span> <span class="dv">5</span><span class="sc">/</span><span class="dv">3</span>,</span>
<span id="cb1930-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="fu">adjustcolor</span>(pp[<span class="dv">4</span>], <span class="at">alpha.f =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>),</span>
<span id="cb1930-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">min_height =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb1930-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the vertical lines below the Gaussians</span></span>
<span id="cb1930-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">interaction</span>(Thorax, .draw)),</span>
<span id="cb1930-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1930-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the regression lines</span></span>
<span id="cb1930-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> f,</span>
<span id="cb1930-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">group =</span> .draw),</span>
<span id="cb1930-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1930-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the data</span></span>
<span id="cb1930-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1930-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span> pp[<span class="dv">10</span>]) <span class="sc">+</span></span>
<span id="cb1930-18"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">110</span>),</span>
<span id="cb1930-19"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylim =</span> <span class="fu">c</span>(.<span class="dv">58</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1930-20"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1930-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> CompanionNumber, <span class="at">ncol =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-67-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Now we have a covariate in the model, we have to decide on which of its values we want to base our group comparisons. Unless there’s a substantive reason for another value, the mean is a good standard choice. And since the covariate <code>thorax_c</code> is already mean centered, that means we can effectively leave it out of the equation. Here we make and save them in the simple difference metric.</p>
<div class="sourceCode" id="cb1931"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1931-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-1" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit19<span class="fl">.5</span>)</span>
<span id="cb1931-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1931-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-3" aria-hidden="true" tabindex="-1"></a>differences <span class="ot">&lt;-</span></span>
<span id="cb1931-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-4" aria-hidden="true" tabindex="-1"></a>  draws <span class="sc">%&gt;%</span> </span>
<span id="cb1931-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="st">`</span><span class="at">Pregnant1.Pregnant8 vs None0</span><span class="st">`</span> <span class="ot">=</span> (<span class="st">`</span><span class="at">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span>) <span class="sc">/</span> <span class="dv">2</span> <span class="sc">-</span> <span class="st">`</span><span class="at">r_CompanionNumber[None0,Intercept]</span><span class="st">`</span>,</span>
<span id="cb1931-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-6" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1931-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Pregnant1.Pregnant8.None0 vs Virgin1</span><span class="st">`</span> <span class="ot">=</span> (<span class="st">`</span><span class="at">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">r_CompanionNumber[None0,Intercept]</span><span class="st">`</span>) <span class="sc">/</span> <span class="dv">3</span> <span class="sc">-</span> <span class="st">`</span><span class="at">r_CompanionNumber[Virgin1,Intercept]</span><span class="st">`</span>,</span>
<span id="cb1931-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-8" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1931-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Virgin1 vs Virgin8</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">r_CompanionNumber[Virgin1,Intercept]</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">r_CompanionNumber[Virgin8,Intercept]</span><span class="st">`</span>,</span>
<span id="cb1931-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-10" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1931-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Pregnant1.Pregnant8.None0 vs Virgin1.Virgin8</span><span class="st">`</span> <span class="ot">=</span> (<span class="st">`</span><span class="at">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">r_CompanionNumber[None0,Intercept]</span><span class="st">`</span>) <span class="sc">/</span> <span class="dv">3</span> <span class="sc">-</span> (<span class="st">`</span><span class="at">r_CompanionNumber[Virgin1,Intercept]</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">r_CompanionNumber[Virgin8,Intercept]</span><span class="st">`</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb1931-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1931-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-13" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1931-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-14" aria-hidden="true" tabindex="-1"></a>  differences <span class="sc">%&gt;%</span> </span>
<span id="cb1931-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span>   </span>
<span id="cb1931-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1931-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1931-18"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1931-19"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">color =</span> pp[<span class="dv">4</span>], </span>
<span id="cb1931-20"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1931-21"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1931-22"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Difference&quot;</span>) <span class="sc">+</span></span>
<span id="cb1931-23"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">6.4</span>)) <span class="sc">+</span></span>
<span id="cb1931-24"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1931-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Now we’ll look at the differences in the effect size metric. Since we saved our leg work above, it’s really easy to just convert the differences in bulk with <code>mutate_all()</code>. After the conversion, we’ll bind the two rows of subplots together with a little <strong>patchwork</strong> and display the results.</p>
<div class="sourceCode" id="cb1932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1932-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1932-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1932-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1932-2" aria-hidden="true" tabindex="-1"></a>  differences <span class="sc">%&gt;%</span> </span>
<span id="cb1932-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1932-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="at">.funs =</span> <span class="sc">~</span>. <span class="sc">/</span> draws<span class="sc">$</span>sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb1932-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1932-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span>   </span>
<span id="cb1932-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1932-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1932-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1932-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1932-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1932-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1932-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1932-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">color =</span> pp[<span class="dv">4</span>], </span>
<span id="cb1932-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1932-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1932-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1932-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1932-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1932-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Effect Size&quot;</span>) <span class="sc">+</span></span>
<span id="cb1932-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1932-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">6.4</span>)) <span class="sc">+</span></span>
<span id="cb1932-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1932-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb1932-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1932-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1932-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1932-15" aria-hidden="true" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb1932-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1932-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-69-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>“The HDI widths of all the contrasts have gotten smaller by virtue of including the covariate in the analysis” (p. 571).</p>
</div>
<div id="analogous-to-traditional-ancova." class="section level3 hasAnchor" number="19.4.2">
<h3><span class="header-section-number">19.4.2</span> Analogous to traditional ANCOVA.<a href="metric-predicted-variable-with-one-nominal-predictor.html#analogous-to-traditional-ancova." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In contrast with ANCOVA,</p>
<blockquote>
<p>Bayesian methods do not partition the least-squares variance to make estimates, and therefore the Bayesian method is analogous to ANCOVA but is not ANCOVA. Frequentist practitioners are urged to test (with <span class="math inline">\(p\)</span> values) whether the assumptions of (a) equal slope in all groups, (b) equal standard deviation in all groups, and (c) normally distributed noise can be rejected. In a Bayesian approach, the descriptive model is generalized to address these concerns, as will be discussed in <a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1">Section 19.5</a>. (p. 572)</p>
</blockquote>
</div>
<div id="relation-to-hierarchical-linear-regression." class="section level3 hasAnchor" number="19.4.3">
<h3><span class="header-section-number">19.4.3</span> Relation to hierarchical linear regression.<a href="metric-predicted-variable-with-one-nominal-predictor.html#relation-to-hierarchical-linear-regression." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here Kruschke contrasts our last model with the one from way back in <a href="metric-predicted-variable-with-one-metric-predictor.html#hierarchical-regression-on-individuals-within-groups">Section 17.3</a>. As a refresher, here’s what that code looked like.</p>
<div class="sourceCode" id="cb1933"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1933-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1933-1" aria-hidden="true" tabindex="-1"></a>fit17<span class="fl">.4</span> <span class="ot">&lt;-</span></span>
<span id="cb1933-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1933-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1933-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1933-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> student,</span>
<span id="cb1933-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1933-4" aria-hidden="true" tabindex="-1"></a>      y_z <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x_z <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> x_z <span class="sc">||</span> Subj),</span>
<span id="cb1933-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1933-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1933-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1933-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> b),</span>
<span id="cb1933-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1933-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb1933-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1933-8" aria-hidden="true" tabindex="-1"></a>                <span class="co"># the next line is new</span></span>
<span id="cb1933-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1933-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb1933-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1933-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(one_over_twentynine) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">class =</span> nu)),</span>
<span id="cb1933-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1933-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1933-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1933-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> <span class="fu">stanvar</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">29</span>, <span class="at">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>),</span>
<span id="cb1933-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1933-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">17</span>,</span>
<span id="cb1933-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1933-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit17.04&quot;</span>)</span></code></pre></div>
<p>And for convenience, here’s the code from the model we just fit.</p>
<div class="sourceCode" id="cb1934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1934-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1934-1" aria-hidden="true" tabindex="-1"></a>fit19<span class="fl">.5</span> <span class="ot">&lt;-</span></span>
<span id="cb1934-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1934-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1934-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1934-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1934-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1934-4" aria-hidden="true" tabindex="-1"></a>      Longevity <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> thorax_c <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> CompanionNumber),</span>
<span id="cb1934-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1934-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1934-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1934-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="sc">*</span> sd_y <span class="sc">/</span> sd_thorax_c), <span class="at">class =</span> b),</span>
<span id="cb1934-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1934-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">gamma</span>(alpha, beta), <span class="at">class =</span> sd),</span>
<span id="cb1934-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1934-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb1934-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1934-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1934-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1934-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">19</span>,</span>
<span id="cb1934-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1934-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>),</span>
<span id="cb1934-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1934-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars,</span>
<span id="cb1934-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1934-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit19.05&quot;</span>)</span></code></pre></div>
<p>It’s easy to get lost in the differences in the priors and the technical details with the model chains and such. The main thing to notice, here, is the differences in the model formulas (i.e., the likelihoods). Both models had intercepts and slopes. But whereas the model from 17.3 set both parameters to random, only the intercept in our last model was random. The covariate <code>thorax_c</code> was fixed–it did not vary by group. Had we wanted it to, our <code>formula</code> syntax would have been something like <code>Longevity ~ 1 + thorax_c + (1 + thorax_c || CompanionNumber)</code>. And again, as noted in <a href="dichotomous-predicted-variable.html#the-model-and-implementation-in-jags-brms.-1">Section 17.3.1</a>, the <code>||</code> portion of the syntax set the random intercepts and slopes to be orthogonal (i.e., correlate exactly at zero). As we’ll see, this will often not be the case. But let’s not get ahead of ourselves.</p>
<blockquote>
<p>Conceptually, the main difference between the models is merely the focus of attention. In the hierarchical linear regression model, the focus was on the slope coefficient. In that case, we were trying to estimate the magnitude of the slope, simultaneously for individuals and overall. The intercepts, which describe the levels of the nominal predictor, were of ancillary interest. In the present section, on the other hand, the focus of attention is reversed. We are most interested in the intercepts and their differences between groups, with the slopes on the covariate being of ancillary interest. (p. 573)</p>
</blockquote>
</div>
</div>
<div id="heterogeneous-variances-and-robustness-against-outliers" class="section level2 hasAnchor" number="19.5">
<h2><span class="header-section-number">19.5</span> Heterogeneous variances and robustness against outliers<a href="metric-predicted-variable-with-one-nominal-predictor.html#heterogeneous-variances-and-robustness-against-outliers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Figure 19.6 on page 574, Kruschke laid out the diagram for a hierarchical Student’s-<span class="math inline">\(t\)</span> model in for which both the <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> parameters are random. If you recall, <span class="citation">Bürkner (<a href="#ref-Bürkner2022Distributional" role="doc-biblioref">2022a</a>)</span> calls these <a href="https://CRAN.R-project.org/package=brms/vignettes/brms_distreg.html">distributional models</a> and they are indeed available within the <strong>brms</strong> framework. But there’s a catch. Though we can model <span class="math inline">\(\sigma\)</span> all day long and we can even make it hierarchical, <strong>brms</strong> limits us to modeling the hierarchical <span class="math inline">\(\sigma\)</span> parameters within the typical Gaussian framework. That is, we will depart from Kruschke’s schematic in that we will be</p>
<ul>
<li>modeling the log of <span class="math inline">\(\sigma\)</span>,</li>
<li>indicating its grand mean with the <code>sigma ~ 1</code> syntax,</li>
<li>modeling the group-level deflections as Gaussian with a mean of 0 and standard deviation <span class="math inline">\(\sigma_\sigma\)</span> estimated from the data,</li>
<li>and choosing a sensible prior for <span class="math inline">\(\sigma_\sigma\)</span> that is left-bound at 0 and gently slopes to the right (i.e., a folded <span class="math inline">\(t\)</span> or gamma distribution).</li>
</ul>
<p>Thus, here’s our <strong>brms</strong>-centric variant of the diagram in Figure 19.6.</p>
<div class="sourceCode" id="cb1935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1935-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bracket</span></span>
<span id="cb1935-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1935-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> .<span class="dv">99</span>,</span>
<span id="cb1935-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> .<span class="dv">5</span>,</span>
<span id="cb1935-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;{_}&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1935-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1935-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1935-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">color =</span> pp[<span class="dv">8</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1935-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1935-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1935-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1935-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  plain arrow</span></span>
<span id="cb1935-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-14" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1935-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> .<span class="dv">68</span>,</span>
<span id="cb1935-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="dv">1</span>,</span>
<span id="cb1935-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> .<span class="dv">68</span>,</span>
<span id="cb1935-18"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> .<span class="dv">25</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1935-19"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1935-20"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb1935-21"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1935-22"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1935-23"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1935-24"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1935-25"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-26"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-26" aria-hidden="true" tabindex="-1"></a><span class="co"># normal density</span></span>
<span id="cb1935-27"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-27" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb1935-28"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1935-29"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1935-30"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1935-31"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1935-32"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1935-33"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1935-34"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1935-35"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1935-36"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.45</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1935-37"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb1935-38"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;italic(M)[0]&quot;</span>, <span class="st">&quot;italic(S)[0]&quot;</span>), </span>
<span id="cb1935-39"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1935-40"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1935-41"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1935-42"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]))</span>
<span id="cb1935-43"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-44"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-44" aria-hidden="true" tabindex="-1"></a><span class="co"># second normal density</span></span>
<span id="cb1935-45"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-45" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb1935-46"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1935-47"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1935-48"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1935-49"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1935-50"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1935-51"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1935-52"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1935-53"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1935-54"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.45</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1935-55"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb1935-56"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-56" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;sigma[beta]&quot;</span>), </span>
<span id="cb1935-57"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-57" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1935-58"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1935-59"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1935-60"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]))</span>
<span id="cb1935-61"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-62"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-62" aria-hidden="true" tabindex="-1"></a><span class="co"># third normal density</span></span>
<span id="cb1935-63"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-63" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span></span>
<span id="cb1935-64"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1935-65"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1935-66"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1935-67"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1935-68"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-68" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1935-69"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-69" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1935-70"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-70" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1935-71"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1935-72"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-72" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.15</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1935-73"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-73" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;italic(M)[mu[sigma]]&quot;</span>, <span class="st">&quot;italic(S)[mu[sigma]]&quot;</span>), </span>
<span id="cb1935-74"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-74" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb1935-75"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-75" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1935-76"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1935-77"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1935-78"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]))</span>
<span id="cb1935-79"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-80"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-80" aria-hidden="true" tabindex="-1"></a><span class="co"># half-normal density</span></span>
<span id="cb1935-81"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-81" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span></span>
<span id="cb1935-82"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1935-83"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1935-84"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1935-85"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1935-86"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-86" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1935-87"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-87" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;half-normal&quot;</span>,</span>
<span id="cb1935-88"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-88" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">6</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1935-89"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1935-90"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-90" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1935-91"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-91" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;0*&#39;,&#39;*~italic(S)[sigma[sigma]]&quot;</span>, </span>
<span id="cb1935-92"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-92" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1935-93"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1935-94"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1935-95"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]))</span>
<span id="cb1935-96"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-97"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-97" aria-hidden="true" tabindex="-1"></a><span class="co"># exponential density</span></span>
<span id="cb1935-98"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-98" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span></span>
<span id="cb1935-99"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1935-100"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dexp</span>(x, <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dexp</span>(x, <span class="dv">2</span>))))) <span class="sc">+</span></span>
<span id="cb1935-101"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1935-102"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1935-103"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-103" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1935-104"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-104" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;exp&quot;</span>,</span>
<span id="cb1935-105"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-105" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1935-106"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1935-107"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-107" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1935-108"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-108" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;italic(K)&quot;</span>,</span>
<span id="cb1935-109"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-109" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1935-110"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1935-111"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1935-112"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]))</span>
<span id="cb1935-113"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-114"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-114" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood formula</span></span>
<span id="cb1935-115"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-115" aria-hidden="true" tabindex="-1"></a>p8 <span class="ot">&lt;-</span></span>
<span id="cb1935-116"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> .<span class="dv">5</span>,</span>
<span id="cb1935-117"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-117" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb1935-118"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-118" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;beta[0]+sum()[italic(j)]*beta[&#39;[&#39;*italic(j)*&#39;]&#39;]*italic(x)[&#39;[&#39;*italic(j)*&#39;]&#39;](italic(i))&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1935-119"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-119" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1935-120"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1935-121"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1935-122"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1935-123"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1935-124"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1935-125"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-126"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-126" aria-hidden="true" tabindex="-1"></a><span class="co"># normal density</span></span>
<span id="cb1935-127"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-127" aria-hidden="true" tabindex="-1"></a>p9 <span class="ot">&lt;-</span></span>
<span id="cb1935-128"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1935-129"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1935-130"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1935-131"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1935-132"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-132" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1935-133"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-133" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1935-134"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-134" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1935-135"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1935-136"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-136" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.2</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1935-137"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-137" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb1935-138"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-138" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;mu[sigma]&quot;</span>, <span class="st">&quot;sigma[sigma]&quot;</span>), </span>
<span id="cb1935-139"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-139" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1935-140"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1935-141"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1935-142"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]))</span>
<span id="cb1935-143"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-144"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-144" aria-hidden="true" tabindex="-1"></a><span class="co"># four annotated arrows</span></span>
<span id="cb1935-145"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-145" aria-hidden="true" tabindex="-1"></a>p10 <span class="ot">&lt;-</span></span>
<span id="cb1935-146"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">06</span>, .<span class="dv">37</span>, .<span class="dv">67</span>, .<span class="dv">95</span>),</span>
<span id="cb1935-147"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-147" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1935-148"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-148" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">31</span>, .<span class="dv">665</span>, .<span class="dv">745</span>),</span>
<span id="cb1935-149"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-149" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, .<span class="dv">2</span>, .<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1935-150"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb1935-151"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-151" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1935-152"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1935-153"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1935-154"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-154" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">065</span>, .<span class="dv">31</span>, .<span class="dv">36</span>, .<span class="dv">64</span>, .<span class="dv">79</span>), <span class="at">y =</span> .<span class="dv">5</span>,</span>
<span id="cb1935-155"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-155" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(j)&quot;</span>, <span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;&#39;~&#39;&quot;</span> ),</span>
<span id="cb1935-156"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-156" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">10</span>), </span>
<span id="cb1935-157"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-157" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1935-158"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1935-159"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1935-160"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-161"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-161" aria-hidden="true" tabindex="-1"></a><span class="co"># student-t density</span></span>
<span id="cb1935-162"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-162" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span></span>
<span id="cb1935-163"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1935-164"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dt</span>(x, <span class="dv">3</span>) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dt</span>(x, <span class="dv">3</span>))))) <span class="sc">+</span></span>
<span id="cb1935-165"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> pp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1935-166"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1935-167"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-167" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1935-168"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-168" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;student t&quot;</span>,</span>
<span id="cb1935-169"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-169" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1935-170"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1935-171"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-171" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.4</span>, <span class="dv">0</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1935-172"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-172" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;nu&quot;</span>, <span class="st">&quot;mu[italic(i)]&quot;</span>),</span>
<span id="cb1935-173"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-173" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1935-174"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1935-175"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1935-176"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> pp[<span class="dv">4</span>]))</span>
<span id="cb1935-177"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-178"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-178" aria-hidden="true" tabindex="-1"></a><span class="co"># log sigma</span></span>
<span id="cb1935-179"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-179" aria-hidden="true" tabindex="-1"></a>p12 <span class="ot">&lt;-</span></span>
<span id="cb1935-180"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> .<span class="dv">65</span>,</span>
<span id="cb1935-181"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-181" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1935-182"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-182" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;log~sigma[italic(j)*&#39;(&#39;*italic(i)*&#39;)&#39;]&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1935-183"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-183" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1935-184"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1935-185"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1935-186"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb1935-187"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1935-188"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1935-189"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-190"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-190" aria-hidden="true" tabindex="-1"></a><span class="co"># two annotated arrows</span></span>
<span id="cb1935-191"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-191" aria-hidden="true" tabindex="-1"></a>p13 <span class="ot">&lt;-</span></span>
<span id="cb1935-192"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">15</span>),</span>
<span id="cb1935-193"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-193" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">47</span>),</span>
<span id="cb1935-194"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-194" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">72</span>),</span>
<span id="cb1935-195"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-195" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="fu">c</span>(.<span class="dv">75</span>, .<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1935-196"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-196" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1935-197"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb1935-198"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-198" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1935-199"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1935-200"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1935-201"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-201" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">15</span>, .<span class="dv">28</span>), <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">92</span>, .<span class="dv">64</span>, .<span class="dv">22</span>),</span>
<span id="cb1935-202"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-202" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;nu*minute+1&quot;</span>, <span class="st">&quot;&#39;=&#39;&quot;</span>),</span>
<span id="cb1935-203"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-203" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">10</span>), <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1935-204"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1935-205"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1935-206"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-207"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-207" aria-hidden="true" tabindex="-1"></a><span class="co"># one annotated arrow</span></span>
<span id="cb1935-208"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-208" aria-hidden="true" tabindex="-1"></a>p14 <span class="ot">&lt;-</span></span>
<span id="cb1935-209"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">38</span>,</span>
<span id="cb1935-210"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-210" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> .<span class="dv">65</span>,</span>
<span id="cb1935-211"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-211" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;&#39;=&#39;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1935-212"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-212" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1935-213"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1935-214"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1935-215"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">5</span>, <span class="at">xend =</span> .<span class="dv">5</span>,</span>
<span id="cb1935-216"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-216" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> .<span class="dv">15</span>, </span>
<span id="cb1935-217"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-217" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> my_arrow, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1935-218"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1935-219"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1935-220"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-221"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-221" aria-hidden="true" tabindex="-1"></a><span class="co"># another annotated arrow</span></span>
<span id="cb1935-222"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-222" aria-hidden="true" tabindex="-1"></a>p15 <span class="ot">&lt;-</span></span>
<span id="cb1935-223"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="fu">c</span>(.<span class="dv">58</span>, .<span class="dv">71</span>),</span>
<span id="cb1935-224"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-224" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> .<span class="dv">6</span>,</span>
<span id="cb1935-225"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-225" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(j)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1935-226"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-226" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1935-227"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1935-228"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>), <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1935-229"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">85</span>, <span class="at">xend =</span> .<span class="dv">42</span>,</span>
<span id="cb1935-230"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-230" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> .<span class="dv">18</span>, </span>
<span id="cb1935-231"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-231" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> my_arrow, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1935-232"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1935-233"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1935-234"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-235"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-235" aria-hidden="true" tabindex="-1"></a><span class="co"># the final annotated arrow</span></span>
<span id="cb1935-236"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-236" aria-hidden="true" tabindex="-1"></a>p16 <span class="ot">&lt;-</span></span>
<span id="cb1935-237"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="fu">c</span>(.<span class="dv">375</span>, .<span class="dv">625</span>),</span>
<span id="cb1935-238"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-238" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb1935-239"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-239" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(i)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1935-240"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-240" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1935-241"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1935-242"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>), </span>
<span id="cb1935-243"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-243" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1935-244"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">5</span>, <span class="at">xend =</span> .<span class="dv">5</span>,</span>
<span id="cb1935-245"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-245" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> <span class="dv">0</span>, </span>
<span id="cb1935-246"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-246" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> my_arrow, <span class="at">color =</span> pp[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb1935-247"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1935-248"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1935-249"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-250"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-250" aria-hidden="true" tabindex="-1"></a><span class="co"># some text</span></span>
<span id="cb1935-251"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-251" aria-hidden="true" tabindex="-1"></a>p17 <span class="ot">&lt;-</span></span>
<span id="cb1935-252"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">5</span>,</span>
<span id="cb1935-253"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-253" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> .<span class="dv">5</span>,</span>
<span id="cb1935-254"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-254" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;italic(y[i])&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1935-255"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-255" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1935-256"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1935-257"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> pp[<span class="dv">4</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1935-258"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1935-259"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1935-260"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-261"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-261" aria-hidden="true" tabindex="-1"></a><span class="co"># define the layout</span></span>
<span id="cb1935-262"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-262" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1935-263"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">8</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb1935-264"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">b =</span> <span class="dv">3</span>, <span class="at">l =</span> <span class="dv">8</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb1935-265"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">3</span>, <span class="at">r =</span> <span class="dv">5</span>),</span>
<span id="cb1935-266"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb1935-267"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">11</span>, <span class="at">r =</span> <span class="dv">13</span>),</span>
<span id="cb1935-268"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">15</span>, <span class="at">r =</span> <span class="dv">17</span>),</span>
<span id="cb1935-269"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">6</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">3</span>),</span>
<span id="cb1935-270"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">6</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb1935-271"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">6</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">11</span>, <span class="at">r =</span> <span class="dv">13</span>),</span>
<span id="cb1935-272"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">5</span>, <span class="at">b =</span> <span class="dv">6</span>, <span class="at">l =</span> <span class="dv">3</span>, <span class="at">r =</span> <span class="dv">17</span>),</span>
<span id="cb1935-273"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">11</span>, <span class="at">l =</span> <span class="dv">6</span>, <span class="at">r =</span> <span class="dv">8</span>),</span>
<span id="cb1935-274"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">11</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb1935-275"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">8</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">8</span>),</span>
<span id="cb1935-276"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">8</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">6</span>, <span class="at">r =</span> <span class="dv">8</span>),</span>
<span id="cb1935-277"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">8</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">6</span>, <span class="at">r =</span> <span class="dv">13</span>),</span>
<span id="cb1935-278"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">12</span>, <span class="at">b =</span> <span class="dv">12</span>, <span class="at">l =</span> <span class="dv">6</span>, <span class="at">r =</span> <span class="dv">8</span>),</span>
<span id="cb1935-279"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">13</span>, <span class="at">b =</span> <span class="dv">13</span>, <span class="at">l =</span> <span class="dv">6</span>, <span class="at">r =</span> <span class="dv">8</span>)</span>
<span id="cb1935-280"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-280" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1935-281"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1935-282"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-282" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot!</span></span>
<span id="cb1935-283"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-283" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p5 <span class="sc">+</span> p6 <span class="sc">+</span> p7 <span class="sc">+</span> p8 <span class="sc">+</span> p9 <span class="sc">+</span> p10 <span class="sc">+</span> p11 <span class="sc">+</span> p12 <span class="sc">+</span> p13 <span class="sc">+</span> p14 <span class="sc">+</span> p15 <span class="sc">+</span> p16 <span class="sc">+</span> p17) <span class="sc">+</span> </span>
<span id="cb1935-284"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout) <span class="sc">&amp;</span></span>
<span id="cb1935-285"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb1935-286"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1935-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>, <span class="fl">5.5</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-72-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Since we’re modeling <span class="math inline">\(\log \left (\sigma_{j(i)} \right )\)</span>, we might use Gaussian prior centered on <code>sd(my_data$y) %&gt;% log()</code> and a reasonable spread like 1. We can simulate a little to get a sense of what those distributions look like.</p>
<div class="sourceCode" id="cb1936"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1936-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1936-1" aria-hidden="true" tabindex="-1"></a>n_draws <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb1936-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1936-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1936-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1936-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">19</span>)</span>
<span id="cb1936-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1936-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">prior =</span> <span class="fu">rnorm</span>(n_draws, <span class="at">mean =</span> <span class="fu">log</span>(<span class="dv">1</span>), <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1936-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1936-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prior_exp =</span> <span class="fu">exp</span>(prior)) <span class="sc">%&gt;%</span> </span>
<span id="cb1936-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1936-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1936-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1936-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1936-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1936-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb1936-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1936-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dots</span>(<span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">slab_color =</span> pp[<span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb1936-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1936-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>)), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb1936-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1936-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-73-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Here’s what is looks like with <code>sd = 2</code>.</p>
<div class="sourceCode" id="cb1937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1937-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1937-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">19</span>)</span>
<span id="cb1937-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1937-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">prior =</span> <span class="fu">rnorm</span>(n_draws, <span class="at">mean =</span> <span class="fu">log</span>(<span class="dv">1</span>), <span class="at">sd =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1937-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1937-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prior_exp =</span> <span class="fu">exp</span>(prior)) <span class="sc">%&gt;%</span> </span>
<span id="cb1937-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1937-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1937-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1937-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> prior_exp)) <span class="sc">+</span></span>
<span id="cb1937-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1937-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dots</span>(<span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">slab_color =</span> pp[<span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb1937-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1937-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))) <span class="sc">+</span></span>
<span id="cb1937-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1937-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>)), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb1937-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1937-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">17</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-74-1.png" width="360" style="display: block; margin: auto;" /></p>
<p>Though we’re still peaking around 1, there’s more mass in the tail, making it easier for the likelihood to pull away from the prior mode.</p>
<p>But all this is the prior on the fixed effect, the grand mean of <span class="math inline">\(\log (\sigma)\)</span>. Keep in mind we’re also estimating group-level deflections using a hierarchical model. The good old folded <span class="math inline">\(t\)</span> on the unit scale is already pretty permissive for an estimate that is itself on the log scale. To make it more conservative, set <span class="math inline">\(\nu\)</span> to infinity and go with a folded Gaussian. Or keep your regularization loose and go with a low-<span class="math inline">\(\nu\)</span> folded <span class="math inline">\(t\)</span> or even a folded Cauchy. And, of course, one could even go with a gamma.</p>
<p>Consider we have data <code>my_data</code> for which our primary variable of interest is <code>y</code>. Starting from preparing our <code>stanvars</code> values, here’s what the model code might look like.</p>
<div class="sourceCode" id="cb1938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1938-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get ready for `stanvars`</span></span>
<span id="cb1938-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-2" aria-hidden="true" tabindex="-1"></a>mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(my_data<span class="sc">$</span>y)</span>
<span id="cb1938-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-3" aria-hidden="true" tabindex="-1"></a>sd_y   <span class="ot">&lt;-</span> <span class="fu">sd</span>(my_data<span class="sc">$</span>y)</span>
<span id="cb1938-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1938-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-5" aria-hidden="true" tabindex="-1"></a>omega  <span class="ot">&lt;-</span> sd_y <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb1938-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-6" aria-hidden="true" tabindex="-1"></a>sigma  <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> sd_y</span>
<span id="cb1938-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1938-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-8" aria-hidden="true" tabindex="-1"></a>s_r    <span class="ot">&lt;-</span> <span class="fu">gamma_a_b_from_omega_sigma</span>(<span class="at">mode =</span> omega, <span class="at">sd =</span> sigma)</span>
<span id="cb1938-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1938-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-10" aria-hidden="true" tabindex="-1"></a><span class="co"># define `stanvars`</span></span>
<span id="cb1938-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-11" aria-hidden="true" tabindex="-1"></a>stanvars <span class="ot">&lt;-</span> </span>
<span id="cb1938-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(mean_y,    <span class="at">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1938-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(sd_y,      <span class="at">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb1938-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>shape, <span class="at">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">+</span></span>
<span id="cb1938-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>rate,  <span class="at">name =</span> <span class="st">&quot;beta&quot;</span>) <span class="sc">+</span></span>
<span id="cb1938-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">29</span>,      <span class="at">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>)</span>
<span id="cb1938-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1938-18"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-18" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the model</span></span>
<span id="cb1938-19"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-19" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span></span>
<span id="cb1938-20"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1938-21"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> student,</span>
<span id="cb1938-22"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bf</span>(Longevity <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> CompanionNumber), </span>
<span id="cb1938-23"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-23" aria-hidden="true" tabindex="-1"></a>         sigma     <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> CompanionNumber)),</span>
<span id="cb1938-24"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="co"># grand means</span></span>
<span id="cb1938-25"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-25" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1938-26"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-26" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fu">log</span>(sd_y), <span class="dv">1</span>), <span class="at">class =</span> Intercept, <span class="at">dpar =</span> sigma),</span>
<span id="cb1938-27"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-27" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1938-28"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-28" aria-hidden="true" tabindex="-1"></a>                <span class="co"># the priors controlling the spread for our hierarchical deflections</span></span>
<span id="cb1938-29"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-29" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">gamma</span>(alpha, beta), <span class="at">class =</span> sd),</span>
<span id="cb1938-30"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-30" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">dpar =</span> sigma),</span>
<span id="cb1938-31"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-31" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1938-32"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-32" aria-hidden="true" tabindex="-1"></a>                <span class="co"># don&#39;t forget our student-t nu</span></span>
<span id="cb1938-33"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-33" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(one_over_twentynine), <span class="at">class =</span> nu)),</span>
<span id="cb1938-34"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1938-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars)</span></code></pre></div>
<div id="example-contrast-of-means-with-different-variances." class="section level3 hasAnchor" number="19.5.1">
<h3><span class="header-section-number">19.5.1</span> Example: Contrast of means with different variances.<a href="metric-predicted-variable-with-one-nominal-predictor.html#example-contrast-of-means-with-different-variances." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s load and take a look at Kruschke’s simulated group data.</p>
<div class="sourceCode" id="cb1939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1939-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1939-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data.R/NonhomogVarData.csv&quot;</span>)</span>
<span id="cb1939-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1939-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1939-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1939-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   Group     Y
##   &lt;chr&gt; &lt;dbl&gt;
## 1 A      97.8
## 2 A      99.9
## 3 A      92.4
## 4 A      96.9
## 5 A     101. 
## 6 A      80.7</code></pre>
<p>Here are the means and <span class="math inline">\(\textit{SD}\)</span>s for each <code>Group</code>.</p>
<div class="sourceCode" id="cb1941"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1941-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1941-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1941-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1941-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Group) <span class="sc">%&gt;%</span> </span>
<span id="cb1941-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1941-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Y),</span>
<span id="cb1941-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1941-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd   =</span> <span class="fu">sd</span>(Y))</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   Group  mean    sd
##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 A       97   8.00
## 2 B       99   1.00
## 3 C      102   1.00
## 4 D      104.  8</code></pre>
<p>First we’ll fit the model with homogeneous variances. To keep things simple, here we’ll fit a conventional model following the form of our original <code>fit1</code>. Here are our <code>stanvars</code>.</p>
<div class="sourceCode" id="cb1943"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1943-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1943-1" aria-hidden="true" tabindex="-1"></a>(mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(my_data<span class="sc">$</span>Y))</span></code></pre></div>
<pre><code>## [1] 100.5</code></pre>
<div class="sourceCode" id="cb1945"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1945-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1945-1" aria-hidden="true" tabindex="-1"></a>(sd_y <span class="ot">&lt;-</span> <span class="fu">sd</span>(my_data<span class="sc">$</span>Y))</span></code></pre></div>
<pre><code>## [1] 6.228965</code></pre>
<div class="sourceCode" id="cb1947"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1947-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1947-1" aria-hidden="true" tabindex="-1"></a>omega <span class="ot">&lt;-</span> sd_y <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb1947-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1947-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> sd_y</span>
<span id="cb1947-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1947-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1947-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1947-4" aria-hidden="true" tabindex="-1"></a>(s_r  <span class="ot">&lt;-</span> <span class="fu">gamma_a_b_from_omega_sigma</span>(<span class="at">mode =</span> omega, <span class="at">sd =</span> sigma))</span></code></pre></div>
<pre><code>## $shape
## [1] 1.283196
## 
## $rate
## [1] 0.09092861</code></pre>
<div class="sourceCode" id="cb1949"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1949-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1949-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define `stanvars`</span></span>
<span id="cb1949-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1949-2" aria-hidden="true" tabindex="-1"></a>stanvars <span class="ot">&lt;-</span> </span>
<span id="cb1949-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1949-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(mean_y,    <span class="at">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1949-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1949-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(sd_y,      <span class="at">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb1949-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1949-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>shape, <span class="at">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">+</span></span>
<span id="cb1949-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1949-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>rate,  <span class="at">name =</span> <span class="st">&quot;beta&quot;</span>)</span></code></pre></div>
<p>Now fit the ANOVA-like homogeneous-variances model.</p>
<div class="sourceCode" id="cb1950"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1950-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1950-1" aria-hidden="true" tabindex="-1"></a>fit19<span class="fl">.6</span> <span class="ot">&lt;-</span></span>
<span id="cb1950-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1950-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1950-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1950-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1950-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1950-4" aria-hidden="true" tabindex="-1"></a>      Y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Group),</span>
<span id="cb1950-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1950-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">10</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1950-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1950-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">gamma</span>(alpha, beta), <span class="at">class =</span> sd),</span>
<span id="cb1950-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1950-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb1950-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1950-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1950-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1950-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">19</span>,</span>
<span id="cb1950-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1950-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">995</span>),</span>
<span id="cb1950-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1950-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars,</span>
<span id="cb1950-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1950-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit19.06&quot;</span>)</span></code></pre></div>
<p>Here’s the model summary.</p>
<div class="sourceCode" id="cb1951"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1951-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1951-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit19<span class="fl">.6</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Y ~ 1 + (1 | Group) 
##    Data: my_data (Number of observations: 96) 
##   Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup draws = 12000
## 
## Group-Level Effects: 
## ~Group (Number of levels: 4) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)     4.85      3.45     1.49    13.81 1.00     2325     3508
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept   100.53      2.85    94.60   106.38 1.00     2447     2774
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     5.76      0.43     4.99     6.66 1.00     6178     5676
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Let’s get ready to make our version of the top of Figure 19.7. First we wrangle.</p>
<div class="sourceCode" id="cb1953"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1953-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1953-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many model-implied Gaussians would you like?</span></span>
<span id="cb1953-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1953-2" aria-hidden="true" tabindex="-1"></a>n_draws <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb1953-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1953-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1953-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1953-4" aria-hidden="true" tabindex="-1"></a>densities <span class="ot">&lt;-</span></span>
<span id="cb1953-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1953-5" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1953-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1953-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Group) <span class="sc">%&gt;%</span> </span>
<span id="cb1953-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1953-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_epred_draws</span>(fit19<span class="fl">.6</span>, <span class="at">ndraws =</span> n_draws, <span class="at">seed =</span> <span class="dv">19</span>, <span class="at">dpar =</span> <span class="fu">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1953-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1953-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ll =</span> <span class="fu">qnorm</span>(.<span class="dv">025</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma),</span>
<span id="cb1953-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1953-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">ul =</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb1953-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1953-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="fu">map2</span>(ll, ul, seq, <span class="at">length.out =</span> <span class="dv">100</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1953-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1953-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(Y) <span class="sc">%&gt;%</span> </span>
<span id="cb1953-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1953-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dnorm</span>(Y, mu, sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb1953-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1953-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.draw) <span class="sc">%&gt;%</span> </span>
<span id="cb1953-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1953-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> density <span class="sc">/</span> <span class="fu">max</span>(density))</span>
<span id="cb1953-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1953-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1953-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1953-16" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(densities)</span></code></pre></div>
<pre><code>## Rows: 8,000
## Columns: 12
## Groups: .draw [20]
## $ Group      &lt;chr&gt; &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;,…
## $ .row       &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ .chain     &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
## $ .iteration &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
## $ .draw      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ .epred     &lt;dbl&gt; 97.49239, 97.49239, 97.49239, 97.49239, 97.49239, 97.49239, 97.49239, 97.49239,…
## $ mu         &lt;dbl&gt; 97.49239, 97.49239, 97.49239, 97.49239, 97.49239, 97.49239, 97.49239, 97.49239,…
## $ sigma      &lt;dbl&gt; 6.508508, 6.508508, 6.508508, 6.508508, 6.508508, 6.508508, 6.508508, 6.508508,…
## $ ll         &lt;dbl&gt; 84.73595, 84.73595, 84.73595, 84.73595, 84.73595, 84.73595, 84.73595, 84.73595,…
## $ ul         &lt;dbl&gt; 110.2488, 110.2488, 110.2488, 110.2488, 110.2488, 110.2488, 110.2488, 110.2488,…
## $ Y          &lt;dbl&gt; 84.73595, 84.99366, 85.25136, 85.50907, 85.76677, 86.02448, 86.28219, 86.53989,…
## $ density    &lt;dbl&gt; 0.1465288, 0.1582290, 0.1705958, 0.1836410, 0.1973740, 0.2118018, 0.2269281, 0.…</code></pre>
<p>In our wrangling code, the main thing to notice is those last two lines. If you look closely to Kruschke’s Gaussians, you’ll notice they all have the same maximum height. Up to this point, ours haven’t. This has to do with technicalities on how densities are scaled. In brief, the wider densities have been shorter. So those last two lines scaled all the densities within the same group to the same metric. Otherwise the code was business as usual.</p>
<p>Anyway, here’s our version of the top panel of Figure 19.7.</p>
<div class="sourceCode" id="cb1955"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1955-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1955-1" aria-hidden="true" tabindex="-1"></a>densities <span class="sc">%&gt;%</span> </span>
<span id="cb1955-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1955-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Y, <span class="at">y =</span> Group)) <span class="sc">+</span></span>
<span id="cb1955-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1955-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ridgeline</span>(<span class="fu">aes</span>(<span class="at">height =</span> density, <span class="at">group =</span> <span class="fu">interaction</span>(Group, .draw)),</span>
<span id="cb1955-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1955-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="fu">adjustcolor</span>(pp[<span class="dv">7</span>], <span class="at">alpha.f =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb1955-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1955-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">scale =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1955-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1955-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1955-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1955-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">height =</span> .<span class="dv">04</span>, <span class="at">alpha =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span> pp[<span class="dv">10</span>]) <span class="sc">+</span></span>
<span id="cb1955-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1955-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">80</span>, <span class="at">to =</span> <span class="dv">120</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb1955-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1955-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Data with Posterior Predictive Distrib.&quot;</span>, </span>
<span id="cb1955-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1955-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1955-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1955-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">75</span>, <span class="dv">125</span>),</span>
<span id="cb1955-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1955-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.25</span>, <span class="fl">4.5</span>)) <span class="sc">+</span></span>
<span id="cb1955-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1955-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1955-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1955-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-81-1.png" width="360" style="display: block; margin: auto;" /></p>
<p>Here are the difference distributions in the middle of Figure 19.7.</p>
<div class="sourceCode" id="cb1956"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1956-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-1" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit19<span class="fl">.6</span>)</span>
<span id="cb1956-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1956-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-3" aria-hidden="true" tabindex="-1"></a>differences <span class="ot">&lt;-</span></span>
<span id="cb1956-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-4" aria-hidden="true" tabindex="-1"></a>  draws <span class="sc">%&gt;%</span> </span>
<span id="cb1956-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="st">`</span><span class="at">D vs A</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">r_Group[D,Intercept]</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">r_Group[A,Intercept]</span><span class="st">`</span>,</span>
<span id="cb1956-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">C vs B</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">r_Group[C,Intercept]</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">r_Group[B,Intercept]</span><span class="st">`</span>)</span>
<span id="cb1956-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1956-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-8" aria-hidden="true" tabindex="-1"></a>differences <span class="sc">%&gt;%</span> </span>
<span id="cb1956-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb1956-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;D vs A&quot;</span>, <span class="st">&quot;C vs B&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1956-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1956-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1956-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1956-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">color =</span> pp[<span class="dv">4</span>],</span>
<span id="cb1956-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1956-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1956-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Difference&quot;</span>) <span class="sc">+</span></span>
<span id="cb1956-18"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1956-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-82-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Now here are the effect sizes at the bottom of the figure.</p>
<div class="sourceCode" id="cb1957"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1957-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1957-1" aria-hidden="true" tabindex="-1"></a>differences <span class="sc">%&gt;%</span> </span>
<span id="cb1957-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1957-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="at">.funs =</span> <span class="sc">~</span> . <span class="sc">/</span> draws<span class="sc">$</span>sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb1957-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1957-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb1957-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1957-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;D vs A&quot;</span>, <span class="st">&quot;C vs B&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1957-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1957-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1957-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1957-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1957-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1957-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1957-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1957-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">color =</span> pp[<span class="dv">4</span>],</span>
<span id="cb1957-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1957-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1957-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1957-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1957-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1957-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Effect Size&quot;</span>) <span class="sc">+</span></span>
<span id="cb1957-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1957-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-83-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Oh and remember, if you’d like to get all the possible contrasts in bulk, <strong>tidybayes</strong> has got your back.</p>
<div class="sourceCode" id="cb1958"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1958-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1958-1" aria-hidden="true" tabindex="-1"></a>fit19<span class="fl">.6</span> <span class="sc">%&gt;%</span></span>
<span id="cb1958-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1958-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread_draws</span>(r_Group[Group,]) <span class="sc">%&gt;%</span></span>
<span id="cb1958-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1958-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compare_levels</span>(r_Group, <span class="at">by =</span> Group) <span class="sc">%&gt;%</span></span>
<span id="cb1958-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1958-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># these next two lines allow us to reorder the contrasts along the y</span></span>
<span id="cb1958-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1958-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1958-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1958-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="fu">reorder</span>(Group, r_Group)) <span class="sc">%&gt;%</span></span>
<span id="cb1958-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1958-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1958-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1958-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> r_Group, <span class="at">y =</span> Group)) <span class="sc">+</span></span>
<span id="cb1958-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1958-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> pp[<span class="dv">12</span>]) <span class="sc">+</span></span>
<span id="cb1958-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1958-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1958-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1958-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">color =</span> pp[<span class="dv">4</span>],</span>
<span id="cb1958-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1958-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1958-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1958-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Contrast&quot;</span>,</span>
<span id="cb1958-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1958-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1958-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1958-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">6.5</span>)) <span class="sc">+</span></span>
<span id="cb1958-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1958-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1958-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1958-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-84-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>But to get back on track, here are the <code>stanvars</code> for the robust hierarchical variances model.</p>
<div class="sourceCode" id="cb1959"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1959-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1959-1" aria-hidden="true" tabindex="-1"></a>stanvars <span class="ot">&lt;-</span> </span>
<span id="cb1959-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1959-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(mean_y,    <span class="at">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1959-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1959-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(sd_y,      <span class="at">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb1959-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1959-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>shape, <span class="at">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">+</span></span>
<span id="cb1959-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1959-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>rate,  <span class="at">name =</span> <span class="st">&quot;beta&quot;</span>) <span class="sc">+</span></span>
<span id="cb1959-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1959-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">29</span>,      <span class="at">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>)</span></code></pre></div>
<p>Now fit that robust better-than-ANOVA model.</p>
<div class="sourceCode" id="cb1960"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1960-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-1" aria-hidden="true" tabindex="-1"></a>fit19<span class="fl">.7</span> <span class="ot">&lt;-</span></span>
<span id="cb1960-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1960-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> student,</span>
<span id="cb1960-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bf</span>(Y     <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Group), </span>
<span id="cb1960-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-5" aria-hidden="true" tabindex="-1"></a>         sigma <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Group)),</span>
<span id="cb1960-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="co"># grand means</span></span>
<span id="cb1960-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">10</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1960-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fu">log</span>(sd_y), <span class="dv">1</span>), <span class="at">class =</span> Intercept, <span class="at">dpar =</span> sigma),</span>
<span id="cb1960-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-9" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1960-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-10" aria-hidden="true" tabindex="-1"></a>                <span class="co"># the priors controlling the spread for our hierarchical deflections</span></span>
<span id="cb1960-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">gamma</span>(alpha, beta), <span class="at">class =</span> sd),</span>
<span id="cb1960-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">dpar =</span> sigma),</span>
<span id="cb1960-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-13" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1960-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-14" aria-hidden="true" tabindex="-1"></a>                <span class="co"># don&#39;t forget our student-t nu</span></span>
<span id="cb1960-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(one_over_twentynine), <span class="at">class =</span> nu)),</span>
<span id="cb1960-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1960-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">19</span>,</span>
<span id="cb1960-18"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb1960-19"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">max_treedepth =</span> <span class="dv">12</span>),</span>
<span id="cb1960-20"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars,</span>
<span id="cb1960-21"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1960-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit19.07&quot;</span>)</span></code></pre></div>
<p>The chains look good.</p>
<div class="sourceCode" id="cb1961"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1961-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1961-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit19<span class="fl">.7</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-86-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Here’s the parameter summary.</p>
<div class="sourceCode" id="cb1962"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1962-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1962-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit19<span class="fl">.7</span>)</span></code></pre></div>
<pre><code>##  Family: student 
##   Links: mu = identity; sigma = log; nu = identity 
## Formula: Y ~ 1 + (1 | Group) 
##          sigma ~ 1 + (1 | Group)
##    Data: my_data (Number of observations: 96) 
##   Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup draws = 12000
## 
## Group-Level Effects: 
## ~Group (Number of levels: 4) 
##                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)           4.57      3.23     1.29    13.08 1.00     2709     4724
## sd(sigma_Intercept)     1.22      0.39     0.65     2.17 1.00     4675     5633
## 
## Population-Level Effects: 
##                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept         100.61      2.70    95.53   106.39 1.00     4143     4138
## sigma_Intercept     1.24      0.53     0.20     2.34 1.00     4405     5926
## 
## Family Specific Parameters: 
##    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## nu    32.49     28.09     4.61   108.89 1.00    10069     7665
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Let’s get ready to make our version of the top of Figure 19.7. First we wrangle.</p>
<div class="sourceCode" id="cb1964"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1964-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1964-1" aria-hidden="true" tabindex="-1"></a>densities <span class="ot">&lt;-</span></span>
<span id="cb1964-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1964-2" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1964-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1964-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Group) <span class="sc">%&gt;%</span> </span>
<span id="cb1964-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1964-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_epred_draws</span>(fit19<span class="fl">.7</span>, <span class="at">ndraws =</span> n_draws, <span class="at">seed =</span> <span class="dv">19</span>, <span class="at">dpar =</span> <span class="fu">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;nu&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1964-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1964-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ll =</span> <span class="fu">qt</span>(.<span class="dv">025</span>, <span class="at">df =</span> nu),</span>
<span id="cb1964-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1964-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ul =</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="at">df =</span> nu)) <span class="sc">%&gt;%</span> </span>
<span id="cb1964-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1964-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="fu">map2</span>(ll, ul, seq, <span class="at">length.out =</span> <span class="dv">100</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1964-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1964-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(Y) <span class="sc">%&gt;%</span></span>
<span id="cb1964-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1964-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dt</span>(Y, nu)) <span class="sc">%&gt;%</span> </span>
<span id="cb1964-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1964-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># notice the conversion</span></span>
<span id="cb1964-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1964-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Y =</span> mu <span class="sc">+</span> Y <span class="sc">*</span> sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb1964-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1964-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.draw) <span class="sc">%&gt;%</span> </span>
<span id="cb1964-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1964-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> density <span class="sc">/</span> <span class="fu">max</span>(density))</span>
<span id="cb1964-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1964-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1964-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1964-15" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(densities)</span></code></pre></div>
<pre><code>## Rows: 8,000
## Columns: 13
## Groups: .draw [20]
## $ Group      &lt;chr&gt; &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;,…
## $ .row       &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ .chain     &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
## $ .iteration &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
## $ .draw      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ .epred     &lt;dbl&gt; 96.41185, 96.41185, 96.41185, 96.41185, 96.41185, 96.41185, 96.41185, 96.41185,…
## $ mu         &lt;dbl&gt; 96.41185, 96.41185, 96.41185, 96.41185, 96.41185, 96.41185, 96.41185, 96.41185,…
## $ sigma      &lt;dbl&gt; 7.029854, 7.029854, 7.029854, 7.029854, 7.029854, 7.029854, 7.029854, 7.029854,…
## $ nu         &lt;dbl&gt; 17.19399, 17.19399, 17.19399, 17.19399, 17.19399, 17.19399, 17.19399, 17.19399,…
## $ ll         &lt;dbl&gt; -2.108004, -2.108004, -2.108004, -2.108004, -2.108004, -2.108004, -2.108004, -2…
## $ ul         &lt;dbl&gt; 2.108004, 2.108004, 2.108004, 2.108004, 2.108004, 2.108004, 2.108004, 2.108004,…
## $ Y          &lt;dbl&gt; 81.59289, 81.89227, 82.19164, 82.49101, 82.79039, 83.08976, 83.38913, 83.68851,…
## $ density    &lt;dbl&gt; 0.1235710, 0.1331992, 0.1434447, 0.1543309, 0.1658803, 0.1781139, 0.1910512, 0.…</code></pre>
<p>If you look closely at our code, above, you’ll note switching from the Gaussian to the Student <span class="math inline">\(t\)</span> required changes in our flow. Most obviously, we switched from <code>qnorm()</code> and <code>dnorm()</code> to <code>qt()</code> and <code>dt()</code>, respectively. The base <strong>R</strong> Student <span class="math inline">\(t\)</span> functions don’t take arguments for <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>. Rather, they’re presumed to be 0 and 1, respectively. That means that for our first three <code>mutate()</code> functions, the computations were all based on the standard Student <span class="math inline">\(t\)</span>, with only the <span class="math inline">\(\nu\)</span> parameter varying according to the posterior. The way we corrected for that was with the fourth <code>mutate()</code>.</p>
<p>Now we’re ready to make and save our version of the top panel of Figure 19.7.</p>
<div class="sourceCode" id="cb1966"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1966-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1966-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1966-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1966-2" aria-hidden="true" tabindex="-1"></a>  densities <span class="sc">%&gt;%</span> </span>
<span id="cb1966-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1966-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Y, <span class="at">y =</span> Group)) <span class="sc">+</span></span>
<span id="cb1966-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1966-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ridgeline</span>(<span class="fu">aes</span>(<span class="at">height =</span> density, <span class="at">group =</span> <span class="fu">interaction</span>(Group, .draw)),</span>
<span id="cb1966-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1966-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="fu">adjustcolor</span>(pp[<span class="dv">7</span>], <span class="at">alpha.f =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb1966-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1966-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">scale =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1966-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1966-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1966-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1966-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">height =</span> .<span class="dv">04</span>, <span class="at">alpha =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span> pp[<span class="dv">10</span>]) <span class="sc">+</span></span>
<span id="cb1966-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1966-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">80</span>, <span class="at">to =</span> <span class="dv">120</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb1966-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1966-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Data with Posterior Predictive Distrib.&quot;</span>, </span>
<span id="cb1966-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1966-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1966-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1966-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">75</span>, <span class="dv">125</span>),</span>
<span id="cb1966-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1966-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.25</span>, <span class="fl">4.5</span>)) <span class="sc">+</span></span>
<span id="cb1966-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1966-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1966-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1966-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p>Here we make the difference distributions in the middle of Figure 19.8.</p>
<div class="sourceCode" id="cb1967"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1967-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1967-1" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit19<span class="fl">.7</span>)</span>
<span id="cb1967-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1967-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1967-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1967-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1967-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1967-4" aria-hidden="true" tabindex="-1"></a>  draws <span class="sc">%&gt;%</span> </span>
<span id="cb1967-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1967-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="st">`</span><span class="at">D vs A</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">r_Group[D,Intercept]</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">r_Group[A,Intercept]</span><span class="st">`</span>,</span>
<span id="cb1967-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1967-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">C vs B</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">r_Group[C,Intercept]</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">r_Group[B,Intercept]</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1967-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1967-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb1967-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1967-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;D vs A&quot;</span>, <span class="st">&quot;C vs B&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1967-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1967-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1967-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1967-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1967-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1967-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1967-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1967-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">color =</span> pp[<span class="dv">4</span>],</span>
<span id="cb1967-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1967-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1967-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1967-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1967-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1967-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Difference&quot;</span>) <span class="sc">+</span></span>
<span id="cb1967-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1967-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>And here we make the plots of the corresponding effect sizes at the bottom of the Figure 19.8.</p>
<div class="sourceCode" id="cb1968"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1968-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first compute and save the sigma_j&#39;s, which will come in handy later </span></span>
<span id="cb1968-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-2" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span></span>
<span id="cb1968-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-3" aria-hidden="true" tabindex="-1"></a>  draws <span class="sc">%&gt;%</span> </span>
<span id="cb1968-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sigma_A =</span> <span class="fu">exp</span>(b_sigma_Intercept <span class="sc">+</span> <span class="st">`</span><span class="at">r_Group__sigma[A,Intercept]</span><span class="st">`</span>),</span>
<span id="cb1968-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">sigma_B =</span> <span class="fu">exp</span>(b_sigma_Intercept <span class="sc">+</span> <span class="st">`</span><span class="at">r_Group__sigma[B,Intercept]</span><span class="st">`</span>),</span>
<span id="cb1968-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">sigma_C =</span> <span class="fu">exp</span>(b_sigma_Intercept <span class="sc">+</span> <span class="st">`</span><span class="at">r_Group__sigma[C,Intercept]</span><span class="st">`</span>),</span>
<span id="cb1968-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">sigma_D =</span> <span class="fu">exp</span>(b_sigma_Intercept <span class="sc">+</span> <span class="st">`</span><span class="at">r_Group__sigma[D,Intercept]</span><span class="st">`</span>))</span>
<span id="cb1968-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1968-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-9" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb1968-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-10" aria-hidden="true" tabindex="-1"></a>  draws <span class="sc">%&gt;%</span> </span>
<span id="cb1968-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note we&#39;re using pooled standard deviations to standardize our effect sizes, here</span></span>
<span id="cb1968-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="st">`</span><span class="at">D vs A</span><span class="st">`</span> <span class="ot">=</span> (<span class="st">`</span><span class="at">r_Group[D,Intercept]</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">r_Group[A,Intercept]</span><span class="st">`</span>) <span class="sc">/</span> <span class="fu">sqrt</span>((sigma_A<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sigma_D<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">2</span>),</span>
<span id="cb1968-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">C vs B</span><span class="st">`</span> <span class="ot">=</span> (<span class="st">`</span><span class="at">r_Group[C,Intercept]</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">r_Group[B,Intercept]</span><span class="st">`</span>) <span class="sc">/</span> <span class="fu">sqrt</span>((sigma_B<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sigma_C<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1968-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb1968-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;D vs A&quot;</span>, <span class="st">&quot;C vs B&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1968-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1968-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1968-18"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1968-19"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">color =</span> pp[<span class="dv">4</span>],</span>
<span id="cb1968-20"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1968-21"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1968-22"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Effect Size&quot;</span>) <span class="sc">+</span></span>
<span id="cb1968-23"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1968-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Combine them all and plot!</p>
<div class="sourceCode" id="cb1969"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1969-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1969-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2 <span class="sc">/</span> p3 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-92-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>Notice that because (a) the sigma parameters were heterogeneous and (b) they were estimated on the log scale, we had to do quite a bit more data processing before they effect size estimates were ready.</p>
<p>“Finally, because each group has its own estimated scale (i.e., <span class="math inline">\(\sigma_j\)</span>), we can investigate differences in scales across groups” (p. 578). That’s not a bad idea. Even though Kruschke didn’t show this in the text, we may as well give it a go.</p>
<div class="sourceCode" id="cb1970"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1970-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1970-1" aria-hidden="true" tabindex="-1"></a><span class="co"># recall we computed the sigma_j&#39;s a couple blocks up;</span></span>
<span id="cb1970-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1970-2" aria-hidden="true" tabindex="-1"></a><span class="co"># now we put them to use</span></span>
<span id="cb1970-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1970-3" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb1970-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1970-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="st">`</span><span class="at">D vs A</span><span class="st">`</span> <span class="ot">=</span> sigma_D <span class="sc">-</span> sigma_A,</span>
<span id="cb1970-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1970-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">C vs B</span><span class="st">`</span> <span class="ot">=</span> sigma_C <span class="sc">-</span> sigma_B,</span>
<span id="cb1970-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1970-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">D vs C</span><span class="st">`</span> <span class="ot">=</span> sigma_D <span class="sc">-</span> sigma_C,</span>
<span id="cb1970-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1970-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">B vs A</span><span class="st">`</span> <span class="ot">=</span> sigma_B <span class="sc">-</span> sigma_A) <span class="sc">%&gt;%</span> </span>
<span id="cb1970-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1970-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb1970-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1970-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;D vs A&quot;</span>, <span class="st">&quot;C vs B&quot;</span>, <span class="st">&quot;D vs C&quot;</span>, <span class="st">&quot;B vs A&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1970-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1970-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1970-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1970-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1970-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1970-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1970-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1970-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">5</span>], <span class="at">color =</span> pp[<span class="dv">4</span>],</span>
<span id="cb1970-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1970-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1970-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1970-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1970-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1970-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(Differences<span class="sc">~</span><span class="st">&#39;in&#39;</span><span class="sc">~</span>sigma[<span class="fu">italic</span>(j)])) <span class="sc">+</span></span>
<span id="cb1970-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1970-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-93-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>For more on models including a hierarchical structure on both the mean and scale structures, check out <a href="https://twitter.com/wdonald_1985">Donald Williams</a> and colleagues’ work on what they call Mixed Effect Location and Scale Models [MELSM; e.g., <span class="citation">Donald R. Williams et al. (<a href="#ref-williamsBayesianMultivariateMixedeffects2021" role="doc-biblioref">2021</a>)</span>; <span class="citation">Donald R. Williams et al. (<a href="#ref-williamsBayesianNonlinearMixedeffects2019" role="doc-biblioref">2019</a>)</span>]. They’re quite handy and I’ve begun using them in my applied work (e.g., <a href="https://osf.io/vekpf/">here</a>). You can also find a brief introduction to MELSM’s within the context of the multilevel growth model in <a href="https://bookdown.org/content/4857/adventures-in-covariance.html#summary-bonus-multilevel-growth-models-and-the-melsm">Section 14.6</a> of my <span class="citation">(<a href="#ref-kurzStatisticalRethinkingBrms2020" role="doc-biblioref">2020</a>)</span> translation of McElreath’s <span class="citation">(<a href="#ref-mcelreathStatisticalRethinkingBayesian2020" role="doc-biblioref">2020</a>)</span> second edition.</p>
</div>
</div>
<div id="exercises-walk-out-an-effect-size" class="section level2 hasAnchor" number="19.6">
<h2><span class="header-section-number">19.6</span> <del>Exercises</del> Walk out an effect size<a href="metric-predicted-variable-with-one-nominal-predictor.html#exercises-walk-out-an-effect-size" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We computed a lot of effect sizes in this chapter. They were all standardized mean differences. <span class="citation">Cohen (<a href="#ref-cohenStatisticalPowerAnalysis1988" role="doc-biblioref">1988</a>)</span> discussed these kinds of effect sizes in this way:</p>
<blockquote>
<p>We need a “pure” number, one free of our original measurement unit, with which to index what can be alternately called the degree of departure from the null hypothesis of the alternate hypothesis, or the ES (effect size) we wish to detect. This is accomplished by standardizing the raw effect size as expressed in the measurement unit of the dependent variable by dividing it by the (common) standard deviation of the measures in their respective populations, the latter also in the original measurement unit. (p. 20)</p>
</blockquote>
<p>Though Cohen framed his discussion in terms of null-hypothesis significance testing, we can just as easily apply it to our Bayesian modeling framework. The main thing is we can use his definitions from above to define a particular kind of effect size–the standardized mean difference between two groups. This is commonly referred to as a Cohen’s <span class="math inline">\(d\)</span>, which follows the formula</p>
<p><span class="math display">\[d = \frac{\bar y_A - \bar y_B}{s_p},\]</span></p>
<p>where the unstandardized means of the variable of interest <span class="math inline">\(y\)</span> are compared between two groups, A and B. From the raw data, we compute their two means, <span class="math inline">\(\bar y_A\)</span> and <span class="math inline">\(\bar y_B\)</span>, and divide their difference by the common (i.e., pooled) standard deviation <span class="math inline">\(s_p\)</span>. In practice, the empirically-derived means and standard deviations are stand-ins (i.e., estimates) of the population parameters. If we’re willing to ignore uncertainty, we can do this all by hand.</p>
<p>Let’s walk this out with the fruit-fly data from <a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-and-death.">Section 19.3.2</a>.</p>
<div class="sourceCode" id="cb1971"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1971-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1971-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data.R/FruitflyDataReduced.csv&quot;</span>)</span>
<span id="cb1971-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1971-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1971-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1971-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(my_data)</span></code></pre></div>
<pre><code>## Rows: 125
## Columns: 3
## $ Longevity       &lt;dbl&gt; 35, 37, 49, 46, 63, 39, 46, 56, 63, 65, 56, 65, 70, 63, 65, 70, 77, 81, 86…
## $ CompanionNumber &lt;chr&gt; &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant…
## $ Thorax          &lt;dbl&gt; 0.64, 0.68, 0.68, 0.72, 0.72, 0.76, 0.76, 0.76, 0.76, 0.76, 0.80, 0.80, 0.…</code></pre>
<p>Recall we have five groups indexed by <code>CompanionNumber</code>, each with <span class="math inline">\(n = 25\)</span>.</p>
<div class="sourceCode" id="cb1973"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1973-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1973-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1973-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1973-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(CompanionNumber)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   CompanionNumber     n
##   &lt;chr&gt;           &lt;int&gt;
## 1 None0              25
## 2 Pregnant1          25
## 3 Pregnant8          25
## 4 Virgin1            25
## 5 Virgin8            25</code></pre>
<p>Let’s focus on just two groups, the male fruit flies for which individual males were supplied access to one or with virgin female fruit flies per day. In the data, these are <code>CompanionNumber == Virgin1</code> and <code>CompanionNumber == Virgin8</code>, respectively. Here’s a look at their mean <code>Longevity</code> values.</p>
<div class="sourceCode" id="cb1975"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1975-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1975-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1975-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1975-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(CompanionNumber, <span class="st">&quot;Virgin&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1975-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1975-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CompanionNumber) <span class="sc">%&gt;%</span> </span>
<span id="cb1975-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1975-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Longevity))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   CompanionNumber  mean
##   &lt;chr&gt;           &lt;dbl&gt;
## 1 Virgin1          56.8
## 2 Virgin8          38.7</code></pre>
<p>If we’re willing to treat the males in the <code>Virgin1</code> group as group “a” and those in the <code>Virgin8</code> group as group “b”, we can save those mean values like so.</p>
<div class="sourceCode" id="cb1977"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1977-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1977-1" aria-hidden="true" tabindex="-1"></a>y_bar_a <span class="ot">&lt;-</span> <span class="fu">filter</span>(my_data, CompanionNumber <span class="sc">==</span> <span class="st">&quot;Virgin1&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">y_bar =</span> <span class="fu">mean</span>(Longevity)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb1977-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1977-2" aria-hidden="true" tabindex="-1"></a>y_bar_b <span class="ot">&lt;-</span> <span class="fu">filter</span>(my_data, CompanionNumber <span class="sc">==</span> <span class="st">&quot;Virgin8&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">y_bar =</span> <span class="fu">mean</span>(Longevity)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span></code></pre></div>
<p>Now we’ll compute their pooled standard deviation.</p>
<div class="sourceCode" id="cb1978"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1978-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1978-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1978-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1978-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(CompanionNumber, <span class="st">&quot;Virgin&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1978-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1978-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CompanionNumber) <span class="sc">%&gt;%</span> </span>
<span id="cb1978-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1978-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">s =</span> <span class="fu">sd</span>(Longevity)) <span class="sc">%&gt;%</span> </span>
<span id="cb1978-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1978-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">s_p =</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(s<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##     s_p
##   &lt;dbl&gt;
## 1  13.6</code></pre>
<p>Save that value.</p>
<div class="sourceCode" id="cb1980"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1980-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1980-1" aria-hidden="true" tabindex="-1"></a>s_a <span class="ot">&lt;-</span> <span class="fu">filter</span>(my_data, CompanionNumber <span class="sc">==</span> <span class="st">&quot;Virgin1&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">s =</span> <span class="fu">sd</span>(Longevity)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb1980-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1980-2" aria-hidden="true" tabindex="-1"></a>s_b <span class="ot">&lt;-</span> <span class="fu">filter</span>(my_data, CompanionNumber <span class="sc">==</span> <span class="st">&quot;Virgin8&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">s =</span> <span class="fu">sd</span>(Longevity)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb1980-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1980-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1980-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1980-4" aria-hidden="true" tabindex="-1"></a>s_p <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((s_a<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> s_b<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">2</span>)</span></code></pre></div>
<p>If you’re confused by how we computed the pooled standard deviation, recall that when comparing two groups that may have different group-level standard deviations, the formula for the <span class="math inline">\(s_p\)</span> is</p>
<p><span class="math display">\[s_p = \sqrt{\frac{s_A^2 + s_B^2}{2}},\]</span></p>
<p>where <span class="math inline">\(s_A\)</span> and <span class="math inline">\(s_B\)</span> are the group-level standard deviations. Kruschke introduced this formula back in <a href="metric-predicted-variable-on-one-or-two-groups.html#two-groups">Section 16.3</a> and we briefly emphasized it in our <a href="metric-predicted-variable-on-one-or-two-groups.html#bonus-pooled-standard-deviation.">Bonus Section 16.3.0.1</a>. Now we have the sample <span class="math inline">\(s_p\)</span> in hand, computing Cohen’s <span class="math inline">\(d\)</span> is just simple arithmetic.</p>
<div class="sourceCode" id="cb1981"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1981-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1981-1" aria-hidden="true" tabindex="-1"></a>(y_bar_a <span class="sc">-</span> y_bar_b) <span class="sc">/</span> s_p</span></code></pre></div>
<pre><code>## [1] 1.327554</code></pre>
<p>Though I’m not up on contemporary standards in fruit fly research, a Cohen’s <span class="math inline">\(d\)</span> of that size would be considered [conspicuously] large in most areas of my field (psychology). If we’d like to compute the <span class="math inline">\(d\)</span> estimates for any other combination of experimental conditions, we’d just follow the corresponding arithmetic.</p>
<p>As I hinted at earlier, the problem with this approach is it ignores uncertainty. Frequentists use various formulas to express this in terms of 95% confidence intervals. Our approach will be to express it with the posterior distribution of a Bayesian model. We’ve already accomplished this with our <code>fit19.1</code> from above. Here we’ll use three other approaches.</p>
<p>Instead of the Bayesian hierarchical alternative to the frequentist ANOVA, we can use a single-level model where we predict a metric variable with separate intercepts for the two levels of <code>CompanionNumber</code>. First, we subset the data and define our <code>stanvars</code>.</p>
<div class="sourceCode" id="cb1983"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1983-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1983-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span></span>
<span id="cb1983-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1983-2" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1983-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1983-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(CompanionNumber, <span class="st">&quot;Virgin&quot;</span>))</span>
<span id="cb1983-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1983-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1983-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1983-5" aria-hidden="true" tabindex="-1"></a>mean_y <span class="ot">&lt;-</span> (y_bar_a <span class="sc">+</span> y_bar_b) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb1983-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1983-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1983-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1983-7" aria-hidden="true" tabindex="-1"></a>stanvars <span class="ot">&lt;-</span> </span>
<span id="cb1983-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1983-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(mean_y, <span class="at">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1983-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1983-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_p,    <span class="at">name =</span> <span class="st">&quot;sd_y&quot;</span>)</span></code></pre></div>
<p>Fit the model with <code>brm()</code>.</p>
<div class="sourceCode" id="cb1984"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1984-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1984-1" aria-hidden="true" tabindex="-1"></a>fit19<span class="fl">.8</span> <span class="ot">&lt;-</span></span>
<span id="cb1984-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1984-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1984-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1984-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1984-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1984-4" aria-hidden="true" tabindex="-1"></a>      Longevity <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> CompanionNumber,</span>
<span id="cb1984-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1984-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> b),</span>
<span id="cb1984-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1984-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb1984-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1984-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">3000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1984-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1984-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">19</span>,</span>
<span id="cb1984-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1984-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars,</span>
<span id="cb1984-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1984-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit19.08&quot;</span>)</span></code></pre></div>
<p>Check the summary.</p>
<div class="sourceCode" id="cb1985"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1985-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1985-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit19<span class="fl">.8</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Longevity ~ 0 + CompanionNumber 
##    Data: my_data (Number of observations: 50) 
##   Draws: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
##          total post-warmup draws = 8000
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## CompanionNumberVirgin1    56.73      2.79    51.28    62.08 1.00     7472     5631
## CompanionNumberVirgin8    38.79      2.74    33.50    44.17 1.00     7514     5542
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    13.80      1.44    11.34    16.96 1.00     7950     5657
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Extract the posterior draws.</p>
<div class="sourceCode" id="cb1987"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1987-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1987-1" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit19<span class="fl">.8</span>)</span></code></pre></div>
<p>Here we’ll plot the three dimensions of the posterior, each with the corresponding value from the Cohen’s <span class="math inline">\(d\)</span> formula marked off as a vertical line in the foreground.</p>
<div class="sourceCode" id="cb1988"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1988-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1988-1" aria-hidden="true" tabindex="-1"></a>lines <span class="ot">&lt;-</span></span>
<span id="cb1988-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1988-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">name  =</span> <span class="fu">c</span>(<span class="st">&quot;b_CompanionNumberVirgin1&quot;</span>, <span class="st">&quot;b_CompanionNumberVirgin8&quot;</span>, <span class="st">&quot;sigma&quot;</span>),</span>
<span id="cb1988-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1988-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">value =</span> <span class="fu">c</span>(y_bar_a, y_bar_b, s_p))</span>
<span id="cb1988-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1988-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1988-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1988-5" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb1988-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1988-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(b_CompanionNumberVirgin1<span class="sc">:</span>sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb1988-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1988-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1988-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1988-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1988-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1988-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1988-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1988-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">2</span>], <span class="at">color =</span> pp[<span class="dv">7</span>],</span>
<span id="cb1988-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1988-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1988-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1988-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> lines,</span>
<span id="cb1988-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1988-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">xintercept =</span> value),</span>
<span id="cb1988-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1988-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> pp[<span class="dv">13</span>], <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1988-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1988-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1988-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1988-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;posterior&quot;</span>) <span class="sc">+</span></span>
<span id="cb1988-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1988-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-104-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The model did a great job capturing all three parameters. If we would like to compute our Cohen’s <span class="math inline">\(d\)</span> using the posterior iterations from <code>fit19.8</code>, we’d execute something like this.</p>
<div class="sourceCode" id="cb1989"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1989-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1989-1" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb1989-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1989-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d =</span> (b_CompanionNumberVirgin1 <span class="sc">-</span> b_CompanionNumberVirgin8) <span class="sc">/</span> sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb1989-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1989-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1989-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1989-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1989-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1989-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1989-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1989-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">2</span>], <span class="at">color =</span> pp[<span class="dv">7</span>],</span>
<span id="cb1989-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1989-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1989-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1989-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> (y_bar_a <span class="sc">-</span> y_bar_b) <span class="sc">/</span> s_p,</span>
<span id="cb1989-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1989-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> pp[<span class="dv">13</span>], <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1989-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1989-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1989-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1989-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="st">&quot;Cohen&#39;s&quot;</span><span class="sc">~</span><span class="fu">italic</span>(d)<span class="sc">~</span><span class="st">&quot;expressed as a posterior&quot;</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-105-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>Similar to the previous plots, this time we superimposed the posterior density with the sample estimate for <span class="math inline">\(d\)</span> we computed above, <code>(y_bar_a - y_bar_b) / s_p</code>. Happily, the hand-calculated estimate coheres nicely with the central tendency of our posterior distribution. But now we get a full measure of uncertainty. Notice how wide those 95% HDIs are. Hopefully this isn’t a surprise given our noncommittal priors and only <span class="math inline">\(n = 25\)</span> for both groups. There’s a lot of uncertainty in that posterior.</p>
<p>A second way we might use a single-level model to compute a Cohen’s <span class="math inline">\(d\)</span> effect size is using a dummy variable. We’ll convert our nominal variable <code>CompanionNumber</code> into a binary variable <code>Virgin1</code> for which 1 corresponds to <code>CompanionNumber == Virgin1</code> and 0 corresponds to <code>CompanionNumber == Virgin8</code>. Compute the dummy.</p>
<div class="sourceCode" id="cb1990"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1990-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1990-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span></span>
<span id="cb1990-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1990-2" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1990-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1990-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Virgin1 =</span> <span class="fu">if_else</span>(CompanionNumber <span class="sc">==</span> <span class="st">&quot;Virgin1&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code></pre></div>
<p>Now fit the dummy-predictor model with <code>brm()</code>.</p>
<div class="sourceCode" id="cb1991"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1991-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1991-1" aria-hidden="true" tabindex="-1"></a>fit19<span class="fl">.9</span> <span class="ot">&lt;-</span></span>
<span id="cb1991-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1991-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1991-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1991-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1991-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1991-4" aria-hidden="true" tabindex="-1"></a>      Longevity <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Virgin1,</span>
<span id="cb1991-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1991-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1991-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1991-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, sd_y <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> b),</span>
<span id="cb1991-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1991-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb1991-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1991-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">3000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1991-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1991-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">19</span>,</span>
<span id="cb1991-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1991-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars,</span>
<span id="cb1991-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1991-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit19.09&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1992"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1992-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1992-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit19<span class="fl">.9</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Longevity ~ 1 + Virgin1 
##    Data: my_data (Number of observations: 50) 
##   Draws: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
##          total post-warmup draws = 8000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    38.78      2.77    33.35    44.15 1.00     6678     5009
## Virgin1      17.97      3.87    10.24    25.54 1.00     7088     5360
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    13.80      1.45    11.36    16.97 1.00     7021     5250
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>With this parameterization, our posterior for <code>Intercept</code> is the same, within simulation variation, as <code>CompanionNumberVirgin8</code> from <code>fit7</code>. The posterior for <code>sigma</code> is about the same for both models, too. But focus on <code>Virgin1</code>. This is the unstandardized mean difference, what we called <span class="math inline">\(\bar y_A - \bar y_B\)</span> when we computed Cohen’s <span class="math inline">\(d\)</span> using sample statistics. Here’s a look at its posterior distribution with its empirical estimate superimposed with a vertical line.</p>
<div class="sourceCode" id="cb1994"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1994-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1994-1" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit19<span class="fl">.9</span>)</span>
<span id="cb1994-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1994-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1994-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1994-3" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb1994-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1994-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> b_Virgin1, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1994-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1994-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1994-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1994-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">2</span>], <span class="at">color =</span> pp[<span class="dv">7</span>],</span>
<span id="cb1994-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1994-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1994-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1994-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> y_bar_a <span class="sc">-</span> y_bar_b,</span>
<span id="cb1994-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1994-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> pp[<span class="dv">13</span>], <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1994-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1994-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1994-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1994-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Unstandardized mean difference&quot;</span>)</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-108-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>Here’s how to standardize that unstandardized effect size into a Cohen’s-<span class="math inline">\(d\)</span> metric.</p>
<div class="sourceCode" id="cb1995"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1995-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1995-1" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb1995-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1995-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d =</span> b_Virgin1 <span class="sc">/</span> sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb1995-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1995-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1995-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1995-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1995-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1995-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1995-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1995-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">2</span>], <span class="at">color =</span> pp[<span class="dv">7</span>],</span>
<span id="cb1995-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1995-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1995-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1995-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> (y_bar_a <span class="sc">-</span> y_bar_b) <span class="sc">/</span> s_p,</span>
<span id="cb1995-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1995-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> pp[<span class="dv">13</span>], <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1995-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1995-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1995-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1995-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="st">&quot;Cohen&#39;s&quot;</span><span class="sc">~</span><span class="fu">italic</span>(d)<span class="sc">~</span><span class="st">&quot;expressed as a posterior&quot;</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-109-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>Let’s work this one more way. By simple algebra, a standardized mean difference is the same as the difference between two standardized means. The trick, though, is you have to use the pooled standard deviation (<span class="math inline">\(s_p\)</span>) as your standardizer. Thus, if we standardize the criterion <code>Longevity</code> before fitting the model and continue using the dummy variable approach, the <code>Virgin1</code> posterior will be the same as a Cohen’s <span class="math inline">\(d\)</span>.</p>
<p>Standardize the criterion with <code>s_p</code>.</p>
<div class="sourceCode" id="cb1996"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1996-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1996-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span></span>
<span id="cb1996-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1996-2" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1996-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1996-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Longevity_s =</span> (Longevity <span class="sc">-</span> <span class="fu">mean</span>(Longevity)) <span class="sc">/</span> s_p)</span></code></pre></div>
<p>Because our criterion in a standardized metric, we no longer need our <code>stanvars</code>.</p>
<div class="sourceCode" id="cb1997"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1997-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1997-1" aria-hidden="true" tabindex="-1"></a>fit19<span class="fl">.10</span> <span class="ot">&lt;-</span></span>
<span id="cb1997-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1997-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1997-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1997-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1997-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1997-4" aria-hidden="true" tabindex="-1"></a>      Longevity_s <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Virgin1,</span>
<span id="cb1997-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1997-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span> <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1997-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1997-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span> <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> b),</span>
<span id="cb1997-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1997-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb1997-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1997-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">3000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1997-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1997-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">19</span>,</span>
<span id="cb1997-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1997-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit19.10&quot;</span>)</span></code></pre></div>
<p>Behold our out-of-the-box Bayesian Cohen’s <span class="math inline">\(d\)</span>.</p>
<div class="sourceCode" id="cb1998"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1998-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1998-1" aria-hidden="true" tabindex="-1"></a><span class="co"># no transformation necessary</span></span>
<span id="cb1998-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1998-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit19<span class="fl">.10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1998-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1998-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1998-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1998-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> b_Virgin1, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1998-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1998-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1998-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1998-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">2</span>], <span class="at">color =</span> pp[<span class="dv">7</span>],</span>
<span id="cb1998-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1998-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb1998-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1998-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> (y_bar_a <span class="sc">-</span> y_bar_b) <span class="sc">/</span> s_p,</span>
<span id="cb1998-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1998-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> pp[<span class="dv">13</span>], <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1998-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1998-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1998-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1998-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="st">&quot;Cohen&#39;s&quot;</span><span class="sc">~</span><span class="fu">italic</span>(d)<span class="sc">~</span><span class="st">&quot;expressed as a posterior&quot;</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-111-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>If you work them through, the three approaches we just took can be generalized to models with more than two groups. You just need to be careful how to compute the <span class="math inline">\(s_p\)</span> for each comparison.</p>
<p>It’s also the case the that standardized mean differences we computed for <code>fit19.1</code>, above, are not quite Cohen’s <span class="math inline">\(d\)</span> effect sizes in the same way these have been. This is because the hierarchical approach we used partially pooled the estimates for each group toward the grand mean. You might say they were hierarchically-regularized Cohen’s <span class="math inline">\(d\)</span>s. But then again, Cohen’s formula for his <span class="math inline">\(d\)</span> statistic did not account for Bayesian priors, either. So perhaps a purist would deny that any of the standardized mean differences we’ve computed in this chapter were proper Cohen’s <span class="math inline">\(d\)</span> effect sizes. To be on the safe side, tell your readers exactly how you computed your models and what formulas you used to compute your effect sizes.</p>
<div id="your-sample-sizes-may-differ." class="section level3 hasAnchor" number="19.6.1">
<h3><span class="header-section-number">19.6.1</span> Your sample sizes may differ.<a href="metric-predicted-variable-with-one-nominal-predictor.html#your-sample-sizes-may-differ." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the examples, above, the two groups had equal sample sizes, which allowed us to be lazy with how we hand computed the sample estimate of the pooled standard deviation. When working with data for which <span class="math inline">\(n_A \neq n_B\)</span>, it’s a good idea to switch out the equation for the pooled standard deviation <span class="math inline">\(s_p\)</span> for <span class="math inline">\(s_p^*\)</span>, which is robust to unequal sample sizes. We wan write the equation for the two-groups version of <span class="math inline">\(s_p^*\)</span> as</p>
<p><span class="math display">\[s_p^* = \sqrt{\frac{(n_A - 1)s_A^2 + (n_B - 1)s_B^2}{n_A + n_B - 2}},\]</span></p>
<p>which strategically weights the sample estimate for the pooled standard deviation by sample size.</p>
<p>We should practice with <span class="math inline">\(s_p^*\)</span>, a bit, to see how it works together with our Bayesian modeling paradigm. Back in <a href="metric-predicted-variable-on-one-or-two-groups.html#approximation-by-mcmc-in-jags-hmc-in-brms.">Section 16.1.2</a>, we saw an example of this with the <code>TwoGroupIQ</code> data. Let’s load them, again.</p>
<div class="sourceCode" id="cb1999"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1999-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1999-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data.R/TwoGroupIQ.csv&quot;</span>)</span>
<span id="cb1999-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1999-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1999-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb1999-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(my_data)</span></code></pre></div>
<pre><code>## Rows: 120
## Columns: 2
## $ Score &lt;dbl&gt; 102, 107, 92, 101, 110, 68, 119, 106, 99, 103, 90, 93, 79, 89, 137, 119, 126, 110, 7…
## $ Group &lt;chr&gt; &quot;Smart Drug&quot;, &quot;Smart Drug&quot;, &quot;Smart Drug&quot;, &quot;Smart Drug&quot;, &quot;Smart Drug&quot;, &quot;Smart Drug&quot;, …</code></pre>
<p>The data are IQ scores for participants in two groups. They look like this.</p>
<div class="sourceCode" id="cb2001"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2001-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2001-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb2001-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2001-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Score, Group)) <span class="sc">+</span></span>
<span id="cb2001-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2001-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb2001-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2001-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">2</span>], <span class="at">color =</span> pp[<span class="dv">7</span>],</span>
<span id="cb2001-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2001-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb2001-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2001-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;IQ score&quot;</span>) <span class="sc">+</span></span>
<span id="cb2001-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2001-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.25</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-113-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Unlike the examples from the last section, the samples sizes are different for our two levels of <code>Group</code>.</p>
<div class="sourceCode" id="cb2002"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2002-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2002-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb2002-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2002-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Group)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   Group          n
##   &lt;chr&gt;      &lt;int&gt;
## 1 Placebo       57
## 2 Smart Drug    63</code></pre>
<p>Here’s how we can use that information to hand compute the sample estimate for Cohen’s <span class="math inline">\(d\)</span>.</p>
<div class="sourceCode" id="cb2004"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2004-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2004-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save the sample means for the groups</span></span>
<span id="cb2004-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2004-2" aria-hidden="true" tabindex="-1"></a>y_bar_a <span class="ot">&lt;-</span> <span class="fu">filter</span>(my_data, Group <span class="sc">==</span> <span class="st">&quot;Smart Drug&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">m =</span> <span class="fu">mean</span>(Score)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb2004-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2004-3" aria-hidden="true" tabindex="-1"></a>y_bar_b <span class="ot">&lt;-</span> <span class="fu">filter</span>(my_data, Group <span class="sc">==</span> <span class="st">&quot;Placebo&quot;</span>)    <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">m =</span> <span class="fu">mean</span>(Score)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb2004-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2004-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2004-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2004-5" aria-hidden="true" tabindex="-1"></a><span class="co"># save the sample sizes for the groups </span></span>
<span id="cb2004-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2004-6" aria-hidden="true" tabindex="-1"></a>n_a <span class="ot">&lt;-</span> <span class="fu">filter</span>(my_data, Group <span class="sc">==</span> <span class="st">&quot;Smart Drug&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb2004-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2004-7" aria-hidden="true" tabindex="-1"></a>n_b <span class="ot">&lt;-</span> <span class="fu">filter</span>(my_data, Group <span class="sc">==</span> <span class="st">&quot;Placebo&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb2004-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2004-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2004-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2004-9" aria-hidden="true" tabindex="-1"></a><span class="co"># save the sample standard deviations</span></span>
<span id="cb2004-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2004-10" aria-hidden="true" tabindex="-1"></a>s_a <span class="ot">&lt;-</span> <span class="fu">filter</span>(my_data, Group <span class="sc">==</span> <span class="st">&quot;Smart Drug&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">s =</span> <span class="fu">sd</span>(Score)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb2004-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2004-11" aria-hidden="true" tabindex="-1"></a>s_b <span class="ot">&lt;-</span> <span class="fu">filter</span>(my_data, Group <span class="sc">==</span> <span class="st">&quot;Placebo&quot;</span>)    <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">s =</span> <span class="fu">sd</span>(Score)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb2004-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2004-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2004-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2004-13" aria-hidden="true" tabindex="-1"></a><span class="co"># compute and save the sample pooled standard deviation</span></span>
<span id="cb2004-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2004-14" aria-hidden="true" tabindex="-1"></a>s_p <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(((n_a <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> s_a<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (n_b <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> s_b<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (n_a <span class="sc">+</span> n_b <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb2004-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2004-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2004-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2004-16" aria-hidden="true" tabindex="-1"></a><span class="co"># compute Cohen&#39;s d</span></span>
<span id="cb2004-17"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2004-17" aria-hidden="true" tabindex="-1"></a>(y_bar_a <span class="sc">-</span> y_bar_b) <span class="sc">/</span> s_p</span></code></pre></div>
<pre><code>## [1] 0.3518743</code></pre>
<p>Although it’s a lot of work to compute a sample-size corrected Cohen’s <span class="math inline">\(d\)</span> with unequally-sized sample data, it’s straightforward to compute the effect size in a Bayesian model. We could use any of the three approaches, from above. Here we’ll practice with the <code>Score ~ 0 + Group</code> syntax.</p>
<div class="sourceCode" id="cb2006"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2006-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2006-1" aria-hidden="true" tabindex="-1"></a>mean_y <span class="ot">&lt;-</span> (y_bar_a <span class="sc">+</span> y_bar_b) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb2006-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2006-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2006-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2006-3" aria-hidden="true" tabindex="-1"></a>stanvars <span class="ot">&lt;-</span> </span>
<span id="cb2006-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2006-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(mean_y, <span class="at">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="sc">+</span> </span>
<span id="cb2006-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2006-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_p,    <span class="at">name =</span> <span class="st">&quot;sd_y&quot;</span>)</span>
<span id="cb2006-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2006-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2006-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2006-7" aria-hidden="true" tabindex="-1"></a>fit19<span class="fl">.11</span> <span class="ot">&lt;-</span></span>
<span id="cb2006-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2006-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb2006-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2006-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb2006-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2006-10" aria-hidden="true" tabindex="-1"></a>      Score <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Group,</span>
<span id="cb2006-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2006-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> b),</span>
<span id="cb2006-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2006-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb2006-13"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2006-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">3000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb2006-14"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2006-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">19</span>,</span>
<span id="cb2006-15"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2006-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars,</span>
<span id="cb2006-16"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2006-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit19.11&quot;</span>)</span></code></pre></div>
<p>Review the model summary.</p>
<div class="sourceCode" id="cb2007"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2007-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2007-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit19<span class="fl">.11</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Score ~ 0 + Group 
##    Data: my_data (Number of observations: 120) 
##   Draws: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
##          total post-warmup draws = 8000
## 
## Population-Level Effects: 
##                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## GroupPlacebo     100.03      2.97    94.24   105.74 1.00     7073     5933
## GroupSmartDrug   107.89      2.81   102.35   113.56 1.00     6670     5303
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    22.34      1.47    19.71    25.42 1.00     8176     6135
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>The <span class="math inline">\(\sigma\)</span> parameter within this model is an estimate of the population value for <span class="math inline">\(\sigma_p\)</span>. Happily, it already accommodates the differences in sample sizes, which we tried to correct for, above, with <span class="math inline">\(s_p^*\)</span>. To give a sense, here’s a plot of the <span class="math inline">\(\sigma\)</span> posterior with our hand-computed <code>s_p</code> value superimposed as a dashed line.</p>
<div class="sourceCode" id="cb2009"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2009-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2009-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit19<span class="fl">.11</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2009-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2009-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2009-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2009-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sigma, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2009-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2009-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb2009-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2009-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">2</span>], <span class="at">color =</span> pp[<span class="dv">7</span>],</span>
<span id="cb2009-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2009-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb2009-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2009-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> s_p,</span>
<span id="cb2009-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2009-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> pp[<span class="dv">13</span>], <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2009-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2009-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2009-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2009-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(sigma[<span class="fu">italic</span>(p)]))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-117-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>Nailed it! Now here’s how we might use the posterior samples to then compute the standardized mean difference.</p>
<div class="sourceCode" id="cb2010"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2010-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2010-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit19<span class="fl">.11</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2010-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2010-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d =</span> (b_GroupSmartDrug <span class="sc">-</span> b_GroupPlacebo) <span class="sc">/</span> sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb2010-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2010-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2010-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2010-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2010-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2010-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb2010-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2010-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">2</span>], <span class="at">color =</span> pp[<span class="dv">7</span>],</span>
<span id="cb2010-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2010-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb2010-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2010-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> (y_bar_a <span class="sc">-</span> y_bar_b) <span class="sc">/</span> s_p,</span>
<span id="cb2010-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2010-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> pp[<span class="dv">13</span>], <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2010-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2010-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2010-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2010-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>((mu[<span class="fu">italic</span>(B)]<span class="sc">-</span>mu[<span class="fu">italic</span>(A)])<span class="sc">/</span>sigma[<span class="fu">italic</span>(p)]<span class="sc">*</span><span class="st">&quot;, where &quot;</span><span class="sc">*</span>sigma[<span class="fu">italic</span>(p)]<span class="sc">%~~%</span><span class="fu">sqrt</span>(((<span class="fu">italic</span>(n[A])<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">italic</span>(s)[<span class="fu">italic</span>(A)]<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(<span class="fu">italic</span>(n[B])<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">italic</span>(s)[<span class="fu">italic</span>(B)]<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">italic</span>(n[A])<span class="sc">+</span><span class="fu">italic</span>(n[B])<span class="sc">-</span><span class="dv">2</span>)))) <span class="sc">+</span></span>
<span id="cb2010-12"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2010-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-118-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>Sometimes fitting a model is easier than computing estimates, by hand.</p>
</div>
<div id="populations-and-samples." class="section level3 hasAnchor" number="19.6.2">
<h3><span class="header-section-number">19.6.2</span> Populations and samples.<a href="metric-predicted-variable-with-one-nominal-predictor.html#populations-and-samples." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You may have noticed that in our equation for <span class="math inline">\(d\)</span>, above, we defined our standardized mean differences in terms of sample statistics,</p>
<p><span class="math display">\[d = \frac{\bar y_A - \bar y_B}{s_p},\]</span></p>
<p>where <span class="math inline">\(s_p\)</span> can either assume equal sample sizes, or it can be replaced with <span class="math inline">\(s_p^*\)</span> when sample sizes differ. Sometimes we speak of the true population effect size <span class="math inline">\(\delta\)</span>, which is correspondingly defined as</p>
<p><span class="math display">\[\delta = \frac{\mu_A - \mu_B}{\sigma},\]</span></p>
<p>where <span class="math inline">\(\mu_A\)</span> and <span class="math inline">\(\mu_B\)</span> are the population means for the two groups under consideration and <span class="math inline">\(\sigma\)</span> is the pooled standard deviation in the population. Often times we don’t have access to these values, which is why we run experiments and fit statistical models. But sometimes we do have access to the exact population parameters. In those cases, we can just plug them into the formula rather than estimate them in our models or with our sample statistics.</p>
<p>In the case of our IQ score data from the last section, we actually know the population mean and standard deviation for IQ are 100 and 15, respectively. We know this because the people who make IQ tests design them that way. Let’s see how well our sample statistics approximate the population parameters.</p>
<div class="sourceCode" id="cb2011"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2011-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2011-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb2011-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2011-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Group) <span class="sc">%&gt;%</span> </span>
<span id="cb2011-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2011-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Score),</span>
<span id="cb2011-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2011-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(Score))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   Group       mean    sd
##   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;
## 1 Placebo     100.  17.9
## 2 Smart Drug  108.  25.4</code></pre>
<div class="sourceCode" id="cb2013"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2013-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2013-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pooled standard deviation</span></span>
<span id="cb2013-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2013-2" aria-hidden="true" tabindex="-1"></a>s_p</span></code></pre></div>
<pre><code>## [1] 22.18458</code></pre>
<p>Unsurprisingly, the values for the <code>Smart Drug</code> group are notably different from the population parameters. But notice how close the values from the <code>Placebo</code> group are to the population parameters. If they weren’t, we’d be concerned the <code>Placebo</code> condition was not a valid control. Looks like it was.</p>
<p>However, notice that the mean and standard deviation for the <code>Placebo</code> group are not the exact values of 100 and 15 the way they are in the population. If we wanted to compute a standardized mean difference between our <code>Smart Drug</code> group and folks in the population, we could just plug those values directly into our effect size equation. Here’s what that would look like if we plug in the population mean for the control group.</p>
<div class="sourceCode" id="cb2015"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2015-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2015-1" aria-hidden="true" tabindex="-1"></a>(y_bar_a <span class="sc">-</span> <span class="dv">100</span>) <span class="sc">/</span> s_p</span></code></pre></div>
<pre><code>## [1] 0.3534559</code></pre>
<p>The result is very close to the one above. But this time our equation for <span class="math inline">\(d\)</span> was</p>
<p><span class="math display">\[d = \frac{\bar y_A - \mu_B}{s_p},\]</span></p>
<p>where we used the population mean <span class="math inline">\(\mu_B\)</span>, but the other two terms were based on values from the sample. As long as you are defining the <code>Placebo</code> control as a stand-in for the population, this is a more precise way to compute <span class="math inline">\(d\)</span>. Going further, we can also replace our sample estimate <span class="math inline">\(s_p\)</span> with the true value for <span class="math inline">\(\sigma\)</span>, 15.</p>
<div class="sourceCode" id="cb2017"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2017-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2017-1" aria-hidden="true" tabindex="-1"></a>(y_bar_a <span class="sc">-</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">15</span></span></code></pre></div>
<pre><code>## [1] 0.5227513</code></pre>
<p>Now our hand-computed estimate for <span class="math inline">\(d\)</span> is quite different. <em>Why</em>? Recall that sample standard deviations for both groups were larger than 15, which therefore produced an <span class="math inline">\(s_p\)</span> value that was larger than 15. When working with fractions, larger denominators return smaller products.</p>
<p>Here’s what this looks like if we work with the posterior from the last model, <code>fit19.11</code>.</p>
<div class="sourceCode" id="cb2019"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2019-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2019-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit19<span class="fl">.11</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2019-2"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2019-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d =</span> (b_GroupSmartDrug <span class="sc">-</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2019-3"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2019-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2019-4"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2019-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2019-5"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2019-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb2019-6"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2019-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_fill =</span> pp[<span class="dv">2</span>], <span class="at">color =</span> pp[<span class="dv">7</span>],</span>
<span id="cb2019-7"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2019-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_size =</span> <span class="dv">0</span>, <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb2019-8"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2019-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> (y_bar_a <span class="sc">-</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">15</span>,</span>
<span id="cb2019-9"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2019-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> pp[<span class="dv">13</span>], <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2019-10"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2019-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2019-11"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2019-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>((mu[<span class="fu">italic</span>(B)]<span class="sc">-</span><span class="dv">100</span>)<span class="sc">/</span><span class="dv">15</span>))</span></code></pre></div>
<p><img src="19_files/figure-html/unnamed-chunk-122-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>Note how we’ve now changed our effect size formula to</p>
<p><span class="math display">\[d = \frac{\bar y_A - \mu_B}{\sigma}.\]</span></p>
</div>
<div id="report-your-effect-sizes-effectively." class="section level3 hasAnchor" number="19.6.3">
<h3><span class="header-section-number">19.6.3</span> Report your effect sizes effectively.<a href="metric-predicted-variable-with-one-nominal-predictor.html#report-your-effect-sizes-effectively." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Wrapping up, we’ve been practicing computing standardized mean differences (<span class="math inline">\(d\)</span>’s) by hand with sample statistics, with posterior samples from our Bayesian models, and with combinations of the two. We’ve also seen that whereas unequal sample sizes can matter a lot for hand computing your <span class="math inline">\(d\)</span> estimates, the procedure is more straightforward when using the Bayesian posterior approach. Finally, we played around a bit with how we defined our formula for <span class="math inline">\(d\)</span>, depending on whether we knew the true population values of any of the parameters.</p>
<p>Confusingly, you might see all these variants, and more, referred to as Cohen’s <span class="math inline">\(d\)</span> within the literature. As with all the other decisions you make with experimental design and data analysis, use careful reasoning to decide on how you’d like to compute your effect sizes. To stave off confusion, report the formulas for your effect sizes transparently in your work. When possible, use equations, prose, and authoritative citations.</p>
<p>Though we’ve followed Kruschke’s lead and focused on the Cohen’s <span class="math inline">\(d\)</span> approach to effect sizes, there are many other ways to express effect sizes. Furthermore, <span class="math inline">\(d\)</span>-type effect sizes aren’t appropriate for some model types or for some research questions. To expand your effect size repertoire, you might brush up on Cohen’s <span class="citation">(<a href="#ref-cohenStatisticalPowerAnalysis1988" role="doc-biblioref">1988</a>)</span> authoritative text or Cummings newer <span class="citation">(<a href="#ref-cummingUnderstandingTheNewStatistics2012" role="doc-biblioref">2012</a>)</span> text. For nice conceptual overview on effect sizes, I recommend Kelley and Preacher’s <span class="citation">(<a href="#ref-kelley2012effect" role="doc-biblioref">2012</a>)</span> paper, <a href="https://www3.nd.edu/~kkelley/publications/articles/Kelley_and_Preacher_Psychological_Methods_2012.pdf"><em>On effect size</em></a>. Also see Pek and Flora’s <span class="citation">(<a href="#ref-pekReportingEffectSizes2018" role="doc-biblioref">2018</a>)</span> handy paper, <a href="https://doi.apa.org/fulltext/2017-10871-001.html"><em>Reporting effect sizes in original psychological research: A discussion and tutorial</em></a>.</p>
</div>
</div>
<div id="session-info-18" class="section level2 unnumbered hasAnchor">
<h2>Session info<a href="metric-predicted-variable-with-one-nominal-predictor.html#session-info-18" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb2020"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2020-1"><a href="metric-predicted-variable-with-one-nominal-predictor.html#cb2020-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.2.0 (2022-04-22)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur/Monterey 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] tidybayes_3.0.2   bayesplot_1.9.0   brms_2.18.0       Rcpp_1.0.9        patchwork_1.1.2  
##  [6] ggridges_0.5.3    palettetown_0.1.1 forcats_0.5.1     stringr_1.4.1     dplyr_1.0.10     
## [11] purrr_0.3.4       readr_2.1.2       tidyr_1.2.1       tibble_3.1.8      ggplot2_3.4.0    
## [16] tidyverse_1.3.2  
## 
## loaded via a namespace (and not attached):
##   [1] readxl_1.4.1         backports_1.4.1      plyr_1.8.7           igraph_1.3.4        
##   [5] svUnit_1.0.6         splines_4.2.0        crosstalk_1.2.0      TH.data_1.1-1       
##   [9] rstantools_2.2.0     inline_0.3.19        digest_0.6.30        htmltools_0.5.3     
##  [13] fansi_1.0.3          magrittr_2.0.3       checkmate_2.1.0      googlesheets4_1.0.1 
##  [17] tzdb_0.3.0           modelr_0.1.8         RcppParallel_5.1.5   matrixStats_0.62.0  
##  [21] vroom_1.5.7          xts_0.12.1           sandwich_3.0-2       prettyunits_1.1.1   
##  [25] colorspace_2.0-3     rvest_1.0.2          ggdist_3.2.0         haven_2.5.1         
##  [29] xfun_0.35            callr_3.7.3          crayon_1.5.2         jsonlite_1.8.3      
##  [33] lme4_1.1-31          survival_3.4-0       zoo_1.8-10           glue_1.6.2          
##  [37] gtable_0.3.1         gargle_1.2.0         emmeans_1.8.0        distributional_0.3.1
##  [41] pkgbuild_1.3.1       rstan_2.21.7         abind_1.4-5          scales_1.2.1        
##  [45] mvtnorm_1.1-3        DBI_1.1.3            miniUI_0.1.1.1       xtable_1.8-4        
##  [49] HDInterval_0.2.2     bit_4.0.4            stats4_4.2.0         StanHeaders_2.21.0-7
##  [53] DT_0.24              htmlwidgets_1.5.4    httr_1.4.4           threejs_0.3.3       
##  [57] arrayhelpers_1.1-0   posterior_1.3.1      ellipsis_0.3.2       pkgconfig_2.0.3     
##  [61] loo_2.5.1            farver_2.1.1         sass_0.4.2           dbplyr_2.2.1        
##  [65] utf8_1.2.2           tidyselect_1.1.2     labeling_0.4.2       rlang_1.0.6         
##  [69] reshape2_1.4.4       later_1.3.0          munsell_0.5.0        cellranger_1.1.0    
##  [73] tools_4.2.0          cachem_1.0.6         cli_3.5.0            generics_0.1.3      
##  [77] broom_1.0.1          evaluate_0.18        fastmap_1.1.0        processx_3.8.0      
##  [81] knitr_1.40           bit64_4.0.5          fs_1.5.2             nlme_3.1-159        
##  [85] projpred_2.2.1       mime_0.12            xml2_1.3.3           compiler_4.2.0      
##  [89] shinythemes_1.2.0    rstudioapi_0.13      gamm4_0.2-6          reprex_2.0.2        
##  [93] bslib_0.4.0          stringi_1.7.8        highr_0.9            ps_1.7.2            
##  [97] Brobdingnag_1.2-8    lattice_0.20-45      Matrix_1.4-1         nloptr_2.0.3        
## [101] markdown_1.1         shinyjs_2.1.0        tensorA_0.36.2       vctrs_0.5.1         
## [105] pillar_1.8.1         lifecycle_1.0.3      jquerylib_0.1.4      bridgesampling_1.1-2
## [109] estimability_1.4.1   httpuv_1.6.5         R6_2.5.1             bookdown_0.28       
## [113] promises_1.2.0.1     gridExtra_2.3        codetools_0.2-18     boot_1.3-28         
## [117] MASS_7.3-58.1        colourpicker_1.1.1   gtools_3.9.3         assertthat_0.2.1    
## [121] withr_2.5.0          shinystan_2.6.0      multcomp_1.4-20      mgcv_1.8-40         
## [125] parallel_4.2.0       hms_1.1.1            grid_4.2.0           minqa_1.2.5         
## [129] coda_0.19-4          rmarkdown_2.16       googledrive_2.0.0    shiny_1.7.2         
## [133] lubridate_1.8.0      base64enc_0.1-3      dygraphs_1.1.1.6</code></pre>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Bürkner2022Distributional" class="csl-entry">
Bürkner, P.-C. (2022a). <em>Estimating distributional models with brms</em>. <a href="https://CRAN.R-project.org/package=brms/vignettes/brms_distreg.html">https://CRAN.R-project.org/package=brms/vignettes/brms_distreg.html</a>
</div>
<div id="ref-chungNondegeneratePenalizedLikelihood2013" class="csl-entry">
Chung, Y., Rabe-Hesketh, S., Dorie, V., Gelman, A., &amp; Liu, J. (2013). A nondegenerate penalized likelihood estimator for variance parameters in multilevel models. <em>Psychometrika</em>, <em>78</em>(4), 685–709. <a href="https://doi.org/10.1007/s11336-013-9328-2">https://doi.org/10.1007/s11336-013-9328-2</a>
</div>
<div id="ref-cohenStatisticalPowerAnalysis1988" class="csl-entry">
Cohen, J. (1988). <em>Statistical power analysis for the behavioral sciences</em> (2nd Edition). <span>Routledge</span>. <a href="https://doi.org/10.4324/9780203771587">https://doi.org/10.4324/9780203771587</a>
</div>
<div id="ref-cummingUnderstandingTheNewStatistics2012" class="csl-entry">
Cumming, G. (2012). <em>Understanding the new statistics: <span>Effect</span> sizes, confidence intervals, and meta-analysis</em>. <span>Routledge</span>. <a href="https://www.routledge.com/Understanding-The-New-Statistics-Effect-Sizes-Confidence-Intervals-and/Cumming/p/book/9780415879682">https://www.routledge.com/Understanding-The-New-Statistics-Effect-Sizes-Confidence-Intervals-and/Cumming/p/book/9780415879682</a>
</div>
<div id="ref-efronSteinParadoxStatistics1977" class="csl-entry">
Efron, B., &amp; Morris, C. (1977). Stein’s paradox in statistics. <em>Scientific American</em>, <em>236</em>(5), 119–127. <a href="https://doi.org/10.1038/scientificamerican0577-119">https://doi.org/10.1038/scientificamerican0577-119</a>
</div>
<div id="ref-fernandesUncertaintyDisplaysUsing2018" class="csl-entry">
Fernandes, M., Walls, L., Munson, S., Hullman, J., &amp; Kay, M. (2018). Uncertainty displays using quantile dotplots or <span>CDFs</span> improve transit decision-making. In <em>Proceedings of the 2018 <span>CHI Conference</span> on <span>Human Factors</span> in <span>Computing Systems</span></em> (pp. 1–12). <span>Association for Computing Machinery</span>. <a href="https://doi.org/10.1145/3173574.3173718">https://doi.org/10.1145/3173574.3173718</a>
</div>
<div id="ref-fisherStatisticalMethodsResearch1925" class="csl-entry">
Fisher, R. A. (1925). <em>Statistical methods for research workers, 11th ed. rev</em>. <span>Edinburgh</span>. <a href="https://psycnet.apa.org/record/1925-15003-000">https://psycnet.apa.org/record/1925-15003-000</a>
</div>
<div id="ref-gelmanPriorDistributionsVariance2006" class="csl-entry">
Gelman, A. (2006). Prior distributions for variance parameters in hierarchical models (comment on article by <span>Browne</span> and <span>Draper</span>). <em>Bayesian Analysis</em>, <em>1</em>(3), 515–534. <a href="https://doi.org/10.1214/06-BA117A">https://doi.org/10.1214/06-BA117A</a>
</div>
<div id="ref-hanleySexualActivityLifespan1994" class="csl-entry">
Hanley, J., A, &amp; Shapiro, S., H. (1994). Sexual activity and the lifespan of male fruitflies: <span>A</span> dataset that gets attention. <em>Journal of Statistics Education</em>, <em>2</em>(1), null. <a href="https://doi.org/10.1080/10691898.1994.11910467">https://doi.org/10.1080/10691898.1994.11910467</a>
</div>
<div id="ref-kayExtractingVisualizingTidy2021" class="csl-entry">
Kay, M. (2021). <em>Extracting and visualizing tidy draws from brms models</em>. <a href="https://mjskay.github.io/tidybayes/articles/tidy-brms.html">https://mjskay.github.io/tidybayes/articles/tidy-brms.html</a>
</div>
<div id="ref-kelley2012effect" class="csl-entry">
Kelley, K., &amp; Preacher, K. J. (2012). On effect size. <em>Psychological Methods</em>, <em>17</em>(2), 137. <a href="https://doi.org/10.1037/a0028086">https://doi.org/10.1037/a0028086</a>
</div>
<div id="ref-kruschkeDoingBayesianData2015" class="csl-entry">
Kruschke, J. K. (2015). <em>Doing <span>Bayesian</span> data analysis: <span>A</span> tutorial with <span>R</span>, <span>JAGS</span>, and <span>Stan</span></em>. <span>Academic Press</span>. <a href="https://sites.google.com/site/doingbayesiandataanalysis/">https://sites.google.com/site/doingbayesiandataanalysis/</a>
</div>
<div id="ref-kurzStatisticalRethinkingBrms2020" class="csl-entry">
Kurz, A. S. (2020). <em>Statistical rethinking with brms, <span class="nocase">ggplot2</span>, and the tidyverse</em> (version 1.2.0). <a href="https://doi.org/10.5281/zenodo.3693202">https://doi.org/10.5281/zenodo.3693202</a>
</div>
<div id="ref-R-palettetown" class="csl-entry">
Lucas, T. (2016). <em><span class="nocase">palettetown</span>: <span>Use Pokemon</span> inspired colour palettes</em> [Manual]. <a href="https://CRAN.R-project.org/package=palettetown">https://CRAN.R-project.org/package=palettetown</a>
</div>
<div id="ref-mcelreathStatisticalRethinkingBayesian2020" class="csl-entry">
McElreath, R. (2020). <em>Statistical rethinking: <span>A Bayesian</span> course with examples in <span>R</span> and <span>Stan</span></em> (Second Edition). <span>CRC Press</span>. <a href="https://xcelab.net/rm/statistical-rethinking/">https://xcelab.net/rm/statistical-rethinking/</a>
</div>
<div id="ref-pekReportingEffectSizes2018" class="csl-entry">
Pek, J., &amp; Flora, D. B. (2018). Reporting effect sizes in original psychological research: <span>A</span> discussion and tutorial. <em>Psychological Methods</em>, <em>23</em>(2), 208. https://doi.org/<a href="https://doi.apa.org/fulltext/2017-10871-001.html">https://doi.apa.org/fulltext/2017-10871-001.html</a>
</div>
<div id="ref-williamsBayesianMultivariateMixedeffects2021" class="csl-entry">
Williams, Donald R., Martin, S. R., Liu, S., &amp; Rast, P. (2021). Bayesian multivariate mixed-effects location scale modeling of longitudinal relations among affective traits, states, and physical activity. <em>European Journal of Psychological Assessment</em>. <a href="https://doi.org/10.1027/1015-5759/a000624">https://doi.org/10.1027/1015-5759/a000624</a>
</div>
<div id="ref-williamsBayesianNonlinearMixedeffects2019" class="csl-entry">
Williams, Donald R., Zimprich, D. R., &amp; Rast, P. (2019). A <span>Bayesian</span> nonlinear mixed-effects location scale model for learning. <em>Behavior Research Methods</em>, <em>51</em>(5), 1968–1986. <a href="https://doi.org/10.3758/s13428-019-01255-9">https://doi.org/10.3758/s13428-019-01255-9</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="metric-predicted-variable-with-multiple-metric-predictors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="metric-predicted-variable-with-multiple-nominal-predictors.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
