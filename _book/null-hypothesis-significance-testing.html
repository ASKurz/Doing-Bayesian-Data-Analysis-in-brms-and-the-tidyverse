<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Null Hypothesis Significance Testing | Doing Bayesian Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in Kruschke’s (2014) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Null Hypothesis Significance Testing | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is an attempt to re-express the code in Kruschke’s (2014) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Null Hypothesis Significance Testing | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in Kruschke’s (2014) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2019-11-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="model-comparison-and-hierarchical-modeling.html">
<link rel="next" href="bayesian-approaches-to-testing-a-point-null-hypothesis.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caution-work-in-progress"><i class="fa fa-check"></i>Caution: Work in progress</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html"><i class="fa fa-check"></i><b>1</b> What’s in This Book (Read This First!)</a><ul>
<li class="chapter" data-level="1.1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#real-people-can-read-this-book"><i class="fa fa-check"></i><b>1.1</b> Real people can read this book</a></li>
<li class="chapter" data-level="1.2" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-in-this-book"><i class="fa fa-check"></i><b>1.2</b> What’s in this book</a></li>
<li class="chapter" data-level="1.3" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-new-in-the-second-edition"><i class="fa fa-check"></i><b>1.3</b> What’s new in the second edition</a></li>
<li class="chapter" data-level="1.4" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#gimme-feedback-be-polite"><i class="fa fa-check"></i><b>1.4</b> Gimme feedback (be polite)</a></li>
<li class="chapter" data-level="1.5" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#thank-you"><i class="fa fa-check"></i><b>1.5</b> Thank you!</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#reference"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>I THE BASICS: MODELS, PROBABILITY, BAYES’ RULE, AND R</b></span></li>
<li class="chapter" data-level="2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Introduction: Credibility, Models, and Parameters</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#bayesian-inference-is-reallocation-of-credibility-across-possibilities"><i class="fa fa-check"></i><b>2.1</b> Bayesian inference is reallocation of credibility across possibilities</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#data-are-noisy-and-inferences-are-probabilistic."><i class="fa fa-check"></i><b>2.1.1</b> Data are noisy and inferences are probabilistic.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#possibilities-are-parameter-values-in-descriptive-models"><i class="fa fa-check"></i><b>2.2</b> Possibilities are parameter values in descriptive models</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.3</b> The steps of Bayesian data analysis</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#reference-1"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html"><i class="fa fa-check"></i><b>3</b> The R Programming Language</a><ul>
<li class="chapter" data-level="3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-software"><i class="fa fa-check"></i><b>3.1</b> Get the software</a><ul>
<li class="chapter" data-level="3.1.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-look-at-rstudio."><i class="fa fa-check"></i><b>3.1.1</b> A look at RStudio.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-simple-example-of-r-in-action"><i class="fa fa-check"></i><b>3.2</b> A simple example of R in action</a><ul>
<li class="chapter" data-level="3.2.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-programs-used-with-this-book."><i class="fa fa-check"></i><b>3.2.1</b> Get the programs used with this book.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#basic-commands-and-operators-in-r"><i class="fa fa-check"></i><b>3.3</b> Basic commands and operators in R</a><ul>
<li class="chapter" data-level="3.3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#getting-help-in-r."><i class="fa fa-check"></i><b>3.3.1</b> Getting help in R.</a></li>
<li class="chapter" data-level="3.3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#arithmetic-and-logical-operators."><i class="fa fa-check"></i><b>3.3.2</b> Arithmetic and logical operators.</a></li>
<li class="chapter" data-level="3.3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#assignment-relational-operators-and-tests-of-equality."><i class="fa fa-check"></i><b>3.3.3</b> Assignment, relational operators, and tests of equality.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-types"><i class="fa fa-check"></i><b>3.4</b> Variable types</a><ul>
<li class="chapter" data-level="3.4.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#vector."><i class="fa fa-check"></i><b>3.4.1</b> Vector.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#factor."><i class="fa fa-check"></i><b>3.4.2</b> Factor.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#matrix-and-array."><i class="fa fa-check"></i><b>3.4.3</b> Matrix and array.</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#list-and-data-frame."><i class="fa fa-check"></i><b>3.4.4</b> List and data frame.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#loading-and-saving-data"><i class="fa fa-check"></i><b>3.5</b> Loading and saving data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#the-read.csv-read_csv-and-read.table-read_table-functions."><i class="fa fa-check"></i><b>3.5.1</b> The <del>read.csv</del> <code>read_csv()</code> and <del>read.table</del> <code>read_table()</code> functions.</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#saving-data-from-r."><i class="fa fa-check"></i><b>3.5.2</b> Saving data from R.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#some-utility-functions"><i class="fa fa-check"></i><b>3.6</b> Some utility functions</a></li>
<li class="chapter" data-level="3.7" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-in-r"><i class="fa fa-check"></i><b>3.7</b> Programming in R</a><ul>
<li class="chapter" data-level="3.7.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-names-in-r."><i class="fa fa-check"></i><b>3.7.1</b> Variable names in R.</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#running-a-program."><i class="fa fa-check"></i><b>3.7.2</b> Running a program.</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-a-function."><i class="fa fa-check"></i><b>3.7.3</b> Programming a function.</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conditions-and-loops."><i class="fa fa-check"></i><b>3.7.4</b> Conditions and loops.</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#measuring-processing-time."><i class="fa fa-check"></i><b>3.7.5</b> Measuring processing time.</a></li>
<li class="chapter" data-level="3.7.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#debugging."><i class="fa fa-check"></i><b>3.7.6</b> Debugging.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#graphical-plots-opening-and-saving"><i class="fa fa-check"></i><b>3.8</b> Graphical plots: Opening and saving</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#reference-2"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html"><i class="fa fa-check"></i><b>4</b> What is This Stuff Called Probability?</a><ul>
<li class="chapter" data-level="4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#the-set-of-all-possible-events"><i class="fa fa-check"></i><b>4.1</b> The set of all possible events</a></li>
<li class="chapter" data-level="4.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-outside-or-inside-the-head"><i class="fa fa-check"></i><b>4.2</b> Probability: Outside or inside the head</a><ul>
<li class="chapter" data-level="4.2.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#outside-the-head-long-run-relative-frequency."><i class="fa fa-check"></i><b>4.2.1</b> Outside the head: Long-run relative frequency.</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#inside-the-head-subjective-belief."><i class="fa fa-check"></i><b>4.2.2</b> Inside the head: Subjective belief.</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probabilities-assign-numbers-to-possibilities."><i class="fa fa-check"></i><b>4.2.3</b> Probabilities assign numbers to possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Probability distributions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#discrete-distributions-probability-mass."><i class="fa fa-check"></i><b>4.3.1</b> Discrete distributions: Probability mass.</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#continuous-distributions-rendezvous-with-density."><i class="fa fa-check"></i><b>4.3.2</b> Continuous distributions: Rendezvous with density.</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#mean-and-variance-of-a-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Mean and variance of a distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#highest-density-interval-hdi."><i class="fa fa-check"></i><b>4.3.4</b> Highest density interval (HDI).</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#two-way-distributions"><i class="fa fa-check"></i><b>4.4</b> Two-way distributions</a></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#reference-3"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-rule-1"><i class="fa fa-check"></i><b>5.1</b> Bayes’ rule</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#derived-from-definitions-of-conditional-probability."><i class="fa fa-check"></i><b>5.1.1</b> Derived from definitions of conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule.html"><a href="bayes-rule.html#applied-to-parameters-and-data"><i class="fa fa-check"></i><b>5.2</b> Applied to parameters and data</a></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule.html"><a href="bayes-rule.html#complete-examples-estimating-bias-in-a-coin"><i class="fa fa-check"></i><b>5.3</b> Complete examples: Estimating bias in a coin</a><ul>
<li class="chapter" data-level="5.3.1" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-sample-size-on-the-posterior."><i class="fa fa-check"></i><b>5.3.1</b> Influence of sample size on the posterior.</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-prior-on-the-posterior."><i class="fa fa-check"></i><b>5.3.2</b> Influence of prior on the posterior.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule.html"><a href="bayes-rule.html#why-bayesian-inference-can-be-difficult"><i class="fa fa-check"></i><b>5.4</b> Why Bayesian inference can be difficult</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#reference-4"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>II ALL THE FUNDAMENTALS APPLIED TO INFERRING A BINOMIAL PROBABILITY</b></span></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-likelihood-function-the-bernoulli-distribution"><i class="fa fa-check"></i><b>6.1</b> The likelihood function: The Bernoulli distribution</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-description-of-credibilities-the-beta-distribution"><i class="fa fa-check"></i><b>6.2</b> A description of credibilities: The beta distribution</a><ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#specifying-a-beta-prior."><i class="fa fa-check"></i><b>6.2.1</b> Specifying a beta prior.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-posterior-beta"><i class="fa fa-check"></i><b>6.3</b> The posterior beta</a><ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#posterior-is-compromise-of-prior-and-likelihood."><i class="fa fa-check"></i><b>6.3.1</b> Posterior is compromise of prior and likelihood.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a><ul>
<li class="chapter" data-level="6.4.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.1</b> Prior knowledge expressed as a beta distribution.</a></li>
<li class="chapter" data-level="6.4.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.2</b> Prior knowledge that cannot be expressed as a beta distribution.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#reference-5"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo</a><ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#approximating-a-distribution-with-a-large-sample"><i class="fa fa-check"></i><b>7.1</b> Approximating a distribution with a large sample</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-simple-case-of-the-metropolis-algorithm"><i class="fa fa-check"></i><b>7.2</b> A simple case of the Metropolis algorithm</a><ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-politician-stumbles-upon-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.2.1</b> A politician stumbles upon the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-random-walk."><i class="fa fa-check"></i><b>7.2.2</b> A random walk.</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#general-properties-of-a-random-walk."><i class="fa fa-check"></i><b>7.2.3</b> General properties of a random walk.</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#why-we-care."><i class="fa fa-check"></i><b>7.2.4</b> Why we care.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-metropolis-algorithm-more-generally"><i class="fa fa-check"></i><b>7.3</b> The Metropolis algorithm more generally</a><ul>
<li class="chapter" data-level="7.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithm-applied-to-bernoulli-likelihood-and-beta-prior."><i class="fa fa-check"></i><b>7.3.1</b> Metropolis algorithm applied to Bernoulli likelihood and beta prior.</a></li>
<li class="chapter" data-level="7.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-of-metropolis-algorithm."><i class="fa fa-check"></i><b>7.3.2</b> Summary of Metropolis algorithm.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#toward-gibbs-sampling-estimating-two-coin-biases"><i class="fa fa-check"></i><b>7.4</b> Toward Gibbs sampling: Estimating two coin biases</a><ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#prior-likelihood-and-posterior-for-two-biases."><i class="fa fa-check"></i><b>7.4.1</b> Prior, likelihood and posterior for two biases.</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-exact-formal-analysis."><i class="fa fa-check"></i><b>7.4.2</b> The posterior via exact formal analysis.</a></li>
<li class="chapter" data-level="7.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.4.3</b> The posterior via the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-hamiltonian-monte-carlo-sampling."><i class="fa fa-check"></i><b>7.4.4</b> <del>Gibbs</del> Hamiltonian Monte Carlo sampling.</a></li>
<li class="chapter" data-level="7.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#is-there-a-difference-between-biases"><i class="fa fa-check"></i><b>7.4.5</b> Is there a difference between biases?</a></li>
<li class="chapter" data-level="7.4.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#terminology-mcmc."><i class="fa fa-check"></i><b>7.4.6</b> Terminology: MCMC.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness-accuracy-and-efficiency"><i class="fa fa-check"></i><b>7.5</b> MCMC representativeness, accuracy, and efficiency</a><ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness."><i class="fa fa-check"></i><b>7.5.1</b> MCMC representativeness.</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-accuracy."><i class="fa fa-check"></i><b>7.5.2</b> MCMC accuracy.</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-efficiency."><i class="fa fa-check"></i><b>7.5.3</b> MCMC efficiency.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#reference-6"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-brms.html"><a href="jags-brms.html"><i class="fa fa-check"></i><b>8</b> <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.1" data-path="jags-brms.html"><a href="jags-brms.html#jags-brms-and-its-relation-to-r"><i class="fa fa-check"></i><b>8.1</b> <del>JAGS</del> brms and its relation to R</a></li>
<li class="chapter" data-level="8.2" data-path="jags-brms.html"><a href="jags-brms.html#a-complete-example"><i class="fa fa-check"></i><b>8.2</b> A complete example</a><ul>
<li class="chapter" data-level="8.2.1" data-path="jags-brms.html"><a href="jags-brms.html#load-data."><i class="fa fa-check"></i><b>8.2.1</b> Load data.</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-brms.html"><a href="jags-brms.html#specify-model."><i class="fa fa-check"></i><b>8.2.2</b> Specify model.</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-brms.html"><a href="jags-brms.html#initialize-chains."><i class="fa fa-check"></i><b>8.2.3</b> Initialize chains.</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-brms.html"><a href="jags-brms.html#generate-chains."><i class="fa fa-check"></i><b>8.2.4</b> Generate chains.</a></li>
<li class="chapter" data-level="8.2.5" data-path="jags-brms.html"><a href="jags-brms.html#examine-chains."><i class="fa fa-check"></i><b>8.2.5</b> Examine chains.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-brms.html"><a href="jags-brms.html#simplified-scripts-for-frequently-used-analyses"><i class="fa fa-check"></i><b>8.3</b> Simplified scripts for frequently used analyses</a></li>
<li class="chapter" data-level="8.4" data-path="jags-brms.html"><a href="jags-brms.html#example-difference-of-biases"><i class="fa fa-check"></i><b>8.4</b> Example: Difference of biases</a></li>
<li class="chapter" data-level="8.5" data-path="jags-brms.html"><a href="jags-brms.html#sampling-from-the-prior-distribution-in-jags-brms"><i class="fa fa-check"></i><b>8.5</b> Sampling from the prior distribution in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="8.6" data-path="jags-brms.html"><a href="jags-brms.html#probability-distributions-available-in-jags-brms"><i class="fa fa-check"></i><b>8.6</b> Probability distributions available in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.6.1" data-path="jags-brms.html"><a href="jags-brms.html#defining-new-likelihood-functions."><i class="fa fa-check"></i><b>8.6.1</b> Defining new likelihood functions.</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="jags-brms.html"><a href="jags-brms.html#faster-sampling-with-parallel-processing-in-runjags-brmsbrm"><i class="fa fa-check"></i><b>8.7</b> Faster sampling with parallel processing in <del>runjags</del> <code>brms::brm()</code></a></li>
<li class="chapter" data-level="8.8" data-path="jags-brms.html"><a href="jags-brms.html#tips-for-expanding-jags-brms-models"><i class="fa fa-check"></i><b>8.8</b> Tips for expanding <del>JAGS</del> brms models</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#reference-7"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Hierarchical Models</a><ul>
<li class="chapter" data-level="9.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-single-coin-from-a-single-mint"><i class="fa fa-check"></i><b>9.1</b> A single coin from a single mint</a><ul>
<li class="chapter" data-level="9.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation."><i class="fa fa-check"></i><b>9.1.1</b> Posterior via grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#multiple-coins-from-a-single-mint"><i class="fa fa-check"></i><b>9.2</b> Multiple coins from a single mint</a><ul>
<li class="chapter" data-level="9.2.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation.-1"><i class="fa fa-check"></i><b>9.2.1</b> Posterior via grid approximation.</a></li>
<li class="chapter" data-level="9.2.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-realistic-model-with-mcmc."><i class="fa fa-check"></i><b>9.2.2</b> A realistic model with MCMC.</a></li>
<li class="chapter" data-level="9.2.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#doing-it-with-jags-brms."><i class="fa fa-check"></i><b>9.2.3</b> Doing it with <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="9.2.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-therapeutic-touch."><i class="fa fa-check"></i><b>9.2.4</b> Example: Therapeutic touch.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#shrinkage-in-hierarchical-models"><i class="fa fa-check"></i><b>9.3</b> Shrinkage in hierarchical models</a></li>
<li class="chapter" data-level="9.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#speeding-up-jags-brms"><i class="fa fa-check"></i><b>9.4</b> Speeding up <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="9.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#extending-the-hierarchy-subjects-within-categories"><i class="fa fa-check"></i><b>9.5</b> Extending the hierarchy: Subjects within categories</a><ul>
<li class="chapter" data-level="9.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-batting-abilities-by-position."><i class="fa fa-check"></i><b>9.5.1</b> Example: Baseball batting abilities by position.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#reference-8"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html"><i class="fa fa-check"></i><b>10</b> Model Comparison and Hierarchical Modeling</a><ul>
<li class="chapter" data-level="10.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#general-formula-and-the-bayes-factor"><i class="fa fa-check"></i><b>10.1</b> General formula and the Bayes factor</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#example-two-factories-of-coins"><i class="fa fa-check"></i><b>10.2</b> Example: Two factories of coins</a><ul>
<li class="chapter" data-level="10.2.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-formal-analysis."><i class="fa fa-check"></i><b>10.2.1</b> Solution by formal analysis.</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-grid-approximation."><i class="fa fa-check"></i><b>10.2.2</b> Solution by grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-mcmc"><i class="fa fa-check"></i><b>10.3</b> Solution by MCMC</a><ul>
<li class="chapter" data-level="10.3.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#nonhierarchical-mcmc-computation-of-each-models-marginal-likelihood."><i class="fa fa-check"></i><b>10.3.1</b> Nonhierarchical MCMC computation of each model’s marginal likelihood.</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#hierarchical-mcmc-computation-of-relative-model-probability-is-not-available-in-brms-well-cover-information-criteria-instead."><i class="fa fa-check"></i><b>10.3.2</b> Hierarchical MCMC computation <del>of relative model probability</del> is not available in brms: We’ll cover information criteria instead.</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#models-with-different-noise-distributions-in-jags-brms."><i class="fa fa-check"></i><b>10.3.3</b> Models with different “noise” distributions in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#prediction-model-averaging"><i class="fa fa-check"></i><b>10.4</b> Prediction: Model averaging</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#model-complexity-naturally-accounted-for"><i class="fa fa-check"></i><b>10.5</b> Model complexity naturally accounted for</a><ul>
<li class="chapter" data-level="10.5.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#caveats-regarding-nested-model-comparison."><i class="fa fa-check"></i><b>10.5.1</b> Caveats regarding nested model comparison.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#extreme-sensitivity-to-the-prior-distribution"><i class="fa fa-check"></i><b>10.6</b> Extreme sensitivity to the prior distribution</a><ul>
<li class="chapter" data-level="10.6.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#priors-of-different-models-should-be-equally-informed."><i class="fa fa-check"></i><b>10.6.1</b> Priors of different models should be equally informed.</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#bonus-theres-danger-ahead"><i class="fa fa-check"></i><b>10.7</b> Bonus: There’s danger ahead</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#reference-9"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>11</b> Null Hypothesis Significance Testing</a><ul>
<li class="chapter" data-level="11.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#paved-with-good-intentions"><i class="fa fa-check"></i><b>11.1</b> Paved with good intentions</a><ul>
<li class="chapter" data-level="11.1.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#definition-of-p-value."><i class="fa fa-check"></i><b>11.1.1</b> Definition of <span class="math inline">\(p\)</span> value.</a></li>
<li class="chapter" data-level="11.1.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-n."><i class="fa fa-check"></i><b>11.1.2</b> With intention to fix <span class="math inline">\(N\)</span>.</a></li>
<li class="chapter" data-level="11.1.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-z."><i class="fa fa-check"></i><b>11.1.3</b> With intention to fix <span class="math inline">\(z\)</span>.</a></li>
<li class="chapter" data-level="11.1.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-duration."><i class="fa fa-check"></i><b>11.1.4</b> With intention to fix duration.</a></li>
<li class="chapter" data-level="11.1.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-make-multiple-tests."><i class="fa fa-check"></i><b>11.1.5</b> With intention to make multiple tests.</a></li>
<li class="chapter" data-level="11.1.6" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#soul-searching."><i class="fa fa-check"></i><b>11.1.6</b> Soul searching.</a></li>
<li class="chapter" data-level="11.1.7" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis."><i class="fa fa-check"></i><b>11.1.7</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#prior-knowledge"><i class="fa fa-check"></i><b>11.2</b> Prior knowledge</a><ul>
<li class="chapter" data-level="11.2.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-analysis."><i class="fa fa-check"></i><b>11.2.1</b> NHST analysis.</a></li>
<li class="chapter" data-level="11.2.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis.-1"><i class="fa fa-check"></i><b>11.2.2</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#confidence-interval-and-highest-density-interval"><i class="fa fa-check"></i><b>11.3</b> Confidence interval and highest density interval</a><ul>
<li class="chapter" data-level="11.3.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#ci-depends-on-intention."><i class="fa fa-check"></i><b>11.3.1</b> CI depends on intention.</a></li>
<li class="chapter" data-level="11.3.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-hdi."><i class="fa fa-check"></i><b>11.3.2</b> Bayesian HDI.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#multiple-comparisons"><i class="fa fa-check"></i><b>11.4</b> Multiple comparisons</a><ul>
<li class="chapter" data-level="11.4.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-correction-for-experiment-wise-error."><i class="fa fa-check"></i><b>11.4.1</b> NHST correction for experiment wise error.</a></li>
<li class="chapter" data-level="11.4.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#just-one-bayesian-posterior-no-matter-how-you-look-at-it."><i class="fa fa-check"></i><b>11.4.2</b> Just one Bayesian posterior no matter how you look at it.</a></li>
<li class="chapter" data-level="11.4.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#how-bayesian-analysis-mitigates-false-alarms."><i class="fa fa-check"></i><b>11.4.3</b> How Bayesian analysis mitigates false alarms.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#what-a-sampling-distribution-is-good-for"><i class="fa fa-check"></i><b>11.5</b> What a sampling distribution is good for</a><ul>
<li class="chapter" data-level="11.5.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#planning-an-experiment."><i class="fa fa-check"></i><b>11.5.1</b> Planning an experiment.</a></li>
<li class="chapter" data-level="11.5.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#exploring-model-predictions-posterior-predictive-check."><i class="fa fa-check"></i><b>11.5.2</b> Exploring model predictions (posterior predictive check).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#reference-10"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><i class="fa fa-check"></i><b>12</b> Bayesian Approaches to Testing a Point (“Null”) Hypothesis</a><ul>
<li class="chapter" data-level="12.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-estimation-approach"><i class="fa fa-check"></i><b>12.1</b> The estimation approach</a><ul>
<li class="chapter" data-level="12.1.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#region-of-practical-equivalence."><i class="fa fa-check"></i><b>12.1.1</b> Region of practical equivalence.</a></li>
<li class="chapter" data-level="12.1.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#some-examples."><i class="fa fa-check"></i><b>12.1.2</b> Some examples.</a></li>
<li class="chapter" data-level="12.1.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#differences-of-correlated-parameters."><i class="fa fa-check"></i><b>12.1.3</b> Differences of correlated parameters.</a></li>
<li class="chapter" data-level="12.1.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#why-hdi-and-not-equal-tailed-interval"><i class="fa fa-check"></i><b>12.1.4</b> Why HDI and not equal-tailed interval?</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-model-comparison-approach"><i class="fa fa-check"></i><b>12.2</b> The model-comparison approach</a><ul>
<li class="chapter" data-level="12.2.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#is-a-coin-fair-or-not"><i class="fa fa-check"></i><b>12.2.1</b> Is a coin fair or not?</a></li>
<li class="chapter" data-level="12.2.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#bayes-factor-can-accept-null-with-poor-precision."><i class="fa fa-check"></i><b>12.2.2</b> Bayes’ factor can accept null with poor precision.</a></li>
<li class="chapter" data-level="12.2.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#are-different-groups-equal-or-not"><i class="fa fa-check"></i><b>12.2.3</b> Are different groups equal or not?</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#relations-of-parameter-estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.3</b> Relations of parameter estimation and model comparison</a></li>
<li class="chapter" data-level="12.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.4</b> Estimation and model comparison?</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#reference-11"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html"><i class="fa fa-check"></i><b>13</b> Goals, Power, and Sample Size</a><ul>
<li class="chapter" data-level="13.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-will-to-power"><i class="fa fa-check"></i><b>13.1</b> The will to power</a><ul>
<li class="chapter" data-level="13.1.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#goals-and-obstacles."><i class="fa fa-check"></i><b>13.1.1</b> Goals and obstacles.</a></li>
<li class="chapter" data-level="13.1.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power."><i class="fa fa-check"></i><b>13.1.2</b> Power.</a></li>
<li class="chapter" data-level="13.1.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sample-size."><i class="fa fa-check"></i><b>13.1.3</b> Sample size.</a></li>
<li class="chapter" data-level="13.1.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#other-expressions-of-goals."><i class="fa fa-check"></i><b>13.1.4</b> Other expressions of goals.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#computing-power-and-sample-size"><i class="fa fa-check"></i><b>13.2</b> Computing power and sample size</a><ul>
<li class="chapter" data-level="13.2.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-to-exclude-a-null-value."><i class="fa fa-check"></i><b>13.2.1</b> When the goal is to exclude a null value.</a></li>
<li class="chapter" data-level="13.2.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#formal-solution-and-implementation-in-r."><i class="fa fa-check"></i><b>13.2.2</b> Formal solution and implementation in R.</a></li>
<li class="chapter" data-level="13.2.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-precision."><i class="fa fa-check"></i><b>13.2.3</b> When the goal is precision.</a></li>
<li class="chapter" data-level="13.2.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#monte-carlo-approximation-of-power."><i class="fa fa-check"></i><b>13.2.4</b> Monte Carlo approximation of power.</a></li>
<li class="chapter" data-level="13.2.5" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-from-idealized-or-actual-data."><i class="fa fa-check"></i><b>13.2.5</b> Power from idealized or actual data.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sequential-testing-and-the-goal-of-precision"><i class="fa fa-check"></i><b>13.3</b> Sequential testing and the goal of precision</a><ul>
<li class="chapter" data-level="13.3.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#examples-ofsequential-tests."><i class="fa fa-check"></i><b>13.3.1</b> Examples ofsequential tests.</a></li>
<li class="chapter" data-level="13.3.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#more-will-come-soon"><i class="fa fa-check"></i><b>13.3.2</b> More will come soon…</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#reference-12"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a><ul>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#references"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>III THE GENERALIZED LINEAR MODEL</b></span></li>
<li class="chapter" data-level="15" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>15</b> Overview of the Generalized Linear Model</a><ul>
<li class="chapter" data-level="15.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#types-of-variables"><i class="fa fa-check"></i><b>15.1</b> Types of variables</a><ul>
<li class="chapter" data-level="15.1.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#predictor-and-predicted-variables."><i class="fa fa-check"></i><b>15.1.1</b> Predictor and predicted variables.</a></li>
<li class="chapter" data-level="15.1.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#scale-types-metric-ordinal-nominal-and-count."><i class="fa fa-check"></i><b>15.1.2</b> Scale types: metric, ordinal, nominal, and count.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-combination-of-predictors"><i class="fa fa-check"></i><b>15.2</b> Linear combination of predictors</a><ul>
<li class="chapter" data-level="15.2.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-function-of-a-single-metric-predictor."><i class="fa fa-check"></i><b>15.2.1</b> Linear function of a single metric predictor.</a></li>
<li class="chapter" data-level="15.2.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#additive-combination-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.2</b> Additive combination of metric predictors.</a></li>
<li class="chapter" data-level="15.2.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nonadditive-interaction-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.3</b> Nonadditive interaction of metric predictors.</a></li>
<li class="chapter" data-level="15.2.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nominal-predictors."><i class="fa fa-check"></i><b>15.2.4</b> Nominal predictors.</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linking-from-combined-predictors-to-noisy-predicted-data"><i class="fa fa-check"></i><b>15.3</b> Linking from combined predictors to noisy predicted data</a><ul>
<li class="chapter" data-level="15.3.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predictors-to-predicted-central-tendency."><i class="fa fa-check"></i><b>15.3.1</b> From predictors to predicted central tendency.</a></li>
<li class="chapter" data-level="15.3.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predicted-central-tendency-to-noisy-data."><i class="fa fa-check"></i><b>15.3.2</b> From predicted central tendency to noisy data.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#formal-expression-of-the-glm"><i class="fa fa-check"></i><b>15.4</b> Formal expression of the GLM</a><ul>
<li class="chapter" data-level="15.4.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#cases-of-the-glm."><i class="fa fa-check"></i><b>15.4.1</b> Cases of the GLM.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#reference-13"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html"><i class="fa fa-check"></i><b>16</b> Metric-Predicted Variable on One or Two Groups</a><ul>
<li class="chapter" data-level="16.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#estimating-the-mean-and-standard-deviation-of-a-normal-distribution"><i class="fa fa-check"></i><b>16.1</b> Estimating the mean and standard deviation of a normal distribution</a><ul>
<li class="chapter" data-level="16.1.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#solution-by-mathematical-analysis-heads-up-on-precision."><i class="fa fa-check"></i><b>16.1.1</b> <del>Solution by mathematical analysis</del> Heads up on precision.</a></li>
<li class="chapter" data-level="16.1.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#approximation-by-mcmc-in-jags-hmc-in-brms."><i class="fa fa-check"></i><b>16.1.2</b> Approximation by <del>MCMC in JAGS</del> HMC in brms.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#outliers-and-robust-estimation-the-t-distribution"><i class="fa fa-check"></i><b>16.2</b> Outliers and robust estimation: The <span class="math inline">\(t\)</span> distribution</a><ul>
<li class="chapter" data-level="16.2.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-jags-brms."><i class="fa fa-check"></i><b>16.2.1</b> Using the <span class="math inline">\(t\)</span> distribution in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="16.2.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-stan."><i class="fa fa-check"></i><b>16.2.2</b> Using the <span class="math inline">\(t\)</span> distribution in Stan.</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#two-groups"><i class="fa fa-check"></i><b>16.3</b> Two groups</a><ul>
<li class="chapter" data-level="16.3.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#analysis-by-nhst."><i class="fa fa-check"></i><b>16.3.1</b> Analysis by NHST.</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#other-noise-distributions-and-transforming-data"><i class="fa fa-check"></i><b>16.4</b> Other noise distributions and transforming data</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#reference-14"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#session-info-15"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html"><i class="fa fa-check"></i><b>17</b> Metric Predicted Variable with One Metric Predictor</a><ul>
<li class="chapter" data-level="17.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#simple-linear-regression"><i class="fa fa-check"></i><b>17.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="17.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Robust linear regression</a><ul>
<li class="chapter" data-level="17.2.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-jags-brms."><i class="fa fa-check"></i><b>17.2.1</b> Robust linear regression in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.2.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-stan."><i class="fa fa-check"></i><b>17.2.2</b> Robust linear regression in Stan.</a></li>
<li class="chapter" data-level="17.2.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#stan-or-jags"><i class="fa fa-check"></i><b>17.2.3</b> Stan or JAGS?</a></li>
<li class="chapter" data-level="17.2.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>17.2.4</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#hierarchical-regression-on-individuals-within-groups"><i class="fa fa-check"></i><b>17.3</b> Hierarchical regression on individuals within groups</a><ul>
<li class="chapter" data-level="17.3.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>17.3.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.3.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-posterior-distribution-shrinkage-and-prediction."><i class="fa fa-check"></i><b>17.3.2</b> The posterior distribution: Shrinkage and prediction.</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#quadratic-trend-and-weighted-data"><i class="fa fa-check"></i><b>17.4</b> Quadratic trend and weighted data</a><ul>
<li class="chapter" data-level="17.4.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#results-and-interpretation."><i class="fa fa-check"></i><b>17.4.1</b> Results and interpretation.</a></li>
<li class="chapter" data-level="17.4.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#further-extensions."><i class="fa fa-check"></i><b>17.4.2</b> Further extensions.</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#procedure-and-perils-for-expanding-a-model"><i class="fa fa-check"></i><b>17.5</b> Procedure and perils for expanding a model</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#reference-15"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#session-info-16"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Metric Predicted Variable with Multiple Metric Predictors</a><ul>
<li class="chapter" data-level="18.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiple-linear-regression"><i class="fa fa-check"></i><b>18.1</b> Multiple linear regression</a><ul>
<li class="chapter" data-level="18.1.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-perils-of-correlated-predictors."><i class="fa fa-check"></i><b>18.1.1</b> The perils of correlated predictors.</a></li>
<li class="chapter" data-level="18.1.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-model-and-implementation."><i class="fa fa-check"></i><b>18.1.2</b> The model and implementation.</a></li>
<li class="chapter" data-level="18.1.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-posterior-distribution."><i class="fa fa-check"></i><b>18.1.3</b> The posterior distribution.</a></li>
<li class="chapter" data-level="18.1.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#redundant-predictors."><i class="fa fa-check"></i><b>18.1.4</b> Redundant predictors.</a></li>
<li class="chapter" data-level="18.1.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#informative-priors-sparse-data-and-correlated-predictors."><i class="fa fa-check"></i><b>18.1.5</b> Informative priors, sparse data, and correlated predictors.</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiplicative-interaction-of-metric-predictors"><i class="fa fa-check"></i><b>18.2</b> Multiplicative interaction of metric predictors</a><ul>
<li class="chapter" data-level="18.2.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#an-example."><i class="fa fa-check"></i><b>18.2.1</b> An example.</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#shrinkage-of-regression-coefficients"><i class="fa fa-check"></i><b>18.3</b> Shrinkage of regression coefficients</a></li>
<li class="chapter" data-level="18.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection"><i class="fa fa-check"></i><b>18.4</b> Variable selection</a><ul>
<li class="chapter" data-level="18.4.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#inclusion-probability-is-strongly-affected-by-vagueness-of-prior."><i class="fa fa-check"></i><b>18.4.1</b> Inclusion probability is strongly affected by vagueness of prior.</a></li>
<li class="chapter" data-level="18.4.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection-with-hierarchical-shrinkage."><i class="fa fa-check"></i><b>18.4.2</b> Variable selection with hierarchical shrinkage.</a></li>
<li class="chapter" data-level="18.4.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#what-to-report-and-what-to-conclude."><i class="fa fa-check"></i><b>18.4.3</b> What to report and what to conclude.</a></li>
<li class="chapter" data-level="18.4.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-computational-methods."><i class="fa fa-check"></i><b>18.4.4</b> Caution: Computational methods.</a></li>
<li class="chapter" data-level="18.4.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-interaction-variables."><i class="fa fa-check"></i><b>18.4.5</b> Caution: Interaction variables.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#reference-16"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#session-info-17"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html"><i class="fa fa-check"></i><b>19</b> Metric Predicted Variable with One Nominal Predictor</a><ul>
<li class="chapter" data-level="19.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#describing-multiple-groups-of-metric-data"><i class="fa fa-check"></i><b>19.1</b> Describing multiple groups of metric data</a></li>
<li class="chapter" data-level="19.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#traditional-analysis-of-variance"><i class="fa fa-check"></i><b>19.2</b> Traditional analysis of variance</a></li>
<li class="chapter" data-level="19.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#hierarchical-bayesian-approach"><i class="fa fa-check"></i><b>19.3</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="19.3.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#implementation-in-jags-brms."><i class="fa fa-check"></i><b>19.3.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="19.3.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-and-death."><i class="fa fa-check"></i><b>19.3.2</b> Example: Sex and death.</a></li>
<li class="chapter" data-level="19.3.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#contrasts."><i class="fa fa-check"></i><b>19.3.3</b> Contrasts.</a></li>
<li class="chapter" data-level="19.3.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#multiple-comparisons-and-shrinkage."><i class="fa fa-check"></i><b>19.3.4</b> Multiple comparisons and shrinkage.</a></li>
<li class="chapter" data-level="19.3.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#the-two-group-case."><i class="fa fa-check"></i><b>19.3.5</b> The two-group case.</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#including-a-metric-predictor"><i class="fa fa-check"></i><b>19.4</b> Including a metric predictor</a><ul>
<li class="chapter" data-level="19.4.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-death-and-size."><i class="fa fa-check"></i><b>19.4.1</b> Example: Sex, death, and size.</a></li>
<li class="chapter" data-level="19.4.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#analogous-to-traditional-ancova."><i class="fa fa-check"></i><b>19.4.2</b> Analogous to traditional ANCOVA.</a></li>
<li class="chapter" data-level="19.4.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#relation-to-hierarchical-linear-regression."><i class="fa fa-check"></i><b>19.4.3</b> Relation to hierarchical linear regression.</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#heterogeneous-variances-and-robustness-against-outliers"><i class="fa fa-check"></i><b>19.5</b> Heterogeneous variances and robustness against outliers</a><ul>
<li class="chapter" data-level="19.5.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-contrast-of-means-with-different-variances."><i class="fa fa-check"></i><b>19.5.1</b> Example: Contrast of means with different variances.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#reference-17"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#session-info-18"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Metric Predicted Variable with Multiple Nominal Predictors</a><ul>
<li class="chapter" data-level="20.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#describing-groups-of-metric-data-with-multiple-nominal-predictors"><i class="fa fa-check"></i><b>20.1</b> Describing groups of metric data with multiple nominal predictors</a><ul>
<li class="chapter" data-level="20.1.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction."><i class="fa fa-check"></i><b>20.1.1</b> Interaction.</a></li>
<li class="chapter" data-level="20.1.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#traditional-anova."><i class="fa fa-check"></i><b>20.1.2</b> Traditional ANOVA.</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#hierarchical-bayesian-approach-1"><i class="fa fa-check"></i><b>20.2</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="20.2.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>20.2.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="20.2.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#example-its-only-money."><i class="fa fa-check"></i><b>20.2.2</b> Example: It’s only money.</a></li>
<li class="chapter" data-level="20.2.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#main-effect-contrasts."><i class="fa fa-check"></i><b>20.2.3</b> Main effect contrasts.</a></li>
<li class="chapter" data-level="20.2.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction-contrasts-and-simple-effects."><i class="fa fa-check"></i><b>20.2.4</b> Interaction contrasts and simple effects.</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#rescaling-can-change-interactions-homogeneity-and-normality"><i class="fa fa-check"></i><b>20.3</b> Rescaling can change interactions, homogeneity, and normality</a></li>
<li class="chapter" data-level="20.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1"><i class="fa fa-check"></i><b>20.4</b> Heterogeneous variances and robustness against outliers</a></li>
<li class="chapter" data-level="20.5" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#within-subject-designs"><i class="fa fa-check"></i><b>20.5</b> Within-subject designs</a><ul>
<li class="chapter" data-level="20.5.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#why-use-a-within-subject-design-and-why-not"><i class="fa fa-check"></i><b>20.5.1</b> Why use a within-subject design? And why not?</a></li>
<li class="chapter" data-level="20.5.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#split-plot-design."><i class="fa fa-check"></i><b>20.5.2</b> Split-plot design.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#reference-18"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#session-info-19"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html"><i class="fa fa-check"></i><b>21</b> Dichotomous Predicted Variable</a><ul>
<li class="chapter" data-level="21.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-metric-predictors"><i class="fa fa-check"></i><b>21.1</b> Multiple metric predictors</a><ul>
<li class="chapter" data-level="21.1.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#the-model-and-implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>21.1.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="21.1.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#example-height-weight-and-gender."><i class="fa fa-check"></i><b>21.1.2</b> Example: Height, weight, and gender.</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interpreting-the-regression-coefficients"><i class="fa fa-check"></i><b>21.2</b> Interpreting the regression coefficients</a><ul>
<li class="chapter" data-level="21.2.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#log-odds."><i class="fa fa-check"></i><b>21.2.1</b> Log odds.</a></li>
<li class="chapter" data-level="21.2.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#when-there-are-few-1s-or-0s-in-the-data."><i class="fa fa-check"></i><b>21.2.2</b> When there are few 1’s or 0’s in the data.</a></li>
<li class="chapter" data-level="21.2.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#correlated-predictors."><i class="fa fa-check"></i><b>21.2.3</b> Correlated predictors.</a></li>
<li class="chapter" data-level="21.2.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interaction-of-metric-predictors."><i class="fa fa-check"></i><b>21.2.4</b> Interaction of metric predictors.</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#robust-logistic-regression"><i class="fa fa-check"></i><b>21.3</b> Robust logistic regression</a></li>
<li class="chapter" data-level="21.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#nominal-predictors"><i class="fa fa-check"></i><b>21.4</b> Nominal predictors</a><ul>
<li class="chapter" data-level="21.4.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#single-group."><i class="fa fa-check"></i><b>21.4.1</b> Single group.</a></li>
<li class="chapter" data-level="21.4.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-groups."><i class="fa fa-check"></i><b>21.4.2</b> Multiple groups.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#reference-19"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#session-info-20"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Doing Bayesian Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="null-hypothesis-significance-testing" class="section level1">
<h1><span class="header-section-number">11</span> Null Hypothesis Significance Testing</h1>
<p>It’s worth repeating a couple paragraphs from page 298 (<em>emphasis</em> in the original):</p>
<blockquote>
<p>The logic of conventional NHST goes like this. Suppose the coin is fair (i.e., <span class="math inline">\(\theta\)</span> = 0.50). Then, when we flip the coin, we expect that about half the flips should come up heads. If the actual number of heads is far greater or fewer than half the flips, then we should reject the hypothesis that the coin is fair. To make this reasoning precise, we need to figure out the exact probabilities of all possible outcomes, which in turn can be used to figure out the probability of getting an outcome as extreme as (or more extreme than) the actually observed outcome. This probability, of getting an outcome from the null hypothesis that is as extreme as (or more extreme than) the actual outcome, is called a “<span class="math inline">\(p\)</span> value.” If the <span class="math inline">\(p\)</span> value is very small, say less than 5%, then we decide to reject the null hypothesis.</p>
<p>Notice that this reasoning depends on defining a space of all possible outcomes from the null hypothesis, because we have to compute the probabilities of each outcome relative to the space of all possible outcomes. The space of all possible outcomes is based on how we intend to collect data. For example, was the intention to flip the coin exactly <span class="math inline">\(N\)</span> times? In that case, the space of possible outcomes contains all sequences of exactly <span class="math inline">\(N\)</span> flips. Was the intention to flip until the <span class="math inline">\(z\)</span>th head appeared? In that case, the space of possible outcomes contains all sequences for which the <span class="math inline">\(z\)</span>th head appears on the last flip. Was the intention to flip for a fixed duration? In that case, the space of possible outcomes contains all combinations of <span class="math inline">\(N\)</span> and <span class="math inline">\(z\)</span> that could be obtained in that fixed duration. Thus, a more explicit definition of a <span class="math inline">\(p\)</span> value is the probability of getting a sample outcome from the hypothesized population that is as extreme as or more extreme than the actual outcome <em>when using the intended sampling and testing procedures.</em></p>
</blockquote>
<div id="paved-with-good-intentions" class="section level2">
<h2><span class="header-section-number">11.1</span> Paved with good intentions</h2>
<p>This is a little silly, but I wanted to challenge myself to randomly generate a series of 24 <code>H</code> and <code>T</code> characters for which there were 7 <code>H</code>s. The base <strong>R</strong> <code>sample()</code> function gets us part of the way there.</p>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb862-1" data-line-number="1"><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;H&quot;</span>, <span class="st">&quot;T&quot;</span>), <span class="dt">size =</span> <span class="dv">24</span>, <span class="dt">replace =</span> T)</a></code></pre></div>
<pre><code>##  [1] &quot;T&quot; &quot;H&quot; &quot;T&quot; &quot;T&quot; &quot;H&quot; &quot;T&quot; &quot;H&quot; &quot;H&quot; &quot;H&quot; &quot;T&quot; &quot;T&quot; &quot;H&quot; &quot;T&quot; &quot;H&quot; &quot;T&quot; &quot;T&quot; &quot;H&quot;
## [18] &quot;T&quot; &quot;H&quot; &quot;H&quot; &quot;H&quot; &quot;T&quot; &quot;H&quot; &quot;H&quot;</code></pre>
<p>I wanted the solution to be reproducible, which required I find the appropriate seed for <code>set.seed()</code>. To do that, I made a custom <code>h_counter()</code> function into which I could input an arbitrary seed value and retrieve the count of <code>H</code>. I then fed a sequence of integers into <code>h_counter()</code> and filtered the output to find which seed produces the desirable outcome.</p>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb864-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb864-2" data-line-number="2"></a>
<a class="sourceLine" id="cb864-3" data-line-number="3">h_counter &lt;-<span class="st"> </span><span class="cf">function</span>(seed) {</a>
<a class="sourceLine" id="cb864-4" data-line-number="4">  <span class="kw">set.seed</span>(seed)</a>
<a class="sourceLine" id="cb864-5" data-line-number="5">  coins &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;H&quot;</span>, <span class="st">&quot;T&quot;</span>), <span class="dt">size =</span> <span class="dv">24</span>, <span class="dt">replace =</span> T)</a>
<a class="sourceLine" id="cb864-6" data-line-number="6">  <span class="kw">length</span>(<span class="kw">which</span>(coins <span class="op">==</span><span class="st"> &quot;H&quot;</span>))</a>
<a class="sourceLine" id="cb864-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb864-8" data-line-number="8"></a>
<a class="sourceLine" id="cb864-9" data-line-number="9">coins &lt;-</a>
<a class="sourceLine" id="cb864-10" data-line-number="10"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">seed =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">200</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb864-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_heads =</span> <span class="kw">map_dbl</span>(seed, h_counter))</a>
<a class="sourceLine" id="cb864-12" data-line-number="12"></a>
<a class="sourceLine" id="cb864-13" data-line-number="13">coins <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb864-14" data-line-number="14"><span class="st">  </span><span class="kw">filter</span>(n_heads <span class="op">==</span><span class="st"> </span><span class="dv">7</span>)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##    seed n_heads
##   &lt;int&gt;   &lt;dbl&gt;
## 1   115       7
## 2   143       7</code></pre>
<p>Looks like <code>set.seed(115)</code> will work.</p>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb866-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">115</span>)</a>
<a class="sourceLine" id="cb866-2" data-line-number="2"><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;H&quot;</span>, <span class="st">&quot;T&quot;</span>), <span class="dt">size =</span> <span class="dv">24</span>, <span class="dt">replace =</span> T)</a></code></pre></div>
<pre><code>##  [1] &quot;H&quot; &quot;T&quot; &quot;H&quot; &quot;T&quot; &quot;T&quot; &quot;T&quot; &quot;T&quot; &quot;H&quot; &quot;T&quot; &quot;H&quot; &quot;T&quot; &quot;T&quot; &quot;H&quot; &quot;T&quot; &quot;T&quot; &quot;H&quot; &quot;T&quot;
## [18] &quot;T&quot; &quot;T&quot; &quot;T&quot; &quot;T&quot; &quot;H&quot; &quot;T&quot; &quot;T&quot;</code></pre>
<p>The sequence isn’t in the exact order as the data from page 300, but they do have the crucial ratio of heads to tails.</p>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb868-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">115</span>)</a>
<a class="sourceLine" id="cb868-2" data-line-number="2"><span class="kw">tibble</span>(<span class="dt">flips =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;H&quot;</span>, <span class="st">&quot;T&quot;</span>), <span class="dt">size =</span> <span class="dv">24</span>, <span class="dt">replace =</span> T)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb868-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb868-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> flips)) <span class="op">+</span></a>
<a class="sourceLine" id="cb868-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb868-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">7</span>, <span class="dv">17</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb868-7" data-line-number="7"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major.x =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb868-8" data-line-number="8">        <span class="dt">panel.grid.minor.y =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-4-1.png" /><!-- --></p>
<div id="definition-of-p-value." class="section level3">
<h3><span class="header-section-number">11.1.1</span> Definition of <span class="math inline">\(p\)</span> value.</h3>
<blockquote>
<p>In summary, the likelihood function defines the probability for a single measurement, and the intended sampling process defines the cloud of possible sample outcomes. The null hypothesis is the likelihood function with its specific value for parameter <span class="math inline">\(\theta\)</span>, and the cloud of possible samples is defined by the stopping and testing intentions, denoted <span class="math inline">\(I\)</span>. Each imaginary sample generated from the null hypothesis is summarized by a descriptive statistic, denoted <span class="math inline">\(D_{\theta, I}\)</span>. In the case of a sample of coin flips, the descriptive summary statistic is <span class="math inline">\(z / N\)</span> , the proportion of heads in the sample. Now, imagine generating infinitely many samples from the null hypothesis using stopping and testing intention <span class="math inline">\(I\)</span> ; this creates a cloud of possible summary values <span class="math inline">\(D_{\theta, I}\)</span>, each of which has a particular probability. The probability distribution over the cloud of possibilities is the sampling distribution: <span class="math inline">\(p (D_{\theta, I} | \theta, I )\)</span>.</p>
<p>To compute the <span class="math inline">\(p\)</span> value, we want to know how much of that cloud is as extreme as, or more extreme than, the actually observed outcome. To define “extremeness” we must determine the typical value of <span class="math inline">\(D_{\theta, I}\)</span>, which is usually defined as the expected value, <span class="math inline">\(E [D_{\theta, I}]\)</span> (recall Equations 4.5 and 4.6). This typical value is the center of the cloud of possibilities. An outcome is more “extreme” when it is farther away from the central tendency. The <span class="math inline">\(p\)</span> value of the actual outcome is the probability of getting a hypothetical outcome that is as or more extreme. Formally, we can express this as</p>
<p><span class="math display">\[p \text{ value} = p (D_{\theta, I} \succcurlyeq D_\text{actual} | \theta, I)\]</span></p>
<p>where “<span class="math inline">\(\succcurlyeq\)</span>” in this context means “as extreme as or more extreme than, relative to the expected value from the hypothesis.” Most introductory applied statistics textbooks suppress the sampling intention <span class="math inline">\(I\)</span> from the definition, but precedents for making the sampling intention explicit can be found in <a href="https://link.springer.com/article/10.3758/BF03194105">Wagenmakers (2007, Online Supplement A)</a> and additional references cited therein. (p. 301)</p>
</blockquote>
</div>
<div id="with-intention-to-fix-n." class="section level3">
<h3><span class="header-section-number">11.1.2</span> With intention to fix <span class="math inline">\(N\)</span>.</h3>
<p>In this subsection, “the space of possible outcomes is restricted to combinations of <span class="math inline">\(z\)</span> and <span class="math inline">\(N\)</span> for which <span class="math inline">\(N\)</span> is fixed at <span class="math inline">\(N = 24\)</span>” (p. 302).</p>
<blockquote>
<p>What is the probability of getting a particular number of heads when N is fixed? The answer is provided by the <em>binomial probability distribution</em>, which states that the probability of getting z heads out of N flips is</p>
<p><span class="math display">\[ p(z | N, \theta) = \begin{pmatrix} N \\ z \end{pmatrix} \theta^z (1 - \theta)^{N - z}\]</span></p>
<p>where the notation <span class="math inline">\(\begin{pmatrix} N \\ z \end{pmatrix}\)</span> [is a shorthand notation defined in more detail in the text. It has to do with factorials and, getting more to the point,] the number of ways of allocating <span class="math inline">\(z\)</span> heads among <span class="math inline">\(N\)</span> flips, without duplicate counting of equivalent allocations, is <span class="math inline">\(N !/[(N − z)!z!]\)</span>. This factor is also called the number of ways of choosing <span class="math inline">\(z\)</span> items from <span class="math inline">\(N\)</span> possibilities, or “<span class="math inline">\(N\)</span> choose <span class="math inline">\(z\)</span>” for short, and is denoted <span class="math inline">\(\begin{pmatrix} N \\ z \end{pmatrix}\)</span>. Thus, the overall probability of getting <span class="math inline">\(z\)</span> heads in <span class="math inline">\(N\)</span> flips is the probability of any particular sequence of <span class="math inline">\(z\)</span> heads in <span class="math inline">\(N\)</span> flips times the number of ways of choosing <span class="math inline">\(z\)</span> slots from among the <span class="math inline">\(N\)</span> possible flips. (p. 303, <em>emphasis</em> in the original)</p>
</blockquote>
<p>To do factorials in <strong>R</strong>, use the <code>factorial()</code> function. E.g., we can use the formula <span class="math inline">\(N! / [(N − z)!z!]\)</span> like so:</p>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb869-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">24</span></a>
<a class="sourceLine" id="cb869-2" data-line-number="2">z &lt;-<span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb869-3" data-line-number="3"></a>
<a class="sourceLine" id="cb869-4" data-line-number="4"><span class="kw">factorial</span>(n) <span class="op">/</span><span class="st"> </span>(<span class="kw">factorial</span>(n <span class="op">-</span><span class="st"> </span>z) <span class="op">*</span><span class="st"> </span><span class="kw">factorial</span>(z))</a></code></pre></div>
<pre><code>## [1] 346104</code></pre>
<p>That value, recall, is a count, “the number of ways of allocating <span class="math inline">\(z\)</span> heads among <span class="math inline">\(N\)</span> flips, without duplicate counting of equivalent allocations” (p. 303). That formula’s a little cumbersome to work with. We can make our programming lives easier by wrapping it into a function.</p>
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb871-1" data-line-number="1">n_choose_z &lt;-<span class="st"> </span><span class="cf">function</span>(n, z) {</a>
<a class="sourceLine" id="cb871-2" data-line-number="2">  <span class="kw">factorial</span>(n) <span class="op">/</span><span class="st"> </span>(<span class="kw">factorial</span>(n <span class="op">-</span><span class="st"> </span>z) <span class="op">*</span><span class="st"> </span><span class="kw">factorial</span>(z))</a>
<a class="sourceLine" id="cb871-3" data-line-number="3">  }</a></code></pre></div>
<p>Now we can employ our <code>n_choose_z()</code> function to help make the data we’ll use for Figure 11.3.b. Here are the data.</p>
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb872-1" data-line-number="1">flips &lt;-</a>
<a class="sourceLine" id="cb872-2" data-line-number="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">z          =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">24</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb872-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_choose_z =</span> <span class="kw">n_choose_z</span>(n, z)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb872-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">p(z/N)</span><span class="st">`</span>   =<span class="st"> </span>n_choose_z <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n_choose_z),</a>
<a class="sourceLine" id="cb872-5" data-line-number="5">         <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span> =<span class="st"> </span>z <span class="op">/</span><span class="st"> </span>n)</a>
<a class="sourceLine" id="cb872-6" data-line-number="6"></a>
<a class="sourceLine" id="cb872-7" data-line-number="7"><span class="kw">head</span>(flips, <span class="dt">n =</span> <span class="dv">10</span>)</a></code></pre></div>
<pre><code>## # A tibble: 10 x 4
##        z n_choose_z     `p(z/N)` `Sample Proportion z/N`
##    &lt;int&gt;      &lt;dbl&gt;        &lt;dbl&gt;                   &lt;dbl&gt;
##  1     0        1   0.0000000596                  0     
##  2     1       24.0 0.00000143                    0.0417
##  3     2      276   0.0000165                     0.0833
##  4     3     2024   0.000121                      0.125 
##  5     4    10626   0.000633                      0.167 
##  6     5    42504   0.00253                       0.208 
##  7     6   134596   0.00802                       0.25  
##  8     7   346104   0.0206                        0.292 
##  9     8   735471   0.0438                        0.333 
## 10     9  1307504   0.0779                        0.375</code></pre>
<p>Now here’s the histogram of that sampling distribution.</p>
<div class="sourceCode" id="cb874"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb874-1" data-line-number="1">flips <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb874-2" data-line-number="2"><span class="st">  </span></a>
<a class="sourceLine" id="cb874-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span>, <span class="dt">y =</span> <span class="st">`</span><span class="dt">p(z/N)</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb874-4" data-line-number="4">             <span class="dt">fill =</span> z <span class="op">&lt;=</span><span class="st"> </span><span class="dv">7</span>, <span class="dt">color =</span> z <span class="op">&lt;=</span><span class="st"> </span><span class="dv">7</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb874-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">width =</span> <span class="fl">.025</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb874-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb874-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb874-8" data-line-number="8"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Implied Sampling Distribution&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb874-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb874-10" data-line-number="10">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-8-1.png" /><!-- --></p>
<p>We can get the one-sided <span class="math inline">\(p\)</span>-value with a quick <code>filter()</code> and <code>summarise()</code>.</p>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb875-1" data-line-number="1">flips <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb875-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(z <span class="op">&lt;=</span><span class="st"> </span><span class="dv">7</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb875-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">p_value =</span> <span class="kw">sum</span>(<span class="st">`</span><span class="dt">p(z/N)</span><span class="st">`</span>))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   p_value
##     &lt;dbl&gt;
## 1  0.0320</code></pre>
<p>Here’s Figure 11.3.a.</p>
<div class="sourceCode" id="cb877"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb877-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">y =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>, <span class="st">&quot;head&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>, <span class="st">&quot;head&quot;</span>)),</a>
<a class="sourceLine" id="cb877-2" data-line-number="2">       <span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span> =<span class="st"> </span><span class="fl">.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb877-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb877-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">y =</span> <span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb877-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb877-6" data-line-number="6"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb877-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;Hypothetical Population&quot;</span>,</a>
<a class="sourceLine" id="cb877-8" data-line-number="8">       <span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(theta, <span class="st">&quot; = .5&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb877-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid   =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb877-10" data-line-number="10">        <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-10-1.png" /><!-- --></p>
<p>As Kruschke wrote on page 304, “It is important to understand that the sampling distribution is a probability distribution over samples of data, and is <em>not</em> a probability distribution over parameter values.”</p>
<p>Here is the probability “of getting <em>exactly</em> <span class="math inline">\(z = 7\)</span> heads in <span class="math inline">\(N = 24\)</span> flips” (p. 304, <em>emphasis</em> in the original):</p>
<div class="sourceCode" id="cb878"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb878-1" data-line-number="1">flips <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb878-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(z <span class="op">==</span><span class="st"> </span><span class="dv">7</span>)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##       z n_choose_z `p(z/N)` `Sample Proportion z/N`
##   &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;                   &lt;dbl&gt;
## 1     7     346104   0.0206                   0.292</code></pre>
<p>It was already sitting there in our <code>p(z/N)</code> column.</p>
<blockquote>
<p>Here’s the conclusion for our particular case. The actual observation was <span class="math inline">\(z/N = 7/24\)</span>. The one-tailed probability is <span class="math inline">\(p = 0.032\)</span>, which was computed from Equation 11.4, and is shown in Figure 11.3. Because the <span class="math inline">\(p\)</span> value is not less than 2.5%, we do <em>not</em> reject the null hypothesis that <span class="math inline">\(\theta = 0.5\)</span>. In NHST parlance, we would say that the result “has failed to reach significance.” This does not mean we <em>accept</em> the null hypothesis; we merely suspend judgment regarding rejection of this particular hypothesis. Notice that we have not determined any degree of belief in the hypothesis that <span class="math inline">\(\theta = 0.5\)</span>. The hypothesis might be true or might be false; we suspend judgment. (p. 305, <em>emphasis</em> in the original)</p>
</blockquote>
</div>
<div id="with-intention-to-fix-z." class="section level3">
<h3><span class="header-section-number">11.1.3</span> With intention to fix <span class="math inline">\(z\)</span>.</h3>
<p>In this subsection, “<span class="math inline">\(z\)</span> is fixed in advance and <span class="math inline">\(N\)</span> is the random variable. We don’t talk about the probability of getting <span class="math inline">\(z\)</span> heads out of <span class="math inline">\(N\)</span> flips, we instead talk about the probability of taking <span class="math inline">\(N\)</span> flips to get <span class="math inline">\(z\)</span> heads” (p. 306).</p>
<p>This time we’re interested in</p>
<blockquote>
<p><em>What is the probability of taking <span class="math inline">\(N\)</span> flips to get <span class="math inline">\(z\)</span> heads</em>? To answer this question, consider this: We know that the <span class="math inline">\(N\)</span>th flip is the <span class="math inline">\(z\)</span>th head, because that is what caused flipping to stop. Therefore the previous <span class="math inline">\(N - 1\)</span> flips had <span class="math inline">\(z - 1\)</span> heads in some random sequence. The probability of getting <span class="math inline">\(z - 1\)</span> heads in <span class="math inline">\(N - 1\)</span> flips is <span class="math inline">\(\begin{pmatrix} N-1 \\ z-1 \end{pmatrix} \theta^{z-1} (1 - \theta)^{N - z}\)</span>. The probability that the last flip comes up heads is <span class="math inline">\(\theta\)</span>. Therefore, the probability that it takes <span class="math inline">\(N\)</span> flips to get <span class="math inline">\(z\)</span> heads is</p>
<p><span class="math display">\[\begin{align*}
p(N | z, \theta) &amp; = \begin{pmatrix} N-1 \\ z-1 \end{pmatrix} \theta^{z-1} (1 - \theta)^{N - z} \cdot \theta \\
                 &amp; = \begin{pmatrix} N-1 \\ z-1 \end{pmatrix} \theta^z (1 - \theta)^{N - z} \\
                 &amp; = \frac{z}{N} \begin{pmatrix} N \\ z \end{pmatrix} \theta^z (1 - \theta)^{N - z}
\end{align*}\]</span></p>
<p>(This distribution is sometimes called the “negative binomial” but that term sometimes refers to other formulations and can be confusing, so I will not use it here.) This is a sampling distribution, like the binomial distribution, because it specifies the relative probabilities of all the possible data outcomes for the hypothesized fixed value of <span class="math inline">\(\theta\)</span> and the intended stopping rule. (p. 306, <em>emphasis</em> added)</p>
</blockquote>
<p>With that formula in hand, here’s how to generate the data for Figure 11.4.b.</p>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb880-1" data-line-number="1">theta &lt;-<span class="st"> </span><span class="fl">.5</span></a>
<a class="sourceLine" id="cb880-2" data-line-number="2"></a>
<a class="sourceLine" id="cb880-3" data-line-number="3"><span class="co"># we have to stop somewhere. where should we stop?</span></a>
<a class="sourceLine" id="cb880-4" data-line-number="4">highest_n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb880-5" data-line-number="5"></a>
<a class="sourceLine" id="cb880-6" data-line-number="6">flips &lt;-</a>
<a class="sourceLine" id="cb880-7" data-line-number="7"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">n              =</span> <span class="dv">7</span><span class="op">:</span>highest_n) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb880-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_choose_z     =</span> <span class="kw">n_choose_z</span>(n, z)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb880-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">p(z/N)</span><span class="st">`</span>       =<span class="st"> </span>n_choose_z <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n_choose_z),</a>
<a class="sourceLine" id="cb880-10" data-line-number="10">         <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span> =<span class="st"> </span>z <span class="op">/</span><span class="st"> </span>n,</a>
<a class="sourceLine" id="cb880-11" data-line-number="11">         <span class="st">`</span><span class="dt">p(N|z,theta)</span><span class="st">`</span> =<span class="st"> </span>(z <span class="op">/</span><span class="st"> </span>n) <span class="op">*</span><span class="st"> </span>n_choose_z <span class="op">*</span><span class="st"> </span>(theta<span class="op">^</span>z) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta)<span class="op">^</span>(n <span class="op">-</span><span class="st"> </span>z))</a></code></pre></div>
<p>To keep things simple, we just went up to <span class="math inline">\(N = 100\)</span>.</p>
<p>At the bottom of page 306, Kruschke described the probability “spikes” for various values of <span class="math inline">\(N\)</span> when <span class="math inline">\(z/N = 7/7\)</span>, <span class="math inline">\(z/N = 7/8\)</span>, and <span class="math inline">\(z/N = 7/9\)</span>. We have those spike values in the <code>Sample Proportion z/N</code> column of our <code>flips</code> data. Here are those first three spikes.</p>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb881-1" data-line-number="1">flips <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb881-2" data-line-number="2"><span class="st">  </span><span class="kw">head</span>(<span class="dt">n =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 5
##       n n_choose_z `p(z/N)` `Sample Proportion z/N` `p(N|z,theta)`
##   &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;                   &lt;dbl&gt;          &lt;dbl&gt;
## 1     7          1 4.95e-12                   1            0.00781
## 2     8          8 3.96e-11                   0.875        0.0273 
## 3     9         36 1.78e-10                   0.778        0.0547</code></pre>
<p>Those values correspond to the rightmost vertical lines in our Figure 11.4.b, below.</p>
<div class="sourceCode" id="cb883"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb883-1" data-line-number="1">flips <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb883-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span>, <span class="dt">y =</span> <span class="st">`</span><span class="dt">p(N|z,theta)</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb883-3" data-line-number="3">             <span class="dt">fill =</span> n <span class="op">&gt;=</span><span class="st"> </span><span class="dv">24</span>, <span class="dt">color =</span> n <span class="op">&gt;=</span><span class="st"> </span><span class="dv">24</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb883-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">width =</span> <span class="fl">.005</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb883-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb883-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb883-7" data-line-number="7"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Implied Sampling Distribution&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb883-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb883-9" data-line-number="9">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-14-1.png" /><!-- --></p>
<p>Our Figure 11.4.a is the same as Figure 11.3.a, above. I won’t repeat it, here.</p>
<p>We got the formula for that last variable, <code>p(N|z,theta)</code>, from formula 11.6 on page 306. You’ll note how Kruschke continued to refer to it as <span class="math inline">\(p(z|N)\)</span> in his Figure 11.4. It’s entirely opaque, to me, how <span class="math inline">\(p(z|N) = p(N|z, \theta)\)</span>. I’m just going with it.</p>
<p>Here’s the <span class="math inline">\(p\)</span>-value.</p>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb884-1" data-line-number="1">flips <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb884-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(n <span class="op">&gt;=</span><span class="st"> </span><span class="dv">24</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb884-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">p_value =</span> <span class="kw">sum</span>(<span class="st">`</span><span class="dt">p(N|z,theta)</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">3</span>))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   p_value
##     &lt;dbl&gt;
## 1   0.017</code></pre>
<p>If you experiment a bit with the <code>highest_n</code> value from above, you’ll see that the exact value for the <span class="math inline">\(p\)</span>-value is dependent on what <span class="math inline">\(N\)</span> you go up to.</p>
</div>
<div id="with-intention-to-fix-duration." class="section level3">
<h3><span class="header-section-number">11.1.4</span> With intention to fix duration.</h3>
<p>In this subsection,</p>
<blockquote>
<p>neither <span class="math inline">\(N\)</span> nor <span class="math inline">\(z\)</span> is fixed…</p>
<p>The key to analyzing this scenario is specifying how various combinations of <span class="math inline">\(z\)</span> and <span class="math inline">\(N\)</span> can arise when sampling for a fixed duration. There is no single, uniquely “correct” specification, because there are many different real-world constraints on sampling through time. But one approach is to think of the sample size <span class="math inline">\(N\)</span> as a random value. (p. 308).</p>
</blockquote>
<p>Here’s a glance at the Poisson distribution for which <span class="math inline">\(\lambda = 24\)</span>. The mean is colored orange.</p>
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb886-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">50</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb886-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">dpois</span>(<span class="dt">x =</span> x, <span class="dt">lambda =</span> <span class="dv">24</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb886-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb886-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y,</a>
<a class="sourceLine" id="cb886-5" data-line-number="5">             <span class="dt">fill =</span> x <span class="op">==</span><span class="st"> </span><span class="dv">24</span>, <span class="dt">color =</span> x <span class="op">==</span><span class="st"> </span><span class="dv">24</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb886-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">width =</span> <span class="fl">.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb886-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb886-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb886-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb886-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb886-11" data-line-number="11">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-16-1.png" /><!-- --></p>
<p>In the note for Figure 11.5, Kruschke explained the “sample sizes are drawn randomly from a Poisson distribution with mean <span class="math inline">\(\lambda\)</span>”. Earlier in the prose he explained “<span class="math inline">\(\lambda\)</span> was set to 24 merely to match <span class="math inline">\(N\)</span> and make the example most comparable to the preceding examples” (p. 309). To do such a simulation, one must choose how many draws to take from <span class="math inline">\(\operatorname{Poisson}(24)\)</span>. Here’s an example where we take just one.</p>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb887-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">11</span>)</a>
<a class="sourceLine" id="cb887-2" data-line-number="2"></a>
<a class="sourceLine" id="cb887-3" data-line-number="3">n_iter &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb887-4" data-line-number="4"></a>
<a class="sourceLine" id="cb887-5" data-line-number="5">flips &lt;-</a>
<a class="sourceLine" id="cb887-6" data-line-number="6"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span>n_iter,</a>
<a class="sourceLine" id="cb887-7" data-line-number="7">         <span class="dt">n    =</span> <span class="kw">rpois</span>(n_iter, <span class="dt">lambda =</span> <span class="dv">24</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb887-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z    =</span> <span class="kw">map</span>(n, <span class="op">~</span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> ., <span class="dt">by =</span> <span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb887-9" data-line-number="9"><span class="st">  </span><span class="kw">unnest</span>(z) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb887-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_choose_z =</span> <span class="kw">n_choose_z</span>(n, z)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb887-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">p(z/N)</span><span class="st">`</span>   =<span class="st"> </span>n_choose_z <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n_choose_z),</a>
<a class="sourceLine" id="cb887-12" data-line-number="12">         <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span> =<span class="st"> </span>z <span class="op">/</span><span class="st"> </span>n) </a>
<a class="sourceLine" id="cb887-13" data-line-number="13"></a>
<a class="sourceLine" id="cb887-14" data-line-number="14">flips</a></code></pre></div>
<pre><code>## # A tibble: 22 x 6
##     iter     n     z n_choose_z    `p(z/N)` `Sample Proportion z/N`
##    &lt;int&gt; &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;                   &lt;dbl&gt;
##  1     1    21     0          1 0.000000477                  0     
##  2     1    21     1         21 0.0000100                    0.0476
##  3     1    21     2        210 0.000100                     0.0952
##  4     1    21     3       1330 0.000634                     0.143 
##  5     1    21     4       5985 0.00285                      0.190 
##  6     1    21     5      20349 0.00970                      0.238 
##  7     1    21     6      54264 0.0259                       0.286 
##  8     1    21     7     116280 0.0554                       0.333 
##  9     1    21     8     203490 0.0970                       0.381 
## 10     1    21     9     293930 0.140                        0.429 
## # … with 12 more rows</code></pre>
<p>As indicate in our <code>n</code> column, by chance we drew a 21. We then computed the same values for all possible values of <code>z</code>, ranging from 0 to 21. But this doesn’t make for a very interesting plot, nor does it make for the same kind of plot Kruschke made in Figure 11.5.b.</p>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb889-1" data-line-number="1">flips <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb889-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span>, <span class="dt">y =</span> <span class="st">`</span><span class="dt">p(z/N)</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb889-3" data-line-number="3">             <span class="dt">fill =</span> z <span class="op">&lt;=</span><span class="st"> </span><span class="dv">7</span>, <span class="dt">color =</span> z <span class="op">&lt;=</span><span class="st"> </span><span class="dv">7</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb889-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">width =</span> <span class="fl">.01</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb889-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb889-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb889-7" data-line-number="7"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb889-8" data-line-number="8">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-18-1.png" /><!-- --></p>
<p>Instead we have to take many draws to take from <span class="math inline">\(\operatorname{Poisson}(24)\)</span>. Here’s what it looks like when we take 10,000.</p>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb890-1" data-line-number="1">n_iter &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb890-2" data-line-number="2"></a>
<a class="sourceLine" id="cb890-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">11</span>)</a>
<a class="sourceLine" id="cb890-4" data-line-number="4"></a>
<a class="sourceLine" id="cb890-5" data-line-number="5">flips &lt;-</a>
<a class="sourceLine" id="cb890-6" data-line-number="6"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span>n_iter,</a>
<a class="sourceLine" id="cb890-7" data-line-number="7">         <span class="dt">n    =</span> <span class="kw">rpois</span>(n_iter, <span class="dt">lambda =</span> <span class="dv">24</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb890-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z    =</span> <span class="kw">map</span>(n, <span class="op">~</span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> ., <span class="dt">by =</span> <span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb890-9" data-line-number="9"><span class="st">  </span><span class="kw">unnest</span>(z) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb890-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_choose_z =</span> <span class="kw">n_choose_z</span>(n, z)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb890-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">p(z/N)</span><span class="st">`</span>   =<span class="st"> </span>n_choose_z <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n_choose_z),</a>
<a class="sourceLine" id="cb890-12" data-line-number="12">         <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span> =<span class="st"> </span>z <span class="op">/</span><span class="st"> </span>n) </a>
<a class="sourceLine" id="cb890-13" data-line-number="13"></a>
<a class="sourceLine" id="cb890-14" data-line-number="14">flips <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb890-15" data-line-number="15"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span>, <span class="dt">y =</span> <span class="st">`</span><span class="dt">p(z/N)</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb890-16" data-line-number="16">             <span class="dt">fill =</span> z <span class="op">&lt;=</span><span class="st"> </span><span class="dv">7</span>, <span class="dt">color =</span> z <span class="op">&lt;=</span><span class="st"> </span><span class="dv">7</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb890-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">width =</span> <span class="fl">.003</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">15</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb890-18" data-line-number="18"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb890-19" data-line-number="19"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb890-20" data-line-number="20"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.03</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb890-21" data-line-number="21"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb890-22" data-line-number="22">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-19-1.png" /><!-- --></p>
<p>I played around with the simulation a bit, and this is about as good as I’ve gotten. If you have a solution that more faithfully reproduces what Kruschke did, <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/issues">please share your code</a>.</p>
<p>Here’s my attempt at the <span class="math inline">\(p\)</span> value.</p>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb891-1" data-line-number="1">flips <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb891-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(z <span class="op">&lt;=</span><span class="st"> </span><span class="dv">7</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb891-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">p_value =</span> <span class="kw">sum</span>(<span class="st">`</span><span class="dt">p(z/N)</span><span class="st">`</span>))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##    p_value
##      &lt;dbl&gt;
## 1 0.000218</code></pre>
<p>It’s unclear, to me, why it’s so much lower than the one Kruschke reported in the text.</p>
</div>
<div id="with-intention-to-make-multiple-tests." class="section level3">
<h3><span class="header-section-number">11.1.5</span> With intention to make multiple tests.</h3>
<p>I’m not sure how to do the simulation for this section. This, for example, doesn’t get the job done.</p>
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb893-1" data-line-number="1">flips &lt;-</a>
<a class="sourceLine" id="cb893-2" data-line-number="2"><span class="st">  </span><span class="kw">crossing</span>(<span class="dt">z    =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">24</span>,</a>
<a class="sourceLine" id="cb893-3" data-line-number="3">           <span class="dt">coin =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb893-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(coin) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb893-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_choose_z =</span> <span class="kw">n_choose_z</span>(n, z)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb893-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">p(z/N)</span><span class="st">`</span>   =<span class="st"> </span>n_choose_z <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n_choose_z),</a>
<a class="sourceLine" id="cb893-7" data-line-number="7">         <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span> =<span class="st"> </span>z <span class="op">/</span><span class="st"> </span>n)</a>
<a class="sourceLine" id="cb893-8" data-line-number="8"></a>
<a class="sourceLine" id="cb893-9" data-line-number="9"><span class="kw">head</span>(flips, <span class="dt">n =</span> <span class="dv">10</span>)</a></code></pre></div>
<pre><code>## # A tibble: 10 x 5
## # Groups:   coin [2]
##        z coin  n_choose_z     `p(z/N)` `Sample Proportion z/N`
##    &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;        &lt;dbl&gt;                   &lt;dbl&gt;
##  1     0 a            1   0.0000000596                  0     
##  2     0 b            1   0.0000000596                  0     
##  3     1 a           24.0 0.00000143                    0.0417
##  4     1 b           24.0 0.00000143                    0.0417
##  5     2 a          276   0.0000165                     0.0833
##  6     2 b          276   0.0000165                     0.0833
##  7     3 a         2024   0.000121                      0.125 
##  8     3 b         2024   0.000121                      0.125 
##  9     4 a        10626   0.000633                      0.167 
## 10     4 b        10626   0.000633                      0.167</code></pre>
<p>The result is a failed attempt at Figure 11.6:</p>
<div class="sourceCode" id="cb895"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb895-1" data-line-number="1">flips <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb895-2" data-line-number="2"><span class="st">  </span></a>
<a class="sourceLine" id="cb895-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span>, <span class="dt">y =</span> <span class="st">`</span><span class="dt">p(z/N)</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb895-4" data-line-number="4">             <span class="dt">fill =</span> z <span class="op">&lt;=</span><span class="st"> </span><span class="dv">7</span>, <span class="dt">color =</span> z <span class="op">&lt;=</span><span class="st"> </span><span class="dv">7</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb895-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">width =</span> <span class="fl">.01</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb895-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb895-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb895-8" data-line-number="8"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Implied Sampling Distribution&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb895-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb895-10" data-line-number="10">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-22-1.png" /><!-- --></p>
<p>If you know how to do the simulation properly, <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/issues">please share your code</a>.</p>
</div>
<div id="soul-searching." class="section level3">
<h3><span class="header-section-number">11.1.6</span> Soul searching.</h3>
<blockquote>
<p>Within the context of NHST, the solution is to establish the true intention of the researcher. This is the approach taken explicitly when applying corrections for multiple tests. The analyst determines what the truly intended tests are, and determines whether those testing intentions were honestly conceived <em>a priori</em> or <em>post hoc</em> (i.e., motivated only after seeing the data), and then computes the appropriate <span class="math inline">\(p\)</span> value. The same approach should be taken for stopping rules: The data analyst should determine what the truly intended stopping rule was, and then compute the appropriate <span class="math inline">\(p\)</span> value. Unfortunately, determining the true intentions can be difficult. Therefore, perhaps researchers who use <span class="math inline">\(p\)</span> values to make decisions should be required to publicly pre-register their intended stopping rule and tests, before collecting the data. (p. 314, <em>emphasis</em> in the original)</p>
</blockquote>
</div>
<div id="bayesian-analysis." class="section level3">
<h3><span class="header-section-number">11.1.7</span> Bayesian analysis.</h3>
<p>Happily for us, “the Bayesian interpretation of data does not depend on the covert sampling and testing intentions of the data collector” (p. 314).</p>
</div>
</div>
<div id="prior-knowledge" class="section level2">
<h2><span class="header-section-number">11.2</span> Prior knowledge</h2>
<p>Nothing for us, here.</p>
<div id="nhst-analysis." class="section level3">
<h3><span class="header-section-number">11.2.1</span> NHST analysis.</h3>
<p>More nothing.</p>
</div>
<div id="bayesian-analysis.-1" class="section level3">
<h3><span class="header-section-number">11.2.2</span> Bayesian analysis.</h3>
<p>If you recall from Chapter 6, we need a function to compute the Bernoulli likelihood.</p>
<div class="sourceCode" id="cb896"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb896-1" data-line-number="1">bernoulli_likelihood &lt;-<span class="st"> </span><span class="cf">function</span>(theta, data) {</a>
<a class="sourceLine" id="cb896-2" data-line-number="2">  n   &lt;-<span class="st"> </span><span class="kw">length</span>(data)</a>
<a class="sourceLine" id="cb896-3" data-line-number="3">  z   &lt;-<span class="st"> </span><span class="kw">sum</span>(data)</a>
<a class="sourceLine" id="cb896-4" data-line-number="4">  <span class="kw">return</span>(theta<span class="op">^</span>z <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta)<span class="op">^</span>(n <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(data)))</a>
<a class="sourceLine" id="cb896-5" data-line-number="5">  }</a></code></pre></div>
<p>There are a handful of steps before we can use our <code>bernoulli_likelihood()</code> function to make the plot data. All these are repeats from Chapter 6.</p>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb897-1" data-line-number="1"><span class="co"># we need these to compute the likelihood</span></a>
<a class="sourceLine" id="cb897-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">24</span></a>
<a class="sourceLine" id="cb897-3" data-line-number="3">z &lt;-<span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb897-4" data-line-number="4"></a>
<a class="sourceLine" id="cb897-5" data-line-number="5">trial_data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> n <span class="op">-</span><span class="st"> </span>z), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dt">times =</span> z))            <span class="co"># (i.e., data)</span></a>
<a class="sourceLine" id="cb897-6" data-line-number="6"></a>
<a class="sourceLine" id="cb897-7" data-line-number="7">d_nail &lt;-</a>
<a class="sourceLine" id="cb897-8" data-line-number="8"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta      =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">1000</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># (i.e., theta)</span></a>
<a class="sourceLine" id="cb897-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Prior      =</span> <span class="kw">dbeta</span>(<span class="dt">x =</span> theta, <span class="dt">shape1 =</span> <span class="dv">2</span>, <span class="dt">shape2 =</span> <span class="dv">20</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb897-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Likelihood =</span> <span class="kw">bernoulli_likelihood</span>(<span class="dt">theta =</span> theta,            <span class="co"># (i.e., p(D | theta))</span></a>
<a class="sourceLine" id="cb897-11" data-line-number="11">                                           <span class="dt">data =</span> trial_data)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb897-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">evidence   =</span> <span class="kw">sum</span>(Likelihood <span class="op">*</span><span class="st"> </span>Prior)) <span class="op">%&gt;%</span><span class="st">                   </span><span class="co"># (i.e., p(D))</span></a>
<a class="sourceLine" id="cb897-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Posterior  =</span> Likelihood <span class="op">*</span><span class="st"> </span>Prior <span class="op">/</span><span class="st"> </span>evidence)                 <span class="co"># (i.e., p(theta | D))</span></a>
<a class="sourceLine" id="cb897-14" data-line-number="14">  </a>
<a class="sourceLine" id="cb897-15" data-line-number="15"><span class="kw">glimpse</span>(d_nail)</a></code></pre></div>
<pre><code>## Observations: 1,000
## Variables: 5
## $ theta      &lt;dbl&gt; 0.000000000, 0.001001001, 0.002002002, 0.003003003, 0…
## $ Prior      &lt;dbl&gt; 0.0000000, 0.4124961, 0.8094267, 1.1912097, 1.5582533…
## $ Likelihood &lt;dbl&gt; 0.000000e+00, 9.900280e-22, 1.245822e-19, 2.092598e-1…
## $ evidence   &lt;dbl&gt; 5.260882e-05, 5.260882e-05, 5.260882e-05, 5.260882e-0…
## $ Posterior  &lt;dbl&gt; 0.000000e+00, 7.762627e-18, 1.916792e-15, 4.738222e-1…</code></pre>
<p>Here’s the left column of Figure 11.7.</p>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb899-1" data-line-number="1">p1 &lt;-</a>
<a class="sourceLine" id="cb899-2" data-line-number="2"><span class="st">  </span>d_nail <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb899-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb899-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> Prior),</a>
<a class="sourceLine" id="cb899-5" data-line-number="5">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb899-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb899-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Prior (beta)&quot;</span>,</a>
<a class="sourceLine" id="cb899-8" data-line-number="8">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb899-9" data-line-number="9">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;dbeta(&quot;</span>, theta, <span class="st">&quot;|2, 20)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb899-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb899-11" data-line-number="11"></a>
<a class="sourceLine" id="cb899-12" data-line-number="12">p2 &lt;-</a>
<a class="sourceLine" id="cb899-13" data-line-number="13"><span class="st">  </span>d_nail <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb899-14" data-line-number="14"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb899-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> Likelihood),</a>
<a class="sourceLine" id="cb899-16" data-line-number="16">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb899-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb899-18" data-line-number="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Likelihood (Bernoulli)&quot;</span>,</a>
<a class="sourceLine" id="cb899-19" data-line-number="19">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb899-20" data-line-number="20">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;p(D|&quot;</span>, theta, <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb899-21" data-line-number="21"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid  =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb899-22" data-line-number="22">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>())</a>
<a class="sourceLine" id="cb899-23" data-line-number="23"></a>
<a class="sourceLine" id="cb899-24" data-line-number="24">p3 &lt;-</a>
<a class="sourceLine" id="cb899-25" data-line-number="25"><span class="st">  </span>d_nail <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb899-26" data-line-number="26"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb899-27" data-line-number="27"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> Posterior),</a>
<a class="sourceLine" id="cb899-28" data-line-number="28">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb899-29" data-line-number="29"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb899-30" data-line-number="30"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Posterior (beta)&quot;</span>,</a>
<a class="sourceLine" id="cb899-31" data-line-number="31">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb899-32" data-line-number="32">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;dbeta(&quot;</span>, theta, <span class="st">&quot;|9, 37)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb899-33" data-line-number="33"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb899-34" data-line-number="34"></a>
<a class="sourceLine" id="cb899-35" data-line-number="35"><span class="kw">library</span>(gridExtra)</a>
<a class="sourceLine" id="cb899-36" data-line-number="36"></a>
<a class="sourceLine" id="cb899-37" data-line-number="37"><span class="kw">grid.arrange</span>(p1, p2, p3)</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-25-1.png" /><!-- --></p>
<p>If we’d like the 95% HDIs, we’ll need to redifine the <code>hdi_of_icdf()</code> function.</p>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb900-1" data-line-number="1">hdi_of_icdf &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">name =</span> qbeta, <span class="dt">width =</span> <span class="fl">.95</span>, <span class="dt">tol =</span> <span class="fl">1e-8</span>, ... ) {</a>
<a class="sourceLine" id="cb900-2" data-line-number="2"></a>
<a class="sourceLine" id="cb900-3" data-line-number="3">  incredible_mass &lt;-<span class="st">  </span><span class="fl">1.0</span> <span class="op">-</span><span class="st"> </span>width</a>
<a class="sourceLine" id="cb900-4" data-line-number="4">  interval_width  &lt;-<span class="st"> </span><span class="cf">function</span>(low_tail_prob, name, width, ...) {</a>
<a class="sourceLine" id="cb900-5" data-line-number="5">    <span class="kw">name</span>(width <span class="op">+</span><span class="st"> </span>low_tail_prob, ...) <span class="op">-</span><span class="st"> </span><span class="kw">name</span>(low_tail_prob, ...)</a>
<a class="sourceLine" id="cb900-6" data-line-number="6">  }</a>
<a class="sourceLine" id="cb900-7" data-line-number="7">  </a>
<a class="sourceLine" id="cb900-8" data-line-number="8">  opt_info &lt;-<span class="st"> </span><span class="kw">optimize</span>(interval_width, <span class="kw">c</span>(<span class="dv">0</span>, incredible_mass), </a>
<a class="sourceLine" id="cb900-9" data-line-number="9">                       <span class="dt">name =</span> name, <span class="dt">width =</span> width, </a>
<a class="sourceLine" id="cb900-10" data-line-number="10">                       <span class="dt">tol =</span> tol, ...)</a>
<a class="sourceLine" id="cb900-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb900-12" data-line-number="12">  hdi_lower_tail_prob &lt;-<span class="st"> </span>opt_info<span class="op">$</span>minimum</a>
<a class="sourceLine" id="cb900-13" data-line-number="13">  </a>
<a class="sourceLine" id="cb900-14" data-line-number="14">  <span class="kw">return</span>(<span class="kw">c</span>(<span class="kw">name</span>(hdi_lower_tail_prob, ...),</a>
<a class="sourceLine" id="cb900-15" data-line-number="15">           <span class="kw">name</span>(width <span class="op">+</span><span class="st"> </span>hdi_lower_tail_prob, ...)))</a>
<a class="sourceLine" id="cb900-16" data-line-number="16">  </a>
<a class="sourceLine" id="cb900-17" data-line-number="17">}</a></code></pre></div>
<p>Note that this time we made the <code>qbeta()</code> function the default setting for the <code>name</code> argument. Here are the HDIs for the prior and posterior, above.</p>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb901-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">shape1 =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb901-2" data-line-number="2">            <span class="dt">shape2 =</span> <span class="dv">20</span>)</a></code></pre></div>
<pre><code>## [1] 0.002600585 0.208030932</code></pre>
<div class="sourceCode" id="cb903"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb903-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">shape1 =</span> <span class="dv">2</span> <span class="op">+</span><span class="st"> </span>z,</a>
<a class="sourceLine" id="cb903-2" data-line-number="2">            <span class="dt">shape2 =</span> <span class="dv">20</span> <span class="op">+</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span>z))</a></code></pre></div>
<pre><code>## [1] 0.08839668 0.31043265</code></pre>
<p>To get the left column of Figure 11.7, we have to update the data with our new prior, <span class="math inline">\(\operatorname{beta} (11, 11)\)</span>.</p>
<div class="sourceCode" id="cb905"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb905-1" data-line-number="1"><span class="co"># here are the data based on our updated beta(11, 11) prior</span></a>
<a class="sourceLine" id="cb905-2" data-line-number="2">d_coin &lt;-</a>
<a class="sourceLine" id="cb905-3" data-line-number="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta      =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">1000</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb905-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Prior      =</span> <span class="kw">dbeta</span>(<span class="dt">x =</span> theta, <span class="dt">shape1 =</span> <span class="dv">11</span>, <span class="dt">shape2 =</span> <span class="dv">11</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb905-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Likelihood =</span> <span class="kw">bernoulli_likelihood</span>(<span class="dt">theta =</span> theta,</a>
<a class="sourceLine" id="cb905-6" data-line-number="6">                                           <span class="dt">data =</span> trial_data)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb905-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Posterior  =</span> Likelihood <span class="op">*</span><span class="st"> </span>Prior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(Likelihood <span class="op">*</span><span class="st"> </span>Prior))</a>
<a class="sourceLine" id="cb905-8" data-line-number="8"></a>
<a class="sourceLine" id="cb905-9" data-line-number="9"><span class="co"># The updated plots:</span></a>
<a class="sourceLine" id="cb905-10" data-line-number="10">p1 &lt;-</a>
<a class="sourceLine" id="cb905-11" data-line-number="11"><span class="st">  </span>d_coin <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb905-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb905-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> Prior),</a>
<a class="sourceLine" id="cb905-14" data-line-number="14">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb905-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb905-16" data-line-number="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Prior (beta)&quot;</span>,</a>
<a class="sourceLine" id="cb905-17" data-line-number="17">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb905-18" data-line-number="18">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;dbeta(&quot;</span>, theta, <span class="st">&quot;|11, 11)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb905-19" data-line-number="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb905-20" data-line-number="20"></a>
<a class="sourceLine" id="cb905-21" data-line-number="21">p2 &lt;-</a>
<a class="sourceLine" id="cb905-22" data-line-number="22"><span class="st">  </span>d_coin <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb905-23" data-line-number="23"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb905-24" data-line-number="24"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> Likelihood),</a>
<a class="sourceLine" id="cb905-25" data-line-number="25">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb905-26" data-line-number="26"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb905-27" data-line-number="27"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Likelihood (Bernoulli)&quot;</span>,</a>
<a class="sourceLine" id="cb905-28" data-line-number="28">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb905-29" data-line-number="29">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;p(D|&quot;</span>, theta, <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb905-30" data-line-number="30"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid  =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb905-31" data-line-number="31">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>())</a>
<a class="sourceLine" id="cb905-32" data-line-number="32"></a>
<a class="sourceLine" id="cb905-33" data-line-number="33">p3 &lt;-</a>
<a class="sourceLine" id="cb905-34" data-line-number="34"><span class="st">  </span>d_coin <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb905-35" data-line-number="35"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb905-36" data-line-number="36"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> Posterior),</a>
<a class="sourceLine" id="cb905-37" data-line-number="37">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb905-38" data-line-number="38"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb905-39" data-line-number="39"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Posterior (beta)&quot;</span>,</a>
<a class="sourceLine" id="cb905-40" data-line-number="40">       <span class="dt">x     =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb905-41" data-line-number="41">       <span class="dt">y     =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;dbeta(&quot;</span>, theta, <span class="st">&quot;|18, 28)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb905-42" data-line-number="42"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb905-43" data-line-number="43"></a>
<a class="sourceLine" id="cb905-44" data-line-number="44"><span class="kw">grid.arrange</span>(p1, p2, p3)</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-28-1.png" /><!-- --></p>
<p>Here are the corresponding HDIs for <span class="math inline">\(\operatorname{beta} (11, 11)\)</span> and <span class="math inline">\(\operatorname{beta} (11 + 7, 11 + 24 - 7)\)</span>.</p>
<div class="sourceCode" id="cb906"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb906-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">shape1 =</span> <span class="dv">11</span>,</a>
<a class="sourceLine" id="cb906-2" data-line-number="2">            <span class="dt">shape2 =</span> <span class="dv">11</span>)</a></code></pre></div>
<pre><code>## [1] 0.2978068 0.7021932</code></pre>
<div class="sourceCode" id="cb908"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb908-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">shape1 =</span> <span class="dv">11</span> <span class="op">+</span><span class="st"> </span>z,</a>
<a class="sourceLine" id="cb908-2" data-line-number="2">            <span class="dt">shape2 =</span> <span class="dv">11</span> <span class="op">+</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span>z))</a></code></pre></div>
<pre><code>## [1] 0.2539378 0.5312685</code></pre>
<div id="priors-are-overt-and-relevant." class="section level4">
<h4><span class="header-section-number">11.2.2.1</span> Priors are overt and relevant.</h4>
<p>In this subsection’s opening paragraph, Kruschke opined:</p>
<blockquote>
<p>Prior beliefs are overt, explicitly debated, and founded on publicly accessible previous research. A Bayesian analyst might have personal priors that differ from what most people think, but if the analysis is supposed to convince an audience, then the analysis must use priors that the audience finds palatable. It is the job of the Bayesian analyst to make cogent arguments for the particular prior that is used. (p. 317)</p>
</blockquote>
</div>
</div>
</div>
<div id="confidence-interval-and-highest-density-interval" class="section level2">
<h2><span class="header-section-number">11.3</span> Confidence interval and highest density interval</h2>
<blockquote>
<p>This section defines CIs and provides examples. It shows that, while CIs ameliorate some of the problems of <span class="math inline">\(p\)</span> values, ultimately CIs suffer the same problems as <span class="math inline">\(p\)</span> values because CIs are defined in terms of <span class="math inline">\(p\)</span> values. Bayesian posterior distributions, on the other hand, provide the needed information. (p. 318)</p>
</blockquote>
<div id="ci-depends-on-intention." class="section level3">
<h3><span class="header-section-number">11.3.1</span> CI depends on intention.</h3>
<blockquote>
<p>The primary goal of NHST is determining whether a particular “null” value of a parameter can be rejected. One can also ask what <em>range</em> of parameter values would not be rejected. This range of nonrejectable parameter values is called the CI. (There are different ways of defining an NHST CI; this one is conceptually the most general and coherent with NHST precepts.) The 95% CI consists of all values of <span class="math inline">\(\theta\)</span> that would not be rejected by a (two-tailed) significance test that allows 5% false alarms. (p. 318, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Here’s the upper left panel of Figure 11.8.</p>
<div class="sourceCode" id="cb910"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb910-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">y      =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>, <span class="st">&quot;head&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>, <span class="st">&quot;head&quot;</span>)),</a>
<a class="sourceLine" id="cb910-2" data-line-number="2">       <span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">.126</span>, <span class="fl">.126</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb910-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb910-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">y =</span> <span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb910-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb910-6" data-line-number="6"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb910-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;Hypothetical Population&quot;</span>,</a>
<a class="sourceLine" id="cb910-8" data-line-number="8">       <span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(theta, <span class="st">&quot; = .126&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb910-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid   =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb910-10" data-line-number="10">        <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-30-1.png" /><!-- --></p>
<p>Here’s the lower left panel of Figure 11.8.</p>
<div class="sourceCode" id="cb911"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb911-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">y      =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>, <span class="st">&quot;head&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>, <span class="st">&quot;head&quot;</span>)),</a>
<a class="sourceLine" id="cb911-2" data-line-number="2">       <span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">.511</span>, <span class="fl">.511</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb911-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb911-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">y =</span> <span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb911-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb911-6" data-line-number="6"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb911-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;Hypothetical Population&quot;</span>,</a>
<a class="sourceLine" id="cb911-8" data-line-number="8">       <span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(theta, <span class="st">&quot; = .511&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb911-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid   =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb911-10" data-line-number="10">        <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-31-1.png" /><!-- --></p>
<p>Here’s the upper right panel, the sampling distribution for when <span class="math inline">\(\theta = .126\)</span>.</p>
<div class="sourceCode" id="cb912"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb912-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">z =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">24</span>,</a>
<a class="sourceLine" id="cb912-2" data-line-number="2">       <span class="dt">y =</span> <span class="kw">dbinom</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">24</span>, <span class="dt">size =</span> <span class="dv">24</span>, <span class="dt">prob =</span> <span class="fl">.126</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb912-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb912-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> z<span class="op">/</span><span class="dv">25</span>, <span class="dt">y =</span> y,</a>
<a class="sourceLine" id="cb912-5" data-line-number="5">             <span class="dt">fill =</span> z <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb912-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">width =</span> <span class="fl">.025</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb912-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb912-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Implied Sampling Distribution&quot;</span>,</a>
<a class="sourceLine" id="cb912-9" data-line-number="9">       <span class="dt">x     =</span> <span class="st">&quot;Sample Proportion z/N&quot;</span>,</a>
<a class="sourceLine" id="cb912-10" data-line-number="10">       <span class="dt">y     =</span> <span class="st">&quot;p(z/N)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb912-11" data-line-number="11"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb912-12" data-line-number="12">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-32-1.png" /><!-- --></p>
<p>And here’s the lower right, the sampling distribution for when <span class="math inline">\(\theta = .511\)</span>.</p>
<div class="sourceCode" id="cb913"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb913-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">z =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">24</span>,</a>
<a class="sourceLine" id="cb913-2" data-line-number="2">       <span class="dt">y =</span> <span class="kw">dbinom</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">24</span>, <span class="dt">size =</span> <span class="dv">24</span>, <span class="dt">prob =</span> <span class="fl">.511</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb913-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb913-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> z <span class="op">/</span><span class="st"> </span><span class="dv">24</span>, <span class="dt">y =</span> y,</a>
<a class="sourceLine" id="cb913-5" data-line-number="5">             <span class="dt">fill =</span> z <span class="op">&lt;=</span><span class="st"> </span><span class="dv">7</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb913-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">width =</span> <span class="fl">.025</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb913-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb913-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Implied Sampling Distribution&quot;</span>,</a>
<a class="sourceLine" id="cb913-9" data-line-number="9">       <span class="dt">x     =</span> <span class="st">&quot;Sample Proportion z/N&quot;</span>,</a>
<a class="sourceLine" id="cb913-10" data-line-number="10">       <span class="dt">y     =</span> <span class="st">&quot;p(z/N)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb913-11" data-line-number="11"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb913-12" data-line-number="12">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-33-1.png" /><!-- --></p>
<p>The upper left panel in Figure 11.9 is the same as 11.8, which you can see above. Here’s the lower left panel.</p>
<div class="sourceCode" id="cb914"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb914-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">y      =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>, <span class="st">&quot;head&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>, <span class="st">&quot;head&quot;</span>)),</a>
<a class="sourceLine" id="cb914-2" data-line-number="2">       <span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">.484</span>, <span class="fl">.484</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb914-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb914-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">y =</span> <span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb914-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb914-6" data-line-number="6"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb914-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;Hypothetical Population&quot;</span>,</a>
<a class="sourceLine" id="cb914-8" data-line-number="8">       <span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(theta, <span class="st">&quot; = .484&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb914-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid   =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb914-10" data-line-number="10">        <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-34-1.png" /><!-- --></p>
<p>We’ll need fresh data for the upper right panel of Figure 11.9.</p>
<div class="sourceCode" id="cb915"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb915-1" data-line-number="1">theta &lt;-<span class="st"> </span><span class="fl">.126</span></a>
<a class="sourceLine" id="cb915-2" data-line-number="2"></a>
<a class="sourceLine" id="cb915-3" data-line-number="3">flips &lt;-</a>
<a class="sourceLine" id="cb915-4" data-line-number="4"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">n           =</span> <span class="dv">7</span><span class="op">:</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb915-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_choose_z  =</span> <span class="kw">n_choose_z</span>(n, z)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb915-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">p(z/N)</span><span class="st">`</span>    =<span class="st"> </span>n_choose_z <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n_choose_z),</a>
<a class="sourceLine" id="cb915-7" data-line-number="7">         <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span> =<span class="st"> </span>z <span class="op">/</span><span class="st"> </span>n,</a>
<a class="sourceLine" id="cb915-8" data-line-number="8">         <span class="st">`</span><span class="dt">p(N|z,theta)</span><span class="st">`</span> =<span class="st"> </span>(z <span class="op">/</span><span class="st"> </span>n) <span class="op">*</span><span class="st"> </span>n_choose_z <span class="op">*</span><span class="st"> </span>(theta<span class="op">^</span>z) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta)<span class="op">^</span>(n <span class="op">-</span><span class="st"> </span>z))</a>
<a class="sourceLine" id="cb915-9" data-line-number="9"></a>
<a class="sourceLine" id="cb915-10" data-line-number="10">flips <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb915-11" data-line-number="11"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span>, <span class="dt">y =</span> <span class="st">`</span><span class="dt">p(N|z,theta)</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb915-12" data-line-number="12">             <span class="dt">fill =</span> n <span class="op">&lt;=</span><span class="st"> </span><span class="dv">24</span>, <span class="dt">color =</span> n <span class="op">&lt;=</span><span class="st"> </span><span class="dv">24</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb915-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">width =</span> <span class="fl">.005</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb915-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb915-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb915-16" data-line-number="16"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Implied Sampling Distribution&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb915-17" data-line-number="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb915-18" data-line-number="18">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-35-1.png" /><!-- --></p>
<p>And once again, we’ll renew <code>theta</code> and the data for the lower right panel.</p>
<div class="sourceCode" id="cb916"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb916-1" data-line-number="1">theta &lt;-<span class="st"> </span><span class="fl">.484</span></a>
<a class="sourceLine" id="cb916-2" data-line-number="2"></a>
<a class="sourceLine" id="cb916-3" data-line-number="3">flips &lt;-</a>
<a class="sourceLine" id="cb916-4" data-line-number="4"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">n           =</span> <span class="dv">7</span><span class="op">:</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb916-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_choose_z  =</span> <span class="kw">n_choose_z</span>(n, z)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb916-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">p(z/N)</span><span class="st">`</span>    =<span class="st"> </span>n_choose_z <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n_choose_z),</a>
<a class="sourceLine" id="cb916-7" data-line-number="7">         <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span> =<span class="st"> </span>z <span class="op">/</span><span class="st"> </span>n,</a>
<a class="sourceLine" id="cb916-8" data-line-number="8">         <span class="st">`</span><span class="dt">p(N|z,theta)</span><span class="st">`</span> =<span class="st"> </span>(z <span class="op">/</span><span class="st"> </span>n) <span class="op">*</span><span class="st"> </span>n_choose_z <span class="op">*</span><span class="st"> </span>(theta<span class="op">^</span>z) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta)<span class="op">^</span>(n <span class="op">-</span><span class="st"> </span>z))</a>
<a class="sourceLine" id="cb916-9" data-line-number="9"></a>
<a class="sourceLine" id="cb916-10" data-line-number="10">flips <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb916-11" data-line-number="11"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span>, <span class="dt">y =</span> <span class="st">`</span><span class="dt">p(N|z,theta)</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb916-12" data-line-number="12">             <span class="dt">fill =</span> n <span class="op">&gt;=</span><span class="st"> </span><span class="dv">24</span>, <span class="dt">color =</span> n <span class="op">&gt;=</span><span class="st"> </span><span class="dv">24</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb916-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">width =</span> <span class="fl">.005</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb916-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb916-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb916-16" data-line-number="16"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Implied Sampling Distribution&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb916-17" data-line-number="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb916-18" data-line-number="18">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-36-1.png" /><!-- --></p>
<p>Here’s the lower left panel for Figure 11.10.</p>
<div class="sourceCode" id="cb917"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb917-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">y      =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>, <span class="st">&quot;head&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>, <span class="st">&quot;head&quot;</span>)),</a>
<a class="sourceLine" id="cb917-2" data-line-number="2">       <span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">.135</span>, <span class="fl">.135</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb917-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb917-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">y =</span> <span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb917-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb917-6" data-line-number="6"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb917-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;Hypothetical Population&quot;</span>,</a>
<a class="sourceLine" id="cb917-8" data-line-number="8">       <span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(theta, <span class="st">&quot; = .135&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb917-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid   =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb917-10" data-line-number="10">        <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-37-1.png" /><!-- --></p>
<p>After switching out a few theta values, here’s the lower right panel of Figure 11.10.</p>
<div class="sourceCode" id="cb918"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb918-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">y      =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>, <span class="st">&quot;head&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>, <span class="st">&quot;head&quot;</span>)),</a>
<a class="sourceLine" id="cb918-2" data-line-number="2">       <span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">.497</span>, <span class="fl">.497</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb918-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb918-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">y =</span> <span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb918-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb918-6" data-line-number="6"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb918-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;Hypothetical Population&quot;</span>,</a>
<a class="sourceLine" id="cb918-8" data-line-number="8">       <span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(theta, <span class="st">&quot; = .497&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb918-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid   =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb918-10" data-line-number="10">        <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-38-1.png" /><!-- --></p>
<p>Like with Figure 11.5.b, my attempts for the right panels of Figure 11.10 just aren’t quite right. If you understand where I’m going wrong with the simulation, <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/issues">please share your code</a>.</p>
<div class="sourceCode" id="cb919"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb919-1" data-line-number="1">z_maker &lt;-<span class="st"> </span><span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb919-2" data-line-number="2">  <span class="kw">set.seed</span>(i)</a>
<a class="sourceLine" id="cb919-3" data-line-number="3">  n &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">lambda =</span> <span class="dv">24</span>)</a>
<a class="sourceLine" id="cb919-4" data-line-number="4">  <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> n, <span class="dt">by =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb919-5" data-line-number="5">}</a>
<a class="sourceLine" id="cb919-6" data-line-number="6"></a>
<a class="sourceLine" id="cb919-7" data-line-number="7">theta &lt;-<span class="st"> </span><span class="fl">.135</span></a>
<a class="sourceLine" id="cb919-8" data-line-number="8"></a>
<a class="sourceLine" id="cb919-9" data-line-number="9"><span class="kw">tibble</span>(<span class="dt">seed =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb919-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z =</span> <span class="kw">map</span>(seed, z_maker)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb919-11" data-line-number="11"><span class="st">  </span><span class="kw">unnest</span>(z) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb919-12" data-line-number="12"><span class="st">  </span><span class="kw">group_by</span>(seed) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb919-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb919-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_choose_z  =</span> <span class="kw">n_choose_z</span>(n, z)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb919-15" data-line-number="15"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">p(z/N)</span><span class="st">`</span>    =<span class="st"> </span>n_choose_z <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n_choose_z),</a>
<a class="sourceLine" id="cb919-16" data-line-number="16">         <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span> =<span class="st"> </span>z <span class="op">/</span><span class="st"> </span>n,</a>
<a class="sourceLine" id="cb919-17" data-line-number="17">         <span class="st">`</span><span class="dt">p(N|z,theta)</span><span class="st">`</span> =<span class="st"> </span>(z <span class="op">/</span><span class="st"> </span>n) <span class="op">*</span><span class="st"> </span>n_choose_z <span class="op">*</span><span class="st"> </span>(theta<span class="op">^</span>z) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta)<span class="op">^</span>(n <span class="op">-</span><span class="st"> </span>z)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb919-18" data-line-number="18"><span class="st">  </span></a>
<a class="sourceLine" id="cb919-19" data-line-number="19"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span>, <span class="dt">y =</span> <span class="st">`</span><span class="dt">p(N|z,theta)</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb919-20" data-line-number="20">             <span class="dt">fill =</span> <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span> <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span> <span class="op">/</span><span class="st"> </span><span class="dv">24</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb919-21" data-line-number="21"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">width =</span> <span class="fl">.004</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb919-22" data-line-number="22"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb919-23" data-line-number="23"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb919-24" data-line-number="24">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-39-1.png" /><!-- --></p>
<div class="sourceCode" id="cb920"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb920-1" data-line-number="1">theta &lt;-<span class="st"> </span><span class="fl">.497</span></a>
<a class="sourceLine" id="cb920-2" data-line-number="2"></a>
<a class="sourceLine" id="cb920-3" data-line-number="3"><span class="kw">tibble</span>(<span class="dt">seed =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb920-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z =</span> <span class="kw">map</span>(seed, z_maker)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb920-5" data-line-number="5"><span class="st">  </span><span class="kw">unnest</span>(z) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb920-6" data-line-number="6"><span class="st">  </span><span class="kw">group_by</span>(seed) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb920-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb920-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_choose_z  =</span> <span class="kw">n_choose_z</span>(n, z)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb920-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">p(z/N)</span><span class="st">`</span>    =<span class="st"> </span>n_choose_z <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n_choose_z),</a>
<a class="sourceLine" id="cb920-10" data-line-number="10">         <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span> =<span class="st"> </span>z <span class="op">/</span><span class="st"> </span>n,</a>
<a class="sourceLine" id="cb920-11" data-line-number="11">         <span class="st">`</span><span class="dt">p(N|z,theta)</span><span class="st">`</span> =<span class="st"> </span>(z <span class="op">/</span><span class="st"> </span>n) <span class="op">*</span><span class="st"> </span>n_choose_z <span class="op">*</span><span class="st"> </span>(theta<span class="op">^</span>z) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta)<span class="op">^</span>(n <span class="op">-</span><span class="st"> </span>z)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb920-12" data-line-number="12"><span class="st">  </span></a>
<a class="sourceLine" id="cb920-13" data-line-number="13"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span>, <span class="dt">y =</span> <span class="st">`</span><span class="dt">p(N|z,theta)</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb920-14" data-line-number="14">             <span class="dt">fill =</span> <span class="st">`</span><span class="dt">Sample Proportion z/N</span><span class="st">`</span> <span class="op">&lt;=</span><span class="st"> </span><span class="dv">7</span> <span class="op">/</span><span class="st"> </span><span class="dv">24</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb920-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">width =</span> <span class="fl">.004</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb920-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb920-17" data-line-number="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb920-18" data-line-number="18">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-40-1.png" /><!-- --></p>
<p>Let’s leave failure behind. Here’s the upper left panel for Figure 11.11.</p>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb921-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">y      =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>, <span class="st">&quot;head&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>, <span class="st">&quot;head&quot;</span>)),</a>
<a class="sourceLine" id="cb921-2" data-line-number="2">       <span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">.11</span>, <span class="fl">.11</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb921-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb921-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">y =</span> <span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb921-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb921-6" data-line-number="6"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb921-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;Hypothetical Population&quot;</span>,</a>
<a class="sourceLine" id="cb921-8" data-line-number="8">       <span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(theta[<span class="dv">1</span>], <span class="st">&quot; = .11; &quot;</span>, theta[<span class="dv">2</span>], <span class="st">&quot; = .11&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb921-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid   =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb921-10" data-line-number="10">        <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-41-1.png" /><!-- --></p>
<p>And the lower panel for Figure 11.11.</p>
<div class="sourceCode" id="cb922"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb922-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">y      =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>, <span class="st">&quot;head&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>, <span class="st">&quot;head&quot;</span>)),</a>
<a class="sourceLine" id="cb922-2" data-line-number="2">       <span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">.539</span>, <span class="fl">.539</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb922-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb922-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">y =</span> <span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb922-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb922-6" data-line-number="6"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb922-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;Hypothetical Population&quot;</span>,</a>
<a class="sourceLine" id="cb922-8" data-line-number="8">       <span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(theta[<span class="dv">1</span>], <span class="st">&quot; = .539; &quot;</span>, theta[<span class="dv">2</span>], <span class="st">&quot; = .539&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb922-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid   =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb922-10" data-line-number="10">        <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-42-1.png" /><!-- --></p>
<p>Much like with Figure 11.6, I don’t understand how to do the simulation properly for the right panels of Figure 11.11. If you’ve got it, <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/issues">please share your code</a>.</p>
<div id="ci-is-not-a-distribution." class="section level4">
<h4><span class="header-section-number">11.3.1.1</span> CI is not a distribution.</h4>
<blockquote>
<p>A CI is merely two end points. A common misconception of a confidence interval is that it indicates some sort of probability distribution over values of <span class="math inline">\(\theta\)</span>. It is very tempting to think that values of <span class="math inline">\(\theta\)</span> in the middle of a CI should be more believable than values of <span class="math inline">\(\theta\)</span> at or beyond the limits of the CI.</p>
<p>… Methods for imposing a distribution upon a CI seem to be motivated by a natural Bayesian intuition: Parameter values that are consistent with the data should be more credible than parameter values that are not consistent with the data (subject to prior credibility). If we were confined to frequentist methods, then the various proposals outlined above would be expressions of that intuition. But we are not confined to frequentist methods. Instead, we can express our natural Bayesian intuitions in fully Bayesian formalisms. (pp. 323–324)</p>
</blockquote>
</div>
</div>
<div id="bayesian-hdi." class="section level3">
<h3><span class="header-section-number">11.3.2</span> Bayesian HDI.</h3>
<p>“The 95% HDI consists of those values of <span class="math inline">\(\theta\)</span> that have at least some minimal level of posterior credibility, such that the total probability of all such <span class="math inline">\(\theta\)</span> values is 95%” (p. 324).</p>
<p>Once again, here’s how to analytically compute the 95% HDIs for our example of <span class="math inline">\(z = 7, N = 24\)</span> and the prior of <span class="math inline">\(\operatorname{beta} (11, 11)\)</span>.</p>
<div class="sourceCode" id="cb923"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb923-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">shape1 =</span> <span class="dv">11</span> <span class="op">+</span><span class="st"> </span>z,</a>
<a class="sourceLine" id="cb923-2" data-line-number="2">            <span class="dt">shape2 =</span> <span class="dv">11</span> <span class="op">+</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span>z))</a></code></pre></div>
<pre><code>## [1] 0.2539378 0.5312685</code></pre>
</div>
</div>
<div id="multiple-comparisons" class="section level2">
<h2><span class="header-section-number">11.4</span> Multiple comparisons</h2>
<p>It’s worth quoting Kruschke at length:</p>
<blockquote>
<p>When comparing multiple conditions, a key goal in NHST is to keep the overall false alarm rate down to a desired maximum such as 5%. Abiding by this constraint depends on the number of comparisons that are to be made, which in turn depends on the intentions of the experimenter. In a Bayesian analysis, however, there is just one posterior distribu- tion over the parameters that describe the conditions. That posterior distribution is unaffected by the intentions of the experimenter, and the posterior distribution can be examined from multiple perspectives however is suggested by insight and curiosity. (p. 325)</p>
</blockquote>
<div id="nhst-correction-for-experiment-wise-error." class="section level3">
<h3><span class="header-section-number">11.4.1</span> NHST correction for experiment wise error.</h3>
<blockquote>
<p>In NHST, we have to take into account all comparisons we intend for the whole experiment. Suppose we set a criterion for rejecting the null such that each decision has a “per-comparison” (PC) false alarm rate of <span class="math inline">\(\alpha_\text{PC}\)</span>, e.g., 5%. Our goal is to determine the overall false alarm rate when we conduct several comparisons. To get there, we do a little algebra. First, suppose the null hypothesis is true, which means that the groups are identical, and we get apparent differences in the samples by chance alone. This means that we get a false alarm on a proportion <span class="math inline">\(\alpha_\text{PC}\)</span> of replications of a comparison test. Therefore, we do <em>not</em> get a false alarm on the complementary proportion <span class="math inline">\(1 - \alpha_\text{PC}\)</span> of replications. If we run <em>c</em> independent comparison tests, then the probability of not getting a false alarm on <em>any</em> of the tests is <span class="math inline">\((1 - \alpha_\text{PC})^c\)</span>. Consequently, the probability of getting at least one false alarm is <span class="math inline">\(1 - (1 - \alpha_\text{PC})^c\)</span>. We call that probability of getting at least one false alarm, across all the comparisons in the experiment, the “experimentwise” false alarm rate, denoted <span class="math inline">\(\alpha_\text{EW}\)</span>. (pp. 325–326, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Here’s what this looks like in action.</p>
<div class="sourceCode" id="cb925"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb925-1" data-line-number="1">alpha_pc &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb925-2" data-line-number="2">c        &lt;-<span class="st"> </span><span class="dv">36</span></a>
<a class="sourceLine" id="cb925-3" data-line-number="3"></a>
<a class="sourceLine" id="cb925-4" data-line-number="4"><span class="co"># the probability of not getting a false alarm on any of the tests</span></a>
<a class="sourceLine" id="cb925-5" data-line-number="5">(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha_pc)<span class="op">^</span>c</a></code></pre></div>
<pre><code>## [1] 0.1577792</code></pre>
<div class="sourceCode" id="cb927"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb927-1" data-line-number="1"><span class="co"># the probability of getting at least one false alarm is</span></a>
<a class="sourceLine" id="cb927-2" data-line-number="2"><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha_pc)<span class="op">^</span>c</a></code></pre></div>
<pre><code>## [1] 0.8422208</code></pre>
<p>For kicks and giggles, it might be interesting to plot this.</p>
<div class="sourceCode" id="cb929"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb929-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">c =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb929-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p1 =</span> (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha_pc)<span class="op">^</span>c,</a>
<a class="sourceLine" id="cb929-3" data-line-number="3">         <span class="dt">p2 =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha_pc)<span class="op">^</span>c) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb929-4" data-line-number="4"><span class="st">  </span><span class="kw">gather</span>(key, probability, <span class="op">-</span>c) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb929-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb929-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> c, <span class="dt">y =</span> probability, <span class="dt">color =</span> key)) <span class="op">+</span></a>
<a class="sourceLine" id="cb929-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb929-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb929-9" data-line-number="9">    <span class="dt">c =</span> <span class="kw">c</span>(<span class="dv">85</span>, <span class="dv">75</span>, <span class="dv">70</span>),</a>
<a class="sourceLine" id="cb929-10" data-line-number="10">    <span class="dt">probability =</span> <span class="kw">c</span>(.<span class="dv">08</span>, <span class="fl">.9</span>, <span class="fl">.82</span>),</a>
<a class="sourceLine" id="cb929-11" data-line-number="11">    <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;no false alarms&quot;</span>,</a>
<a class="sourceLine" id="cb929-12" data-line-number="12">              <span class="st">&quot;at least one false alarm&quot;</span>,</a>
<a class="sourceLine" id="cb929-13" data-line-number="13">              <span class="st">&quot;(i.e., experimentwise false alarm rate)&quot;</span>),</a>
<a class="sourceLine" id="cb929-14" data-line-number="14">    <span class="dt">key =</span> <span class="kw">c</span>(<span class="st">&quot;p1&quot;</span>, <span class="st">&quot;p2&quot;</span>, <span class="st">&quot;p2&quot;</span>)</a>
<a class="sourceLine" id="cb929-15" data-line-number="15">  ),</a>
<a class="sourceLine" id="cb929-16" data-line-number="16">  <span class="kw">aes</span>(<span class="dt">label =</span> label)) <span class="op">+</span></a>
<a class="sourceLine" id="cb929-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">end =</span> <span class="fl">.4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb929-18" data-line-number="18"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;the number of independent tests, c&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb929-19" data-line-number="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb929-20" data-line-number="20">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-45-1.png" /><!-- --></p>
<p>One way to keep the experimentwise false alarm rate down to 5% is by reducing the
permitted false alarm rate for the individual comparisons, i.e., setting a more stringent
criterion for rejecting the null hypothesis in individual comparisons. One often-used re-
setting is the Bonferonni correction, which sets <span class="math inline">\(\alpha_\text{PC} = \alpha_\text{EW}^\text{desired} / c\)</span>.</p>
<p>Here’s how to apply the Bonferonni correction to our example if the desired false-alarm rate is .05.</p>
<div class="sourceCode" id="cb930"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb930-1" data-line-number="1">alpha_pc &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb930-2" data-line-number="2">c        &lt;-<span class="st"> </span><span class="dv">36</span></a>
<a class="sourceLine" id="cb930-3" data-line-number="3"></a>
<a class="sourceLine" id="cb930-4" data-line-number="4"><span class="co"># the Bonferonni correction</span></a>
<a class="sourceLine" id="cb930-5" data-line-number="5">alpha_pc <span class="op">/</span><span class="st"> </span>c</a></code></pre></div>
<pre><code>## [1] 0.001388889</code></pre>
<p>Again, it might be useful to plot the consequence of Bonferonni’s correction on <span class="math inline">\(\alpha\)</span> for different levels of <span class="math inline">\(c\)</span>.</p>
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb932-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">c =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb932-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">a_ew =</span> alpha_pc<span class="op">^</span>c) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb932-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb932-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> c, <span class="dt">y =</span> a_ew)) <span class="op">+</span></a>
<a class="sourceLine" id="cb932-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb932-6" data-line-number="6"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;the number of independent tests, c&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb932-7" data-line-number="7"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-47-1.png" /><!-- --></p>
<p>A little shocking, isn’t it? If you put it on a log scale, you’ll see the relationship is linear.</p>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb933-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">c      =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb933-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">a_ew =</span> alpha_pc<span class="op">^</span>c) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb933-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb933-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> c, <span class="dt">y =</span> a_ew)) <span class="op">+</span></a>
<a class="sourceLine" id="cb933-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb933-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_log10</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb933-7" data-line-number="7"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;the number of independent tests, c&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb933-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="11_files/figure-gfm/unnamed-chunk-48-1.png" /><!-- --></p>
<p>But just look at how low the values on the y-axis get.</p>
</div>
<div id="just-one-bayesian-posterior-no-matter-how-you-look-at-it." class="section level3">
<h3><span class="header-section-number">11.4.2</span> Just one Bayesian posterior no matter how you look at it.</h3>
<blockquote>
<p>In a Bayesian analysis, the interpretation of the data is not influenced by the experimenter’s stopping and testing intentions (assuming that those intentions do not affect the data). A Bayesian analysis yields a posterior distribution over the parameters of the model. The posterior distribution is the complete implication of the data. The posterior distribution can be examined in as many different ways as the analyst deems interesting; various comparisons of groups are merely different perspectives on the posterior distribution. (p. 328)</p>
</blockquote>
</div>
<div id="how-bayesian-analysis-mitigates-false-alarms." class="section level3">
<h3><span class="header-section-number">11.4.3</span> How Bayesian analysis mitigates false alarms.</h3>
<p>From page 329: “How, then, does a Bayesian analysis address the problem of false alarms? By incorporating prior knowledge into the structure of the model.” In addition, we use heirarchical models when possible (e.g., <a href="https://arxiv.org/pdf/0907.2478.pdf">Gelman, Hill, &amp; Yajima, 2009</a>).</p>
</div>
</div>
<div id="what-a-sampling-distribution-is-good-for" class="section level2">
<h2><span class="header-section-number">11.5</span> What a sampling distribution is good for</h2>
<p>“Sampling distributions tell us the probability of imaginary outcomes given a parameter value and an intention, <span class="math inline">\(p(D_{\theta, I}|\theta, I)\)</span>, instead of the probability of parameter values given the actual data, <span class="math inline">\((\theta|D_\text{actual})\)</span>.”</p>
<div id="planning-an-experiment." class="section level3">
<h3><span class="header-section-number">11.5.1</span> Planning an experiment.</h3>
<p>Gelman touched on these sensibilities in a <a href="http://andrewgelman.com/2018/07/19/idea-replication-central-not-just-scientific-practice-also-formal-statistics-frequentist-statistics-relies-reference-set-repeated-experiments-bayesian-statist/">recent blog post</a>.</p>
</div>
<div id="exploring-model-predictions-posterior-predictive-check." class="section level3">
<h3><span class="header-section-number">11.5.2</span> Exploring model predictions (posterior predictive check).</h3>
<p>There’s no shortage of ppc talk on Gelman’s blog (e.g., <a href="http://andrewgelman.com/2017/09/07/touch-want-feel-data/">here</a> or <a href="http://andrewgelman.com/2014/08/11/discussion-sander-greenland-posterior-predictive-checks/">here</a> or <a href="http://andrewgelman.com/2009/02/07/confusions_abou/">here</a>).</p>
</div>
</div>
<div id="reference-10" class="section level2 unnumbered">
<h2>Reference</h2>
<p><a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke, J. K. (2015). <em>Doing Bayesian data analysis, Second Edition: A tutorial with R, JAGS, and Stan.</em> Burlington, MA: Academic Press/Elsevier.</a></p>
</div>
<div id="session-info-10" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb934"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb934-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.0 (2019-04-26)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS High Sierra 10.13.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] gridExtra_2.3   forcats_0.4.0   stringr_1.4.0   dplyr_0.8.3    
##  [5] purrr_0.3.3     readr_1.3.1     tidyr_1.0.0     tibble_2.1.3   
##  [9] ggplot2_3.2.1   tidyverse_1.2.1
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_0.2.5  xfun_0.10         haven_2.1.0      
##  [4] lattice_0.20-38   colorspace_1.4-1  vctrs_0.2.0      
##  [7] generics_0.0.2    htmltools_0.4.0   viridisLite_0.3.0
## [10] yaml_2.2.0        utf8_1.1.4        rlang_0.4.1      
## [13] pillar_1.4.2      glue_1.3.1.9000   withr_2.1.2      
## [16] modelr_0.1.4      readxl_1.3.1      lifecycle_0.1.0  
## [19] munsell_0.5.0     gtable_0.3.0      cellranger_1.1.0 
## [22] rvest_0.3.4       evaluate_0.14     labeling_0.3     
## [25] knitr_1.23        fansi_0.4.0       broom_0.5.2      
## [28] Rcpp_1.0.2        scales_1.0.0      backports_1.1.5  
## [31] jsonlite_1.6      hms_0.4.2         digest_0.6.21    
## [34] stringi_1.4.3     grid_3.6.0        cli_1.1.0        
## [37] tools_3.6.0       magrittr_1.5      lazyeval_0.2.2   
## [40] crayon_1.3.4      pkgconfig_2.0.3   zeallot_0.1.0    
## [43] ellipsis_0.3.0    xml2_1.2.0        lubridate_1.7.4  
## [46] assertthat_0.2.1  rmarkdown_1.13    httr_1.4.0       
## [49] rstudioapi_0.10   R6_2.4.0          nlme_3.1-139     
## [52] compiler_3.6.0</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="model-comparison-and-hierarchical-modeling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
