<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>17 Metric Predicted Variable with One Metric Predictor | Doing Bayesian Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="17 Metric Predicted Variable with One Metric Predictor | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="17 Metric Predicted Variable with One Metric Predictor | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2023-01-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="metric-predicted-variable-on-one-or-two-groups.html"/>
<link rel="next" href="metric-predicted-variable-with-multiple-metric-predictors.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-setup"><i class="fa fa-check"></i><strong>R</strong> setup</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#we-have-updates"><i class="fa fa-check"></i>We have updates</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.1.0."><i class="fa fa-check"></i>Version 0.1.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.2.0."><i class="fa fa-check"></i>Version 0.2.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.3.0."><i class="fa fa-check"></i>Version 0.3.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.4.0."><i class="fa fa-check"></i>Version 0.4.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-1.0.0."><i class="fa fa-check"></i>Version 1.0.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-1.0.1."><i class="fa fa-check"></i>Version 1.0.1.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#some-minor-issues-remain."><i class="fa fa-check"></i>Some minor issues remain.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thank-yous-are-in-order"><i class="fa fa-check"></i>Thank-you’s are in order</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-citation"><i class="fa fa-check"></i>License and citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html"><i class="fa fa-check"></i><b>1</b> What’s in This Book (Read This First!)</a>
<ul>
<li class="chapter" data-level="1.1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#real-people-can-read-this-book"><i class="fa fa-check"></i><b>1.1</b> Real people can read this book</a></li>
<li class="chapter" data-level="1.2" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-in-this-book"><i class="fa fa-check"></i><b>1.2</b> What’s in this book</a></li>
<li class="chapter" data-level="1.3" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-new-in-the-second-edition"><i class="fa fa-check"></i><b>1.3</b> What’s new in the second edition</a></li>
<li class="chapter" data-level="1.4" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#gimme-feedback-be-polite"><i class="fa fa-check"></i><b>1.4</b> Gimme feedback (be polite)</a></li>
<li class="chapter" data-level="1.5" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#thank-you"><i class="fa fa-check"></i><b>1.5</b> Thank you!</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Introduction: Credibility, Models, and Parameters</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#bayesian-inference-is-reallocation-of-credibility-across-possibilities"><i class="fa fa-check"></i><b>2.1</b> Bayesian inference is reallocation of credibility across possibilities</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#data-are-noisy-and-inferences-are-probabilistic."><i class="fa fa-check"></i><b>2.1.1</b> Data are noisy and inferences are probabilistic.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#possibilities-are-parameter-values-in-descriptive-models"><i class="fa fa-check"></i><b>2.2</b> Possibilities are parameter values in descriptive models</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.3</b> The steps of Bayesian data analysis</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html"><i class="fa fa-check"></i><b>3</b> The R Programming Language</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-software"><i class="fa fa-check"></i><b>3.1</b> Get the software</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-look-at-rstudio."><i class="fa fa-check"></i><b>3.1.1</b> A look at RStudio.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-simple-example-of-r-in-action"><i class="fa fa-check"></i><b>3.2</b> A simple example of R in action</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-programs-used-with-this-book."><i class="fa fa-check"></i><b>3.2.1</b> Get the programs used with this book.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#basic-commands-and-operators-in-r"><i class="fa fa-check"></i><b>3.3</b> Basic commands and operators in R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#getting-help-in-r."><i class="fa fa-check"></i><b>3.3.1</b> Getting help in R.</a></li>
<li class="chapter" data-level="3.3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#arithmetic-and-logical-operators."><i class="fa fa-check"></i><b>3.3.2</b> Arithmetic and logical operators.</a></li>
<li class="chapter" data-level="3.3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#assignment-relational-operators-and-tests-of-equality."><i class="fa fa-check"></i><b>3.3.3</b> Assignment, relational operators, and tests of equality.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-types"><i class="fa fa-check"></i><b>3.4</b> Variable types</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#vector."><i class="fa fa-check"></i><b>3.4.1</b> Vector.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#factor."><i class="fa fa-check"></i><b>3.4.2</b> Factor.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#matrix-and-array."><i class="fa fa-check"></i><b>3.4.3</b> Matrix and array.</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#list-and-data-frame."><i class="fa fa-check"></i><b>3.4.4</b> List and data frame.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#loading-and-saving-data"><i class="fa fa-check"></i><b>3.5</b> Loading and saving data</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#the-read.csv-read_csv-and-read.table-read_table-functions."><i class="fa fa-check"></i><b>3.5.1</b> The <del>read.csv</del> <code>read_csv()</code> and <del>read.table</del> <code>read_table()</code> functions.</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#saving-data-from-r."><i class="fa fa-check"></i><b>3.5.2</b> Saving data from R.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#some-utility-functions"><i class="fa fa-check"></i><b>3.6</b> Some utility functions</a></li>
<li class="chapter" data-level="3.7" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-in-r"><i class="fa fa-check"></i><b>3.7</b> Programming in R</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-names-in-r."><i class="fa fa-check"></i><b>3.7.1</b> Variable names in R.</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#running-a-program."><i class="fa fa-check"></i><b>3.7.2</b> Running a program.</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-a-function."><i class="fa fa-check"></i><b>3.7.3</b> Programming a function.</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conditions-and-loops."><i class="fa fa-check"></i><b>3.7.4</b> Conditions and loops.</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#measuring-processing-time."><i class="fa fa-check"></i><b>3.7.5</b> Measuring processing time.</a></li>
<li class="chapter" data-level="3.7.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#debugging."><i class="fa fa-check"></i><b>3.7.6</b> Debugging.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#graphical-plots-opening-and-saving"><i class="fa fa-check"></i><b>3.8</b> Graphical plots: Opening and saving</a></li>
<li class="chapter" data-level="3.9" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conclusion-brms-related-needs"><i class="fa fa-check"></i><b>3.9</b> <del>Conclusion</del> <strong>brms</strong>-related needs</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html"><i class="fa fa-check"></i><b>4</b> What is This Stuff Called Probability?</a>
<ul>
<li class="chapter" data-level="4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#the-set-of-all-possible-events"><i class="fa fa-check"></i><b>4.1</b> The set of all possible events</a></li>
<li class="chapter" data-level="4.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-outside-or-inside-the-head"><i class="fa fa-check"></i><b>4.2</b> Probability: Outside or inside the head</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#outside-the-head-long-run-relative-frequency."><i class="fa fa-check"></i><b>4.2.1</b> Outside the head: Long-run relative frequency.</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#inside-the-head-subjective-belief."><i class="fa fa-check"></i><b>4.2.2</b> Inside the head: Subjective belief.</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probabilities-assign-numbers-to-possibilities."><i class="fa fa-check"></i><b>4.2.3</b> Probabilities assign numbers to possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Probability distributions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#discrete-distributions-probability-mass."><i class="fa fa-check"></i><b>4.3.1</b> Discrete distributions: Probability mass.</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#continuous-distributions-rendezvous-with-density."><i class="fa fa-check"></i><b>4.3.2</b> Continuous distributions: Rendezvous with density.</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#mean-and-variance-of-a-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Mean and variance of a distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#highest-density-interval-hdi."><i class="fa fa-check"></i><b>4.3.4</b> Highest density interval (HDI).</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#two-way-distributions"><i class="fa fa-check"></i><b>4.4</b> Two-way distributions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#conditional-probability."><i class="fa fa-check"></i><b>4.4.1</b> Conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule</a>
<ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-rule-1"><i class="fa fa-check"></i><b>5.1</b> Bayes’ rule</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#derived-from-definitions-of-conditional-probability."><i class="fa fa-check"></i><b>5.1.1</b> Derived from definitions of conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule.html"><a href="bayes-rule.html#applied-to-parameters-and-data"><i class="fa fa-check"></i><b>5.2</b> Applied to parameters and data</a></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule.html"><a href="bayes-rule.html#complete-examples-estimating-bias-in-a-coin"><i class="fa fa-check"></i><b>5.3</b> Complete examples: Estimating bias in a coin</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-sample-size-on-the-posterior."><i class="fa fa-check"></i><b>5.3.1</b> Influence of sample size on the posterior.</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-prior-on-the-posterior."><i class="fa fa-check"></i><b>5.3.2</b> Influence of prior on the posterior.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule.html"><a href="bayes-rule.html#why-bayesian-inference-can-be-difficult"><i class="fa fa-check"></i><b>5.4</b> Why Bayesian inference can be difficult</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-likelihood-function-the-bernoulli-distribution"><i class="fa fa-check"></i><b>6.1</b> The likelihood function: The Bernoulli distribution</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-description-of-credibilities-the-beta-distribution"><i class="fa fa-check"></i><b>6.2</b> A description of credibilities: The beta distribution</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#specifying-a-beta-prior."><i class="fa fa-check"></i><b>6.2.1</b> Specifying a beta prior.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-posterior-beta"><i class="fa fa-check"></i><b>6.3</b> The posterior beta</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#posterior-is-compromise-of-prior-and-likelihood."><i class="fa fa-check"></i><b>6.3.1</b> Posterior is compromise of prior and likelihood.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.1</b> Prior knowledge expressed as a beta distribution.</a></li>
<li class="chapter" data-level="6.4.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.2</b> Prior knowledge that cannot be expressed as a beta distribution.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#approximating-a-distribution-with-a-large-sample"><i class="fa fa-check"></i><b>7.1</b> Approximating a distribution with a large sample</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-simple-case-of-the-metropolis-algorithm"><i class="fa fa-check"></i><b>7.2</b> A simple case of the Metropolis algorithm</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-politician-stumbles-upon-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.2.1</b> A politician stumbles upon the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-random-walk."><i class="fa fa-check"></i><b>7.2.2</b> A random walk.</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#general-properties-of-a-random-walk."><i class="fa fa-check"></i><b>7.2.3</b> General properties of a random walk.</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#why-we-care."><i class="fa fa-check"></i><b>7.2.4</b> Why we care.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-metropolis-algorithm-more-generally"><i class="fa fa-check"></i><b>7.3</b> The Metropolis algorithm more generally</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithm-applied-to-bernoulli-likelihood-and-beta-prior."><i class="fa fa-check"></i><b>7.3.1</b> Metropolis algorithm applied to Bernoulli likelihood and beta prior.</a></li>
<li class="chapter" data-level="7.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-of-metropolis-algorithm."><i class="fa fa-check"></i><b>7.3.2</b> Summary of Metropolis algorithm.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#toward-gibbs-sampling-estimating-two-coin-biases"><i class="fa fa-check"></i><b>7.4</b> Toward Gibbs sampling: Estimating two coin biases</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#prior-likelihood-and-posterior-for-two-biases."><i class="fa fa-check"></i><b>7.4.1</b> Prior, likelihood and posterior for two biases.</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-exact-formal-analysis."><i class="fa fa-check"></i><b>7.4.2</b> The posterior via exact formal analysis.</a></li>
<li class="chapter" data-level="7.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.4.3</b> The posterior via the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-hamiltonian-monte-carlo-sampling."><i class="fa fa-check"></i><b>7.4.4</b> <del>Gibbs</del> Hamiltonian Monte Carlo sampling.</a></li>
<li class="chapter" data-level="7.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#is-there-a-difference-between-biases"><i class="fa fa-check"></i><b>7.4.5</b> Is there a difference between biases?</a></li>
<li class="chapter" data-level="7.4.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#terminology-mcmc."><i class="fa fa-check"></i><b>7.4.6</b> Terminology: MCMC.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness-accuracy-and-efficiency"><i class="fa fa-check"></i><b>7.5</b> MCMC representativeness, accuracy, and efficiency</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness."><i class="fa fa-check"></i><b>7.5.1</b> MCMC representativeness.</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-accuracy."><i class="fa fa-check"></i><b>7.5.2</b> MCMC accuracy.</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-efficiency."><i class="fa fa-check"></i><b>7.5.3</b> MCMC efficiency.</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-1"><i class="fa fa-check"></i><b>7.6</b> Summary</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#footnote-1"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-brms.html"><a href="jags-brms.html"><i class="fa fa-check"></i><b>8</b> <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="8.1" data-path="jags-brms.html"><a href="jags-brms.html#jags-brms-and-its-relation-to-r"><i class="fa fa-check"></i><b>8.1</b> <del>JAGS</del> brms and its relation to R</a></li>
<li class="chapter" data-level="8.2" data-path="jags-brms.html"><a href="jags-brms.html#a-complete-example"><i class="fa fa-check"></i><b>8.2</b> A complete example</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="jags-brms.html"><a href="jags-brms.html#load-data."><i class="fa fa-check"></i><b>8.2.1</b> Load data.</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-brms.html"><a href="jags-brms.html#specify-model."><i class="fa fa-check"></i><b>8.2.2</b> Specify model.</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-brms.html"><a href="jags-brms.html#initialize-chains."><i class="fa fa-check"></i><b>8.2.3</b> Initialize chains.</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-brms.html"><a href="jags-brms.html#generate-chains."><i class="fa fa-check"></i><b>8.2.4</b> Generate chains.</a></li>
<li class="chapter" data-level="8.2.5" data-path="jags-brms.html"><a href="jags-brms.html#examine-chains."><i class="fa fa-check"></i><b>8.2.5</b> Examine chains.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-brms.html"><a href="jags-brms.html#simplified-scripts-for-frequently-used-analyses"><i class="fa fa-check"></i><b>8.3</b> Simplified scripts for frequently used analyses</a></li>
<li class="chapter" data-level="8.4" data-path="jags-brms.html"><a href="jags-brms.html#example-difference-of-biases"><i class="fa fa-check"></i><b>8.4</b> Example: Difference of biases</a></li>
<li class="chapter" data-level="8.5" data-path="jags-brms.html"><a href="jags-brms.html#sampling-from-the-prior-distribution-in-jags-brms"><i class="fa fa-check"></i><b>8.5</b> Sampling from the prior distribution in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="8.6" data-path="jags-brms.html"><a href="jags-brms.html#probability-distributions-available-in-jags-brms"><i class="fa fa-check"></i><b>8.6</b> Probability distributions available in <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="jags-brms.html"><a href="jags-brms.html#defining-new-likelihood-functions."><i class="fa fa-check"></i><b>8.6.1</b> Defining new likelihood functions.</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="jags-brms.html"><a href="jags-brms.html#faster-sampling-with-parallel-processing-in-runjags-brmsbrm"><i class="fa fa-check"></i><b>8.7</b> Faster sampling with parallel processing in <del>runjags</del> <code>brms::brm()</code></a></li>
<li class="chapter" data-level="8.8" data-path="jags-brms.html"><a href="jags-brms.html#tips-for-expanding-jags-brms-models"><i class="fa fa-check"></i><b>8.8</b> Tips for expanding <del>JAGS</del> brms models</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Hierarchical Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-single-coin-from-a-single-mint"><i class="fa fa-check"></i><b>9.1</b> A single coin from a single mint</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation."><i class="fa fa-check"></i><b>9.1.1</b> Posterior via grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#multiple-coins-from-a-single-mint"><i class="fa fa-check"></i><b>9.2</b> Multiple coins from a single mint</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation.-1"><i class="fa fa-check"></i><b>9.2.1</b> Posterior via grid approximation.</a></li>
<li class="chapter" data-level="9.2.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-realistic-model-with-mcmc."><i class="fa fa-check"></i><b>9.2.2</b> A realistic model with MCMC.</a></li>
<li class="chapter" data-level="9.2.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#doing-it-with-jags-brms."><i class="fa fa-check"></i><b>9.2.3</b> Doing it with <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="9.2.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-therapeutic-touch."><i class="fa fa-check"></i><b>9.2.4</b> Example: Therapeutic touch.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#shrinkage-in-hierarchical-models"><i class="fa fa-check"></i><b>9.3</b> Shrinkage in hierarchical models</a></li>
<li class="chapter" data-level="9.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#speeding-up-jags-brms"><i class="fa fa-check"></i><b>9.4</b> Speeding up <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="9.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#extending-the-hierarchy-subjects-within-categories"><i class="fa fa-check"></i><b>9.5</b> Extending the hierarchy: Subjects within categories</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-batting-abilities-by-position."><i class="fa fa-check"></i><b>9.5.1</b> Example: Baseball batting abilities by position.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html"><i class="fa fa-check"></i><b>10</b> Model Comparison and Hierarchical Modeling</a>
<ul>
<li class="chapter" data-level="10.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#general-formula-and-the-bayes-factor"><i class="fa fa-check"></i><b>10.1</b> General formula and the Bayes factor</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#example-two-factories-of-coins"><i class="fa fa-check"></i><b>10.2</b> Example: Two factories of coins</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-formal-analysis."><i class="fa fa-check"></i><b>10.2.1</b> Solution by formal analysis.</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-grid-approximation."><i class="fa fa-check"></i><b>10.2.2</b> Solution by grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-mcmc"><i class="fa fa-check"></i><b>10.3</b> Solution by MCMC</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#nonhierarchical-mcmc-computation-of-each-models-marginal-likelihood."><i class="fa fa-check"></i><b>10.3.1</b> Nonhierarchical MCMC computation of each model’s marginal likelihood.</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#hierarchical-mcmc-computation-of-relative-model-probability-is-not-available-in-brms-well-cover-information-criteria-instead."><i class="fa fa-check"></i><b>10.3.2</b> Hierarchical MCMC computation <del>of relative model probability</del> is not available in brms: We’ll cover information criteria instead.</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#models-with-different-noise-distributions-in-jags-brms."><i class="fa fa-check"></i><b>10.3.3</b> Models with different “noise” distributions in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#prediction-model-averaging"><i class="fa fa-check"></i><b>10.4</b> Prediction: Model averaging</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#model-complexity-naturally-accounted-for"><i class="fa fa-check"></i><b>10.5</b> Model complexity naturally accounted for</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#caveats-regarding-nested-model-comparison."><i class="fa fa-check"></i><b>10.5.1</b> Caveats regarding nested model comparison.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#extreme-sensitivity-to-prior-distribution"><i class="fa fa-check"></i><b>10.6</b> Extreme sensitivity to prior distribution</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#priors-of-different-models-should-be-equally-informed."><i class="fa fa-check"></i><b>10.6.1</b> Priors of different models should be equally informed.</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#bonus-theres-danger-ahead"><i class="fa fa-check"></i><b>10.7</b> Bonus: There’s danger ahead</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#footnote-2"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>11</b> Null Hypothesis Significance Testing</a>
<ul>
<li class="chapter" data-level="11.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#paved-with-good-intentions"><i class="fa fa-check"></i><b>11.1</b> Paved with good intentions</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#definition-of-p-value."><i class="fa fa-check"></i><b>11.1.1</b> Definition of <span class="math inline">\(p\)</span> value.</a></li>
<li class="chapter" data-level="11.1.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-n."><i class="fa fa-check"></i><b>11.1.2</b> With intention to fix <span class="math inline">\(N\)</span>.</a></li>
<li class="chapter" data-level="11.1.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-z."><i class="fa fa-check"></i><b>11.1.3</b> With intention to fix <span class="math inline">\(z\)</span>.</a></li>
<li class="chapter" data-level="11.1.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-duration."><i class="fa fa-check"></i><b>11.1.4</b> With intention to fix duration.</a></li>
<li class="chapter" data-level="11.1.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-make-multiple-tests."><i class="fa fa-check"></i><b>11.1.5</b> With intention to make multiple tests.</a></li>
<li class="chapter" data-level="11.1.6" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#soul-searching."><i class="fa fa-check"></i><b>11.1.6</b> Soul searching.</a></li>
<li class="chapter" data-level="11.1.7" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis."><i class="fa fa-check"></i><b>11.1.7</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#prior-knowledge"><i class="fa fa-check"></i><b>11.2</b> Prior knowledge</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-analysis."><i class="fa fa-check"></i><b>11.2.1</b> NHST analysis.</a></li>
<li class="chapter" data-level="11.2.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis.-1"><i class="fa fa-check"></i><b>11.2.2</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#confidence-interval-and-highest-density-interval"><i class="fa fa-check"></i><b>11.3</b> Confidence interval and highest density interval</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#ci-depends-on-intention."><i class="fa fa-check"></i><b>11.3.1</b> CI depends on intention.</a></li>
<li class="chapter" data-level="11.3.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-hdi."><i class="fa fa-check"></i><b>11.3.2</b> Bayesian HDI.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#multiple-comparisons"><i class="fa fa-check"></i><b>11.4</b> Multiple comparisons</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-correction-for-experiment-wise-error."><i class="fa fa-check"></i><b>11.4.1</b> NHST correction for experiment wise error.</a></li>
<li class="chapter" data-level="11.4.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#just-one-bayesian-posterior-no-matter-how-you-look-at-it."><i class="fa fa-check"></i><b>11.4.2</b> Just one Bayesian posterior no matter how you look at it.</a></li>
<li class="chapter" data-level="11.4.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#how-bayesian-analysis-mitigates-false-alarms."><i class="fa fa-check"></i><b>11.4.3</b> How Bayesian analysis mitigates false alarms.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#what-a-sampling-distribution-is-good-for"><i class="fa fa-check"></i><b>11.5</b> What a sampling distribution is good for</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#planning-an-experiment."><i class="fa fa-check"></i><b>11.5.1</b> Planning an experiment.</a></li>
<li class="chapter" data-level="11.5.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#exploring-model-predictions-posterior-predictive-check."><i class="fa fa-check"></i><b>11.5.2</b> Exploring model predictions (posterior predictive check).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#footnote-3"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><i class="fa fa-check"></i><b>12</b> Bayesian Approaches to Testing a Point (“Null”) Hypothesis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-estimation-approach"><i class="fa fa-check"></i><b>12.1</b> The estimation approach</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#region-of-practical-equivalence."><i class="fa fa-check"></i><b>12.1.1</b> Region of practical equivalence.</a></li>
<li class="chapter" data-level="12.1.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#some-examples."><i class="fa fa-check"></i><b>12.1.2</b> Some examples.</a></li>
<li class="chapter" data-level="12.1.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#differences-of-correlated-parameters."><i class="fa fa-check"></i><b>12.1.3</b> Differences of correlated parameters.</a></li>
<li class="chapter" data-level="12.1.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#why-hdi-and-not-equal-tailed-interval"><i class="fa fa-check"></i><b>12.1.4</b> Why HDI and not equal-tailed interval?</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-model-comparison-approach"><i class="fa fa-check"></i><b>12.2</b> The model-comparison approach</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#is-a-coin-fair-or-not"><i class="fa fa-check"></i><b>12.2.1</b> Is a coin fair or not?</a></li>
<li class="chapter" data-level="12.2.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#are-different-groups-equal-or-not"><i class="fa fa-check"></i><b>12.2.2</b> Are different groups equal or not?</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#relations-of-parameter-estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.3</b> Relations of parameter estimation and model comparison</a></li>
<li class="chapter" data-level="12.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.4</b> Estimation and model comparison?</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html"><i class="fa fa-check"></i><b>13</b> Goals, Power, and Sample Size</a>
<ul>
<li class="chapter" data-level="13.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-will-to-power"><i class="fa fa-check"></i><b>13.1</b> The will to power</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#goals-and-obstacles."><i class="fa fa-check"></i><b>13.1.1</b> Goals and obstacles.</a></li>
<li class="chapter" data-level="13.1.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power."><i class="fa fa-check"></i><b>13.1.2</b> Power.</a></li>
<li class="chapter" data-level="13.1.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sample-size."><i class="fa fa-check"></i><b>13.1.3</b> Sample size.</a></li>
<li class="chapter" data-level="13.1.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#other-expressions-of-goals."><i class="fa fa-check"></i><b>13.1.4</b> Other expressions of goals.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#computing-power-and-sample-size"><i class="fa fa-check"></i><b>13.2</b> Computing power and sample size</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-to-exclude-a-null-value."><i class="fa fa-check"></i><b>13.2.1</b> When the goal is to exclude a null value.</a></li>
<li class="chapter" data-level="13.2.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#formal-solution-and-implementation-in-r."><i class="fa fa-check"></i><b>13.2.2</b> Formal solution and implementation in R.</a></li>
<li class="chapter" data-level="13.2.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-precision."><i class="fa fa-check"></i><b>13.2.3</b> When the goal is precision.</a></li>
<li class="chapter" data-level="13.2.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#monte-carlo-approximation-of-power."><i class="fa fa-check"></i><b>13.2.4</b> Monte Carlo approximation of power.</a></li>
<li class="chapter" data-level="13.2.5" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-from-idealized-or-actual-data."><i class="fa fa-check"></i><b>13.2.5</b> Power from idealized or actual data.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sequential-testing-and-the-goal-of-precision"><i class="fa fa-check"></i><b>13.3</b> Sequential testing and the goal of precision</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#examples-of-sequential-tests."><i class="fa fa-check"></i><b>13.3.1</b> Examples of sequential tests.</a></li>
<li class="chapter" data-level="13.3.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#average-behavior-of-sequential-tests."><i class="fa fa-check"></i><b>13.3.2</b> Average behavior of sequential tests.</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#discussion"><i class="fa fa-check"></i><b>13.4</b> Discussion</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-and-multiple-comparisons."><i class="fa fa-check"></i><b>13.4.1</b> Power and multiple comparisons.</a></li>
<li class="chapter" data-level="13.4.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-prospective-retrospective-and-replication."><i class="fa fa-check"></i><b>13.4.2</b> Power: prospective, retrospective, and replication.</a></li>
<li class="chapter" data-level="13.4.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-analysis-requires-verisimilitude-of-simulated-data."><i class="fa fa-check"></i><b>13.4.3</b> Power analysis requires verisimilitude of simulated data.</a></li>
<li class="chapter" data-level="13.4.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-importance-of-planning."><i class="fa fa-check"></i><b>13.4.4</b> The importance of planning.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a>
<ul>
<li class="chapter" data-level="14.1" data-path="stan.html"><a href="stan.html#hmc-sampling"><i class="fa fa-check"></i><b>14.1</b> HMC sampling</a></li>
<li class="chapter" data-level="14.2" data-path="stan.html"><a href="stan.html#installing-stan"><i class="fa fa-check"></i><b>14.2</b> Installing Stan</a></li>
<li class="chapter" data-level="14.3" data-path="stan.html"><a href="stan.html#a-complete-example-1"><i class="fa fa-check"></i><b>14.3</b> A Complete example</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="stan.html"><a href="stan.html#reusing-the-compiled-model."><i class="fa fa-check"></i><b>14.3.1</b> Reusing the compiled model.</a></li>
<li class="chapter" data-level="14.3.2" data-path="stan.html"><a href="stan.html#general-structure-of-stan-model-specification."><i class="fa fa-check"></i><b>14.3.2</b> General structure of Stan model specification.</a></li>
<li class="chapter" data-level="14.3.3" data-path="stan.html"><a href="stan.html#think-log-probability-to-think-like-stan."><i class="fa fa-check"></i><b>14.3.3</b> Think log probability to think like Stan.</a></li>
<li class="chapter" data-level="14.3.4" data-path="stan.html"><a href="stan.html#sampling-the-prior-in-stan."><i class="fa fa-check"></i><b>14.3.4</b> Sampling the prior in Stan.</a></li>
<li class="chapter" data-level="14.3.5" data-path="stan.html"><a href="stan.html#simplified-scripts-for-frequently-used-analyses."><i class="fa fa-check"></i><b>14.3.5</b> Simplified scripts for frequently used analyses.</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="stan.html"><a href="stan.html#specify-models-top-down-in-stan"><i class="fa fa-check"></i><b>14.4</b> Specify models top-down in Stan</a></li>
<li class="chapter" data-level="14.5" data-path="stan.html"><a href="stan.html#limitations-and-extras"><i class="fa fa-check"></i><b>14.5</b> Limitations and extras</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#footnote-4"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>15</b> Overview of the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="15.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#types-of-variables"><i class="fa fa-check"></i><b>15.1</b> Types of variables</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#predictor-and-predicted-variables."><i class="fa fa-check"></i><b>15.1.1</b> Predictor and predicted variables.</a></li>
<li class="chapter" data-level="15.1.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#scale-types-metric-ordinal-nominal-and-count."><i class="fa fa-check"></i><b>15.1.2</b> Scale types: metric, ordinal, nominal, and count.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-combination-of-predictors"><i class="fa fa-check"></i><b>15.2</b> Linear combination of predictors</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-function-of-a-single-metric-predictor."><i class="fa fa-check"></i><b>15.2.1</b> Linear function of a single metric predictor.</a></li>
<li class="chapter" data-level="15.2.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#additive-combination-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.2</b> Additive combination of metric predictors.</a></li>
<li class="chapter" data-level="15.2.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nonadditive-interaction-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.3</b> Nonadditive interaction of metric predictors.</a></li>
<li class="chapter" data-level="15.2.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nominal-predictors."><i class="fa fa-check"></i><b>15.2.4</b> Nominal predictors.</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linking-from-combined-predictors-to-noisy-predicted-data"><i class="fa fa-check"></i><b>15.3</b> Linking from combined predictors to noisy predicted data</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predictors-to-predicted-central-tendency."><i class="fa fa-check"></i><b>15.3.1</b> From predictors to predicted central tendency.</a></li>
<li class="chapter" data-level="15.3.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predicted-central-tendency-to-noisy-data."><i class="fa fa-check"></i><b>15.3.2</b> From predicted central tendency to noisy data.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#formal-expression-of-the-glm"><i class="fa fa-check"></i><b>15.4</b> Formal expression of the GLM</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#cases-of-the-glm."><i class="fa fa-check"></i><b>15.4.1</b> Cases of the GLM.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html"><i class="fa fa-check"></i><b>16</b> Metric-Predicted Variable on One or Two Groups</a>
<ul>
<li class="chapter" data-level="16.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#estimating-the-mean-and-standard-deviation-of-a-normal-distribution"><i class="fa fa-check"></i><b>16.1</b> Estimating the mean and standard deviation of a normal distribution</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#solution-by-mathematical-analysis-heads-up-on-precision."><i class="fa fa-check"></i><b>16.1.1</b> <del>Solution by mathematical analysis</del> Heads up on precision.</a></li>
<li class="chapter" data-level="16.1.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#approximation-by-mcmc-in-jags-hmc-in-brms."><i class="fa fa-check"></i><b>16.1.2</b> Approximation by <del>MCMC in JAGS</del> HMC in brms.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#outliers-and-robust-estimation-the-t-distribution"><i class="fa fa-check"></i><b>16.2</b> Outliers and robust estimation: The <span class="math inline">\(t\)</span> distribution</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-jags-brms."><i class="fa fa-check"></i><b>16.2.1</b> Using the <span class="math inline">\(t\)</span> distribution in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="16.2.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-stan."><i class="fa fa-check"></i><b>16.2.2</b> Using the <span class="math inline">\(t\)</span> distribution in Stan.</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#two-groups"><i class="fa fa-check"></i><b>16.3</b> Two groups</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#analysis-by-nhst."><i class="fa fa-check"></i><b>16.3.1</b> Analysis by NHST.</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#other-noise-distributions-and-transforming-data"><i class="fa fa-check"></i><b>16.4</b> Other noise distributions and transforming data</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#session-info-15"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html"><i class="fa fa-check"></i><b>17</b> Metric Predicted Variable with One Metric Predictor</a>
<ul>
<li class="chapter" data-level="17.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#simple-linear-regression"><i class="fa fa-check"></i><b>17.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="17.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Robust linear regression</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-jags-brms."><i class="fa fa-check"></i><b>17.2.1</b> Robust linear regression in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.2.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-stan."><i class="fa fa-check"></i><b>17.2.2</b> Robust linear regression in Stan.</a></li>
<li class="chapter" data-level="17.2.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#stan-or-jags"><i class="fa fa-check"></i><b>17.2.3</b> Stan or JAGS?</a></li>
<li class="chapter" data-level="17.2.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>17.2.4</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#hierarchical-regression-on-individuals-within-groups"><i class="fa fa-check"></i><b>17.3</b> Hierarchical regression on individuals within groups</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>17.3.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.3.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-posterior-distribution-shrinkage-and-prediction."><i class="fa fa-check"></i><b>17.3.2</b> The posterior distribution: Shrinkage and prediction.</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#quadratic-trend-and-weighted-data"><i class="fa fa-check"></i><b>17.4</b> Quadratic trend and weighted data</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#results-and-interpretation."><i class="fa fa-check"></i><b>17.4.1</b> Results and interpretation.</a></li>
<li class="chapter" data-level="17.4.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#further-extensions."><i class="fa fa-check"></i><b>17.4.2</b> Further extensions.</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#procedure-and-perils-for-expanding-a-model"><i class="fa fa-check"></i><b>17.5</b> Procedure and perils for expanding a model</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#session-info-16"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Metric Predicted Variable with Multiple Metric Predictors</a>
<ul>
<li class="chapter" data-level="18.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiple-linear-regression"><i class="fa fa-check"></i><b>18.1</b> Multiple linear regression</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-perils-of-correlated-predictors."><i class="fa fa-check"></i><b>18.1.1</b> The perils of correlated predictors.</a></li>
<li class="chapter" data-level="18.1.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-model-and-implementation."><i class="fa fa-check"></i><b>18.1.2</b> The model and implementation.</a></li>
<li class="chapter" data-level="18.1.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-posterior-distribution."><i class="fa fa-check"></i><b>18.1.3</b> The posterior distribution.</a></li>
<li class="chapter" data-level="18.1.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#redundant-predictors."><i class="fa fa-check"></i><b>18.1.4</b> Redundant predictors.</a></li>
<li class="chapter" data-level="18.1.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#informative-priors-sparse-data-and-correlated-predictors."><i class="fa fa-check"></i><b>18.1.5</b> Informative priors, sparse data, and correlated predictors.</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiplicative-interaction-of-metric-predictors"><i class="fa fa-check"></i><b>18.2</b> Multiplicative interaction of metric predictors</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#an-example."><i class="fa fa-check"></i><b>18.2.1</b> An example.</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#shrinkage-of-regression-coefficients"><i class="fa fa-check"></i><b>18.3</b> Shrinkage of regression coefficients</a></li>
<li class="chapter" data-level="18.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection"><i class="fa fa-check"></i><b>18.4</b> Variable selection</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#inclusion-probability-is-strongly-affected-by-vagueness-of-prior."><i class="fa fa-check"></i><b>18.4.1</b> Inclusion probability is strongly affected by vagueness of prior.</a></li>
<li class="chapter" data-level="18.4.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection-with-hierarchical-shrinkage."><i class="fa fa-check"></i><b>18.4.2</b> Variable selection with hierarchical shrinkage.</a></li>
<li class="chapter" data-level="18.4.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#what-to-report-and-what-to-conclude."><i class="fa fa-check"></i><b>18.4.3</b> What to report and what to conclude.</a></li>
<li class="chapter" data-level="18.4.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-computational-methods."><i class="fa fa-check"></i><b>18.4.4</b> Caution: Computational methods.</a></li>
<li class="chapter" data-level="18.4.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-interaction-variables."><i class="fa fa-check"></i><b>18.4.5</b> Caution: Interaction variables.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#session-info-17"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#footnote-5"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html"><i class="fa fa-check"></i><b>19</b> Metric Predicted Variable with One Nominal Predictor</a>
<ul>
<li class="chapter" data-level="19.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#describing-multiple-groups-of-metric-data"><i class="fa fa-check"></i><b>19.1</b> Describing multiple groups of metric data</a></li>
<li class="chapter" data-level="19.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#traditional-analysis-of-variance"><i class="fa fa-check"></i><b>19.2</b> Traditional analysis of variance</a></li>
<li class="chapter" data-level="19.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#hierarchical-bayesian-approach"><i class="fa fa-check"></i><b>19.3</b> Hierarchical Bayesian approach</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#implementation-in-jags-brms."><i class="fa fa-check"></i><b>19.3.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="19.3.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-and-death."><i class="fa fa-check"></i><b>19.3.2</b> Example: Sex and death.</a></li>
<li class="chapter" data-level="19.3.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#contrasts."><i class="fa fa-check"></i><b>19.3.3</b> Contrasts.</a></li>
<li class="chapter" data-level="19.3.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#multiple-comparisons-and-shrinkage."><i class="fa fa-check"></i><b>19.3.4</b> Multiple comparisons and shrinkage.</a></li>
<li class="chapter" data-level="19.3.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#the-two-group-case."><i class="fa fa-check"></i><b>19.3.5</b> The two-group case.</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#including-a-metric-predictor"><i class="fa fa-check"></i><b>19.4</b> Including a metric predictor</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-death-and-size."><i class="fa fa-check"></i><b>19.4.1</b> Example: Sex, death, and size.</a></li>
<li class="chapter" data-level="19.4.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#analogous-to-traditional-ancova."><i class="fa fa-check"></i><b>19.4.2</b> Analogous to traditional ANCOVA.</a></li>
<li class="chapter" data-level="19.4.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#relation-to-hierarchical-linear-regression."><i class="fa fa-check"></i><b>19.4.3</b> Relation to hierarchical linear regression.</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#heterogeneous-variances-and-robustness-against-outliers"><i class="fa fa-check"></i><b>19.5</b> Heterogeneous variances and robustness against outliers</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-contrast-of-means-with-different-variances."><i class="fa fa-check"></i><b>19.5.1</b> Example: Contrast of means with different variances.</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#exercises-walk-out-an-effect-size"><i class="fa fa-check"></i><b>19.6</b> <del>Exercises</del> Walk out an effect size</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#your-sample-sizes-may-differ."><i class="fa fa-check"></i><b>19.6.1</b> Your sample sizes may differ.</a></li>
<li class="chapter" data-level="19.6.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#populations-and-samples."><i class="fa fa-check"></i><b>19.6.2</b> Populations and samples.</a></li>
<li class="chapter" data-level="19.6.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#report-your-effect-sizes-effectively."><i class="fa fa-check"></i><b>19.6.3</b> Report your effect sizes effectively.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#session-info-18"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Metric Predicted Variable with Multiple Nominal Predictors</a>
<ul>
<li class="chapter" data-level="20.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#describing-groups-of-metric-data-with-multiple-nominal-predictors"><i class="fa fa-check"></i><b>20.1</b> Describing groups of metric data with multiple nominal predictors</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction."><i class="fa fa-check"></i><b>20.1.1</b> Interaction.</a></li>
<li class="chapter" data-level="20.1.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#traditional-anova."><i class="fa fa-check"></i><b>20.1.2</b> Traditional ANOVA.</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#hierarchical-bayesian-approach-1"><i class="fa fa-check"></i><b>20.2</b> Hierarchical Bayesian approach</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>20.2.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="20.2.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#example-its-only-money."><i class="fa fa-check"></i><b>20.2.2</b> Example: It’s only money.</a></li>
<li class="chapter" data-level="20.2.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#main-effect-contrasts."><i class="fa fa-check"></i><b>20.2.3</b> Main effect contrasts.</a></li>
<li class="chapter" data-level="20.2.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction-contrasts-and-simple-effects."><i class="fa fa-check"></i><b>20.2.4</b> Interaction contrasts and simple effects.</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#rescaling-can-change-interactions-homogeneity-and-normality"><i class="fa fa-check"></i><b>20.3</b> Rescaling can change interactions, homogeneity, and normality</a></li>
<li class="chapter" data-level="20.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1"><i class="fa fa-check"></i><b>20.4</b> Heterogeneous variances and robustness against outliers</a></li>
<li class="chapter" data-level="20.5" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#within-subject-designs"><i class="fa fa-check"></i><b>20.5</b> Within-subject designs</a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#why-use-a-within-subject-design-and-why-not"><i class="fa fa-check"></i><b>20.5.1</b> Why use a within-subject design? And why not?</a></li>
<li class="chapter" data-level="20.5.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#split-plot-design."><i class="fa fa-check"></i><b>20.5.2</b> Split-plot design.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#session-info-19"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#footnote-6"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html"><i class="fa fa-check"></i><b>21</b> Dichotomous Predicted Variable</a>
<ul>
<li class="chapter" data-level="21.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-metric-predictors"><i class="fa fa-check"></i><b>21.1</b> Multiple metric predictors</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#the-model-and-implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>21.1.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="21.1.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#example-height-weight-and-gender."><i class="fa fa-check"></i><b>21.1.2</b> Example: Height, weight, and gender.</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interpreting-the-regression-coefficients"><i class="fa fa-check"></i><b>21.2</b> Interpreting the regression coefficients</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#log-odds."><i class="fa fa-check"></i><b>21.2.1</b> Log odds.</a></li>
<li class="chapter" data-level="21.2.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#when-there-are-few-1s-or-0s-in-the-data."><i class="fa fa-check"></i><b>21.2.2</b> When there are few 1’s or 0’s in the data.</a></li>
<li class="chapter" data-level="21.2.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#correlated-predictors."><i class="fa fa-check"></i><b>21.2.3</b> Correlated predictors.</a></li>
<li class="chapter" data-level="21.2.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interaction-of-metric-predictors."><i class="fa fa-check"></i><b>21.2.4</b> Interaction of metric predictors.</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#robust-logistic-regression"><i class="fa fa-check"></i><b>21.3</b> Robust logistic regression</a></li>
<li class="chapter" data-level="21.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#nominal-predictors"><i class="fa fa-check"></i><b>21.4</b> Nominal predictors</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#single-group."><i class="fa fa-check"></i><b>21.4.1</b> Single group.</a></li>
<li class="chapter" data-level="21.4.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-groups."><i class="fa fa-check"></i><b>21.4.2</b> Multiple groups.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#session-info-20"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html"><i class="fa fa-check"></i><b>22</b> Nominal Predicted Variable</a>
<ul>
<li class="chapter" data-level="22.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-regression"><i class="fa fa-check"></i><b>22.1</b> Softmax regression</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-reduces-to-logistic-for-two-outcomes."><i class="fa fa-check"></i><b>22.1.1</b> Softmax reduces to logistic for two outcomes.</a></li>
<li class="chapter" data-level="22.1.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#independence-from-irrelevant-attributes."><i class="fa fa-check"></i><b>22.1.2</b> Independence from irrelevant attributes.</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>22.2</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="22.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#implementation-in-jags-brms"><i class="fa fa-check"></i><b>22.3</b> Implementation in <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-model."><i class="fa fa-check"></i><b>22.3.1</b> Softmax model.</a></li>
<li class="chapter" data-level="22.3.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-model."><i class="fa fa-check"></i><b>22.3.2</b> Conditional logistic model.</a></li>
<li class="chapter" data-level="22.3.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#results-interpreting-the-regression-coefficients."><i class="fa fa-check"></i><b>22.3.3</b> Results: Interpreting the regression coefficients.</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#generalizations-and-variations-of-the-models"><i class="fa fa-check"></i><b>22.4</b> Generalizations and variations of the models</a></li>
<li class="chapter" data-level="" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#session-info-21"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html"><i class="fa fa-check"></i><b>23</b> Ordinal Predicted Variable</a>
<ul>
<li class="chapter" data-level="23.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#modeling-ordinal-data-with-an-underlying-metric-variable"><i class="fa fa-check"></i><b>23.1</b> Modeling ordinal data with an underlying metric variable</a></li>
<li class="chapter" data-level="23.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-a-single-group"><i class="fa fa-check"></i><b>23.2</b> The case of a single group</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-3"><i class="fa fa-check"></i><b>23.2.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.2.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-bayesian-estimation-recovers-true-parameter-values."><i class="fa fa-check"></i><b>23.2.2</b> Examples: Bayesian estimation recovers true parameter values.</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-two-groups"><i class="fa fa-check"></i><b>23.3</b> The case of two groups</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-4"><i class="fa fa-check"></i><b>23.3.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.3.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-not-funny."><i class="fa fa-check"></i><b>23.3.2</b> Examples: Not funny.</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-metric-predictors"><i class="fa fa-check"></i><b>23.4</b> The Case of metric predictors</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-5"><i class="fa fa-check"></i><b>23.4.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="23.4.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-happiness-and-money."><i class="fa fa-check"></i><b>23.4.2</b> Example: Happiness and money.</a></li>
<li class="chapter" data-level="23.4.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-moviesthey-dont-make-em-like-they-used-to."><i class="fa fa-check"></i><b>23.4.3</b> Example: Movies–They don’t make ’em like they used to.</a></li>
<li class="chapter" data-level="23.4.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#why-are-some-thresholds-outside-the-data"><i class="fa fa-check"></i><b>23.4.4</b> Why are some thresholds outside the data?</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#posterior-prediction"><i class="fa fa-check"></i><b>23.5</b> Posterior prediction</a></li>
<li class="chapter" data-level="23.6" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#generalizations-and-extensions"><i class="fa fa-check"></i><b>23.6</b> Generalizations and extensions</a></li>
<li class="chapter" data-level="" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#session-info-22"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html"><i class="fa fa-check"></i><b>24</b> Count Predicted Variable</a>
<ul>
<li class="chapter" data-level="24.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-exponential-model"><i class="fa fa-check"></i><b>24.1</b> Poisson exponential model</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#data-structure."><i class="fa fa-check"></i><b>24.1.1</b> Data structure.</a></li>
<li class="chapter" data-level="24.1.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#exponential-link-function."><i class="fa fa-check"></i><b>24.1.2</b> Exponential link function.</a></li>
<li class="chapter" data-level="24.1.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-noise-distribution."><i class="fa fa-check"></i><b>24.1.3</b> Poisson noise distribution.</a></li>
<li class="chapter" data-level="24.1.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#the-complete-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>24.1.4</b> The complete model and implementation in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-hair-eye-go-again"><i class="fa fa-check"></i><b>24.2</b> Example: Hair eye go again</a></li>
<li class="chapter" data-level="24.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-interaction-contrasts-shrinkage-and-omnibus-test"><i class="fa fa-check"></i><b>24.3</b> Example: Interaction contrasts, shrinkage, and omnibus test</a></li>
<li class="chapter" data-level="24.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#log-linear-models-for-contingency-tables-bonus-alternative-parameterization"><i class="fa fa-check"></i><b>24.4</b> <del>Log-linear models for contingency tables</del> Bonus: Alternative parameterization</a></li>
<li class="chapter" data-level="" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#session-info-23"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html"><i class="fa fa-check"></i><b>25</b> Tools in the Trunk</a>
<ul>
<li class="chapter" data-level="25.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reporting-a-bayesian-analysis"><i class="fa fa-check"></i><b>25.1</b> Reporting a Bayesian analysis</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#essential-points."><i class="fa fa-check"></i><b>25.1.1</b> Essential points.</a></li>
<li class="chapter" data-level="25.1.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#optional-points."><i class="fa fa-check"></i><b>25.1.2</b> Optional points.</a></li>
<li class="chapter" data-level="25.1.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#helpful-points."><i class="fa fa-check"></i><b>25.1.3</b> Helpful points.</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#functions-for-computing-highest-density-intervals"><i class="fa fa-check"></i><b>25.2</b> Functions for computing highest density intervals</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-grid-approximation."><i class="fa fa-check"></i><b>25.2.1</b> R code for computing HDI of a grid approximation.</a></li>
<li class="chapter" data-level="25.2.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#hdi-of-unimodal-distribution-is-shortest-interval."><i class="fa fa-check"></i><b>25.2.2</b> HDI of unimodal distribution is shortest interval.</a></li>
<li class="chapter" data-level="25.2.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-mcmc-sample."><i class="fa fa-check"></i><b>25.2.3</b> R code for computing HDI of a MCMC sample.</a></li>
<li class="chapter" data-level="25.2.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-function."><i class="fa fa-check"></i><b>25.2.4</b> R code for computing HDI of a function.</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reparameterization"><i class="fa fa-check"></i><b>25.3</b> Reparameterization</a></li>
<li class="chapter" data-level="25.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#censored-data-in-jags-brms"><i class="fa fa-check"></i><b>25.4</b> Censored data in <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="25.4.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#right-censoring-when-youre-uncertain-beyond-a-single-threshold."><i class="fa fa-check"></i><b>25.4.1</b> Right censoring: When you’re uncertain beyond a single threshold.</a></li>
<li class="chapter" data-level="25.4.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#interval-censoring-when-your-values-are-somewhere-in-the-middle."><i class="fa fa-check"></i><b>25.4.2</b> Interval censoring: When your values are somewhere in the middle.</a></li>
<li class="chapter" data-level="25.4.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#complex-censoring-when-the-going-gets-tough"><i class="fa fa-check"></i><b>25.4.3</b> Complex censoring: When the going gets tough…</a></li>
<li class="chapter" data-level="25.4.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#bonus-truncation."><i class="fa fa-check"></i><b>25.4.4</b> Bonus: Truncation.</a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#what-next"><i class="fa fa-check"></i><b>25.5</b> What Next?</a></li>
<li class="chapter" data-level="" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#session-info-24"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Doing Bayesian Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="metric-predicted-variable-with-one-metric-predictor" class="section level1 hasAnchor" number="17">
<h1><span class="header-section-number">17</span> Metric Predicted Variable with One Metric Predictor<a href="metric-predicted-variable-with-one-metric-predictor.html#metric-predicted-variable-with-one-metric-predictor" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>We will initially describe the relationship between the predicted variable, <span class="math inline">\(y\)</span> and predictor, <span class="math inline">\(x\)</span>, with a simple linear model and normally distributed residual randomness in <span class="math inline">\(y\)</span>. This model is often referred to as ‘simple linear regression.’ We will generalize the model in three ways. First, we will give it a noise distribution that accommodates outliers, which is to say that we will replace the normal distribution with a <span class="math inline">\(t\)</span> distribution as we did in the previous chapter. The model will be implemented in [<strong>brms</strong>]. Next, we will consider differently shaped relations between the predictor and the predicted, such as quadratic trend. Finally, we will consider hierarchical models of situations in which every individual has data that can be described by an individual trend, and we also want to estimate group-level typical trends across individuals. <span class="citation">(<a href="#ref-kruschkeDoingBayesianData2015" role="doc-biblioref">Kruschke, 2015, p. 478</a>)</span></p>
</blockquote>
<div id="simple-linear-regression" class="section level2 hasAnchor" number="17.1">
<h2><span class="header-section-number">17.1</span> Simple linear regression<a href="metric-predicted-variable-with-one-metric-predictor.html#simple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It wasn’t entirely clear how Kruschke simulated the bimodal data on the right panel of Figure 17.1. I figured an even split of two Gaussians would suffice and just sighted their <span class="math inline">\(\mu\)</span>’s and <span class="math inline">\(\sigma\)</span>’s.</p>
<div class="sourceCode" id="cb1551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1551-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1551-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1551-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1551-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1551-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1551-3" aria-hidden="true" tabindex="-1"></a><span class="co"># how many draws per panel would you like?</span></span>
<span id="cb1551-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1551-4" aria-hidden="true" tabindex="-1"></a>n_draw <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1551-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1551-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1551-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1551-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">17</span>)</span>
<span id="cb1551-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1551-7" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb1551-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1551-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">panel =</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> n_draw),</span>
<span id="cb1551-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1551-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="fu">c</span>(<span class="fu">runif</span>(<span class="at">n =</span> n_draw, <span class="at">min =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">max =</span> <span class="dv">10</span>),</span>
<span id="cb1551-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1551-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">rnorm</span>(<span class="at">n =</span> n_draw <span class="sc">/</span> <span class="dv">2</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">7</span>, <span class="at">sd =</span> <span class="dv">2</span>),</span>
<span id="cb1551-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1551-11" aria-hidden="true" tabindex="-1"></a>               <span class="fu">rnorm</span>(<span class="at">n =</span> n_draw <span class="sc">/</span> <span class="dv">2</span>, <span class="at">mean =</span>  <span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">2</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1551-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1551-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">2</span>))</span>
<span id="cb1551-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1551-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1551-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1551-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   panel      x     y
##   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1 a     -6.90  -4.09
## 2 a      9.37  28.6 
## 3 a     -0.635 11.8 
## 4 a      5.54  23.3 
## 5 a     -1.84  10.9 
## 6 a      0.776 10.9</code></pre>
<p>In case you missed it, Kruschke defied the formula for these data in Figure 17.1. It is</p>
<p><span class="math display">\[\begin{align*}
y_i &amp; \sim \operatorname{Normal}(\mu_i, \sigma = 2), \text{where} \\
\mu_i &amp; = 10 + 2 x_i.
\end{align*}\]</span></p>
<p>“Note that the model only specifies the dependency of <span class="math inline">\(y\)</span> on <span class="math inline">\(x\)</span>. The model does not say anything about what generates <span class="math inline">\(x\)</span>, and there is no probability distribution assumed for describing <span class="math inline">\(x\)</span>” (p. 479). Let this sink into your soul. It took a long time, for me. E.g., a lot of people fret over the distributions of their <span class="math inline">\(x\)</span> variables. Now one might should examine them to make sure nothing looks off, such as for data coding mistakes. But if they’re not perfectly or even approximately Gaussian, that isn’t necessarily an issue. The typical linear model makes no presumption about the distribution of the predictors. Often times, the largest issue is whether the <span class="math inline">\(x\)</span> variables are categorical or continuous.</p>
<p>Before we make our Figure 17.1, we’ll want to make a separate tibble of the values necessary to plot those sideways Gaussians. Here are the steps.</p>
<div class="sourceCode" id="cb1553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1553-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-1" aria-hidden="true" tabindex="-1"></a>curves <span class="ot">&lt;-</span></span>
<span id="cb1553-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define the 3 x-values we want the Gaussians to originate from</span></span>
<span id="cb1553-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="fl">7.5</span>, <span class="at">to =</span> <span class="fl">7.5</span>, <span class="at">length.out =</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1553-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1553-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use the formula 10 + 2x to compute the expected y-value for x</span></span>
<span id="cb1553-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y_mean =</span> <span class="dv">10</span> <span class="sc">+</span> (<span class="dv">2</span> <span class="sc">*</span> x)) <span class="sc">%&gt;%</span></span>
<span id="cb1553-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1553-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># based on a Gaussian with `mean = y_mean` and `sd = 2`, compute the 99% intervals</span></span>
<span id="cb1553-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ll =</span> <span class="fu">qnorm</span>(.<span class="dv">005</span>, <span class="at">mean =</span> y_mean, <span class="at">sd =</span> <span class="dv">2</span>),</span>
<span id="cb1553-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">ul =</span> <span class="fu">qnorm</span>(.<span class="dv">995</span>, <span class="at">mean =</span> y_mean, <span class="at">sd =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1553-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1553-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># now use those interval bounds to make a sequence of y-values</span></span>
<span id="cb1553-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">map2</span>(ll, ul, seq, <span class="at">length.out =</span> <span class="dv">100</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1553-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1553-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># since that operation returned a nested column, we need to `unnest()`</span></span>
<span id="cb1553-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(y) <span class="sc">%&gt;%</span></span>
<span id="cb1553-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1553-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute the density values</span></span>
<span id="cb1553-19"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">map2_dbl</span>(y, y_mean, dnorm, <span class="at">sd =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1553-20"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1553-21"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># now rescale the density values to be wider.</span></span>
<span id="cb1553-22"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># since we want these to be our x-values, we&#39;ll </span></span>
<span id="cb1553-23"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># just redefine the x column with these results</span></span>
<span id="cb1553-24"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> x <span class="sc">-</span> density <span class="sc">*</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">max</span>(density))</span>
<span id="cb1553-25"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1553-26"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1553-26" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(curves)</span></code></pre></div>
<pre><code>## tibble [400 × 6] (S3: tbl_df/tbl/data.frame)
##  $ x      : num [1:400] -7.57 -7.58 -7.59 -7.61 -7.62 ...
##  $ y_mean : num [1:400] -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 ...
##  $ ll     : num [1:400] -10.2 -10.2 -10.2 -10.2 -10.2 ...
##  $ ul     : num [1:400] 0.152 0.152 0.152 0.152 0.152 ...
##  $ y      : num [1:400] -10.15 -10.05 -9.94 -9.84 -9.74 ...
##  $ density: num [1:400] 0.00723 0.00826 0.0094 0.01068 0.01209 ...</code></pre>
<p>Before we make Figure 17.1, let’s talk color. Like last chapter, we’ll take our color palette from the <strong>beyonce</strong> package. Our palette will be a nine-point version of #41.</p>
<div class="sourceCode" id="cb1555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1555-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1555-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(beyonce)</span>
<span id="cb1555-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1555-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1555-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1555-3" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">beyonce_palette</span>(<span class="dv">41</span>, <span class="at">n =</span> <span class="dv">9</span>, <span class="at">type =</span> <span class="st">&quot;continuous&quot;</span>)</span>
<span id="cb1555-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1555-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1555-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1555-5" aria-hidden="true" tabindex="-1"></a>bp</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-4-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>The global theme will be <code>ggplot2::theme_linedraw()</code> with the grid lines removed. Make Figure 17.1.</p>
<div class="sourceCode" id="cb1556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1556-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-1" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(</span>
<span id="cb1556-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb1556-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb1556-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1556-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1556-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-6" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb1556-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb1556-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> bp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1556-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> bp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1556-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">color =</span> bp[<span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb1556-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">fullrange =</span> T, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1556-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> curves,</span>
<span id="cb1556-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">group =</span> y_mean),</span>
<span id="cb1556-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> bp[<span class="dv">2</span>], <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1556-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Normal PDF around Linear Function&quot;</span>,</span>
<span id="cb1556-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;We simulated x from a uniform distribution in the left panel and simulated it from a mixture of</span><span class="sc">\n</span><span class="st"> two Gaussians on the right.&quot;</span>) <span class="sc">+</span></span>
<span id="cb1556-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>),</span>
<span id="cb1556-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb1556-19"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1556-20"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb1556-21"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1556-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> panel)</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.</code></pre>
<p><img src="17_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Concerning causality,</p>
<blockquote>
<p><em>the simple linear model makes no claims about causal connections between</em> <span class="math inline">\(x\)</span> <em>and</em> <span class="math inline">\(y\)</span>. <em>The simple linear model merely describes a tendency for</em> <span class="math inline">\(y\)</span> <em>values to be linearly related to</em> <span class="math inline">\(x\)</span> <em>values</em>, hence “predictable” from the <span class="math inline">\(x\)</span> values. When describing data with this model, we are starting with a scatter plot of points generated by an unknown process in the real world, and estimating parameter values that would produce a smattering of points that might mimic the real data. Even if the descriptive model mimics the data well (and it might not), the mathematical “process” in the model may have little if anything to do with the real-world process that created the data. Nevertheless, the parameters in the descriptive model are meaningful because they describe tendencies in the data. (p. 479, <em>emphasis</em> added)</p>
</blockquote>
<p>I emphasized these points because I’ve heard and seen a lot of academics conflate linear regression models with causal models. For sure, it might well be preferable if your regression model was also a causal model. But good old prediction is fine, too.</p>
</div>
<div id="robust-linear-regression" class="section level2 hasAnchor" number="17.2">
<h2><span class="header-section-number">17.2</span> Robust linear regression<a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>There is no requirement to use a normal distribution for the noise distribution. The normal distribution is traditional because of its relative simplicity in mathematical derivations. But real data may have outliers, and the use of (optionally) heavy-tailed noise distributions is straight forward in contemporary Bayesian software[, like <strong>brms</strong>]. (pp. 479–480)</p>
</blockquote>
<p>Let’s make our version of the model diagram in Figure 17.2 to get a sense of where we’re going.</p>
<div class="sourceCode" id="cb1558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1558-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1558-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1558-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-3" aria-hidden="true" tabindex="-1"></a><span class="co"># normal density</span></span>
<span id="cb1558-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1558-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1558-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1558-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1558-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1558-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1558-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1558-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1558-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1558-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1558-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;italic(M)[0]&quot;</span>, <span class="st">&quot;italic(S)[0]&quot;</span>), </span>
<span id="cb1558-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1558-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1558-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1558-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1558-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span></code></pre></div>
<pre><code>## Warning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.
## ℹ Please use the `linewidth` argument instead.</code></pre>
<div class="sourceCode" id="cb1560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1560-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a second normal density</span></span>
<span id="cb1560-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1560-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1560-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1560-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1560-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1560-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1560-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1560-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1560-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1560-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1560-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;italic(M)[1]&quot;</span>, <span class="st">&quot;italic(S)[1]&quot;</span>), </span>
<span id="cb1560-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1560-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1560-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1560-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb1560-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1560-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-18" aria-hidden="true" tabindex="-1"></a><span class="do">## two annotated arrows</span></span>
<span id="cb1560-19"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-19" aria-hidden="true" tabindex="-1"></a><span class="co"># save our custom arrow settings</span></span>
<span id="cb1560-20"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-20" aria-hidden="true" tabindex="-1"></a>my_arrow <span class="ot">&lt;-</span> <span class="fu">arrow</span>(<span class="at">angle =</span> <span class="dv">20</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.35</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">type =</span> <span class="st">&quot;closed&quot;</span>)</span>
<span id="cb1560-21"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-21" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb1560-22"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">33</span>, <span class="fl">1.67</span>),</span>
<span id="cb1560-23"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1560-24"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">75</span>, <span class="fl">1.1</span>),</span>
<span id="cb1560-25"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1560-26"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1560-27"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb1560-28"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1560-29"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1560-30"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1560-31"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">4</span>, <span class="fl">1.25</span>), <span class="at">y =</span> .<span class="dv">5</span>,</span>
<span id="cb1560-32"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;&#39;~&#39;&quot;</span>,</span>
<span id="cb1560-33"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1560-34"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1560-35"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1560-36"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1560-37"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-37" aria-hidden="true" tabindex="-1"></a><span class="co"># exponential density</span></span>
<span id="cb1560-38"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-38" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb1560-39"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1560-40"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dexp</span>(x, <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dexp</span>(x, <span class="dv">2</span>))))) <span class="sc">+</span></span>
<span id="cb1560-41"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1560-42"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1560-43"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1560-44"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;exp&quot;</span>,</span>
<span id="cb1560-45"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1560-46"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1560-47"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-47" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1560-48"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-48" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;italic(K)&quot;</span>,</span>
<span id="cb1560-49"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-49" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1560-50"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1560-51"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1560-52"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb1560-53"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1560-54"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-54" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood formula</span></span>
<span id="cb1560-55"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-55" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span></span>
<span id="cb1560-56"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> .<span class="dv">5</span>,</span>
<span id="cb1560-57"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-57" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb1560-58"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-58" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;beta[0]+beta[1]*italic(x)[italic(i)]&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1560-59"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1560-60"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1560-61"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1560-62"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1560-63"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1560-64"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1560-65"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1560-66"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-66" aria-hidden="true" tabindex="-1"></a><span class="co"># half-normal density</span></span>
<span id="cb1560-67"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-67" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span></span>
<span id="cb1560-68"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1560-69"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1560-70"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1560-71"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1560-72"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-72" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1560-73"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-73" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;half-normal&quot;</span>,</span>
<span id="cb1560-74"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-74" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1560-75"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1560-76"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-76" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1560-77"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-77" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;0*&#39;,&#39;*~italic(S)[sigma]&quot;</span>, </span>
<span id="cb1560-78"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-78" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1560-79"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1560-80"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1560-81"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb1560-82"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1560-83"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-83" aria-hidden="true" tabindex="-1"></a><span class="co"># four annotated arrows</span></span>
<span id="cb1560-84"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-84" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span></span>
<span id="cb1560-85"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">43</span>, .<span class="dv">43</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>),</span>
<span id="cb1560-86"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-86" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">55</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1560-87"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-87" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">43</span>, <span class="fl">1.225</span>, <span class="fl">1.5</span>, <span class="fl">1.75</span>),</span>
<span id="cb1560-88"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-88" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="fu">c</span>(.<span class="dv">8</span>, .<span class="dv">15</span>, .<span class="dv">2</span>, .<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1560-89"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1560-90"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb1560-91"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-91" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1560-92"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1560-93"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1560-94"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-94" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">3</span>, .<span class="dv">7</span>, <span class="fl">1.38</span>, <span class="dv">2</span>), <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">92</span>, .<span class="dv">22</span>, .<span class="dv">65</span>, .<span class="dv">6</span>),</span>
<span id="cb1560-95"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-95" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;&#39;=&#39;&quot;</span>, <span class="st">&quot;&#39;=&#39;&quot;</span>, <span class="st">&quot;&#39;~&#39;&quot;</span>),</span>
<span id="cb1560-96"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-96" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb1560-97"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-97" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1560-98"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1560-99"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-99" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">43</span>, <span class="at">y =</span> .<span class="dv">7</span>,</span>
<span id="cb1560-100"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-100" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;nu*minute+1&quot;</span>,</span>
<span id="cb1560-101"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-101" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1560-102"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1560-103"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1560-104"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1560-105"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-105" aria-hidden="true" tabindex="-1"></a><span class="co"># student-t density</span></span>
<span id="cb1560-106"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-106" aria-hidden="true" tabindex="-1"></a>p8 <span class="ot">&lt;-</span></span>
<span id="cb1560-107"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1560-108"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dt</span>(x, <span class="dv">3</span>) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dt</span>(x, <span class="dv">3</span>))))) <span class="sc">+</span></span>
<span id="cb1560-109"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1560-110"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1560-111"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-111" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1560-112"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-112" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;student t&quot;</span>,</span>
<span id="cb1560-113"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-113" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1560-114"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1560-115"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-115" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1560-116"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-116" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;nu~~~mu[italic(i)]~~~sigma&quot;</span>,</span>
<span id="cb1560-117"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-117" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1560-118"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1560-119"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1560-120"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb1560-121"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1560-122"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-122" aria-hidden="true" tabindex="-1"></a><span class="co"># the final annotated arrow</span></span>
<span id="cb1560-123"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-123" aria-hidden="true" tabindex="-1"></a>p9 <span class="ot">&lt;-</span></span>
<span id="cb1560-124"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="fu">c</span>(.<span class="dv">375</span>, .<span class="dv">625</span>),</span>
<span id="cb1560-125"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-125" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb1560-126"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-126" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(i)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1560-127"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-127" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1560-128"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1560-129"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>), <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1560-130"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">5</span>, <span class="at">xend =</span> .<span class="dv">5</span>,</span>
<span id="cb1560-131"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-131" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> <span class="dv">0</span>, </span>
<span id="cb1560-132"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-132" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">arrow =</span> my_arrow) <span class="sc">+</span></span>
<span id="cb1560-133"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1560-134"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1560-135"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1560-136"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-136" aria-hidden="true" tabindex="-1"></a><span class="co"># some text</span></span>
<span id="cb1560-137"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-137" aria-hidden="true" tabindex="-1"></a>p10 <span class="ot">&lt;-</span></span>
<span id="cb1560-138"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">5</span>,</span>
<span id="cb1560-139"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-139" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> .<span class="dv">5</span>,</span>
<span id="cb1560-140"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-140" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;italic(y[i])&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1560-141"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-141" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1560-142"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1560-143"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1560-144"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1560-145"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1560-146"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1560-147"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-147" aria-hidden="true" tabindex="-1"></a><span class="co"># define the layout</span></span>
<span id="cb1560-148"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-148" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1560-149"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">3</span>, <span class="at">r =</span> <span class="dv">5</span>),</span>
<span id="cb1560-150"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb1560-151"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">4</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">3</span>),</span>
<span id="cb1560-152"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">4</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1560-153"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">4</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">9</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb1560-154"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">3</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb1560-155"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">7</span>, <span class="at">b =</span> <span class="dv">8</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1560-156"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">6</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb1560-157"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">9</span>, <span class="at">b =</span> <span class="dv">9</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1560-158"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>)</span>
<span id="cb1560-159"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-159" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1560-160"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1560-161"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-161" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot!</span></span>
<span id="cb1560-162"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-162" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2 <span class="sc">+</span> p4 <span class="sc">+</span> p5 <span class="sc">+</span> p6 <span class="sc">+</span> p3 <span class="sc">+</span> p8 <span class="sc">+</span> p7 <span class="sc">+</span> p9 <span class="sc">+</span> p10) <span class="sc">+</span> </span>
<span id="cb1560-163"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout) <span class="sc">&amp;</span></span>
<span id="cb1560-164"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb1560-165"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1560-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>, <span class="fl">5.5</span>))</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-6-1.png" width="648" style="display: block; margin: auto;" /></p>
<p>Here’s Kruschke’s <code>HtWtDataGenerator()</code> code.</p>
<div class="sourceCode" id="cb1561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1561-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-1" aria-hidden="true" tabindex="-1"></a>HtWtDataGenerator <span class="ot">&lt;-</span> <span class="cf">function</span>(nSubj, <span class="at">rndsd =</span> <span class="cn">NULL</span>, <span class="at">maleProb =</span> <span class="fl">0.50</span>) {</span>
<span id="cb1561-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Random height, weight generator for males and females. Uses parameters from</span></span>
<span id="cb1561-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Brainard, J. &amp; Burmaster, D. E. (1992). Bivariate distributions for height and</span></span>
<span id="cb1561-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># weight of men and women in the United States. Risk Analysis, 12(2), 267-275.</span></span>
<span id="cb1561-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Kruschke, J. K. (2011). Doing Bayesian data analysis:</span></span>
<span id="cb1561-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># A Tutorial with R and BUGS. Academic Press / Elsevier.</span></span>
<span id="cb1561-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Kruschke, J. K. (2014). Doing Bayesian data analysis, 2nd Edition:</span></span>
<span id="cb1561-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># A Tutorial with R, JAGS and Stan. Academic Press / Elsevier.</span></span>
<span id="cb1561-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1561-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># require(MASS)</span></span>
<span id="cb1561-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1561-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Specify parameters of multivariate normal (MVN) distributions.</span></span>
<span id="cb1561-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Men:</span></span>
<span id="cb1561-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-14" aria-hidden="true" tabindex="-1"></a>  HtMmu   <span class="ot">&lt;-</span> <span class="fl">69.18</span></span>
<span id="cb1561-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-15" aria-hidden="true" tabindex="-1"></a>  HtMsd   <span class="ot">&lt;-</span> <span class="fl">2.87</span></span>
<span id="cb1561-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-16" aria-hidden="true" tabindex="-1"></a>  lnWtMmu <span class="ot">&lt;-</span> <span class="fl">5.14</span></span>
<span id="cb1561-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-17" aria-hidden="true" tabindex="-1"></a>  lnWtMsd <span class="ot">&lt;-</span> <span class="fl">0.17</span></span>
<span id="cb1561-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-18" aria-hidden="true" tabindex="-1"></a>  Mrho    <span class="ot">&lt;-</span> <span class="fl">0.42</span></span>
<span id="cb1561-19"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-19" aria-hidden="true" tabindex="-1"></a>  Mmean   <span class="ot">&lt;-</span> <span class="fu">c</span>(HtMmu, lnWtMmu)</span>
<span id="cb1561-20"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-20" aria-hidden="true" tabindex="-1"></a>  Msigma  <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(HtMsd<span class="sc">^</span><span class="dv">2</span>, Mrho <span class="sc">*</span> HtMsd <span class="sc">*</span> lnWtMsd,</span>
<span id="cb1561-21"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-21" aria-hidden="true" tabindex="-1"></a>                      Mrho <span class="sc">*</span> HtMsd <span class="sc">*</span> lnWtMsd, lnWtMsd<span class="sc">^</span><span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb1561-22"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Women cluster 1:</span></span>
<span id="cb1561-23"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-23" aria-hidden="true" tabindex="-1"></a>  HtFmu1   <span class="ot">&lt;-</span> <span class="fl">63.11</span></span>
<span id="cb1561-24"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-24" aria-hidden="true" tabindex="-1"></a>  HtFsd1   <span class="ot">&lt;-</span> <span class="fl">2.76</span></span>
<span id="cb1561-25"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-25" aria-hidden="true" tabindex="-1"></a>  lnWtFmu1 <span class="ot">&lt;-</span> <span class="fl">5.06</span></span>
<span id="cb1561-26"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-26" aria-hidden="true" tabindex="-1"></a>  lnWtFsd1 <span class="ot">&lt;-</span> <span class="fl">0.24</span></span>
<span id="cb1561-27"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-27" aria-hidden="true" tabindex="-1"></a>  Frho1    <span class="ot">&lt;-</span> <span class="fl">0.41</span></span>
<span id="cb1561-28"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-28" aria-hidden="true" tabindex="-1"></a>  prop1    <span class="ot">&lt;-</span> <span class="fl">0.46</span></span>
<span id="cb1561-29"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-29" aria-hidden="true" tabindex="-1"></a>  Fmean1   <span class="ot">&lt;-</span> <span class="fu">c</span>(HtFmu1, lnWtFmu1)</span>
<span id="cb1561-30"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-30" aria-hidden="true" tabindex="-1"></a>  Fsigma1  <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(HtFsd1<span class="sc">^</span><span class="dv">2</span>, Frho1 <span class="sc">*</span> HtFsd1 <span class="sc">*</span> lnWtFsd1,</span>
<span id="cb1561-31"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-31" aria-hidden="true" tabindex="-1"></a>                       Frho1 <span class="sc">*</span> HtFsd1 <span class="sc">*</span> lnWtFsd1, lnWtFsd1<span class="sc">^</span><span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb1561-32"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Women cluster 2:</span></span>
<span id="cb1561-33"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-33" aria-hidden="true" tabindex="-1"></a>  HtFmu2   <span class="ot">&lt;-</span> <span class="fl">64.36</span></span>
<span id="cb1561-34"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-34" aria-hidden="true" tabindex="-1"></a>  HtFsd2   <span class="ot">&lt;-</span> <span class="fl">2.49</span></span>
<span id="cb1561-35"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-35" aria-hidden="true" tabindex="-1"></a>  lnWtFmu2 <span class="ot">&lt;-</span> <span class="fl">4.86</span></span>
<span id="cb1561-36"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-36" aria-hidden="true" tabindex="-1"></a>  lnWtFsd2 <span class="ot">&lt;-</span> <span class="fl">0.14</span></span>
<span id="cb1561-37"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-37" aria-hidden="true" tabindex="-1"></a>  Frho2    <span class="ot">&lt;-</span> <span class="fl">0.44</span></span>
<span id="cb1561-38"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-38" aria-hidden="true" tabindex="-1"></a>  prop2    <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> prop1</span>
<span id="cb1561-39"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-39" aria-hidden="true" tabindex="-1"></a>  Fmean2   <span class="ot">&lt;-</span> <span class="fu">c</span>(HtFmu2, lnWtFmu2)</span>
<span id="cb1561-40"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-40" aria-hidden="true" tabindex="-1"></a>  Fsigma2  <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(HtFsd2<span class="sc">^</span><span class="dv">2</span>, Frho2 <span class="sc">*</span> HtFsd2 <span class="sc">*</span> lnWtFsd2,</span>
<span id="cb1561-41"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-41" aria-hidden="true" tabindex="-1"></a>                       Frho2 <span class="sc">*</span> HtFsd2 <span class="sc">*</span> lnWtFsd2, lnWtFsd2<span class="sc">^</span><span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb1561-42"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1561-43"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Randomly generate data values from those MVN distributions.</span></span>
<span id="cb1561-44"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-44" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(rndsd)) {<span class="fu">set.seed</span>(rndsd)}</span>
<span id="cb1561-45"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-45" aria-hidden="true" tabindex="-1"></a>  datamatrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> nSubj, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb1561-46"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(datamatrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;height&quot;</span>, <span class="st">&quot;weight&quot;</span>)</span>
<span id="cb1561-47"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-47" aria-hidden="true" tabindex="-1"></a>  maleval <span class="ot">&lt;-</span> <span class="dv">1</span>; femaleval <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># arbitrary coding values</span></span>
<span id="cb1561-48"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-48" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nSubj)  {</span>
<span id="cb1561-49"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip coin to decide sex</span></span>
<span id="cb1561-50"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-50" aria-hidden="true" tabindex="-1"></a>    sex <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(maleval, femaleval), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1561-51"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-51" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prob =</span> <span class="fu">c</span>(maleProb, <span class="dv">1</span> <span class="sc">-</span> maleProb))</span>
<span id="cb1561-52"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (sex <span class="sc">==</span> maleval) {datum <span class="ot">=</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">mu =</span> Mmean, <span class="at">Sigma =</span> Msigma)}</span>
<span id="cb1561-53"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (sex <span class="sc">==</span> femaleval) {</span>
<span id="cb1561-54"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-54" aria-hidden="true" tabindex="-1"></a>      Fclust <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(prop1, prop2))</span>
<span id="cb1561-55"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-55" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (Fclust <span class="sc">==</span> <span class="dv">1</span>) {datum <span class="ot">=</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">mu =</span> Fmean1, <span class="at">Sigma =</span> Fsigma1)}</span>
<span id="cb1561-56"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-56" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (Fclust <span class="sc">==</span> <span class="dv">2</span>) {datum <span class="ot">=</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">mu =</span> Fmean2, <span class="at">Sigma =</span> Fsigma2)}</span>
<span id="cb1561-57"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-57" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1561-58"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-58" aria-hidden="true" tabindex="-1"></a>    datamatrix[i, ] <span class="ot">=</span> <span class="fu">c</span>(sex, <span class="fu">round</span>(<span class="fu">c</span>(datum[<span class="dv">1</span>], <span class="fu">exp</span>(datum[<span class="dv">2</span>])), <span class="dv">1</span>))</span>
<span id="cb1561-59"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-59" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1561-60"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1561-61"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(datamatrix)</span>
<span id="cb1561-62"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1561-62" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s take this baby for a spin to simulate our data.</p>
<div class="sourceCode" id="cb1562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1562-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1562-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> </span>
<span id="cb1562-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1562-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">HtWtDataGenerator</span>(<span class="at">nSubj =</span> <span class="dv">300</span>, <span class="at">rndsd =</span> <span class="dv">17</span>, <span class="at">maleProb =</span> .<span class="dv">50</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1562-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1562-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1562-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1562-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this will allow us to subset 30 of the values into their own group</span></span>
<span id="cb1562-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1562-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">subset =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> <span class="fu">rep</span>(., <span class="dv">30</span>))</span>
<span id="cb1562-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1562-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1562-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1562-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##    male height weight subset
##   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;int&gt;
## 1     0   63.3   167.      0
## 2     0   62.4   126.      0
## 3     1   66.4   124       0
## 4     0   62.9   148.      0
## 5     1   65.5   151.      0
## 6     1   71.4   234.      0</code></pre>
<p>Note how we set the seed for the the pseudorandom number generator with the <code>rndsd</code> argument, which makes the results in this ebook reproducible. But since we do not know what seed value Kruschke used to simulate the data in this section of the test, the results of our models in the next section will differ a little from those in the text. However, if you want to more closely reproduce Kruschke’s examples, load the <code>HtWtData30.csv</code> and <code>HtWtData300.csv</code> data files and fit the models to those, instead.</p>
<p>Anyway,</p>
<blockquote>
<p>fortunately, we do not have to worry much about analytical derivations because we can let JAGS or Stan generate a high resolution picture of the posterior distribution. Our job, therefore, is to specify sensible priors and to make sure that the MCMC process generates a trustworthy posterior sample that is converged and well mixed. (p. 483)</p>
</blockquote>
<div id="robust-linear-regression-in-jags-brms." class="section level3 hasAnchor" number="17.2.1">
<h3><span class="header-section-number">17.2.1</span> Robust linear regression in <del>JAGS</del> brms.<a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-jags-brms." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Presuming a data set with a sole standardized predictor <code>x_z</code> for a sole standardized criterion <code>y_z</code>, the basic <strong>brms</strong> code corresponding to the JAGS code Kruschke showed on page 483 looks like this.</p>
<div class="sourceCode" id="cb1564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1564-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1564-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span></span>
<span id="cb1564-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1564-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1564-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1564-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> student,</span>
<span id="cb1564-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1564-4" aria-hidden="true" tabindex="-1"></a>      y_z <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x_z,</span>
<span id="cb1564-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1564-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1564-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1564-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> b),</span>
<span id="cb1564-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1564-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb1564-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1564-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(one_over_twentynine), <span class="at">class =</span> nu)),</span>
<span id="cb1564-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1564-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> <span class="fu">stanvar</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">29</span>, <span class="at">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>))</span></code></pre></div>
<p>Like we discussed in Chapter 16, we won’t be using the uniform prior for <span class="math inline">\(\sigma\)</span>. Since we’re presuming standardized data, a half-unit normal is a fine choice. But do note this is much tighter than Kruschke’s <span class="math inline">\(\operatorname{Uniform} (0.001, 1000)\)</span> and it will have down-the-road consequences for our results versus those in the text.</p>
<p>Also, look at how we just pumped the definition of our sole <code>stanvar(1/29, name = "one_over_twentynine")</code> operation right into the <code>stanvar</code> argument. If we were defining multiple values this way, I’d prefer to save this as an object first and then just pump that object into <code>stanvars</code>. But in this case, it was simple enough to just throw directly into the <code>brm()</code> function.</p>
<div id="standardizing-the-data-for-mcmc-sampling." class="section level4 hasAnchor" number="17.2.1.1">
<h4><span class="header-section-number">17.2.1.1</span> Standardizing the data for MCMC sampling.<a href="metric-predicted-variable-with-one-metric-predictor.html#standardizing-the-data-for-mcmc-sampling." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>“Standardizing simply means re-scaling the data relative to their mean and standard deviation” (p. 485). For any variable <span class="math inline">\(x\)</span>, that follows the formula</p>
<p><span class="math display">\[z_i = \frac{x_i - \bar x}{s},\]</span></p>
<p>where <span class="math inline">\(x_i\)</span> is the <span class="math inline">\(i\)</span>th row in the vector of <span class="math inline">\(x\)</span> values, <span class="math inline">\(\bar x\)</span> is the sample mean for <span class="math inline">\(x\)</span>, <span class="math inline">\(s\)</span> is the sample standard deviation for <span class="math inline">\(x\)</span>, and the product of the standardizing procedure is <span class="math inline">\(z_i\)</span> (i.e., the <span class="math inline">\(z\)</span>-score).</p>
<p>Kruschke mentioned how standardizing your data before feeding it into JAGS often helps the algorithm operate smoothly. The same basic principle holds for <strong>brms</strong> and Stan. Stan can often handle unstandardized data just fine. But if you ever run into estimation difficulties, consider standardizing your data and trying again.</p>
<p>We’ll make a simple function to standardize the <code>height</code> and <code>weight</code> values.</p>
<div class="sourceCode" id="cb1565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1565-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1565-1" aria-hidden="true" tabindex="-1"></a>standardize <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1565-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1565-2" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> <span class="fu">mean</span>(x)) <span class="sc">/</span> <span class="fu">sd</span>(x)</span>
<span id="cb1565-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1565-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1565-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1565-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1565-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1565-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb1565-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1565-6" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1565-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1565-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">height_z =</span> <span class="fu">standardize</span>(height),</span>
<span id="cb1565-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1565-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">weight_z =</span> <span class="fu">standardize</span>(weight))</span></code></pre></div>
<p>Somewhat analogous to how Kruschke standardized his data within the JAGS code, you could standardize the data within the <code>brm()</code> function. That would look something like this.</p>
<div class="sourceCode" id="cb1566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1566-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1566-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span></span>
<span id="cb1566-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1566-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d <span class="sc">%&gt;%</span>  <span class="co"># the standardizing occurs in the next two lines</span></span>
<span id="cb1566-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1566-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">height_z =</span> <span class="fu">standardize</span>(height),</span>
<span id="cb1566-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1566-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">weight_z =</span> <span class="fu">standardize</span>(weight)),</span>
<span id="cb1566-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1566-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> student,</span>
<span id="cb1566-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1566-6" aria-hidden="true" tabindex="-1"></a>      weight_z <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> height_z)</span></code></pre></div>
<p>But anyway, let’s open <strong>brms</strong>.</p>
<div class="sourceCode" id="cb1567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1567-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1567-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span></code></pre></div>
<p>We’ll fit the two models at once. <code>fit1</code> will be of the total data sample. <code>fit2</code> is of the <span class="math inline">\(n = 30\)</span> subset.</p>
<div class="sourceCode" id="cb1568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1568-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-1" aria-hidden="true" tabindex="-1"></a>fit17<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb1568-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d,</span>
<span id="cb1568-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> student,</span>
<span id="cb1568-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-4" aria-hidden="true" tabindex="-1"></a>      weight_z <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> height_z,</span>
<span id="cb1568-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1568-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> b),</span>
<span id="cb1568-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb1568-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(one_over_twentynine), <span class="at">class =</span> nu)),</span>
<span id="cb1568-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1568-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> <span class="fu">stanvar</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">29</span>, <span class="at">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>),</span>
<span id="cb1568-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">17</span>,</span>
<span id="cb1568-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit17.01&quot;</span>)</span>
<span id="cb1568-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1568-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-14" aria-hidden="true" tabindex="-1"></a>fit17<span class="fl">.2</span> <span class="ot">&lt;-</span></span>
<span id="cb1568-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(fit17<span class="fl">.1</span>,</span>
<span id="cb1568-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb1568-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-17" aria-hidden="true" tabindex="-1"></a>           <span class="fu">filter</span>(subset <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb1568-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1568-19"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">seed =</span> <span class="dv">17</span>,</span>
<span id="cb1568-20"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1568-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">file =</span> <span class="st">&quot;fits/fit17.02&quot;</span>)</span></code></pre></div>
<pre><code>## The desired updates require recompiling the model</code></pre>
<p>Here are the results.</p>
<div class="sourceCode" id="cb1570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1570-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1570-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit17<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##  Family: student 
##   Links: mu = identity; sigma = identity; nu = identity 
## Formula: weight_z ~ 1 + height_z 
##    Data: d (Number of observations: 300) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -0.03      0.05    -0.13     0.07 1.00     3465     2645
## height_z      0.46      0.05     0.35     0.56 1.00     3893     2697
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     0.84      0.05     0.74     0.94 1.00     2948     2733
## nu       25.01     20.46     6.11    83.28 1.00     2741     2778
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb1572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1572-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1572-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit17<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>##  Family: student 
##   Links: mu = identity; sigma = identity; nu = identity 
## Formula: weight_z ~ 1 + height_z 
##    Data: d %&gt;% filter(subset == 1) (Number of observations: 30) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -0.11      0.12    -0.35     0.12 1.00     4055     2855
## height_z      0.61      0.11     0.41     0.82 1.00     3790     2757
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     0.63      0.09     0.48     0.84 1.00     3610     2469
## nu       38.97     31.30     5.45   121.75 1.00     3781     2603
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Based on Kruschke’s Equation 17.2, we can convert the standardized coefficients back to their original metric using the formulas</p>
<p><span class="math display">\[\begin{align*}
\beta_0 &amp; = \zeta_0 \operatorname{SD}_y + M_y - \frac{\zeta_1 M_x \operatorname{SD}_y}{\operatorname{SD}_x} \;\; \text{and}  \\
\beta_1 &amp; = \frac{\zeta_1 \operatorname{SD}_y}{\operatorname{SD}_x},
\end{align*}\]</span></p>
<p>where <span class="math inline">\(\zeta_0\)</span> and <span class="math inline">\(\zeta_1\)</span> denote the intercept and slope for the model of the standardized data, respectively, and that model follows the familiar form</p>
<p><span class="math display">\[z_{\hat y} = \zeta_0 + \zeta_1 z_x.\]</span></p>
<p>To implement those equations, we’ll first extract the posterior draws. We begin with <code>fit17.1</code>, the model for which <span class="math inline">\(N = 300\)</span>.</p>
<div class="sourceCode" id="cb1574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1574-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1574-1" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit17<span class="fl">.1</span>)</span>
<span id="cb1574-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1574-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1574-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1574-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(draws)</span></code></pre></div>
<pre><code>## # A draws_df: 6 iterations, 1 chains, and 6 variables
##   b_Intercept b_height_z sigma   nu lprior lp__
## 1       0.033       0.46  0.77  5.1    -10 -405
## 2       0.091       0.47  0.73 10.8    -11 -408
## 3       0.154       0.41  0.81  6.3    -11 -411
## 4      -0.194       0.48  0.99 51.9    -12 -410
## 5      -0.143       0.48  1.00 40.0    -12 -408
## 6      -0.168       0.49  0.93 49.4    -12 -406
## # ... hidden reserved variables {&#39;.chain&#39;, &#39;.iteration&#39;, &#39;.draw&#39;}</code></pre>
<p>Let’s wrap the consequences of Equation 17.2 into two functions.</p>
<div class="sourceCode" id="cb1576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1576-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1576-1" aria-hidden="true" tabindex="-1"></a>make_beta_0 <span class="ot">&lt;-</span> <span class="cf">function</span>(zeta_0, zeta_1, sd_x, sd_y, m_x, m_y) {</span>
<span id="cb1576-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1576-2" aria-hidden="true" tabindex="-1"></a>  zeta_0 <span class="sc">*</span> sd_y <span class="sc">+</span> m_y <span class="sc">-</span> zeta_1 <span class="sc">*</span> m_x <span class="sc">*</span> sd_y <span class="sc">/</span> sd_x</span>
<span id="cb1576-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1576-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1576-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1576-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1576-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1576-5" aria-hidden="true" tabindex="-1"></a>make_beta_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(zeta_1, sd_x, sd_y) {</span>
<span id="cb1576-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1576-6" aria-hidden="true" tabindex="-1"></a>  zeta_1 <span class="sc">*</span> sd_y <span class="sc">/</span> sd_x</span>
<span id="cb1576-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1576-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>After saving a few values, we’re ready to use our custom functions to convert our posteriors for <code>b_Intercept</code> and <code>b_height_z</code> to their natural metric.</p>
<div class="sourceCode" id="cb1577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1577-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-1" aria-hidden="true" tabindex="-1"></a>sd_x <span class="ot">&lt;-</span> <span class="fu">sd</span>(d<span class="sc">$</span>height)</span>
<span id="cb1577-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-2" aria-hidden="true" tabindex="-1"></a>sd_y <span class="ot">&lt;-</span> <span class="fu">sd</span>(d<span class="sc">$</span>weight)</span>
<span id="cb1577-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-3" aria-hidden="true" tabindex="-1"></a>m_x  <span class="ot">&lt;-</span> <span class="fu">mean</span>(d<span class="sc">$</span>height)</span>
<span id="cb1577-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-4" aria-hidden="true" tabindex="-1"></a>m_y  <span class="ot">&lt;-</span> <span class="fu">mean</span>(d<span class="sc">$</span>weight)</span>
<span id="cb1577-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1577-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-6" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span></span>
<span id="cb1577-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-7" aria-hidden="true" tabindex="-1"></a>  draws <span class="sc">%&gt;%</span> </span>
<span id="cb1577-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">b_0 =</span> <span class="fu">make_beta_0</span>(<span class="at">zeta_0 =</span> b_Intercept,</span>
<span id="cb1577-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">zeta_1 =</span> b_height_z,</span>
<span id="cb1577-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_x   =</span> sd_x,</span>
<span id="cb1577-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_y   =</span> sd_y,</span>
<span id="cb1577-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">m_x    =</span> m_x,</span>
<span id="cb1577-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">m_y    =</span> m_y),</span>
<span id="cb1577-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">b_1 =</span> <span class="fu">make_beta_1</span>(<span class="at">zeta_1 =</span> b_height_z,</span>
<span id="cb1577-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_x   =</span> sd_x,</span>
<span id="cb1577-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_y   =</span> sd_y))</span>
<span id="cb1577-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1577-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1577-18" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(draws)</span></code></pre></div>
<pre><code>## Rows: 4,000
## Columns: 11
## $ b_Intercept &lt;dbl&gt; 0.033449878, 0.091239362, 0.154258692, -0.193823671, -0.142858016, -0.16759966…
## $ b_height_z  &lt;dbl&gt; 0.4630762, 0.4714897, 0.4064655, 0.4757892, 0.4848149, 0.4896576, 0.5275564, 0…
## $ sigma       &lt;dbl&gt; 0.7678310, 0.7267777, 0.8082075, 0.9882686, 1.0003481, 0.9328399, 0.9104863, 0…
## $ nu          &lt;dbl&gt; 5.109545, 10.798497, 6.279290, 51.899674, 39.956352, 49.405875, 55.019777, 10.…
## $ lprior      &lt;dbl&gt; -10.47370, -10.63927, -10.54572, -12.28095, -11.88108, -12.14174, -12.31494, -…
## $ lp__        &lt;dbl&gt; -404.6587, -407.6282, -410.7937, -409.9921, -408.3061, -406.4314, -408.0862, -…
## $ .chain      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ .iteration  &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,…
## $ .draw       &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,…
## $ b_0         &lt;dbl&gt; -123.86501, -127.08109, -84.63352, -139.58365, -143.41445, -147.26777, -171.38…
## $ b_1         &lt;dbl&gt; 4.297515, 4.375596, 3.772148, 4.415497, 4.499259, 4.544201, 4.895916, 3.510447…</code></pre>
<p>Now we’re finally ready to make the top panel of Figure 17.4.</p>
<div class="sourceCode" id="cb1579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1579-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1579-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many posterior lines would you like?</span></span>
<span id="cb1579-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1579-2" aria-hidden="true" tabindex="-1"></a>n_lines <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1579-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1579-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1579-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1579-4" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb1579-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1579-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight)) <span class="sc">+</span></span>
<span id="cb1579-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1579-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> draws <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span>n_lines),</span>
<span id="cb1579-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1579-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> b_0, <span class="at">slope =</span> b_1, <span class="at">group =</span> .draw),</span>
<span id="cb1579-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1579-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> bp[<span class="dv">2</span>], <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb1579-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1579-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">color =</span> bp[<span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb1579-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1579-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">eval</span>(<span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="st">&quot;Data with&quot;</span>, n_lines, <span class="st">&quot;credible regression lines&quot;</span>))),</span>
<span id="cb1579-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1579-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;height&quot;</span>,</span>
<span id="cb1579-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1579-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;weight&quot;</span>) <span class="sc">+</span></span>
<span id="cb1579-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1579-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">80</span>),</span>
<span id="cb1579-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1579-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">50</span>, <span class="dv">470</span>))</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-19-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>We’ll want to open the <strong>tidybayes</strong> package to help make the histograms.</p>
<div class="sourceCode" id="cb1580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1580-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb1580-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1580-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-3" aria-hidden="true" tabindex="-1"></a><span class="co"># we&#39;ll use this to mark off the ROPEs as white strips in the background</span></span>
<span id="cb1580-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-4" aria-hidden="true" tabindex="-1"></a>rope <span class="ot">&lt;-</span></span>
<span id="cb1580-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="st">&quot;Slope&quot;</span>, </span>
<span id="cb1580-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">xmin =</span> <span class="sc">-</span>.<span class="dv">5</span>,</span>
<span id="cb1580-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">xmax =</span> .<span class="dv">5</span>)</span>
<span id="cb1580-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1580-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-9" aria-hidden="true" tabindex="-1"></a><span class="co"># annotate the ROPE</span></span>
<span id="cb1580-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-10" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb1580-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="dv">0</span>,</span>
<span id="cb1580-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fl">0.98</span>,</span>
<span id="cb1580-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;ROPE&quot;</span>,</span>
<span id="cb1580-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">name  =</span> <span class="st">&quot;Slope&quot;</span>)</span>
<span id="cb1580-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1580-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-16" aria-hidden="true" tabindex="-1"></a><span class="co"># here are the primary data</span></span>
<span id="cb1580-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-17" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb1580-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">Intercept =</span> b_0,</span>
<span id="cb1580-19"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">Slope     =</span> b_1,</span>
<span id="cb1580-20"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">Scale     =</span> sigma <span class="sc">*</span> sd_y,</span>
<span id="cb1580-21"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">Normality =</span> nu <span class="sc">%&gt;%</span> <span class="fu">log10</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1580-22"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1580-23"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1580-24"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the plot</span></span>
<span id="cb1580-25"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1580-26"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> rope,</span>
<span id="cb1580-27"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax,</span>
<span id="cb1580-28"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>),</span>
<span id="cb1580-29"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">fill =</span> bp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1580-30"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_histinterval</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>), </span>
<span id="cb1580-31"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-31" aria-hidden="true" tabindex="-1"></a>                    <span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1580-32"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-32" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">slab_color =</span> bp[<span class="dv">5</span>],</span>
<span id="cb1580-33"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-33" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="sc">+</span></span>
<span id="cb1580-34"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb1580-35"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-35" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label),</span>
<span id="cb1580-36"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">2.75</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb1580-37"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1580-38"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1580-39"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1580-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-20-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Here’s the scatter plot for the slope and intercept.</p>
<div class="sourceCode" id="cb1581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1581-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1581-1" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb1581-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1581-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> b_1, <span class="at">y =</span> b_0)) <span class="sc">+</span></span>
<span id="cb1581-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1581-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> bp[<span class="dv">3</span>], <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1581-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1581-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(beta[<span class="dv">1</span>]),</span>
<span id="cb1581-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1581-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(beta[<span class="dv">0</span>]))</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-21-1.png" width="312" style="display: block; margin: auto;" /></p>
<p>That is one strong correlation! Finally, here’s the scatter plot for <span class="math inline">\(\operatorname{log10}(\nu)\)</span> and <span class="math inline">\(\sigma_{\text{transformed back to its raw metric}}\)</span>.</p>
<div class="sourceCode" id="cb1582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1582-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1582-1" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb1582-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1582-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">Scale     =</span> sigma <span class="sc">*</span> sd_y,</span>
<span id="cb1582-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1582-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">Normality =</span> nu <span class="sc">%&gt;%</span> <span class="fu">log10</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1582-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1582-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Normality, <span class="at">y =</span> Scale)) <span class="sc">+</span></span>
<span id="cb1582-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1582-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> bp[<span class="dv">3</span>], <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1582-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1582-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">log10</span>(nu)),</span>
<span id="cb1582-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1582-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(sigma))</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-22-1.png" width="312" style="display: block; margin: auto;" /></p>
<p>Let’s back track and make the plots for Figure 17.3 with <code>fit17.2</code>. We’ll need to extract the posterior draws and wrangle, as before.</p>
<div class="sourceCode" id="cb1583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1583-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1583-1" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit17<span class="fl">.2</span>)</span>
<span id="cb1583-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1583-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1583-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1583-3" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span></span>
<span id="cb1583-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1583-4" aria-hidden="true" tabindex="-1"></a>  draws <span class="sc">%&gt;%</span> </span>
<span id="cb1583-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1583-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">b_0 =</span> <span class="fu">make_beta_0</span>(<span class="at">zeta_0 =</span> b_Intercept,</span>
<span id="cb1583-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1583-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">zeta_1 =</span> b_height_z,</span>
<span id="cb1583-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1583-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_x   =</span> sd_x,</span>
<span id="cb1583-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1583-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_y   =</span> sd_y,</span>
<span id="cb1583-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1583-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">m_x    =</span> m_x,</span>
<span id="cb1583-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1583-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">m_y    =</span> m_y),</span>
<span id="cb1583-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1583-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">b_1 =</span> <span class="fu">make_beta_1</span>(<span class="at">zeta_1 =</span> b_height_z,</span>
<span id="cb1583-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1583-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_x   =</span> sd_x,</span>
<span id="cb1583-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1583-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_y   =</span> sd_y))</span>
<span id="cb1583-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1583-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1583-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1583-15" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(draws)</span></code></pre></div>
<pre><code>## Rows: 4,000
## Columns: 11
## $ b_Intercept &lt;dbl&gt; -0.1019127271, -0.1602236195, -0.2453014631, -0.0767535353, -0.1667942551, -0.…
## $ b_height_z  &lt;dbl&gt; 0.5989544, 0.6491469, 0.5190576, 0.5046634, 0.6864314, 0.7096647, 0.7160394, 0…
## $ sigma       &lt;dbl&gt; 0.7103285, 0.5990408, 0.6441226, 0.7320464, 0.4938717, 0.8033633, 0.8161114, 0…
## $ nu          &lt;dbl&gt; 42.477685, 45.532409, 56.704386, 27.973545, 31.975895, 29.216210, 15.016777, 7…
## $ lprior      &lt;dbl&gt; -11.72048, -11.75331, -12.16595, -11.23548, -11.22862, -11.33463, -10.85538, -…
## $ lp__        &lt;dbl&gt; -36.70185, -36.15062, -37.40014, -37.47648, -37.73622, -39.23489, -40.09140, -…
## $ .chain      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ .iteration  &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,…
## $ .draw       &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,…
## $ b_0         &lt;dbl&gt; -212.69271, -245.79182, -168.15852, -153.42572, -269.11056, -288.95231, -293.2…
## $ b_1         &lt;dbl&gt; 5.558515, 6.024319, 4.817043, 4.683460, 6.370333, 6.585946, 6.645106, 6.573859…</code></pre>
<p>Here’s the top panel of Figure 17.3.</p>
<div class="sourceCode" id="cb1585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1585-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1585-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many posterior lines would you like?</span></span>
<span id="cb1585-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1585-2" aria-hidden="true" tabindex="-1"></a>n_lines <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1585-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1585-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1585-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1585-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb1585-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1585-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(subset <span class="sc">==</span> <span class="dv">1</span>), </span>
<span id="cb1585-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1585-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight)) <span class="sc">+</span></span>
<span id="cb1585-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1585-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> bp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1585-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1585-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> draws <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span>n_lines),</span>
<span id="cb1585-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1585-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> b_0, <span class="at">slope =</span> b_1, <span class="at">group =</span> .draw),</span>
<span id="cb1585-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1585-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1585-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1585-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">color =</span> bp[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb1585-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1585-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">300</span>, <span class="at">to =</span> <span class="dv">200</span>, <span class="at">by =</span> <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb1585-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1585-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">eval</span>(<span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="st">&quot;Data with&quot;</span>, n_lines, <span class="st">&quot;credible regression lines&quot;</span>))),</span>
<span id="cb1585-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1585-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;height&quot;</span>,</span>
<span id="cb1585-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1585-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;weight&quot;</span>) <span class="sc">+</span></span>
<span id="cb1585-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1585-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>),</span>
<span id="cb1585-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1585-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">350</span>, <span class="dv">250</span>))</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-24-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>Next we’ll make the histograms.</p>
<div class="sourceCode" id="cb1586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1586-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here are the primary data</span></span>
<span id="cb1586-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-2" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb1586-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">Intercept =</span> b_0,</span>
<span id="cb1586-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">Slope     =</span> b_1,</span>
<span id="cb1586-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">Scale     =</span> sigma <span class="sc">*</span> sd_y,</span>
<span id="cb1586-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">Normality =</span> nu <span class="sc">%&gt;%</span> <span class="fu">log10</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1586-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1586-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1586-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the plot</span></span>
<span id="cb1586-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1586-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> rope,</span>
<span id="cb1586-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax,</span>
<span id="cb1586-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>),</span>
<span id="cb1586-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">fill =</span> bp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1586-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_histinterval</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>), </span>
<span id="cb1586-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1586-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">slab_color =</span> bp[<span class="dv">5</span>],</span>
<span id="cb1586-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="sc">+</span></span>
<span id="cb1586-19"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1586-20"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1586-21"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1586-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-25-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>And we’ll finish up with the scatter plots.</p>
<div class="sourceCode" id="cb1587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1587-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1587-1" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb1587-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1587-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> b_1, <span class="at">y =</span> b_0)) <span class="sc">+</span></span>
<span id="cb1587-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1587-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> bp[<span class="dv">4</span>], <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1587-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1587-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(beta[<span class="dv">1</span>]),</span>
<span id="cb1587-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1587-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(beta[<span class="dv">0</span>]))</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-26-1.png" width="312" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1588-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1588-1" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb1588-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1588-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">Scale =</span> sigma <span class="sc">*</span> sd_y,</span>
<span id="cb1588-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1588-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">Normality =</span> nu <span class="sc">%&gt;%</span> <span class="fu">log10</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1588-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1588-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Normality, <span class="at">y =</span> Scale)) <span class="sc">+</span></span>
<span id="cb1588-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1588-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> bp[<span class="dv">4</span>], <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1588-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1588-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">log10</span>(nu)),</span>
<span id="cb1588-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1588-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(sigma))</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-26-2.png" width="312" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="robust-linear-regression-in-stan." class="section level3 hasAnchor" number="17.2.2">
<h3><span class="header-section-number">17.2.2</span> Robust linear regression in Stan.<a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-stan." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Recall from <a href="stan.html#hmc-sampling">Section 14.1</a> (p. 400) that Stan uses Hamiltonian dynamics to find proposed positions in parameter space. The trajectories use the gradient of the posterior distribution to move large distances even in narrow distributions. Thus, HMC by itself, without data standardization, should be able to efficiently generate a representative sample from the posterior distribution. (p. 487)</p>
</blockquote>
<p>To be clear, we’re going to fit the models with Stan/<strong>brms</strong> twice. Above, we used the standardized data like Kruschke did with his JAGS code. Now we’re getting ready to follow along with the text and use Stan/<strong>brms</strong> to fit the models with the unstandardized data.</p>
<div id="constants-for-vague-priors." class="section level4 hasAnchor" number="17.2.2.1">
<h4><span class="header-section-number">17.2.2.1</span> Constants for vague priors.<a href="metric-predicted-variable-with-one-metric-predictor.html#constants-for-vague-priors." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The issues is we want a system where we can readily specify vague priors on our regression models when the data are not standardized. As it turns out,</p>
<blockquote>
<p>a regression slope can take on a maximum value of <span class="math inline">\(\operatorname{SD}_y / \operatorname{SD}_x\)</span> for data that are perfectly correlated. Therefore, the prior on the slope will be given a standard deviation that is large compared to that maximum. The biggest that an intercept could be, for data that are perfectly correlated, is <span class="math inline">\(M_x \operatorname{SD}_y / \operatorname{SD}_x\)</span>. Therefore, the prior on the intercept will have a standard deviation that is large compared to that maximum. (p. 487)</p>
</blockquote>
<p>With that in mind, we’ll specify our <code>stanvars</code> as follows.</p>
<div class="sourceCode" id="cb1589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1589-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1589-1" aria-hidden="true" tabindex="-1"></a>beta_0_sigma <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">*</span> <span class="fu">abs</span>(m_x <span class="sc">*</span> sd_y <span class="sc">/</span> sd_x)</span>
<span id="cb1589-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1589-2" aria-hidden="true" tabindex="-1"></a>beta_1_sigma <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">*</span> <span class="fu">abs</span>(sd_y <span class="sc">/</span> sd_x) </span>
<span id="cb1589-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1589-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1589-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1589-4" aria-hidden="true" tabindex="-1"></a>stanvars <span class="ot">&lt;-</span> </span>
<span id="cb1589-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1589-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(beta_0_sigma, <span class="at">name =</span> <span class="st">&quot;beta_0_sigma&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1589-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1589-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(beta_1_sigma, <span class="at">name =</span> <span class="st">&quot;beta_1_sigma&quot;</span>) <span class="sc">+</span></span>
<span id="cb1589-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1589-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(sd_y, <span class="at">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb1589-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1589-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">29</span>, <span class="at">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>)</span></code></pre></div>
<p>As in Chapter 16, “set the priors to be extremely broad relative to the data” (p. 487). With our <code>stanvars</code> defined, we’re ready to fit <code>fit17.3</code>.</p>
<div class="sourceCode" id="cb1590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1590-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1590-1" aria-hidden="true" tabindex="-1"></a>fit17<span class="fl">.3</span> <span class="ot">&lt;-</span></span>
<span id="cb1590-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1590-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d,</span>
<span id="cb1590-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1590-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> student,</span>
<span id="cb1590-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1590-4" aria-hidden="true" tabindex="-1"></a>      weight <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> height,</span>
<span id="cb1590-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1590-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, beta_0_sigma), <span class="at">class =</span> Intercept),</span>
<span id="cb1590-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1590-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, beta_1_sigma), <span class="at">class =</span> b),</span>
<span id="cb1590-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1590-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma),</span>
<span id="cb1590-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1590-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(one_over_twentynine), <span class="at">class =</span> nu)),</span>
<span id="cb1590-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1590-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1590-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1590-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars,</span>
<span id="cb1590-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1590-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">17</span>,</span>
<span id="cb1590-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1590-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit17.03&quot;</span>)</span></code></pre></div>
<p>Here’s the model summary.</p>
<div class="sourceCode" id="cb1591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1591-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1591-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit17<span class="fl">.3</span>)</span></code></pre></div>
<pre><code>##  Family: student 
##   Links: mu = identity; sigma = identity; nu = identity 
## Formula: weight ~ 1 + height 
##    Data: d (Number of observations: 300) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept  -120.60     33.49  -184.21   -56.13 1.00     3068     2594
## height        4.22      0.50     3.25     5.17 1.00     3119     2647
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    29.13      1.70    25.81    32.46 1.00     2484     2282
## nu       25.43     20.98     6.19    82.85 1.00     2059     2553
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Now compare the histograms for these posterior draws to those we made, above, from those <code>fit17.1</code>. You’ll see they’re quite similar.</p>
<div class="sourceCode" id="cb1593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1593-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here are the primary data</span></span>
<span id="cb1593-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit17<span class="fl">.3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1593-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">Intercept =</span> b_Intercept,</span>
<span id="cb1593-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">Slope     =</span> b_height,</span>
<span id="cb1593-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">Scale     =</span> sigma,</span>
<span id="cb1593-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">Normality =</span> nu <span class="sc">%&gt;%</span> <span class="fu">log10</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1593-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1593-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1593-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the plot</span></span>
<span id="cb1593-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1593-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">data =</span> rope,</span>
<span id="cb1593-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax,</span>
<span id="cb1593-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>),</span>
<span id="cb1593-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">fill =</span> bp[<span class="dv">9</span>]) <span class="sc">+</span></span>
<span id="cb1593-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_histinterval</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>), </span>
<span id="cb1593-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1593-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">slab_color =</span> bp[<span class="dv">5</span>],</span>
<span id="cb1593-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="sc">+</span></span>
<span id="cb1593-19"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1593-20"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1593-21"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1593-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-29-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="stan-or-jags" class="section level3 hasAnchor" number="17.2.3">
<h3><span class="header-section-number">17.2.3</span> Stan or JAGS?<a href="metric-predicted-variable-with-one-metric-predictor.html#stan-or-jags" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this ebook we only fit the models with <strong>brms</strong>, which uses Stan under the hood. But since we fit the <span class="math inline">\(N = 300\)</span> model with both standardized and unstandardized data, we can compare their performance. For that, we’ll want <strong>bayesplot</strong>.</p>
<div class="sourceCode" id="cb1594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1594-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1594-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span></code></pre></div>
<p>They had equally impressive autocorrelation plots.</p>
<div class="sourceCode" id="cb1595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1595-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1595-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set the bayesplot color scheme</span></span>
<span id="cb1595-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1595-2" aria-hidden="true" tabindex="-1"></a><span class="fu">color_scheme_set</span>(<span class="at">scheme =</span> bp[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">5</span>)])</span>
<span id="cb1595-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1595-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1595-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1595-4" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit17<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1595-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1595-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chain =</span> .chain) <span class="sc">%&gt;%</span> </span>
<span id="cb1595-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1595-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mcmc_acf</span>(<span class="at">pars =</span> <span class="fu">vars</span>(b_Intercept<span class="sc">:</span>nu),</span>
<span id="cb1595-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1595-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">lags =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb1595-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1595-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;fit17.1&quot;</span>)</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-31-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1596-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1596-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit17<span class="fl">.3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1596-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1596-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chain =</span> .chain) <span class="sc">%&gt;%</span> </span>
<span id="cb1596-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1596-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mcmc_acf</span>(<span class="at">pars =</span> <span class="fu">vars</span>(b_Intercept<span class="sc">:</span>nu),</span>
<span id="cb1596-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1596-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">lags =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb1596-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1596-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;fit17.3&quot;</span>)</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-31-2.png" width="480" style="display: block; margin: auto;" /></p>
<p>Their <span class="math inline">\(N_{eff}/N\)</span> ratios were pretty similar. Both were reasonable. You’d probably want to run a simulation to contrast them with any rigor.</p>
<div class="sourceCode" id="cb1597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1597-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1597-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change the bayesplot color scheme</span></span>
<span id="cb1597-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1597-2" aria-hidden="true" tabindex="-1"></a><span class="fu">color_scheme_set</span>(<span class="at">scheme =</span> bp[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">9</span>)])</span>
<span id="cb1597-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1597-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1597-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1597-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1597-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1597-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">neff_ratio</span>(fit17<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1597-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1597-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mcmc_neff</span>() <span class="sc">+</span></span>
<span id="cb1597-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1597-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">yaxis_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1597-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1597-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;fit17.1&quot;</span>)</span>
<span id="cb1597-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1597-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1597-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1597-10" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1597-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1597-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">neff_ratio</span>(fit17<span class="fl">.3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1597-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1597-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mcmc_neff</span>() <span class="sc">+</span></span>
<span id="cb1597-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1597-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">yaxis_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1597-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1597-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;fit17.3&quot;</span>)</span>
<span id="cb1597-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1597-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1597-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1597-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guide =</span> <span class="st">&quot;collect&quot;</span>)</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-32-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="interpreting-the-posterior-distribution." class="section level3 hasAnchor" number="17.2.4">
<h3><span class="header-section-number">17.2.4</span> Interpreting the posterior distribution.<a href="metric-predicted-variable-with-one-metric-predictor.html#interpreting-the-posterior-distribution." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Halfway through the prose, Kruschke mentioned how the models provide entire posteriors for the <code>weight</code> of a 50-inch-tall person. <strong>brms</strong> offers a few ways to do so.</p>
<blockquote>
<p>In some applications, there is interest in extrapolating or interpolating trends at <span class="math inline">\(x\)</span> values sparsely represented in the current data. For instance, we might want to predict the weight of a person who is <span class="math inline">\(50\)</span> inches tall. A feature of Bayesian analysis is that we get an entire distribution of credible predicted values, not only a point estimate. (p. 489)</p>
</blockquote>
<p>Since this is such a simple model, one way is to work directly with the posterior draws Here we use the model formula <span class="math inline">\(y_i = \beta_0 + \beta_1 x_i\)</span> by adding the transformed intercept <code>b_0</code> to the product of 50 and the transformed coefficient for <code>height</code>, <code>b_1</code>.</p>
<div class="sourceCode" id="cb1598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1598-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1598-1" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb1598-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1598-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight_at_50 =</span> b_0 <span class="sc">+</span> b_1 <span class="sc">*</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1598-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1598-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1598-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1598-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight_at_50, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1598-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1598-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_histinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1598-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1598-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">slab_color =</span> bp[<span class="dv">5</span>],</span>
<span id="cb1598-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1598-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="sc">+</span></span>
<span id="cb1598-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1598-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1598-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1598-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;lbs&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Unknown or uninitialised column: `linewidth`.</code></pre>
<p><img src="17_files/figure-html/unnamed-chunk-33-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>Looks pretty wide, doesn’t it? Hopefully this isn’t a surprise. Recall that this <code>draws</code> is from <code>fit17.2</code>, the posterior based on the <span class="math inline">\(n = 30\)</span> data. With so few cases, most predictions from that model are uncertain. But also, 50 inches is way out of the bounds of the data the model was based on, so we should be uncertain in this range.</p>
<p>Let’s practice a second method. With the <code>brms::fitted()</code> function, we can specify the desired <code>height</code> value into a tibble, which we’ll then feed into the <code>newdata</code> argument. Fitted will then return the model-implied criterion value for that predictor variable. To warm up, we’ll first to it with <code>fit17.3</code>, the model based on the untransformed data.</p>
<div class="sourceCode" id="cb1600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1600-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1600-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">height =</span> <span class="dv">50</span>)</span>
<span id="cb1600-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1600-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1600-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1600-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit17<span class="fl">.3</span>,</span>
<span id="cb1600-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1600-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd)</span></code></pre></div>
<pre><code>##      Estimate Est.Error     Q2.5    Q97.5
## [1,]  90.2715  8.668269 73.33173 107.1422</code></pre>
<p>The code returned a typical <strong>brms</strong>-style summary of the posterior mean, standard deviation, and 95% percentile-based intervals. The same basic method will work for the standardized models, <code>fit17.1</code> or <code>fit17.2</code>. But that will take a little more wrangling. First, we’ll need to transform our desired value 50 into its standardized version.</p>
<div class="sourceCode" id="cb1602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1602-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1602-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">height_z =</span> (<span class="dv">50</span> <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>height)) <span class="sc">/</span> <span class="fu">sd</span>(d<span class="sc">$</span>height))</span></code></pre></div>
<p>When we feed this value into <code>fitted()</code>, it will return the corresponding posterior within the standardized metric. But we want unstandardized, so we’ll need to transform. That’ll be a few-step process. First, to do the transformation properly, we’ll want to work with the poster draws themselves, rather than summary values. So we’ll set <code>summary = F</code>. We’ll then convert the draws into a tibble format. Then we’ll use the <code>transmute()</code> function to do the conversion. In the final step, we’ll use <code>mean_qi()</code> to compute the summary values.</p>
<div class="sourceCode" id="cb1603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1603-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1603-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit17<span class="fl">.1</span>,</span>
<span id="cb1603-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1603-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd,</span>
<span id="cb1603-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1603-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb1603-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1603-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1603-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1603-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">weight =</span> V1 <span class="sc">*</span> <span class="fu">sd</span>(d<span class="sc">$</span>weight) <span class="sc">+</span> <span class="fu">mean</span>(d<span class="sc">$</span>weight)) <span class="sc">%&gt;%</span> </span>
<span id="cb1603-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1603-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_qi</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   weight .lower .upper .width .point .interval
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1   90.0   73.1   107.   0.95 mean   qi</code></pre>
<p>If you look above, you’ll see the results are within rounding error of those from <code>fit3</code>.</p>
</div>
</div>
<div id="hierarchical-regression-on-individuals-within-groups" class="section level2 hasAnchor" number="17.3">
<h2><span class="header-section-number">17.3</span> Hierarchical regression on individuals within groups<a href="metric-predicted-variable-with-one-metric-predictor.html#hierarchical-regression-on-individuals-within-groups" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>In the previous applications, the <span class="math inline">\(j\)</span>th individual contributed a single <span class="math inline">\(x_j, y_j\)</span> pair. But suppose instead that every individual, <span class="math inline">\(j\)</span>, contributes multiple observations of <span class="math inline">\(x_{i|j}, y_{i|j}\)</span> pairs. (The subscript notation <span class="math inline">\(i|j\)</span> means the <span class="math inline">\(i\)</span>th observation within the <span class="math inline">\(j\)</span>th individual.) With these data, we can estimate a regression curve for every individual. If we also assume that the individuals are mutually representative of a common group, then we can estimate group-level parameters too. (p. 490)</p>
</blockquote>
<p>Load the fictitious data and take a <code>glimpse()</code>.</p>
<div class="sourceCode" id="cb1605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1605-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1605-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data.R/HierLinRegressData.csv&quot;</span>)</span>
<span id="cb1605-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1605-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1605-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1605-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(my_data)</span></code></pre></div>
<pre><code>## Rows: 132
## Columns: 3
## $ Subj &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 4, 4, 5, 5, 5, 5, 5…
## $ X    &lt;dbl&gt; 60.2, 61.5, 61.7, 62.3, 67.6, 69.2, 53.7, 60.1, 60.5, 62.3, 63.0, 64.0, 64.1, 66.7, 6…
## $ Y    &lt;dbl&gt; 145.6, 157.3, 165.6, 158.8, 196.1, 183.9, 165.0, 166.9, 179.0, 196.2, 192.3, 200.7, 1…</code></pre>
<blockquote>
<p>Our goal is to describe each individual with a linear regression, and simultaneously to estimate the typical slope and intercept of the group overall. A key assumption for our analysis is that each individual is representative of the group. Therefore, every individual informs the estimate of the group slope and intercept, which in turn inform the estimates of all the individual slopes and intercepts. Thereby we get sharing of information across individuals, and shrinkage of individual estimates toward the overarching mode. (p. 491)</p>
</blockquote>
<div id="the-model-and-implementation-in-jags-brms." class="section level3 hasAnchor" number="17.3.1">
<h3><span class="header-section-number">17.3.1</span> The model and implementation in <del>JAGS</del> brms.<a href="metric-predicted-variable-with-one-metric-predictor.html#the-model-and-implementation-in-jags-brms." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Kruschke described the model diagram in Figure 17.6 as “a bit daunting” (p. 491). The code to make our version of the diagram is “a bit daunting,” too. Just like the code for any other diagram, it’s modular. If you’re following along with me and making these on your own, just build it up, step by step.</p>
<div class="sourceCode" id="cb1607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1607-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normal density</span></span>
<span id="cb1607-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1607-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1607-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1607-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1607-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1607-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1607-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1607-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1607-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;italic(M)[0]&quot;</span>, <span class="st">&quot;italic(S)[0]&quot;</span>), </span>
<span id="cb1607-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1607-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1607-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1607-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb1607-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1607-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-18" aria-hidden="true" tabindex="-1"></a><span class="co"># half-normal density</span></span>
<span id="cb1607-19"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1607-20"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1607-21"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1607-22"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1607-23"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-24"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1607-25"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;half-normal&quot;</span>,</span>
<span id="cb1607-26"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1607-27"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-28"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1607-29"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;0*&#39;,&#39;*~italic(S)[sigma][0]&quot;</span>, </span>
<span id="cb1607-30"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1607-31"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1607-32"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1607-33"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb1607-34"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1607-35"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-35" aria-hidden="true" tabindex="-1"></a><span class="co"># a second normal density</span></span>
<span id="cb1607-36"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-36" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb1607-37"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1607-38"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1607-39"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1607-40"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-41"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1607-42"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1607-43"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1607-44"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-45"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1607-46"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;italic(M)[1]&quot;</span>, <span class="st">&quot;italic(S)[1]&quot;</span>), </span>
<span id="cb1607-47"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-47" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1607-48"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1607-49"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1607-50"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb1607-51"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1607-52"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-52" aria-hidden="true" tabindex="-1"></a><span class="co"># a second half-normal density</span></span>
<span id="cb1607-53"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-53" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb1607-54"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1607-55"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1607-56"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1607-57"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-58"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-58" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1607-59"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-59" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;half-normal&quot;</span>,</span>
<span id="cb1607-60"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-60" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1607-61"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-62"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-62" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1607-63"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-63" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;0*&#39;,&#39;*~italic(S)[sigma][1]&quot;</span>, </span>
<span id="cb1607-64"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-64" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1607-65"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1607-66"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1607-67"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb1607-68"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1607-69"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-69" aria-hidden="true" tabindex="-1"></a><span class="co"># four annotated arrows</span></span>
<span id="cb1607-70"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-70" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span></span>
<span id="cb1607-71"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">35</span>, .<span class="dv">65</span>, .<span class="dv">95</span>),</span>
<span id="cb1607-72"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-72" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1607-73"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-73" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">32</span>, .<span class="dv">4</span>, .<span class="dv">65</span>, .<span class="dv">72</span>),</span>
<span id="cb1607-74"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-74" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">2</span>, .<span class="dv">2</span>, .<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1607-75"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1607-76"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb1607-77"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-77" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1607-78"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1607-79"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-80"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-80" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">35</span>, .<span class="dv">625</span>, .<span class="dv">78</span>), <span class="at">y =</span> .<span class="dv">55</span>,</span>
<span id="cb1607-81"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-81" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;&#39;~&#39;&quot;</span>,</span>
<span id="cb1607-82"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-82" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1607-83"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1607-84"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1607-85"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1607-86"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-86" aria-hidden="true" tabindex="-1"></a><span class="co"># third normal density</span></span>
<span id="cb1607-87"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-87" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span></span>
<span id="cb1607-88"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1607-89"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1607-90"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1607-91"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-92"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-92" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1607-93"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-93" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1607-94"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-94" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1607-95"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-96"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-96" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1607-97"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-97" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;mu[0]&quot;</span>, <span class="st">&quot;sigma[0]&quot;</span>), </span>
<span id="cb1607-98"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-98" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1607-99"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1607-100"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1607-101"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb1607-102"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1607-103"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-103" aria-hidden="true" tabindex="-1"></a><span class="co"># fourth normal density</span></span>
<span id="cb1607-104"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-104" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span></span>
<span id="cb1607-105"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1607-106"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1607-107"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1607-108"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-109"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-109" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1607-110"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-110" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1607-111"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-111" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1607-112"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-113"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-113" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1607-114"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-114" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;mu[1]&quot;</span>, <span class="st">&quot;sigma[1]&quot;</span>), </span>
<span id="cb1607-115"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-115" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1607-116"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1607-117"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1607-118"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb1607-119"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1607-120"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-120" aria-hidden="true" tabindex="-1"></a><span class="co"># two annotated arrows</span></span>
<span id="cb1607-121"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-121" aria-hidden="true" tabindex="-1"></a>p8 <span class="ot">&lt;-</span></span>
<span id="cb1607-122"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">18</span>, .<span class="dv">82</span>),</span>
<span id="cb1607-123"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-123" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1607-124"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-124" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">36</span>, .<span class="dv">55</span>),</span>
<span id="cb1607-125"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-125" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1607-126"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-126" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1607-127"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb1607-128"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-128" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1607-129"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1607-130"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-131"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-131" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">18</span>, .<span class="dv">33</span>, .<span class="dv">64</span>, .<span class="dv">77</span>), <span class="at">y =</span> .<span class="dv">55</span>,</span>
<span id="cb1607-132"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-132" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(j)&quot;</span>, <span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(j)&quot;</span>),</span>
<span id="cb1607-133"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-133" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">7</span>), </span>
<span id="cb1607-134"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-134" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1607-135"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1607-136"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1607-137"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1607-138"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-138" aria-hidden="true" tabindex="-1"></a><span class="co"># exponential density</span></span>
<span id="cb1607-139"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-139" aria-hidden="true" tabindex="-1"></a>p9 <span class="ot">&lt;-</span></span>
<span id="cb1607-140"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1607-141"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dexp</span>(x, <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dexp</span>(x, <span class="dv">2</span>))))) <span class="sc">+</span></span>
<span id="cb1607-142"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1607-143"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-144"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-144" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1607-145"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-145" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;exp&quot;</span>,</span>
<span id="cb1607-146"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-146" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1607-147"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-148"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-148" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1607-149"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-149" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;italic(K)&quot;</span>,</span>
<span id="cb1607-150"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-150" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1607-151"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1607-152"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1607-153"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb1607-154"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1607-155"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-155" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood formula</span></span>
<span id="cb1607-156"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-156" aria-hidden="true" tabindex="-1"></a>p10 <span class="ot">&lt;-</span></span>
<span id="cb1607-157"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> .<span class="dv">5</span>,</span>
<span id="cb1607-158"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-158" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb1607-159"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-159" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;beta[0][italic(j)]+beta[1][italic(j)]*italic(x)[italic(i)*&#39;|&#39;*italic(j)]&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1607-160"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-160" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1607-161"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1607-162"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1607-163"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1607-164"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1607-165"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1607-166"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1607-167"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-167" aria-hidden="true" tabindex="-1"></a><span class="co"># half-normal density</span></span>
<span id="cb1607-168"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-168" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span></span>
<span id="cb1607-169"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1607-170"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1607-171"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1607-172"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-173"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-173" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1607-174"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-174" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;half-normal&quot;</span>,</span>
<span id="cb1607-175"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-175" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1607-176"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-177"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-177" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1607-178"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-178" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;0*&#39;,&#39;*~italic(S)[sigma]&quot;</span>, </span>
<span id="cb1607-179"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-179" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1607-180"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1607-181"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1607-182"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb1607-183"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1607-184"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-184" aria-hidden="true" tabindex="-1"></a><span class="co"># four annotated arrows</span></span>
<span id="cb1607-185"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-185" aria-hidden="true" tabindex="-1"></a>p12 <span class="ot">&lt;-</span></span>
<span id="cb1607-186"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">43</span>, .<span class="dv">43</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>),</span>
<span id="cb1607-187"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-187" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">55</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1607-188"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-188" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">43</span>, <span class="fl">1.225</span>, <span class="fl">1.5</span>, <span class="fl">1.75</span>),</span>
<span id="cb1607-189"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-189" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="fu">c</span>(.<span class="dv">8</span>, .<span class="dv">15</span>, .<span class="dv">2</span>, .<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1607-190"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-190" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1607-191"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb1607-192"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-192" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1607-193"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1607-194"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-195"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-195" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">3</span>, .<span class="dv">7</span>, <span class="fl">1.38</span>, <span class="dv">2</span>), <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">92</span>, .<span class="dv">22</span>, .<span class="dv">65</span>, .<span class="dv">6</span>),</span>
<span id="cb1607-196"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-196" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;&#39;=&#39;&quot;</span>, <span class="st">&quot;&#39;=&#39;&quot;</span>, <span class="st">&quot;&#39;~&#39;&quot;</span>),</span>
<span id="cb1607-197"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-197" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb1607-198"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-198" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1607-199"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-200"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-200" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">43</span>, <span class="at">y =</span> .<span class="dv">7</span>,</span>
<span id="cb1607-201"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-201" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;nu*minute+1&quot;</span>,</span>
<span id="cb1607-202"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-202" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1607-203"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1607-204"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1607-205"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1607-206"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-206" aria-hidden="true" tabindex="-1"></a><span class="co"># student-t density</span></span>
<span id="cb1607-207"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-207" aria-hidden="true" tabindex="-1"></a>p13 <span class="ot">&lt;-</span></span>
<span id="cb1607-208"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1607-209"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dt</span>(x, <span class="dv">3</span>) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dt</span>(x, <span class="dv">3</span>))))) <span class="sc">+</span></span>
<span id="cb1607-210"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1607-211"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-212"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-212" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1607-213"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-213" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;student t&quot;</span>,</span>
<span id="cb1607-214"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-214" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb1607-215"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1607-216"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-216" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1607-217"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-217" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;nu~~mu[italic(i)*&#39;|&#39;*italic(j)]~~sigma&quot;</span>,</span>
<span id="cb1607-218"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-218" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1607-219"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1607-220"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1607-221"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb1607-222"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1607-223"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-223" aria-hidden="true" tabindex="-1"></a><span class="co"># the final annotated arrow</span></span>
<span id="cb1607-224"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-224" aria-hidden="true" tabindex="-1"></a>p14 <span class="ot">&lt;-</span></span>
<span id="cb1607-225"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="fu">c</span>(.<span class="dv">375</span>, .<span class="dv">625</span>),</span>
<span id="cb1607-226"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-226" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb1607-227"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-227" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(i)*&#39;|&#39;*italic(j)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1607-228"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-228" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1607-229"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1607-230"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>), <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1607-231"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">5</span>, <span class="at">xend =</span> .<span class="dv">5</span>,</span>
<span id="cb1607-232"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-232" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> <span class="dv">0</span>, </span>
<span id="cb1607-233"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-233" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">arrow =</span> my_arrow) <span class="sc">+</span></span>
<span id="cb1607-234"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1607-235"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1607-236"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1607-237"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-237" aria-hidden="true" tabindex="-1"></a><span class="co"># some text</span></span>
<span id="cb1607-238"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-238" aria-hidden="true" tabindex="-1"></a>p15 <span class="ot">&lt;-</span></span>
<span id="cb1607-239"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">5</span>,</span>
<span id="cb1607-240"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-240" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> .<span class="dv">5</span>,</span>
<span id="cb1607-241"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-241" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;italic(y)[italic(i)*&#39;|&#39;*italic(j)]&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1607-242"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-242" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1607-243"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1607-244"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1607-245"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1607-246"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1607-247"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1607-248"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-248" aria-hidden="true" tabindex="-1"></a><span class="co"># define the layout</span></span>
<span id="cb1607-249"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-249" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1607-250"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">3</span>),</span>
<span id="cb1607-251"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1607-252"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">9</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb1607-253"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">13</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb1607-254"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">4</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1607-255"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">4</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">9</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb1607-256"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb1607-257"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">7</span>, <span class="at">b =</span> <span class="dv">8</span>, <span class="at">l =</span> <span class="dv">3</span>, <span class="at">r =</span> <span class="dv">5</span>),</span>
<span id="cb1607-258"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">7</span>, <span class="at">b =</span> <span class="dv">8</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb1607-259"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">7</span>, <span class="at">b =</span> <span class="dv">8</span>, <span class="at">l =</span> <span class="dv">11</span>, <span class="at">r =</span> <span class="dv">13</span>),</span>
<span id="cb1607-260"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">6</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb1607-261"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">11</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb1607-262"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">9</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">3</span>, <span class="at">r =</span> <span class="dv">13</span>),</span>
<span id="cb1607-263"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">12</span>, <span class="at">b =</span> <span class="dv">12</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb1607-264"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">13</span>, <span class="at">b =</span> <span class="dv">13</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>)</span>
<span id="cb1607-265"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-265" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1607-266"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1607-267"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-267" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot!</span></span>
<span id="cb1607-268"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-268" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p6 <span class="sc">+</span> p7 <span class="sc">+</span> p5 <span class="sc">+</span> p9 <span class="sc">+</span> p10 <span class="sc">+</span> p11 <span class="sc">+</span> p8 <span class="sc">+</span> p13 <span class="sc">+</span> p12 <span class="sc">+</span> p14 <span class="sc">+</span> p15) <span class="sc">+</span> </span>
<span id="cb1607-269"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout) <span class="sc">&amp;</span></span>
<span id="cb1607-270"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb1607-271"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1607-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>, <span class="fl">5.5</span>))</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-38-1.png" width="816" style="display: block; margin: auto;" /></p>
<p>Just look at that sweet thing! If you made you version, here; have a piece of cake. 🍰 You earned it.</p>
<p>Now let’s standardize the data and define our <code>stanvars</code>. I should note that standardizing and mean centering, more generally, becomes complicated with multilevel models. Here we’re just standardizing based on the grand mean and grand standard deviation. But there are other ways to standardize, such as within groups. Craig Enders has a good <span class="citation">(<a href="#ref-endersCenteringPredictorsContextual2013" role="doc-biblioref">2013</a>)</span> <a href="https://scholar.google.com/scholar?hl=en&amp;as_sdt=0%2C1&amp;q=Centering+Predictors+and+Contextual+Effects&amp;btnG=">book chapter</a> that touched on the topic, as well as an earlier <span class="citation">(<a href="#ref-enders2007centering" role="doc-biblioref">2007</a>)</span> <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.928.9848&amp;rep=rep1&amp;type=pdf">paper</a> with Tofighi.</p>
<div class="sourceCode" id="cb1608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1608-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1608-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span></span>
<span id="cb1608-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1608-2" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1608-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1608-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x_z =</span> <span class="fu">standardize</span>(X),</span>
<span id="cb1608-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1608-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y_z =</span> <span class="fu">standardize</span>(Y))</span></code></pre></div>
<p>In my experience, you typically use the <code>(|)</code> syntax when fitting a hierarchical model with the<code>brm()</code> function. The terms before the <code>|</code> are those varying by group and you tell <code>brm()</code> what the grouping variable is after the <code>|</code>. In the case of multiple group-level parameters–which is the case with this model (i.e., both intercept and the <code>x_z</code> slope)–, this syntax also estimates correlations among the group-level parameters. Kruschke’s model doesn’t appear to include such a correlation. Happily, we can use the <code>(||)</code> syntax instead, which omits correlations among the group-level parameters. If you’re curious about the distinction, fit the model both ways and explore the differences in the <code>print()</code> output. For more on the topic, see the <em>Group-level terms</em> subsection of the <code>brmsformula</code> section of the <a href="https://CRAN.R-project.org/package=brms/brms.pdf"><strong>brms</strong> reference manual</a> <span class="citation">(<a href="#ref-brms2022RM" role="doc-biblioref">Bürkner, 2022d</a>)</span>.</p>
<div class="sourceCode" id="cb1609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1609-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1609-1" aria-hidden="true" tabindex="-1"></a>fit17<span class="fl">.4</span> <span class="ot">&lt;-</span></span>
<span id="cb1609-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1609-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1609-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1609-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> student,</span>
<span id="cb1609-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1609-4" aria-hidden="true" tabindex="-1"></a>      y_z <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x_z <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> x_z <span class="sc">||</span> Subj),</span>
<span id="cb1609-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1609-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1609-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1609-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> b),</span>
<span id="cb1609-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1609-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb1609-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1609-8" aria-hidden="true" tabindex="-1"></a>                <span class="co"># the next line is new</span></span>
<span id="cb1609-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1609-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb1609-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1609-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(one_over_twentynine), <span class="at">class =</span> nu)),</span>
<span id="cb1609-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1609-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1609-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1609-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">17</span>,</span>
<span id="cb1609-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1609-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> <span class="fu">stanvar</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">29</span>, <span class="at">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>),</span>
<span id="cb1609-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1609-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit17.04&quot;</span>)</span></code></pre></div>
<p>Did you catch that <code>prior(normal(0, 1), class = sd)</code> line in the code? That’s the prior we used for our hierarchical variance parameters, <span class="math inline">\(\sigma_0\)</span> and <span class="math inline">\(\sigma_1\)</span>. Just like with the scale parameter, <span class="math inline">\(\sigma\)</span>, we used the zero-mean half-normal distribution. By default, <strong>brms</strong> sets their left boundary to zero, which keeps the HMC algorithm from exploring negative variance values.</p>
<p>Anyway, here’s the model <code>summary()</code>.</p>
<div class="sourceCode" id="cb1610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1610-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1610-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit17<span class="fl">.4</span>)</span></code></pre></div>
<pre><code>##  Family: student 
##   Links: mu = identity; sigma = identity; nu = identity 
## Formula: y_z ~ 1 + x_z + (1 + x_z || Subj) 
##    Data: my_data (Number of observations: 132) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Group-Level Effects: 
## ~Subj (Number of levels: 25) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)     1.02      0.18     0.72     1.44 1.00     1182     2090
## sd(x_z)           0.22      0.12     0.02     0.47 1.00      969     1609
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     0.07      0.22    -0.36     0.49 1.00      874     1376
## x_z           0.70      0.10     0.51     0.90 1.00     2991     3100
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     0.59      0.05     0.49     0.70 1.00     1764     2273
## nu       39.63     30.88     6.23   125.68 1.00     3813     2203
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="the-posterior-distribution-shrinkage-and-prediction." class="section level3 hasAnchor" number="17.3.2">
<h3><span class="header-section-number">17.3.2</span> The posterior distribution: Shrinkage and prediction.<a href="metric-predicted-variable-with-one-metric-predictor.html#the-posterior-distribution-shrinkage-and-prediction." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Keeping in the same spirit of <a href="metric-predicted-variable-with-one-metric-predictor.html#interpreting-the-posterior-distribution.">Section 17.2.4</a>, we’ll make the plots of Figure 17.5 in two ways. First, we’ll use our <code>make_beta_0()</code> and <code>make_beta_1()</code> functions to transform the model coefficients.</p>
<div class="sourceCode" id="cb1612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1612-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-1" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit17<span class="fl">.4</span>)</span>
<span id="cb1612-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1612-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-3" aria-hidden="true" tabindex="-1"></a>sd_x <span class="ot">&lt;-</span> <span class="fu">sd</span>(my_data<span class="sc">$</span>X)</span>
<span id="cb1612-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-4" aria-hidden="true" tabindex="-1"></a>sd_y <span class="ot">&lt;-</span> <span class="fu">sd</span>(my_data<span class="sc">$</span>Y)</span>
<span id="cb1612-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-5" aria-hidden="true" tabindex="-1"></a>m_x  <span class="ot">&lt;-</span> <span class="fu">mean</span>(my_data<span class="sc">$</span>X)</span>
<span id="cb1612-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-6" aria-hidden="true" tabindex="-1"></a>m_y  <span class="ot">&lt;-</span> <span class="fu">mean</span>(my_data<span class="sc">$</span>Y)</span>
<span id="cb1612-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1612-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-8" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span></span>
<span id="cb1612-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-9" aria-hidden="true" tabindex="-1"></a>  draws <span class="sc">%&gt;%</span> </span>
<span id="cb1612-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">b_0 =</span> <span class="fu">make_beta_0</span>(<span class="at">zeta_0 =</span> b_Intercept,</span>
<span id="cb1612-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">zeta_1 =</span> b_x_z,</span>
<span id="cb1612-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_x   =</span> sd_x,</span>
<span id="cb1612-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_y   =</span> sd_y,</span>
<span id="cb1612-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">m_x    =</span> m_x,</span>
<span id="cb1612-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">m_y    =</span> m_y),</span>
<span id="cb1612-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">b_1 =</span> <span class="fu">make_beta_1</span>(<span class="at">zeta_1 =</span> b_x_z,</span>
<span id="cb1612-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-17" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_x   =</span> sd_x,</span>
<span id="cb1612-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_y   =</span> sd_y)) <span class="sc">%&gt;%</span> </span>
<span id="cb1612-19"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw, b_0, b_1)</span>
<span id="cb1612-20"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1612-21"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1612-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(draws)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   .draw   b_0   b_1
##   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1 -90.8  3.59
## 2     2 -64.0  3.20
## 3     3 -51.2  2.94
## 4     4 -84.8  3.51
## 5     5 -21.6  2.54
## 6     6 -82.9  3.49</code></pre>
<p>Here’s the top panel of Figure 17.4.</p>
<div class="sourceCode" id="cb1614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1614-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many posterior lines would you like?</span></span>
<span id="cb1614-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-2" aria-hidden="true" tabindex="-1"></a>n_lines <span class="ot">&lt;-</span> <span class="dv">250</span></span>
<span id="cb1614-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1614-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-4" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1614-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Subj =</span> <span class="fu">factor</span>(Subj, <span class="at">levels =</span> <span class="dv">25</span><span class="sc">:</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1614-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1614-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb1614-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> draws <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span>n_lines),</span>
<span id="cb1614-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> b_0, <span class="at">slope =</span> b_1, <span class="at">group =</span> .draw),</span>
<span id="cb1614-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1614-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Subj),</span>
<span id="cb1614-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1614-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Subj, <span class="at">color =</span> Subj),</span>
<span id="cb1614-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1614-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">beyonce_palette</span>(<span class="dv">41</span>, <span class="at">n =</span> <span class="dv">25</span>, <span class="at">type =</span> <span class="st">&quot;continuous&quot;</span>), <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1614-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">50</span>, <span class="at">to =</span> <span class="dv">250</span>, <span class="at">by =</span> <span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb1614-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">eval</span>(<span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="st">&quot;Data from all units with&quot;</span>, n_lines, <span class="st">&quot;credible population-level</span><span class="sc">\n</span><span class="st">regression lines&quot;</span>)))) <span class="sc">+</span></span>
<span id="cb1614-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">95</span>),</span>
<span id="cb1614-19"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1614-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">270</span>))</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-42-1.png" width="408" style="display: block; margin: auto;" /></p>
<p>Recall how we can use <code>coef()</code> to extract the <code>Subj</code>-specific parameters. But we’ll want posterior draws rather than summaries, which requires <code>summary = F</code>. It’ll take a bit of wrangling to get the output in a tidy format. Once we’re there, the plot code will be fairly simple.</p>
<div class="sourceCode" id="cb1615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1615-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-1" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span></span>
<span id="cb1615-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># first collect and wrangle the draws for the Subj-level intercept and slopes</span></span>
<span id="cb1615-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">coef</span>(fit17<span class="fl">.4</span>, <span class="at">summary =</span> F)<span class="sc">$</span>Subj[, , <span class="st">&quot;Intercept&quot;</span>],</span>
<span id="cb1615-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coef</span>(fit17<span class="fl">.4</span>, <span class="at">summary =</span> F)<span class="sc">$</span>Subj[, , <span class="st">&quot;x_z&quot;</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1615-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1615-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1615-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draw =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4000</span>, <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb1615-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">param =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;Slope&quot;</span>), <span class="at">each =</span> <span class="dv">4000</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1615-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">25</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">&quot;Subj&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1615-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> param, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span> </span>
<span id="cb1615-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># now we&#39;re ready to un-standardize the standardized coefficients</span></span>
<span id="cb1615-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">b_0 =</span> <span class="fu">make_beta_0</span>(<span class="at">zeta_0 =</span> Intercept,</span>
<span id="cb1615-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">zeta_1 =</span> Slope,</span>
<span id="cb1615-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_x   =</span> sd_x,</span>
<span id="cb1615-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_y   =</span> sd_y,</span>
<span id="cb1615-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">m_x    =</span> m_x,</span>
<span id="cb1615-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-17" aria-hidden="true" tabindex="-1"></a>                           <span class="at">m_y    =</span> m_y),</span>
<span id="cb1615-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">b_1 =</span> <span class="fu">make_beta_1</span>(<span class="at">zeta_1 =</span> Slope,</span>
<span id="cb1615-19"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_x   =</span> sd_x,</span>
<span id="cb1615-20"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_y   =</span> sd_y))</span>
<span id="cb1615-21"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1615-22"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-22" aria-hidden="true" tabindex="-1"></a><span class="co"># how many lines would you like?</span></span>
<span id="cb1615-23"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-23" aria-hidden="true" tabindex="-1"></a>n_lines <span class="ot">&lt;-</span> <span class="dv">250</span></span>
<span id="cb1615-24"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1615-25"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-25" aria-hidden="true" tabindex="-1"></a><span class="co"># the plot:</span></span>
<span id="cb1615-26"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-26" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1615-27"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Subj =</span> <span class="fu">factor</span>(Subj, <span class="at">levels =</span> <span class="dv">25</span><span class="sc">:</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1615-28"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1615-29"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb1615-30"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> c <span class="sc">%&gt;%</span> <span class="fu">filter</span>(draw <span class="sc">&lt;=</span> n_lines),</span>
<span id="cb1615-31"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-31" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> b_0, <span class="at">slope =</span> b_1), </span>
<span id="cb1615-32"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1615-33"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Subj)) <span class="sc">+</span></span>
<span id="cb1615-34"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">beyonce_palette</span>(<span class="dv">41</span>, <span class="at">n =</span> <span class="dv">25</span>, <span class="at">type =</span> <span class="st">&quot;continuous&quot;</span>), <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1615-35"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">50</span>, <span class="at">to =</span> <span class="dv">90</span>,  <span class="at">by =</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb1615-36"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">50</span>, <span class="at">to =</span> <span class="dv">250</span>, <span class="at">by =</span> <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb1615-37"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Each unit now has its own bundle of credible regression lines&quot;</span>) <span class="sc">+</span></span>
<span id="cb1615-38"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">90</span>),</span>
<span id="cb1615-39"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-39" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">270</span>)) <span class="sc">+</span></span>
<span id="cb1615-40"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1615-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Subj <span class="sc">%&gt;%</span> <span class="fu">factor</span>(., <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>))</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-43-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>There’s some good pedagogy in that method. But I like having options and in this case <code>fitted()</code> affords a simpler workflow. Here’s the preparatory data wrangling step.</p>
<div class="sourceCode" id="cb1616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1616-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many posterior lines would you like?</span></span>
<span id="cb1616-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-2" aria-hidden="true" tabindex="-1"></a>n_lines <span class="ot">&lt;-</span> <span class="dv">250</span></span>
<span id="cb1616-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1616-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-4" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> </span>
<span id="cb1616-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># since we&#39;re working with straight lines, we only need two x-values</span></span>
<span id="cb1616-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x_z =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1616-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">X    =</span> x_z <span class="sc">*</span> <span class="fu">sd</span>(my_data<span class="sc">$</span>X) <span class="sc">+</span> <span class="fu">mean</span>(my_data<span class="sc">$</span>X),</span>
<span id="cb1616-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">name =</span> <span class="fu">str_c</span>(<span class="st">&quot;V&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()))</span>
<span id="cb1616-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1616-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-10" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb1616-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(fit17<span class="fl">.4</span>,</span>
<span id="cb1616-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> nd,</span>
<span id="cb1616-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-13" aria-hidden="true" tabindex="-1"></a>         <span class="co"># since we only want the fixed effects, we&#39;ll use `re_formula` </span></span>
<span id="cb1616-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-14" aria-hidden="true" tabindex="-1"></a>         <span class="co"># to maginalize over the random effects</span></span>
<span id="cb1616-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">re_formula =</span> Y_z <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> X_z,</span>
<span id="cb1616-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">summary =</span> F,</span>
<span id="cb1616-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-17" aria-hidden="true" tabindex="-1"></a>         <span class="co"># here we use `ndraws` to subset right from the get go</span></span>
<span id="cb1616-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">ndraws =</span> n_lines) <span class="sc">%&gt;%</span> </span>
<span id="cb1616-19"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1616-20"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draw =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1616-21"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>draw) <span class="sc">%&gt;%</span> </span>
<span id="cb1616-22"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># transform the `y_z` values back into the `Y` metric</span></span>
<span id="cb1616-23"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Y =</span> value <span class="sc">*</span> <span class="fu">sd</span>(my_data<span class="sc">$</span>Y) <span class="sc">+</span> <span class="fu">mean</span>(my_data<span class="sc">$</span>Y)) <span class="sc">%&gt;%</span> </span>
<span id="cb1616-24"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># now attach the predictor values to the output</span></span>
<span id="cb1616-25"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(nd, <span class="at">by =</span> <span class="st">&quot;name&quot;</span>)</span>
<span id="cb1616-26"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1616-27"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1616-27" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(f)  </span></code></pre></div>
<pre><code>## # A tibble: 6 × 6
##    draw name  value     Y   x_z     X
##   &lt;int&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1 V1    -2.78  64.2    -5  31.4
## 2     1 V2     2.62 237.      5 103. 
## 3     2 V1    -3.47  42.1    -5  31.4
## 4     2 V2     4.14 286.      5 103. 
## 5     3 V1    -3.33  46.6    -5  31.4
## 6     3 V2     3.99 281.      5 103.</code></pre>
<p>For the second time, here’s the top panel of Figure 17.4, this time based off of <code>fitted()</code>.</p>
<div class="sourceCode" id="cb1618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1618-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1618-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-2" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1618-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Subj =</span> <span class="fu">factor</span>(Subj, <span class="at">levels =</span> <span class="dv">25</span><span class="sc">:</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1618-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1618-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb1618-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> f,</span>
<span id="cb1618-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">group =</span> draw),</span>
<span id="cb1618-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1618-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Subj),</span>
<span id="cb1618-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1618-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Subj, <span class="at">color =</span> Subj),</span>
<span id="cb1618-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1618-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">beyonce_palette</span>(<span class="dv">41</span>, <span class="at">n =</span> <span class="dv">25</span>, <span class="at">type =</span> <span class="st">&quot;continuous&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1618-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">50</span>, <span class="at">to =</span> <span class="dv">250</span>, <span class="at">by =</span> <span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb1618-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">eval</span>(<span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="st">&quot;Data from all units with&quot;</span>, n_lines, <span class="st">&quot;credible population-level</span><span class="sc">\n</span><span class="st">regression lines&quot;</span>)))) <span class="sc">+</span></span>
<span id="cb1618-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">95</span>),</span>
<span id="cb1618-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">270</span>)) <span class="sc">+</span></span>
<span id="cb1618-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb1618-19"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1618-20"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1618-20" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-45-1.png" width="408" style="display: block; margin: auto;" /></p>
<p>The whole process is quite similar for the <code>Subj</code>-specific lines. There are two main differences. First, we need to specify which <code>Subj</code> values we’d like to get <code>fitted()</code> points for. That goes into our <code>nd</code> tibble. Second, we omit the <code>re_formula</code> argument. There are other subtleties, like with the contents of the <code>bind_cols()</code> function. But hopefully those are self-evident.</p>
<div class="sourceCode" id="cb1619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1619-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many posterior lines would you like?</span></span>
<span id="cb1619-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-2" aria-hidden="true" tabindex="-1"></a>n_lines <span class="ot">&lt;-</span> <span class="dv">250</span></span>
<span id="cb1619-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1619-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-4" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> </span>
<span id="cb1619-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x_z =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1619-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">X =</span> x_z <span class="sc">*</span> <span class="fu">sd</span>(my_data<span class="sc">$</span>X) <span class="sc">+</span> <span class="fu">mean</span>(my_data<span class="sc">$</span>X)) <span class="sc">%&gt;%</span> </span>
<span id="cb1619-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(x_z, X),</span>
<span id="cb1619-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Subj =</span> <span class="fu">distinct</span>(my_data, Subj) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1619-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">str_c</span>(<span class="st">&quot;V&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()))</span>
<span id="cb1619-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1619-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-11" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb1619-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(fit17<span class="fl">.4</span>,</span>
<span id="cb1619-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> nd,</span>
<span id="cb1619-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">summary =</span> F,</span>
<span id="cb1619-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">ndraws =</span> n_lines) <span class="sc">%&gt;%</span> </span>
<span id="cb1619-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1619-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draw =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1619-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>draw) <span class="sc">%&gt;%</span> </span>
<span id="cb1619-19"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Y =</span> value <span class="sc">*</span> <span class="fu">sd</span>(my_data<span class="sc">$</span>Y) <span class="sc">+</span> <span class="fu">mean</span>(my_data<span class="sc">$</span>Y)) <span class="sc">%&gt;%</span> </span>
<span id="cb1619-20"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(nd, <span class="at">by =</span> <span class="st">&quot;name&quot;</span>)</span>
<span id="cb1619-21"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1619-22"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1619-22" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(f)  </span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
##    draw name    value       Y   x_z     X  Subj
##   &lt;int&gt; &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1 V1     -4.04    23.9     -5  31.4     1
## 2     1 V2     -0.881  125.      -5  31.4     2
## 3     1 V3     -4.70     2.69    -5  31.4     3
## 4     1 V4     -4.12    21.4     -5  31.4     4
## 5     1 V5     -3.83    30.6     -5  31.4     5
## 6     1 V6    -10.1   -169.      -5  31.4     6</code></pre>
<p>And now for the second time, here’s the bottom panel of Figure 17.4, this time based off of <code>fitted()</code>.</p>
<div class="sourceCode" id="cb1621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1621-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1621-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-2" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1621-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Subj =</span> <span class="fu">factor</span>(Subj, <span class="at">levels =</span> <span class="dv">25</span><span class="sc">:</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1621-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1621-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb1621-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> f,</span>
<span id="cb1621-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">group =</span> draw),</span>
<span id="cb1621-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1621-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Subj)) <span class="sc">+</span></span>
<span id="cb1621-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">beyonce_palette</span>(<span class="dv">41</span>, <span class="at">n =</span> <span class="dv">25</span>, <span class="at">type =</span> <span class="st">&quot;continuous&quot;</span>), <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1621-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">50</span>, <span class="at">to =</span> <span class="dv">90</span>,  <span class="at">by =</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb1621-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">50</span>, <span class="at">to =</span> <span class="dv">250</span>, <span class="at">by =</span> <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb1621-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Each unit now has its own bundle of credible regression lines&quot;</span>) <span class="sc">+</span></span>
<span id="cb1621-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">90</span>),</span>
<span id="cb1621-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">270</span>)) <span class="sc">+</span></span>
<span id="cb1621-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Subj <span class="sc">%&gt;%</span> <span class="fu">factor</span>(., <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>))</span>
<span id="cb1621-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1621-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-18" aria-hidden="true" tabindex="-1"></a><span class="co"># combine with patchwork</span></span>
<span id="cb1621-19"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-19" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">plot_spacer</span>()</span>
<span id="cb1621-20"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1621-21"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-21" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb1621-22"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-22" aria-hidden="true" tabindex="-1"></a>  (p3 <span class="sc">|</span> p1 <span class="sc">|</span> p3) <span class="sc">+</span> </span>
<span id="cb1621-23"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>))</span>
<span id="cb1621-24"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1621-25"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1621-25" aria-hidden="true" tabindex="-1"></a>(p4 <span class="sc">/</span> p2) <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-47-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Especially if you’re new to these kinds of models, it’s easy to get lost in all that code. And for real–the wrangling required for those plots was no joke. The primary difficulty was that we had to convert standardized solutions to unstandardized solutions, which leads to an important distinction. When we used the first method of working with the <code>as_draws_df()</code> and <code>coef()</code> output, we focused on <strong>transforming the model parameters</strong>. In contrast, when we used the second method of working with the <code>fitted()</code> output, we focused instead on <strong>transforming the model predictions and predictor values</strong>. This distinction can be really confusing, at first. Stick with it! There will be times one method is more convenient or intuitive than the other. It’s good to have both methods in your repertoire.</p>
</div>
</div>
<div id="quadratic-trend-and-weighted-data" class="section level2 hasAnchor" number="17.4">
<h2><span class="header-section-number">17.4</span> Quadratic trend and weighted data<a href="metric-predicted-variable-with-one-metric-predictor.html#quadratic-trend-and-weighted-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Quadratic models follow the general form</p>
<p><span class="math display">\[y = \beta_0 + \beta_1 x + \beta_2 x^2,\]</span></p>
<p>where <span class="math inline">\(\beta_2\)</span> is the quadratic term which, when 0, reduces the results to a simple linear model. That’s right; the linear model is a special case of the quadratic.</p>
<p>This time the data come from the American Community Survey and Puerto Rico Community Survey. In his footnote #3, Kruschke indicated “Data are from <a href="http://www.census.gov/hhes/www/income/data/Fam_Inc_SizeofFam1.xls">http://www.census.gov/hhes/www/income/data/Fam_Inc_SizeofFam1.xls</a>, retrieved December 11, 2013. Median family income for years 2009-2011.” As to our <code>read.csv()</code> code, note the <code>comment.char</code> argument.</p>
<div class="sourceCode" id="cb1622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1622-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1622-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data.R/IncomeFamszState3yr.csv&quot;</span>, <span class="at">comment.char =</span> <span class="st">&quot;#&quot;</span>)</span>
<span id="cb1622-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1622-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1622-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1622-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(my_data)</span></code></pre></div>
<pre><code>## Rows: 312
## Columns: 4
## $ FamilySize   &lt;int&gt; 2, 3, 4, 5, 6, 7, 2, 3, 4, 5, 6, 7, 2, 3, 4, 5, 6, 7, 2, 3, 4, 5, 6, 7, 2, 3,…
## $ State        &lt;chr&gt; &quot;Alabama&quot;, &quot;Alabama&quot;, &quot;Alabama&quot;, &quot;Alabama&quot;, &quot;Alabama&quot;, &quot;Alabama&quot;, &quot;Alaska&quot;, &quot;…
## $ MedianIncome &lt;int&gt; 48177, 53323, 64899, 59417, 54099, 47655, 73966, 82276, 87726, 87216, 84488, …
## $ SampErr      &lt;int&gt; 581, 1177, 1170, 2446, 3781, 3561, 1858, 3236, 3722, 6127, 6761, 5754, 590, 1…</code></pre>
<p>Here we’ll standardize all variables but <code>State</code>, our grouping variable. It’d be silly to try to standardize that.</p>
<div class="sourceCode" id="cb1624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1624-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1624-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span></span>
<span id="cb1624-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1624-2" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1624-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1624-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">family_size_z   =</span> <span class="fu">standardize</span>(FamilySize),</span>
<span id="cb1624-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1624-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">median_income_z =</span> <span class="fu">standardize</span>(MedianIncome),</span>
<span id="cb1624-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1624-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">se_z            =</span> SampErr <span class="sc">/</span> (<span class="fu">mean</span>(SampErr)))</span>
<span id="cb1624-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1624-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1624-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1624-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(my_data)</span></code></pre></div>
<pre><code>## Rows: 312
## Columns: 7
## $ FamilySize      &lt;int&gt; 2, 3, 4, 5, 6, 7, 2, 3, 4, 5, 6, 7, 2, 3, 4, 5, 6, 7, 2, 3, 4, 5, 6, 7, 2,…
## $ State           &lt;chr&gt; &quot;Alabama&quot;, &quot;Alabama&quot;, &quot;Alabama&quot;, &quot;Alabama&quot;, &quot;Alabama&quot;, &quot;Alabama&quot;, &quot;Alaska&quot;…
## $ MedianIncome    &lt;int&gt; 48177, 53323, 64899, 59417, 54099, 47655, 73966, 82276, 87726, 87216, 8448…
## $ SampErr         &lt;int&gt; 581, 1177, 1170, 2446, 3781, 3561, 1858, 3236, 3722, 6127, 6761, 5754, 590…
## $ family_size_z   &lt;dbl&gt; -1.4615023, -0.8769014, -0.2923005, 0.2923005, 0.8769014, 1.4615023, -1.46…
## $ median_income_z &lt;dbl&gt; -1.26216763, -0.91386251, -0.13034520, -0.50139236, -0.86133924, -1.297499…
## $ se_z            &lt;dbl&gt; 0.2242541, 0.4542979, 0.4515961, 0.9441060, 1.4593886, 1.3744731, 0.717150…</code></pre>
<p>With <strong>brms</strong>, there are a couple ways to handle measurement error on a variable (e.g., see <a href="https://bookdown.org/content/3890/missing-data-and-other-opportunities.html">Chapter 14</a> of my ebook, <a href="https://bookdown.org/content/3890/"><em>Statistical rethinking with brms, ggplot2, and the tidyverse</em></a> <span class="citation">(<a href="#ref-kurzStatisticalRethinkingBrms2020" role="doc-biblioref">Kurz, 2020</a>)</span>. Here we’ll use the <code>se()</code> syntax, following the form <code>response | se(se_response, sigma = TRUE)</code>. In this form, <code>se</code> stands for standard error, the loose frequentist analogue to the Bayesian posterior <span class="math inline">\(\textit{SD}\)</span>. Unless you’re fitting a meta-analysis on summary information, make sure to specify <code>sigma = TRUE</code>. Without that you’ll have no estimate for <span class="math inline">\(\sigma\)</span>! For more information on the <code>se()</code> method, go to the <a href="https://CRAN.R-project.org/package=brms/brms.pdf"><strong>brms</strong> reference manual</a> and find the <em>Additional response information</em> subsection of the <code>brmsformula</code> section <span class="citation">(<a href="#ref-brms2022RM" role="doc-biblioref">Bürkner, 2022d, p. 42</a>)</span>.</p>
<div class="sourceCode" id="cb1626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1626-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1626-1" aria-hidden="true" tabindex="-1"></a>fit17<span class="fl">.5</span> <span class="ot">&lt;-</span></span>
<span id="cb1626-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1626-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1626-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1626-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> student,</span>
<span id="cb1626-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1626-4" aria-hidden="true" tabindex="-1"></a>      median_income_z <span class="sc">|</span> <span class="fu">se</span>(se_z, <span class="at">sigma =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> family_size_z <span class="sc">+</span>  <span class="fu">I</span>(family_size_z<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb1626-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1626-5" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">1</span> <span class="sc">+</span> family_size_z <span class="sc">+</span>  <span class="fu">I</span>(family_size_z<span class="sc">^</span><span class="dv">2</span>) <span class="sc">||</span> State),</span>
<span id="cb1626-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1626-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1626-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1626-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> b),</span>
<span id="cb1626-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1626-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb1626-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1626-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb1626-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1626-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(one_over_twentynine), <span class="at">class =</span> nu)),</span>
<span id="cb1626-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1626-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1626-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1626-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> <span class="fu">stanvar</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">29</span>, <span class="at">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>),</span>
<span id="cb1626-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1626-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">17</span>,</span>
<span id="cb1626-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1626-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit17.05&quot;</span>)</span></code></pre></div>
<p>Did you notice the <code>I(family_size_z^2)</code> part of the <code>formula</code>? The <strong>brms</strong> package follows a typical convention in <strong>R</strong> statistical functions in that if you want to multiply a variable by itself as in a quadratic model, you nest the <code>family_size_z^2</code> part within the <code>I()</code> function.</p>
<p>Take a look at the model summary.</p>
<div class="sourceCode" id="cb1627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1627-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1627-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit17<span class="fl">.5</span>)</span></code></pre></div>
<pre><code>##  Family: student 
##   Links: mu = identity; sigma = identity; nu = identity 
## Formula: median_income_z | se(se_z, sigma = TRUE) ~ 1 + family_size_z + I(family_size_z^2) + (1 + family_size_z + I(family_size_z^2) || State) 
##    Data: my_data (Number of observations: 312) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Group-Level Effects: 
## ~State (Number of levels: 52) 
##                      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)            0.75      0.09     0.60     0.93 1.00      732     1488
## sd(family_size_z)        0.07      0.04     0.00     0.16 1.01      778     1098
## sd(Ifamily_size_zE2)     0.05      0.03     0.00     0.13 1.01      695     1350
## 
## Population-Level Effects: 
##                  Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept            0.39      0.12     0.17     0.62 1.01      373      826
## family_size_z        0.12      0.05     0.02     0.22 1.00     3352     2759
## Ifamily_size_zE2    -0.44      0.04    -0.52    -0.36 1.00     3436     3041
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     0.05      0.04     0.00     0.13 1.00     2110     1921
## nu       68.97     36.04    22.04   158.27 1.00     6673     3217
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Do see that <code>Ifamily_size_zE2</code> row? That’s the summary of our quadratic term.</p>
<div id="results-and-interpretation." class="section level3 hasAnchor" number="17.4.1">
<h3><span class="header-section-number">17.4.1</span> Results and interpretation.<a href="metric-predicted-variable-with-one-metric-predictor.html#results-and-interpretation." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A new model type requires a different approach to un-standardizing our standardized coefficients. Based on Equation 17.3, we can convert our coefficients using the formulas</p>
<p><span class="math display">\[\begin{align*}
\beta_0 &amp; = \zeta_0 \operatorname{SD}_y + M_y - \frac{\zeta_1 M_x \operatorname{SD}_y}{\operatorname{SD}_x} + \frac{\zeta_2 M^{2}_x \operatorname{SD}_y}{\operatorname{SD}^{2}_x}, \\
\beta_1 &amp; = \frac{\zeta_1 \operatorname{SD}_y}{\operatorname{SD}_x} - \frac{2 \zeta_2 M_x \operatorname{SD}_y}{\operatorname{SD}^{2}_x}, \text{and} \\
\beta_2 &amp; = \frac{\zeta_2 \operatorname{SD}_y}{\operatorname{SD}^{2}_x}.
\end{align*}\]</span></p>
<p>We’ll make new custom functions to use them.</p>
<div class="sourceCode" id="cb1629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1629-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1629-1" aria-hidden="true" tabindex="-1"></a>make_beta_0 <span class="ot">&lt;-</span> <span class="cf">function</span>(zeta_0, zeta_1, zeta_2, sd_x, sd_y, m_x, m_y) {</span>
<span id="cb1629-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1629-2" aria-hidden="true" tabindex="-1"></a>  zeta_0 <span class="sc">*</span> sd_y <span class="sc">+</span> m_y <span class="sc">-</span> zeta_1 <span class="sc">*</span> m_x <span class="sc">*</span> sd_y <span class="sc">/</span> sd_x <span class="sc">+</span> zeta_2 <span class="sc">*</span> m_x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> sd_y <span class="sc">/</span> sd_x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1629-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1629-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1629-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1629-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1629-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1629-5" aria-hidden="true" tabindex="-1"></a>make_beta_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(zeta_1, zeta_2, sd_x, sd_y, m_x) {</span>
<span id="cb1629-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1629-6" aria-hidden="true" tabindex="-1"></a>  zeta_1 <span class="sc">*</span> sd_y <span class="sc">/</span> sd_x <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> zeta_2 <span class="sc">*</span> m_x <span class="sc">*</span> sd_y <span class="sc">/</span> sd_x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1629-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1629-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1629-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1629-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1629-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1629-9" aria-hidden="true" tabindex="-1"></a>make_beta_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(zeta_2, sd_x, sd_y) {</span>
<span id="cb1629-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1629-10" aria-hidden="true" tabindex="-1"></a>  zeta_2 <span class="sc">*</span> sd_y <span class="sc">/</span> sd_x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1629-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1629-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1629-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1629-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1629-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1629-13" aria-hidden="true" tabindex="-1"></a><span class="co"># may as well respecify these, too</span></span>
<span id="cb1629-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1629-14" aria-hidden="true" tabindex="-1"></a>m_x  <span class="ot">&lt;-</span> <span class="fu">mean</span>(my_data<span class="sc">$</span>FamilySize)</span>
<span id="cb1629-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1629-15" aria-hidden="true" tabindex="-1"></a>m_y  <span class="ot">&lt;-</span> <span class="fu">mean</span>(my_data<span class="sc">$</span>MedianIncome)</span>
<span id="cb1629-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1629-16" aria-hidden="true" tabindex="-1"></a>sd_x <span class="ot">&lt;-</span> <span class="fu">sd</span>(my_data<span class="sc">$</span>FamilySize)</span>
<span id="cb1629-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1629-17" aria-hidden="true" tabindex="-1"></a>sd_y <span class="ot">&lt;-</span> <span class="fu">sd</span>(my_data<span class="sc">$</span>MedianIncome)</span></code></pre></div>
<p>Now we’ll extract our posterior draws and make the conversions.</p>
<div class="sourceCode" id="cb1630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1630-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-1" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> </span>
<span id="cb1630-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_draws_df</span>(fit17<span class="fl">.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1630-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">b_0 =</span> <span class="fu">make_beta_0</span>(<span class="at">zeta_0 =</span> b_Intercept,</span>
<span id="cb1630-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">zeta_1 =</span> b_family_size_z,</span>
<span id="cb1630-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">zeta_2 =</span> b_Ifamily_size_zE2,</span>
<span id="cb1630-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_x   =</span> sd_x,</span>
<span id="cb1630-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_y   =</span> sd_y,</span>
<span id="cb1630-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">m_x    =</span> m_x,</span>
<span id="cb1630-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">m_y    =</span> m_y),</span>
<span id="cb1630-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">b_1 =</span> <span class="fu">make_beta_1</span>(<span class="at">zeta_1 =</span> b_family_size_z,</span>
<span id="cb1630-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">zeta_2 =</span> b_Ifamily_size_zE2,</span>
<span id="cb1630-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_x   =</span> sd_x,</span>
<span id="cb1630-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_y   =</span> sd_y,</span>
<span id="cb1630-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">m_x    =</span> m_x),</span>
<span id="cb1630-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">b_2 =</span> <span class="fu">make_beta_2</span>(<span class="at">zeta_2 =</span> b_Ifamily_size_zE2,</span>
<span id="cb1630-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_x   =</span> sd_x,</span>
<span id="cb1630-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-17" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_y   =</span> sd_y)) <span class="sc">%&gt;%</span> </span>
<span id="cb1630-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1630-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw, b_0<span class="sc">:</span>b_2)</span></code></pre></div>
<p>Our <code>geom_abline()</code> approach from before won’t work with curves. We’ll have to resort to <code>geom_line()</code>. With the <code>geom_line()</code> approach, we’ll need many specific values of model-implied <code>MedianIncome</code> across a densely-packed range of <code>FamilySize</code>. We want to use a lot of <code>FamilySize</code> values, like 30 or 50 or so, to make sure the curves look smooth. Below, we’ll use 50 (i.e., <code>length.out = 50</code>). But if it’s still not clear why, try plugging in a lesser value, like 5 or so. You’ll see.</p>
<div class="sourceCode" id="cb1631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1631-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1631-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many posterior lines would you like?</span></span>
<span id="cb1631-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1631-2" aria-hidden="true" tabindex="-1"></a>n_lines <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb1631-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1631-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1631-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1631-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">17</span>)</span>
<span id="cb1631-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1631-5" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span></span>
<span id="cb1631-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1631-6" aria-hidden="true" tabindex="-1"></a>  draws <span class="sc">%&gt;%</span> </span>
<span id="cb1631-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1631-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> n_lines) <span class="sc">%&gt;%</span> </span>
<span id="cb1631-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1631-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;draw&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1631-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1631-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(.draw, b_0, b_1, b_2),</span>
<span id="cb1631-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1631-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">FamilySize =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">9</span>, <span class="at">length.out =</span> <span class="dv">50</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1631-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1631-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MedianIncome =</span> b_0 <span class="sc">+</span> b_1 <span class="sc">*</span> FamilySize <span class="sc">+</span> b_2 <span class="sc">*</span> FamilySize<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1631-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1631-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1631-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1631-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(draws)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 6
##   .draw    b_0    b_1    b_2 FamilySize MedianIncome
##   &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;
## 1     5 20901. 21997. -2364.       1          40533.
## 2     5 20901. 21997. -2364.       1.16       43290.
## 3     5 20901. 21997. -2364.       1.33       45920.
## 4     5 20901. 21997. -2364.       1.49       48424.
## 5     5 20901. 21997. -2364.       1.65       50803.
## 6     5 20901. 21997. -2364.       1.82       53055.</code></pre>
<p>Now we’re ready to make the top panel of Figure 17.7.</p>
<div class="sourceCode" id="cb1633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1633-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1633-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span></span>
<span id="cb1633-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1633-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> FamilySize, <span class="at">y =</span> MedianIncome)) <span class="sc">+</span></span>
<span id="cb1633-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1633-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> draws,</span>
<span id="cb1633-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1633-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">group =</span> .draw),</span>
<span id="cb1633-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1633-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">size  =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;grey67&quot;</span>) <span class="sc">+</span></span>
<span id="cb1633-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1633-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> State, <span class="at">color =</span> State),</span>
<span id="cb1633-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1633-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1633-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1633-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> State),</span>
<span id="cb1633-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1633-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1633-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1633-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">beyonce_palette</span>(<span class="dv">41</span>, <span class="at">n =</span> <span class="dv">52</span>, <span class="at">type =</span> <span class="st">&quot;continuous&quot;</span>), <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1633-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1633-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;Family size&quot;</span>, <span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb1633-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1633-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;All states&quot;</span>,</span>
<span id="cb1633-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1633-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Median income&quot;</span>) <span class="sc">+</span></span>
<span id="cb1633-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1633-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>),</span>
<span id="cb1633-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1633-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">150000</span>))</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-54-1.png" width="408" style="display: block; margin: auto;" /></p>
<p>Like before, we’ll extract the group-level coefficients (i.e., those specific to the <code>State</code>s) with the <code>coef()</code> function. And also like before, the <code>coef()</code> output will require a little wrangling.</p>
<div class="sourceCode" id="cb1634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1634-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-1" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span></span>
<span id="cb1634-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># first collect and wrangle the draws for the State-level intercept and slopes</span></span>
<span id="cb1634-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">coef</span>(fit17<span class="fl">.5</span>, <span class="at">summary =</span> F)<span class="sc">$</span>State[, , <span class="st">&quot;Intercept&quot;</span>],</span>
<span id="cb1634-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coef</span>(fit17<span class="fl">.5</span>, <span class="at">summary =</span> F)<span class="sc">$</span>State[, , <span class="st">&quot;family_size_z&quot;</span>],</span>
<span id="cb1634-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coef</span>(fit17<span class="fl">.5</span>, <span class="at">summary =</span> F)<span class="sc">$</span>State[, , <span class="st">&quot;Ifamily_size_zE2&quot;</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1634-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1634-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draw  =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4000</span>, <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb1634-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">param =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;family_size_z&quot;</span>, <span class="st">&quot;Ifamily_size_zE2&quot;</span>), <span class="at">each =</span> <span class="dv">4000</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1634-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Alabama<span class="sc">:</span>Wyoming, <span class="at">names_to =</span> <span class="st">&quot;State&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1634-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> param, <span class="at">values_from =</span> value)  <span class="sc">%&gt;%</span> </span>
<span id="cb1634-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># let&#39;s go ahead and make the standardized-to-unstandardized conversions, here</span></span>
<span id="cb1634-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">b_0 =</span> <span class="fu">make_beta_0</span>(<span class="at">zeta_0 =</span> Intercept,</span>
<span id="cb1634-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">zeta_1 =</span> family_size_z,</span>
<span id="cb1634-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">zeta_2 =</span> Ifamily_size_zE2,</span>
<span id="cb1634-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_x   =</span> sd_x,</span>
<span id="cb1634-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_y   =</span> sd_y,</span>
<span id="cb1634-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-17" aria-hidden="true" tabindex="-1"></a>                           <span class="at">m_x    =</span> m_x,</span>
<span id="cb1634-18"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">m_y    =</span> m_y),</span>
<span id="cb1634-19"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">b_1 =</span> <span class="fu">make_beta_1</span>(<span class="at">zeta_1 =</span> family_size_z,</span>
<span id="cb1634-20"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">zeta_2 =</span> Ifamily_size_zE2,</span>
<span id="cb1634-21"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_x   =</span> sd_x,</span>
<span id="cb1634-22"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_y   =</span> sd_y,</span>
<span id="cb1634-23"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">m_x    =</span> m_x),</span>
<span id="cb1634-24"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">b_2 =</span> <span class="fu">make_beta_2</span>(<span class="at">zeta_2 =</span> Ifamily_size_zE2,</span>
<span id="cb1634-25"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-25" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_x   =</span> sd_x,</span>
<span id="cb1634-26"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-26" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sd_y   =</span> sd_y)) <span class="sc">%&gt;%</span> </span>
<span id="cb1634-27"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we just want the first 25 states, from Alabama through Mississippi, so we&#39;ll `filter()`</span></span>
<span id="cb1634-28"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(State <span class="sc">&lt;=</span> <span class="st">&quot;Mississippi&quot;</span>)</span>
<span id="cb1634-29"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1634-30"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1634-30" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(c)</span></code></pre></div>
<pre><code>## tibble [100,000 × 8] (S3: tbl_df/tbl/data.frame)
##  $ draw            : int [1:100000] 1 1 1 1 1 1 1 1 1 1 ...
##  $ State           : chr [1:100000] &quot;Alabama&quot; &quot;Alaska&quot; &quot;Arizona&quot; &quot;Arkansas&quot; ...
##  $ Intercept       : num [1:100000] 0.0546 0.6689 0.1472 -0.0836 0.6011 ...
##  $ family_size_z   : num [1:100000] 0.149 0.107 0.155 0.114 0.107 ...
##  $ Ifamily_size_zE2: num [1:100000] -0.513 -0.468 -0.4 -0.524 -0.415 ...
##  $ b_0             : num [1:100000] 9407 24709 22033 7598 29127 ...
##  $ b_1             : num [1:100000] 24594 22182 19533 24790 19777 ...
##  $ b_2             : num [1:100000] -2590 -2362 -2021 -2645 -2095 ...</code></pre>
<p>Now we’ll subset by <code>n_lines</code>, <code>expand()</code> by <code>FamilySize</code>, and use the model formula to compute the expected <code>MedianIncome</code> values.</p>
<div class="sourceCode" id="cb1636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1636-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1636-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many posterior lines would you like?</span></span>
<span id="cb1636-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1636-2" aria-hidden="true" tabindex="-1"></a>n_lines <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb1636-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1636-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1636-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1636-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">17</span>)</span>
<span id="cb1636-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1636-5" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span></span>
<span id="cb1636-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1636-6" aria-hidden="true" tabindex="-1"></a>  c <span class="sc">%&gt;%</span> </span>
<span id="cb1636-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1636-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(State) <span class="sc">%&gt;%</span></span>
<span id="cb1636-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1636-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> n_lines) <span class="sc">%&gt;%</span></span>
<span id="cb1636-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1636-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1636-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1636-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(draw, State, b_0, b_1, b_2),</span>
<span id="cb1636-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1636-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">FamilySize =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">9</span>, <span class="at">length.out =</span> <span class="dv">50</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1636-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1636-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MedianIncome =</span> b_0 <span class="sc">+</span> b_1 <span class="sc">*</span> FamilySize <span class="sc">+</span> b_2 <span class="sc">*</span> FamilySize<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1636-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1636-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1636-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1636-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(c)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
##    draw State   b_0    b_1    b_2 FamilySize MedianIncome
##   &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;
## 1     1 Idaho -951. 25134. -2719.       1          21464.
## 2     1 Idaho -951. 25134. -2719.       1.16       24607.
## 3     1 Idaho -951. 25134. -2719.       1.33       27605.
## 4     1 Idaho -951. 25134. -2719.       1.49       30458.
## 5     1 Idaho -951. 25134. -2719.       1.65       33166.
## 6     1 Idaho -951. 25134. -2719.       1.82       35729.</code></pre>
<p>Finally, we’re ready for the <code>State</code>-specific miniatures in Figure 17.7.</p>
<div class="sourceCode" id="cb1638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1638-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1638-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span></span>
<span id="cb1638-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1638-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(State <span class="sc">&lt;=</span> <span class="st">&quot;Mississippi&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1638-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1638-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1638-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1638-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> FamilySize, <span class="at">y =</span> MedianIncome)) <span class="sc">+</span></span>
<span id="cb1638-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1638-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> c,</span>
<span id="cb1638-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1638-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">group =</span> draw),</span>
<span id="cb1638-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1638-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">size  =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;grey67&quot;</span>) <span class="sc">+</span></span>
<span id="cb1638-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1638-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> State)) <span class="sc">+</span></span>
<span id="cb1638-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1638-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> State)) <span class="sc">+</span></span>
<span id="cb1638-10"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1638-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">beyonce_palette</span>(<span class="dv">41</span>, <span class="at">n =</span> <span class="dv">52</span>, <span class="at">type =</span> <span class="st">&quot;continuous&quot;</span>), <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1638-11"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1638-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;Family size&quot;</span>, <span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb1638-12"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1638-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Each State now has its own bundle of credible regression curves.&quot;</span>,</span>
<span id="cb1638-13"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1638-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Median income&quot;</span>) <span class="sc">+</span></span>
<span id="cb1638-14"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1638-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>),</span>
<span id="cb1638-15"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1638-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">150000</span>)) <span class="sc">+</span></span>
<span id="cb1638-16"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1638-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb1638-17"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1638-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> State)</span></code></pre></div>
<p><img src="17_files/figure-html/unnamed-chunk-57-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Magic! As our model coefficients proliferate, the <code>fitted()</code> approach from above starts to look more and more appetizing. Check it out for yourself.</p>
<p>Although “almost all of the posterior distribution [was] below <span class="math inline">\(\nu = 4\)</span>” in the text (p. 500), the bulk of our <span class="math inline">\(\nu\)</span> distribution spanned across much larger values.</p>
<div class="sourceCode" id="cb1639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1639-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1639-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit17<span class="fl">.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1639-2"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1639-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> nu, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1639-3"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1639-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_histinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>,</span>
<span id="cb1639-4"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1639-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">slab_color =</span> bp[<span class="dv">5</span>],</span>
<span id="cb1639-5"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1639-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="sc">+</span></span>
<span id="cb1639-6"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1639-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))) <span class="sc">+</span></span>
<span id="cb1639-7"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1639-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1639-8"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1639-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">expression</span>(Our<span class="sc">~</span>big<span class="sc">~</span>nu),</span>
<span id="cb1639-9"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1639-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<pre><code>## Warning: Unknown or uninitialised column: `linewidth`.</code></pre>
<p><img src="17_files/figure-html/unnamed-chunk-58-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>I’m guessing the distinction in our <span class="math inline">\(\nu\)</span> distribution and that in the text is our use of the <code>se()</code> syntax in the <code>brm()</code> <code>formula</code>. If you have a better explanation, <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/issues">share it</a>.</p>
</div>
<div id="further-extensions." class="section level3 hasAnchor" number="17.4.2">
<h3><span class="header-section-number">17.4.2</span> Further extensions.<a href="metric-predicted-variable-with-one-metric-predictor.html#further-extensions." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Kruschke discussed the ease with which users of Bayesian software might specify nonlinear models. Check out Bürkner’s <span class="citation">(<a href="#ref-Bürkner2022Non_linear" role="doc-biblioref">2022</a>)</span> vignette, <a href="https://CRAN.R-project.org/package=brms/vignettes/brms_nonlinear.html"><em>Estimating non-linear models with brms</em></a>, for more on the topic. Though I haven’t used it, I believe it is also possible to use the <span class="math inline">\(t\)</span> distribution to model group-level variation in <strong>brms</strong> (see <a href="https://github.com/paul-buerkner/brms/issues/231">this GitHub discussion</a> for details).</p>
</div>
</div>
<div id="procedure-and-perils-for-expanding-a-model" class="section level2 hasAnchor" number="17.5">
<h2><span class="header-section-number">17.5</span> Procedure and perils for expanding a model<a href="metric-predicted-variable-with-one-metric-predictor.html#procedure-and-perils-for-expanding-a-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Across several chapters, we’ve already dipped our toes into posterior predictive checks. For more on the PPC “double dipping” issue, check out Gelman’s <a href="http://andrewgelman.com/2014/08/11/discussion-sander-greenland-posterior-predictive-checks/"><em>Discussion with Sander Greenland on posterior predictive checks</em></a> or Simpson’s <a href="http://andrewgelman.com/2017/09/07/touch-want-feel-data/"><em>Touch me, I want to feel your data</em></a>, which is itself connected to <span class="citation">Gabry et al. (<a href="#ref-gabry2019visualization" role="doc-biblioref">2019</a>)</span>, <a href="https://arxiv.org/abs/1709.01449"><em>Visualization in Bayesian workflow</em></a>.</p>
</div>
<div id="session-info-16" class="section level2 unnumbered hasAnchor">
<h2>Session info<a href="metric-predicted-variable-with-one-metric-predictor.html#session-info-16" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb1641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1641-1"><a href="metric-predicted-variable-with-one-metric-predictor.html#cb1641-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.2.0 (2022-04-22)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur/Monterey 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] bayesplot_1.9.0 tidybayes_3.0.2 brms_2.18.0     Rcpp_1.0.9      patchwork_1.1.2 beyonce_0.1    
##  [7] forcats_0.5.1   stringr_1.4.1   dplyr_1.0.10    purrr_0.3.4     readr_2.1.2     tidyr_1.2.1    
## [13] tibble_3.1.8    ggplot2_3.4.0   tidyverse_1.3.2
## 
## loaded via a namespace (and not attached):
##   [1] readxl_1.4.1         backports_1.4.1      plyr_1.8.7           igraph_1.3.4        
##   [5] svUnit_1.0.6         splines_4.2.0        crosstalk_1.2.0      TH.data_1.1-1       
##   [9] rstantools_2.2.0     inline_0.3.19        digest_0.6.30        htmltools_0.5.3     
##  [13] fansi_1.0.3          magrittr_2.0.3       checkmate_2.1.0      googlesheets4_1.0.1 
##  [17] tzdb_0.3.0           modelr_0.1.8         RcppParallel_5.1.5   matrixStats_0.62.0  
##  [21] vroom_1.5.7          xts_0.12.1           sandwich_3.0-2       prettyunits_1.1.1   
##  [25] colorspace_2.0-3     rvest_1.0.2          ggdist_3.2.0         haven_2.5.1         
##  [29] xfun_0.35            callr_3.7.3          crayon_1.5.2         jsonlite_1.8.3      
##  [33] lme4_1.1-31          survival_3.4-0       zoo_1.8-10           glue_1.6.2          
##  [37] gtable_0.3.1         gargle_1.2.0         emmeans_1.8.0        distributional_0.3.1
##  [41] pkgbuild_1.3.1       rstan_2.21.7         abind_1.4-5          scales_1.2.1        
##  [45] mvtnorm_1.1-3        emo_0.0.0.9000       DBI_1.1.3            miniUI_0.1.1.1      
##  [49] xtable_1.8-4         HDInterval_0.2.2     bit_4.0.4            stats4_4.2.0        
##  [53] StanHeaders_2.21.0-7 DT_0.24              htmlwidgets_1.5.4    httr_1.4.4          
##  [57] threejs_0.3.3        arrayhelpers_1.1-0   posterior_1.3.1      ellipsis_0.3.2      
##  [61] pkgconfig_2.0.3      loo_2.5.1            farver_2.1.1         sass_0.4.2          
##  [65] dbplyr_2.2.1         utf8_1.2.2           tidyselect_1.1.2     labeling_0.4.2      
##  [69] rlang_1.0.6          reshape2_1.4.4       later_1.3.0          munsell_0.5.0       
##  [73] cellranger_1.1.0     tools_4.2.0          cachem_1.0.6         cli_3.5.0           
##  [77] generics_0.1.3       broom_1.0.1          ggridges_0.5.3       evaluate_0.18       
##  [81] fastmap_1.1.0        bit64_4.0.5          processx_3.8.0       knitr_1.40          
##  [85] fs_1.5.2             nlme_3.1-159         mime_0.12            projpred_2.2.1      
##  [89] xml2_1.3.3           compiler_4.2.0       shinythemes_1.2.0    rstudioapi_0.13     
##  [93] gamm4_0.2-6          reprex_2.0.2         bslib_0.4.0          stringi_1.7.8       
##  [97] highr_0.9            ps_1.7.2             Brobdingnag_1.2-8    lattice_0.20-45     
## [101] Matrix_1.4-1         nloptr_2.0.3         markdown_1.1         shinyjs_2.1.0       
## [105] tensorA_0.36.2       vctrs_0.5.1          pillar_1.8.1         lifecycle_1.0.3     
## [109] jquerylib_0.1.4      bridgesampling_1.1-2 estimability_1.4.1   httpuv_1.6.5        
## [113] R6_2.5.1             bookdown_0.28        promises_1.2.0.1     gridExtra_2.3       
## [117] codetools_0.2-18     boot_1.3-28          colourpicker_1.1.1   MASS_7.3-58.1       
## [121] gtools_3.9.3         assertthat_0.2.1     withr_2.5.0          shinystan_2.6.0     
## [125] multcomp_1.4-20      mgcv_1.8-40          parallel_4.2.0       hms_1.1.1           
## [129] grid_4.2.0           minqa_1.2.5          coda_0.19-4          rmarkdown_2.16      
## [133] googledrive_2.0.0    shiny_1.7.2          lubridate_1.8.0      base64enc_0.1-3     
## [137] dygraphs_1.1.1.6</code></pre>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Bürkner2022Non_linear" class="csl-entry">
Bürkner, P.-C. (2022). <em>Estimating non-linear models with brms</em>. <a href="https://CRAN.R-project.org/package=brms/vignettes/brms_nonlinear.html">https://CRAN.R-project.org/package=brms/vignettes/brms_nonlinear.html</a>
</div>
<div id="ref-brms2022RM" class="csl-entry">
Bürkner, P.-C. (2022d). <em><span class="nocase">brms</span> reference manual, <span>Version</span> 2.17.0</em>. <a href="https://CRAN.R-project.org/package=brms/brms.pdf">https://CRAN.R-project.org/package=brms/brms.pdf</a>
</div>
<div id="ref-endersCenteringPredictorsContextual2013" class="csl-entry">
Enders, C. (2013). Centering predictors and contextual effects. In M. Scott, J. Simonoff, &amp; B. Marx (Eds.), <em>The <span>SAGE Handbook</span> of <span>Multilevel Modeling</span></em> (pp. 89–108). <span>SAGE Publications Ltd</span>. <a href="https://doi.org/10.4135/9781446247600.n6">https://doi.org/10.4135/9781446247600.n6</a>
</div>
<div id="ref-enders2007centering" class="csl-entry">
Enders, C. K., &amp; Tofighi, D. (2007). Centering predictor variables in cross-sectional multilevel models: <span>A</span> new look at an old issue. <em>Psychological Methods</em>, <em>12</em>(2), 121. <a href="https://doi.org/10.1037/1082-989X.12.2.121">https://doi.org/10.1037/1082-989X.12.2.121</a>
</div>
<div id="ref-gabry2019visualization" class="csl-entry">
Gabry, J., Simpson, D., Vehtari, A., Betancourt, M., &amp; Gelman, A. (2019). Visualization in <span>Bayesian</span> workflow. <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em>, <em>182</em>(2), 389–402. <a href="https://doi.org/10.1111/rssa.12378">https://doi.org/10.1111/rssa.12378</a>
</div>
<div id="ref-kruschkeDoingBayesianData2015" class="csl-entry">
Kruschke, J. K. (2015). <em>Doing <span>Bayesian</span> data analysis: <span>A</span> tutorial with <span>R</span>, <span>JAGS</span>, and <span>Stan</span></em>. <span>Academic Press</span>. <a href="https://sites.google.com/site/doingbayesiandataanalysis/">https://sites.google.com/site/doingbayesiandataanalysis/</a>
</div>
<div id="ref-kurzStatisticalRethinkingBrms2020" class="csl-entry">
Kurz, A. S. (2020). <em>Statistical rethinking with brms, <span class="nocase">ggplot2</span>, and the tidyverse</em> (version 1.2.0). <a href="https://doi.org/10.5281/zenodo.3693202">https://doi.org/10.5281/zenodo.3693202</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="metric-predicted-variable-on-one-or-two-groups.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="metric-predicted-variable-with-multiple-metric-predictors.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
