<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>13 Goals, Power, and Sample Size | Doing Bayesian Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="13 Goals, Power, and Sample Size | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="13 Goals, Power, and Sample Size | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2020-05-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayesian-approaches-to-testing-a-point-null-hypothesis.html"/>
<link rel="next" href="stan.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#we-have-updates"><i class="fa fa-check"></i>We have updates</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.1.0."><i class="fa fa-check"></i>Version 0.1.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.2.0."><i class="fa fa-check"></i>Version 0.2.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#were-not-done-yet-and-i-could-use-your-help."><i class="fa fa-check"></i>We’re not done yet and I could use your help.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#you-can-do-this-too"><i class="fa fa-check"></i>You can do this, too</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thank-yous-are-in-order"><i class="fa fa-check"></i>Thank-you’s are in order</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html"><i class="fa fa-check"></i><b>1</b> What’s in This Book (Read This First!)</a><ul>
<li class="chapter" data-level="1.1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#real-people-can-read-this-book"><i class="fa fa-check"></i><b>1.1</b> Real people can read this book</a></li>
<li class="chapter" data-level="1.2" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-in-this-book"><i class="fa fa-check"></i><b>1.2</b> What’s in this book</a></li>
<li class="chapter" data-level="1.3" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-new-in-the-second-edition"><i class="fa fa-check"></i><b>1.3</b> What’s new in the second edition</a></li>
<li class="chapter" data-level="1.4" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#gimme-feedback-be-polite"><i class="fa fa-check"></i><b>1.4</b> Gimme feedback (be polite)</a></li>
<li class="chapter" data-level="1.5" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#thank-you"><i class="fa fa-check"></i><b>1.5</b> Thank you!</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Introduction: Credibility, Models, and Parameters</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#bayesian-inference-is-reallocation-of-credibility-across-possibilities"><i class="fa fa-check"></i><b>2.1</b> Bayesian inference is reallocation of credibility across possibilities</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#data-are-noisy-and-inferences-are-probabilistic."><i class="fa fa-check"></i><b>2.1.1</b> Data are noisy and inferences are probabilistic.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#possibilities-are-parameter-values-in-descriptive-models"><i class="fa fa-check"></i><b>2.2</b> Possibilities are parameter values in descriptive models</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.3</b> The steps of Bayesian data analysis</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html"><i class="fa fa-check"></i><b>3</b> The R Programming Language</a><ul>
<li class="chapter" data-level="3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-software"><i class="fa fa-check"></i><b>3.1</b> Get the software</a><ul>
<li class="chapter" data-level="3.1.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-look-at-rstudio."><i class="fa fa-check"></i><b>3.1.1</b> A look at RStudio.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-simple-example-of-r-in-action"><i class="fa fa-check"></i><b>3.2</b> A simple example of R in action</a><ul>
<li class="chapter" data-level="3.2.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-programs-used-with-this-book."><i class="fa fa-check"></i><b>3.2.1</b> Get the programs used with this book.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#basic-commands-and-operators-in-r"><i class="fa fa-check"></i><b>3.3</b> Basic commands and operators in R</a><ul>
<li class="chapter" data-level="3.3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#getting-help-in-r."><i class="fa fa-check"></i><b>3.3.1</b> Getting help in R.</a></li>
<li class="chapter" data-level="3.3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#arithmetic-and-logical-operators."><i class="fa fa-check"></i><b>3.3.2</b> Arithmetic and logical operators.</a></li>
<li class="chapter" data-level="3.3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#assignment-relational-operators-and-tests-of-equality."><i class="fa fa-check"></i><b>3.3.3</b> Assignment, relational operators, and tests of equality.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-types"><i class="fa fa-check"></i><b>3.4</b> Variable types</a><ul>
<li class="chapter" data-level="3.4.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#vector."><i class="fa fa-check"></i><b>3.4.1</b> Vector.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#factor."><i class="fa fa-check"></i><b>3.4.2</b> Factor.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#matrix-and-array."><i class="fa fa-check"></i><b>3.4.3</b> Matrix and array.</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#list-and-data-frame."><i class="fa fa-check"></i><b>3.4.4</b> List and data frame.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#loading-and-saving-data"><i class="fa fa-check"></i><b>3.5</b> Loading and saving data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#the-read.csv-read_csv-and-read.table-read_table-functions."><i class="fa fa-check"></i><b>3.5.1</b> The <del>read.csv</del> <code>read_csv()</code> and <del>read.table</del> <code>read_table()</code> functions.</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#saving-data-from-r."><i class="fa fa-check"></i><b>3.5.2</b> Saving data from R.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#some-utility-functions"><i class="fa fa-check"></i><b>3.6</b> Some utility functions</a></li>
<li class="chapter" data-level="3.7" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-in-r"><i class="fa fa-check"></i><b>3.7</b> Programming in R</a><ul>
<li class="chapter" data-level="3.7.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-names-in-r."><i class="fa fa-check"></i><b>3.7.1</b> Variable names in R.</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#running-a-program."><i class="fa fa-check"></i><b>3.7.2</b> Running a program.</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-a-function."><i class="fa fa-check"></i><b>3.7.3</b> Programming a function.</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conditions-and-loops."><i class="fa fa-check"></i><b>3.7.4</b> Conditions and loops.</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#measuring-processing-time."><i class="fa fa-check"></i><b>3.7.5</b> Measuring processing time.</a></li>
<li class="chapter" data-level="3.7.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#debugging."><i class="fa fa-check"></i><b>3.7.6</b> Debugging.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#graphical-plots-opening-and-saving"><i class="fa fa-check"></i><b>3.8</b> Graphical plots: Opening and saving</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html"><i class="fa fa-check"></i><b>4</b> What is This Stuff Called Probability?</a><ul>
<li class="chapter" data-level="4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#the-set-of-all-possible-events"><i class="fa fa-check"></i><b>4.1</b> The set of all possible events</a></li>
<li class="chapter" data-level="4.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-outside-or-inside-the-head"><i class="fa fa-check"></i><b>4.2</b> Probability: Outside or inside the head</a><ul>
<li class="chapter" data-level="4.2.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#outside-the-head-long-run-relative-frequency."><i class="fa fa-check"></i><b>4.2.1</b> Outside the head: Long-run relative frequency.</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#inside-the-head-subjective-belief."><i class="fa fa-check"></i><b>4.2.2</b> Inside the head: Subjective belief.</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probabilities-assign-numbers-to-possibilities."><i class="fa fa-check"></i><b>4.2.3</b> Probabilities assign numbers to possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Probability distributions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#discrete-distributions-probability-mass."><i class="fa fa-check"></i><b>4.3.1</b> Discrete distributions: Probability mass.</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#continuous-distributions-rendezvous-with-density."><i class="fa fa-check"></i><b>4.3.2</b> Continuous distributions: Rendezvous with density.</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#mean-and-variance-of-a-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Mean and variance of a distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#highest-density-interval-hdi."><i class="fa fa-check"></i><b>4.3.4</b> Highest density interval (HDI).</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#two-way-distributions"><i class="fa fa-check"></i><b>4.4</b> Two-way distributions</a><ul>
<li class="chapter" data-level="4.4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#conditional-probability."><i class="fa fa-check"></i><b>4.4.1</b> Conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-rule-1"><i class="fa fa-check"></i><b>5.1</b> Bayes’ rule</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#derived-from-definitions-of-conditional-probability."><i class="fa fa-check"></i><b>5.1.1</b> Derived from definitions of conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule.html"><a href="bayes-rule.html#applied-to-parameters-and-data"><i class="fa fa-check"></i><b>5.2</b> Applied to parameters and data</a></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule.html"><a href="bayes-rule.html#complete-examples-estimating-bias-in-a-coin"><i class="fa fa-check"></i><b>5.3</b> Complete examples: Estimating bias in a coin</a><ul>
<li class="chapter" data-level="5.3.1" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-sample-size-on-the-posterior."><i class="fa fa-check"></i><b>5.3.1</b> Influence of sample size on the posterior.</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-prior-on-the-posterior."><i class="fa fa-check"></i><b>5.3.2</b> Influence of prior on the posterior.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule.html"><a href="bayes-rule.html#why-bayesian-inference-can-be-difficult"><i class="fa fa-check"></i><b>5.4</b> Why Bayesian inference can be difficult</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-likelihood-function-the-bernoulli-distribution"><i class="fa fa-check"></i><b>6.1</b> The likelihood function: The Bernoulli distribution</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-description-of-credibilities-the-beta-distribution"><i class="fa fa-check"></i><b>6.2</b> A description of credibilities: The beta distribution</a><ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#specifying-a-beta-prior."><i class="fa fa-check"></i><b>6.2.1</b> Specifying a beta prior.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-posterior-beta"><i class="fa fa-check"></i><b>6.3</b> The posterior beta</a><ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#posterior-is-compromise-of-prior-and-likelihood."><i class="fa fa-check"></i><b>6.3.1</b> Posterior is compromise of prior and likelihood.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a><ul>
<li class="chapter" data-level="6.4.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.1</b> Prior knowledge expressed as a beta distribution.</a></li>
<li class="chapter" data-level="6.4.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.2</b> Prior knowledge that cannot be expressed as a beta distribution.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo</a><ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#approximating-a-distribution-with-a-large-sample"><i class="fa fa-check"></i><b>7.1</b> Approximating a distribution with a large sample</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-simple-case-of-the-metropolis-algorithm"><i class="fa fa-check"></i><b>7.2</b> A simple case of the Metropolis algorithm</a><ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-politician-stumbles-upon-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.2.1</b> A politician stumbles upon the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-random-walk."><i class="fa fa-check"></i><b>7.2.2</b> A random walk.</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#general-properties-of-a-random-walk."><i class="fa fa-check"></i><b>7.2.3</b> General properties of a random walk.</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#why-we-care."><i class="fa fa-check"></i><b>7.2.4</b> Why we care.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-metropolis-algorithm-more-generally"><i class="fa fa-check"></i><b>7.3</b> The Metropolis algorithm more generally</a><ul>
<li class="chapter" data-level="7.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithm-applied-to-bernoulli-likelihood-and-beta-prior."><i class="fa fa-check"></i><b>7.3.1</b> Metropolis algorithm applied to Bernoulli likelihood and beta prior.</a></li>
<li class="chapter" data-level="7.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-of-metropolis-algorithm."><i class="fa fa-check"></i><b>7.3.2</b> Summary of Metropolis algorithm.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#toward-gibbs-sampling-estimating-two-coin-biases"><i class="fa fa-check"></i><b>7.4</b> Toward Gibbs sampling: Estimating two coin biases</a><ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#prior-likelihood-and-posterior-for-two-biases."><i class="fa fa-check"></i><b>7.4.1</b> Prior, likelihood and posterior for two biases.</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-exact-formal-analysis."><i class="fa fa-check"></i><b>7.4.2</b> The posterior via exact formal analysis.</a></li>
<li class="chapter" data-level="7.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.4.3</b> The posterior via the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-hamiltonian-monte-carlo-sampling."><i class="fa fa-check"></i><b>7.4.4</b> <del>Gibbs</del> Hamiltonian Monte Carlo sampling.</a></li>
<li class="chapter" data-level="7.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#is-there-a-difference-between-biases"><i class="fa fa-check"></i><b>7.4.5</b> Is there a difference between biases?</a></li>
<li class="chapter" data-level="7.4.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#terminology-mcmc."><i class="fa fa-check"></i><b>7.4.6</b> Terminology: MCMC.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness-accuracy-and-efficiency"><i class="fa fa-check"></i><b>7.5</b> MCMC representativeness, accuracy, and efficiency</a><ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness."><i class="fa fa-check"></i><b>7.5.1</b> MCMC representativeness.</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-accuracy."><i class="fa fa-check"></i><b>7.5.2</b> MCMC accuracy.</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-efficiency."><i class="fa fa-check"></i><b>7.5.3</b> MCMC efficiency.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-brms.html"><a href="jags-brms.html"><i class="fa fa-check"></i><b>8</b> <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.1" data-path="jags-brms.html"><a href="jags-brms.html#jags-brms-and-its-relation-to-r"><i class="fa fa-check"></i><b>8.1</b> <del>JAGS</del> brms and its relation to R</a></li>
<li class="chapter" data-level="8.2" data-path="jags-brms.html"><a href="jags-brms.html#a-complete-example"><i class="fa fa-check"></i><b>8.2</b> A complete example</a><ul>
<li class="chapter" data-level="8.2.1" data-path="jags-brms.html"><a href="jags-brms.html#load-data."><i class="fa fa-check"></i><b>8.2.1</b> Load data.</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-brms.html"><a href="jags-brms.html#specify-model."><i class="fa fa-check"></i><b>8.2.2</b> Specify model.</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-brms.html"><a href="jags-brms.html#initialize-chains."><i class="fa fa-check"></i><b>8.2.3</b> Initialize chains.</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-brms.html"><a href="jags-brms.html#generate-chains."><i class="fa fa-check"></i><b>8.2.4</b> Generate chains.</a></li>
<li class="chapter" data-level="8.2.5" data-path="jags-brms.html"><a href="jags-brms.html#examine-chains."><i class="fa fa-check"></i><b>8.2.5</b> Examine chains.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-brms.html"><a href="jags-brms.html#simplified-scripts-for-frequently-used-analyses"><i class="fa fa-check"></i><b>8.3</b> Simplified scripts for frequently used analyses</a></li>
<li class="chapter" data-level="8.4" data-path="jags-brms.html"><a href="jags-brms.html#example-difference-of-biases"><i class="fa fa-check"></i><b>8.4</b> Example: Difference of biases</a></li>
<li class="chapter" data-level="8.5" data-path="jags-brms.html"><a href="jags-brms.html#sampling-from-the-prior-distribution-in-jags-brms"><i class="fa fa-check"></i><b>8.5</b> Sampling from the prior distribution in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="8.6" data-path="jags-brms.html"><a href="jags-brms.html#probability-distributions-available-in-jags-brms"><i class="fa fa-check"></i><b>8.6</b> Probability distributions available in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.6.1" data-path="jags-brms.html"><a href="jags-brms.html#defining-new-likelihood-functions."><i class="fa fa-check"></i><b>8.6.1</b> Defining new likelihood functions.</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="jags-brms.html"><a href="jags-brms.html#faster-sampling-with-parallel-processing-in-runjags-brmsbrm"><i class="fa fa-check"></i><b>8.7</b> Faster sampling with parallel processing in <del>runjags</del> <code>brms::brm()</code></a></li>
<li class="chapter" data-level="8.8" data-path="jags-brms.html"><a href="jags-brms.html#tips-for-expanding-jags-brms-models"><i class="fa fa-check"></i><b>8.8</b> Tips for expanding <del>JAGS</del> brms models</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Hierarchical Models</a><ul>
<li class="chapter" data-level="9.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-single-coin-from-a-single-mint"><i class="fa fa-check"></i><b>9.1</b> A single coin from a single mint</a><ul>
<li class="chapter" data-level="9.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation."><i class="fa fa-check"></i><b>9.1.1</b> Posterior via grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#multiple-coins-from-a-single-mint"><i class="fa fa-check"></i><b>9.2</b> Multiple coins from a single mint</a><ul>
<li class="chapter" data-level="9.2.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation.-1"><i class="fa fa-check"></i><b>9.2.1</b> Posterior via grid approximation.</a></li>
<li class="chapter" data-level="9.2.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-realistic-model-with-mcmc."><i class="fa fa-check"></i><b>9.2.2</b> A realistic model with MCMC.</a></li>
<li class="chapter" data-level="9.2.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#doing-it-with-jags-brms."><i class="fa fa-check"></i><b>9.2.3</b> Doing it with <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="9.2.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-therapeutic-touch."><i class="fa fa-check"></i><b>9.2.4</b> Example: Therapeutic touch.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#shrinkage-in-hierarchical-models"><i class="fa fa-check"></i><b>9.3</b> Shrinkage in hierarchical models</a></li>
<li class="chapter" data-level="9.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#speeding-up-jags-brms"><i class="fa fa-check"></i><b>9.4</b> Speeding up <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="9.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#extending-the-hierarchy-subjects-within-categories"><i class="fa fa-check"></i><b>9.5</b> Extending the hierarchy: Subjects within categories</a><ul>
<li class="chapter" data-level="9.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-batting-abilities-by-position."><i class="fa fa-check"></i><b>9.5.1</b> Example: Baseball batting abilities by position.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html"><i class="fa fa-check"></i><b>10</b> Model Comparison and Hierarchical Modeling</a><ul>
<li class="chapter" data-level="10.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#general-formula-and-the-bayes-factor"><i class="fa fa-check"></i><b>10.1</b> General formula and the Bayes factor</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#example-two-factories-of-coins"><i class="fa fa-check"></i><b>10.2</b> Example: Two factories of coins</a><ul>
<li class="chapter" data-level="10.2.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-formal-analysis."><i class="fa fa-check"></i><b>10.2.1</b> Solution by formal analysis.</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-grid-approximation."><i class="fa fa-check"></i><b>10.2.2</b> Solution by grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-mcmc"><i class="fa fa-check"></i><b>10.3</b> Solution by MCMC</a><ul>
<li class="chapter" data-level="10.3.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#nonhierarchical-mcmc-computation-of-each-models-marginal-likelihood."><i class="fa fa-check"></i><b>10.3.1</b> Nonhierarchical MCMC computation of each model’s marginal likelihood.</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#hierarchical-mcmc-computation-of-relative-model-probability-is-not-available-in-brms-well-cover-information-criteria-instead."><i class="fa fa-check"></i><b>10.3.2</b> Hierarchical MCMC computation <del>of relative model probability</del> is not available in brms: We’ll cover information criteria instead.</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#models-with-different-noise-distributions-in-jags-brms."><i class="fa fa-check"></i><b>10.3.3</b> Models with different “noise” distributions in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#prediction-model-averaging"><i class="fa fa-check"></i><b>10.4</b> Prediction: Model averaging</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#model-complexity-naturally-accounted-for"><i class="fa fa-check"></i><b>10.5</b> Model complexity naturally accounted for</a><ul>
<li class="chapter" data-level="10.5.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#caveats-regarding-nested-model-comparison."><i class="fa fa-check"></i><b>10.5.1</b> Caveats regarding nested model comparison.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#extreme-sensitivity-to-the-prior-distribution"><i class="fa fa-check"></i><b>10.6</b> Extreme sensitivity to the prior distribution</a><ul>
<li class="chapter" data-level="10.6.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#priors-of-different-models-should-be-equally-informed."><i class="fa fa-check"></i><b>10.6.1</b> Priors of different models should be equally informed.</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#bonus-theres-danger-ahead"><i class="fa fa-check"></i><b>10.7</b> Bonus: There’s danger ahead</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>11</b> Null Hypothesis Significance Testing</a><ul>
<li class="chapter" data-level="11.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#paved-with-good-intentions"><i class="fa fa-check"></i><b>11.1</b> Paved with good intentions</a><ul>
<li class="chapter" data-level="11.1.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#definition-of-p-value."><i class="fa fa-check"></i><b>11.1.1</b> Definition of <span class="math inline">\(p\)</span> value.</a></li>
<li class="chapter" data-level="11.1.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-n."><i class="fa fa-check"></i><b>11.1.2</b> With intention to fix <span class="math inline">\(N\)</span>.</a></li>
<li class="chapter" data-level="11.1.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-z."><i class="fa fa-check"></i><b>11.1.3</b> With intention to fix <span class="math inline">\(z\)</span>.</a></li>
<li class="chapter" data-level="11.1.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-duration."><i class="fa fa-check"></i><b>11.1.4</b> With intention to fix duration.</a></li>
<li class="chapter" data-level="11.1.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-make-multiple-tests."><i class="fa fa-check"></i><b>11.1.5</b> With intention to make multiple tests.</a></li>
<li class="chapter" data-level="11.1.6" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#soul-searching."><i class="fa fa-check"></i><b>11.1.6</b> Soul searching.</a></li>
<li class="chapter" data-level="11.1.7" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis."><i class="fa fa-check"></i><b>11.1.7</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#prior-knowledge"><i class="fa fa-check"></i><b>11.2</b> Prior knowledge</a><ul>
<li class="chapter" data-level="11.2.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-analysis."><i class="fa fa-check"></i><b>11.2.1</b> NHST analysis.</a></li>
<li class="chapter" data-level="11.2.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis.-1"><i class="fa fa-check"></i><b>11.2.2</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#confidence-interval-and-highest-density-interval"><i class="fa fa-check"></i><b>11.3</b> Confidence interval and highest density interval</a><ul>
<li class="chapter" data-level="11.3.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#ci-depends-on-intention."><i class="fa fa-check"></i><b>11.3.1</b> CI depends on intention.</a></li>
<li class="chapter" data-level="11.3.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-hdi."><i class="fa fa-check"></i><b>11.3.2</b> Bayesian HDI.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#multiple-comparisons"><i class="fa fa-check"></i><b>11.4</b> Multiple comparisons</a><ul>
<li class="chapter" data-level="11.4.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-correction-for-experiment-wise-error."><i class="fa fa-check"></i><b>11.4.1</b> NHST correction for experiment wise error.</a></li>
<li class="chapter" data-level="11.4.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#just-one-bayesian-posterior-no-matter-how-you-look-at-it."><i class="fa fa-check"></i><b>11.4.2</b> Just one Bayesian posterior no matter how you look at it.</a></li>
<li class="chapter" data-level="11.4.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#how-bayesian-analysis-mitigates-false-alarms."><i class="fa fa-check"></i><b>11.4.3</b> How Bayesian analysis mitigates false alarms.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#what-a-sampling-distribution-is-good-for"><i class="fa fa-check"></i><b>11.5</b> What a sampling distribution is good for</a><ul>
<li class="chapter" data-level="11.5.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#planning-an-experiment."><i class="fa fa-check"></i><b>11.5.1</b> Planning an experiment.</a></li>
<li class="chapter" data-level="11.5.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#exploring-model-predictions-posterior-predictive-check."><i class="fa fa-check"></i><b>11.5.2</b> Exploring model predictions (posterior predictive check).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><i class="fa fa-check"></i><b>12</b> Bayesian Approaches to Testing a Point (“Null”) Hypothesis</a><ul>
<li class="chapter" data-level="12.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-estimation-approach"><i class="fa fa-check"></i><b>12.1</b> The estimation approach</a><ul>
<li class="chapter" data-level="12.1.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#region-of-practical-equivalence."><i class="fa fa-check"></i><b>12.1.1</b> Region of practical equivalence.</a></li>
<li class="chapter" data-level="12.1.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#some-examples."><i class="fa fa-check"></i><b>12.1.2</b> Some examples.</a></li>
<li class="chapter" data-level="12.1.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#differences-of-correlated-parameters."><i class="fa fa-check"></i><b>12.1.3</b> Differences of correlated parameters.</a></li>
<li class="chapter" data-level="12.1.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#why-hdi-and-not-equal-tailed-interval"><i class="fa fa-check"></i><b>12.1.4</b> Why HDI and not equal-tailed interval?</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-model-comparison-approach"><i class="fa fa-check"></i><b>12.2</b> The model-comparison approach</a><ul>
<li class="chapter" data-level="12.2.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#is-a-coin-fair-or-not"><i class="fa fa-check"></i><b>12.2.1</b> Is a coin fair or not?</a></li>
<li class="chapter" data-level="12.2.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#bayes-factor-can-accept-null-with-poor-precision."><i class="fa fa-check"></i><b>12.2.2</b> Bayes’ factor can accept null with poor precision.</a></li>
<li class="chapter" data-level="12.2.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#are-different-groups-equal-or-not"><i class="fa fa-check"></i><b>12.2.3</b> Are different groups equal or not?</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#relations-of-parameter-estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.3</b> Relations of parameter estimation and model comparison</a></li>
<li class="chapter" data-level="12.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.4</b> Estimation and model comparison?</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html"><i class="fa fa-check"></i><b>13</b> Goals, Power, and Sample Size</a><ul>
<li class="chapter" data-level="13.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-will-to-power"><i class="fa fa-check"></i><b>13.1</b> The will to power</a><ul>
<li class="chapter" data-level="13.1.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#goals-and-obstacles."><i class="fa fa-check"></i><b>13.1.1</b> Goals and obstacles.</a></li>
<li class="chapter" data-level="13.1.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power."><i class="fa fa-check"></i><b>13.1.2</b> Power.</a></li>
<li class="chapter" data-level="13.1.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sample-size."><i class="fa fa-check"></i><b>13.1.3</b> Sample size.</a></li>
<li class="chapter" data-level="13.1.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#other-expressions-of-goals."><i class="fa fa-check"></i><b>13.1.4</b> Other expressions of goals.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#computing-power-and-sample-size"><i class="fa fa-check"></i><b>13.2</b> Computing power and sample size</a><ul>
<li class="chapter" data-level="13.2.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-to-exclude-a-null-value."><i class="fa fa-check"></i><b>13.2.1</b> When the goal is to exclude a null value.</a></li>
<li class="chapter" data-level="13.2.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#formal-solution-and-implementation-in-r."><i class="fa fa-check"></i><b>13.2.2</b> Formal solution and implementation in R.</a></li>
<li class="chapter" data-level="13.2.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-precision."><i class="fa fa-check"></i><b>13.2.3</b> When the goal is precision.</a></li>
<li class="chapter" data-level="13.2.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#monte-carlo-approximation-of-power."><i class="fa fa-check"></i><b>13.2.4</b> Monte Carlo approximation of power.</a></li>
<li class="chapter" data-level="13.2.5" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-from-idealized-or-actual-data."><i class="fa fa-check"></i><b>13.2.5</b> Power from idealized or actual data.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sequential-testing-and-the-goal-of-precision"><i class="fa fa-check"></i><b>13.3</b> Sequential testing and the goal of precision</a><ul>
<li class="chapter" data-level="13.3.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#examples-ofsequential-tests."><i class="fa fa-check"></i><b>13.3.1</b> Examples ofsequential tests.</a></li>
<li class="chapter" data-level="13.3.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#average-behavior-of-sequential-tests."><i class="fa fa-check"></i><b>13.3.2</b> Average behavior of sequential tests.</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#discussion"><i class="fa fa-check"></i><b>13.4</b> Discussion</a><ul>
<li class="chapter" data-level="13.4.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-and-multiple-comparisons."><i class="fa fa-check"></i><b>13.4.1</b> Power and multiple comparisons.</a></li>
<li class="chapter" data-level="13.4.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-prospective-retrospective-and-replication."><i class="fa fa-check"></i><b>13.4.2</b> Power: prospective, retrospective, and replication.</a></li>
<li class="chapter" data-level="13.4.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-analysis-requires-verisimilitude-of-simulated-data."><i class="fa fa-check"></i><b>13.4.3</b> Power analysis requires verisimilitude of simulated data.</a></li>
<li class="chapter" data-level="13.4.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-importance-of-planning."><i class="fa fa-check"></i><b>13.4.4</b> The importance of planning.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a><ul>
<li class="chapter" data-level="14.1" data-path="stan.html"><a href="stan.html#hmc-sampling"><i class="fa fa-check"></i><b>14.1</b> HMC sampling</a></li>
<li class="chapter" data-level="14.2" data-path="stan.html"><a href="stan.html#installing-stan"><i class="fa fa-check"></i><b>14.2</b> Installing Stan</a></li>
<li class="chapter" data-level="14.3" data-path="stan.html"><a href="stan.html#a-complete-example-1"><i class="fa fa-check"></i><b>14.3</b> A Complete example</a><ul>
<li class="chapter" data-level="14.3.1" data-path="stan.html"><a href="stan.html#reusing-the-compiled-model."><i class="fa fa-check"></i><b>14.3.1</b> Reusing the compiled model.</a></li>
<li class="chapter" data-level="14.3.2" data-path="stan.html"><a href="stan.html#general-structure-of-stan-model-specification."><i class="fa fa-check"></i><b>14.3.2</b> General structure of Stan model specification.</a></li>
<li class="chapter" data-level="14.3.3" data-path="stan.html"><a href="stan.html#think-log-probability-to-think-like-stan."><i class="fa fa-check"></i><b>14.3.3</b> Think log probability to think like Stan.</a></li>
<li class="chapter" data-level="14.3.4" data-path="stan.html"><a href="stan.html#sampling-the-prior-in-stan."><i class="fa fa-check"></i><b>14.3.4</b> Sampling the prior in Stan.</a></li>
<li class="chapter" data-level="14.3.5" data-path="stan.html"><a href="stan.html#simplified-scripts-for-frequently-used-analyses."><i class="fa fa-check"></i><b>14.3.5</b> Simplified scripts for frequently used analyses.</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="stan.html"><a href="stan.html#specify-models-top-down-in-stan"><i class="fa fa-check"></i><b>14.4</b> Specify models top-down in Stan</a></li>
<li class="chapter" data-level="14.5" data-path="stan.html"><a href="stan.html#limitations-and-extras"><i class="fa fa-check"></i><b>14.5</b> Limitations and extras</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>15</b> Overview of the Generalized Linear Model</a><ul>
<li class="chapter" data-level="15.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#types-of-variables"><i class="fa fa-check"></i><b>15.1</b> Types of variables</a><ul>
<li class="chapter" data-level="15.1.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#predictor-and-predicted-variables."><i class="fa fa-check"></i><b>15.1.1</b> Predictor and predicted variables.</a></li>
<li class="chapter" data-level="15.1.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#scale-types-metric-ordinal-nominal-and-count."><i class="fa fa-check"></i><b>15.1.2</b> Scale types: metric, ordinal, nominal, and count.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-combination-of-predictors"><i class="fa fa-check"></i><b>15.2</b> Linear combination of predictors</a><ul>
<li class="chapter" data-level="15.2.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-function-of-a-single-metric-predictor."><i class="fa fa-check"></i><b>15.2.1</b> Linear function of a single metric predictor.</a></li>
<li class="chapter" data-level="15.2.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#additive-combination-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.2</b> Additive combination of metric predictors.</a></li>
<li class="chapter" data-level="15.2.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nonadditive-interaction-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.3</b> Nonadditive interaction of metric predictors.</a></li>
<li class="chapter" data-level="15.2.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nominal-predictors."><i class="fa fa-check"></i><b>15.2.4</b> Nominal predictors.</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linking-from-combined-predictors-to-noisy-predicted-data"><i class="fa fa-check"></i><b>15.3</b> Linking from combined predictors to noisy predicted data</a><ul>
<li class="chapter" data-level="15.3.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predictors-to-predicted-central-tendency."><i class="fa fa-check"></i><b>15.3.1</b> From predictors to predicted central tendency.</a></li>
<li class="chapter" data-level="15.3.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predicted-central-tendency-to-noisy-data."><i class="fa fa-check"></i><b>15.3.2</b> From predicted central tendency to noisy data.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#formal-expression-of-the-glm"><i class="fa fa-check"></i><b>15.4</b> Formal expression of the GLM</a><ul>
<li class="chapter" data-level="15.4.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#cases-of-the-glm."><i class="fa fa-check"></i><b>15.4.1</b> Cases of the GLM.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html"><i class="fa fa-check"></i><b>16</b> Metric-Predicted Variable on One or Two Groups</a><ul>
<li class="chapter" data-level="16.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#estimating-the-mean-and-standard-deviation-of-a-normal-distribution"><i class="fa fa-check"></i><b>16.1</b> Estimating the mean and standard deviation of a normal distribution</a><ul>
<li class="chapter" data-level="16.1.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#solution-by-mathematical-analysis-heads-up-on-precision."><i class="fa fa-check"></i><b>16.1.1</b> <del>Solution by mathematical analysis</del> Heads up on precision.</a></li>
<li class="chapter" data-level="16.1.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#approximation-by-mcmc-in-jags-hmc-in-brms."><i class="fa fa-check"></i><b>16.1.2</b> Approximation by <del>MCMC in JAGS</del> HMC in brms.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#outliers-and-robust-estimation-the-t-distribution"><i class="fa fa-check"></i><b>16.2</b> Outliers and robust estimation: The <span class="math inline">\(t\)</span> distribution</a><ul>
<li class="chapter" data-level="16.2.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-jags-brms."><i class="fa fa-check"></i><b>16.2.1</b> Using the <span class="math inline">\(t\)</span> distribution in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="16.2.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-stan."><i class="fa fa-check"></i><b>16.2.2</b> Using the <span class="math inline">\(t\)</span> distribution in Stan.</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#two-groups"><i class="fa fa-check"></i><b>16.3</b> Two groups</a><ul>
<li class="chapter" data-level="16.3.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#analysis-by-nhst."><i class="fa fa-check"></i><b>16.3.1</b> Analysis by NHST.</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#other-noise-distributions-and-transforming-data"><i class="fa fa-check"></i><b>16.4</b> Other noise distributions and transforming data</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#session-info-15"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html"><i class="fa fa-check"></i><b>17</b> Metric Predicted Variable with One Metric Predictor</a><ul>
<li class="chapter" data-level="17.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#simple-linear-regression"><i class="fa fa-check"></i><b>17.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="17.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Robust linear regression</a><ul>
<li class="chapter" data-level="17.2.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-jags-brms."><i class="fa fa-check"></i><b>17.2.1</b> Robust linear regression in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.2.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-stan."><i class="fa fa-check"></i><b>17.2.2</b> Robust linear regression in Stan.</a></li>
<li class="chapter" data-level="17.2.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#stan-or-jags"><i class="fa fa-check"></i><b>17.2.3</b> Stan or JAGS?</a></li>
<li class="chapter" data-level="17.2.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>17.2.4</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#hierarchical-regression-on-individuals-within-groups"><i class="fa fa-check"></i><b>17.3</b> Hierarchical regression on individuals within groups</a><ul>
<li class="chapter" data-level="17.3.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>17.3.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.3.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-posterior-distribution-shrinkage-and-prediction."><i class="fa fa-check"></i><b>17.3.2</b> The posterior distribution: Shrinkage and prediction.</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#quadratic-trend-and-weighted-data"><i class="fa fa-check"></i><b>17.4</b> Quadratic trend and weighted data</a><ul>
<li class="chapter" data-level="17.4.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#results-and-interpretation."><i class="fa fa-check"></i><b>17.4.1</b> Results and interpretation.</a></li>
<li class="chapter" data-level="17.4.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#further-extensions."><i class="fa fa-check"></i><b>17.4.2</b> Further extensions.</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#procedure-and-perils-for-expanding-a-model"><i class="fa fa-check"></i><b>17.5</b> Procedure and perils for expanding a model</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#session-info-16"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Metric Predicted Variable with Multiple Metric Predictors</a><ul>
<li class="chapter" data-level="18.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiple-linear-regression"><i class="fa fa-check"></i><b>18.1</b> Multiple linear regression</a><ul>
<li class="chapter" data-level="18.1.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-perils-of-correlated-predictors."><i class="fa fa-check"></i><b>18.1.1</b> The perils of correlated predictors.</a></li>
<li class="chapter" data-level="18.1.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-model-and-implementation."><i class="fa fa-check"></i><b>18.1.2</b> The model and implementation.</a></li>
<li class="chapter" data-level="18.1.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-posterior-distribution."><i class="fa fa-check"></i><b>18.1.3</b> The posterior distribution.</a></li>
<li class="chapter" data-level="18.1.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#redundant-predictors."><i class="fa fa-check"></i><b>18.1.4</b> Redundant predictors.</a></li>
<li class="chapter" data-level="18.1.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#informative-priors-sparse-data-and-correlated-predictors."><i class="fa fa-check"></i><b>18.1.5</b> Informative priors, sparse data, and correlated predictors.</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiplicative-interaction-of-metric-predictors"><i class="fa fa-check"></i><b>18.2</b> Multiplicative interaction of metric predictors</a><ul>
<li class="chapter" data-level="18.2.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#an-example."><i class="fa fa-check"></i><b>18.2.1</b> An example.</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#shrinkage-of-regression-coefficients"><i class="fa fa-check"></i><b>18.3</b> Shrinkage of regression coefficients</a></li>
<li class="chapter" data-level="18.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection"><i class="fa fa-check"></i><b>18.4</b> Variable selection</a><ul>
<li class="chapter" data-level="18.4.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#inclusion-probability-is-strongly-affected-by-vagueness-of-prior."><i class="fa fa-check"></i><b>18.4.1</b> Inclusion probability is strongly affected by vagueness of prior.</a></li>
<li class="chapter" data-level="18.4.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection-with-hierarchical-shrinkage."><i class="fa fa-check"></i><b>18.4.2</b> Variable selection with hierarchical shrinkage.</a></li>
<li class="chapter" data-level="18.4.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#what-to-report-and-what-to-conclude."><i class="fa fa-check"></i><b>18.4.3</b> What to report and what to conclude.</a></li>
<li class="chapter" data-level="18.4.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-computational-methods."><i class="fa fa-check"></i><b>18.4.4</b> Caution: Computational methods.</a></li>
<li class="chapter" data-level="18.4.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-interaction-variables."><i class="fa fa-check"></i><b>18.4.5</b> Caution: Interaction variables.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#session-info-17"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html"><i class="fa fa-check"></i><b>19</b> Metric Predicted Variable with One Nominal Predictor</a><ul>
<li class="chapter" data-level="19.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#describing-multiple-groups-of-metric-data"><i class="fa fa-check"></i><b>19.1</b> Describing multiple groups of metric data</a></li>
<li class="chapter" data-level="19.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#traditional-analysis-of-variance"><i class="fa fa-check"></i><b>19.2</b> Traditional analysis of variance</a></li>
<li class="chapter" data-level="19.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#hierarchical-bayesian-approach"><i class="fa fa-check"></i><b>19.3</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="19.3.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#implementation-in-jags-brms."><i class="fa fa-check"></i><b>19.3.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="19.3.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-and-death."><i class="fa fa-check"></i><b>19.3.2</b> Example: Sex and death.</a></li>
<li class="chapter" data-level="19.3.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#contrasts."><i class="fa fa-check"></i><b>19.3.3</b> Contrasts.</a></li>
<li class="chapter" data-level="19.3.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#multiple-comparisons-and-shrinkage."><i class="fa fa-check"></i><b>19.3.4</b> Multiple comparisons and shrinkage.</a></li>
<li class="chapter" data-level="19.3.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#the-two-group-case."><i class="fa fa-check"></i><b>19.3.5</b> The two-group case.</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#including-a-metric-predictor"><i class="fa fa-check"></i><b>19.4</b> Including a metric predictor</a><ul>
<li class="chapter" data-level="19.4.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-death-and-size."><i class="fa fa-check"></i><b>19.4.1</b> Example: Sex, death, and size.</a></li>
<li class="chapter" data-level="19.4.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#analogous-to-traditional-ancova."><i class="fa fa-check"></i><b>19.4.2</b> Analogous to traditional ANCOVA.</a></li>
<li class="chapter" data-level="19.4.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#relation-to-hierarchical-linear-regression."><i class="fa fa-check"></i><b>19.4.3</b> Relation to hierarchical linear regression.</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#heterogeneous-variances-and-robustness-against-outliers"><i class="fa fa-check"></i><b>19.5</b> Heterogeneous variances and robustness against outliers</a><ul>
<li class="chapter" data-level="19.5.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-contrast-of-means-with-different-variances."><i class="fa fa-check"></i><b>19.5.1</b> Example: Contrast of means with different variances.</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#exercises-walk-out-an-effect-size"><i class="fa fa-check"></i><b>19.6</b> <del>Exercises</del> Walk out an effect size</a><ul>
<li class="chapter" data-level="19.6.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#populations-and-samples."><i class="fa fa-check"></i><b>19.6.1</b> Populations and samples.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#session-info-18"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Metric Predicted Variable with Multiple Nominal Predictors</a><ul>
<li class="chapter" data-level="20.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#describing-groups-of-metric-data-with-multiple-nominal-predictors"><i class="fa fa-check"></i><b>20.1</b> Describing groups of metric data with multiple nominal predictors</a><ul>
<li class="chapter" data-level="20.1.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction."><i class="fa fa-check"></i><b>20.1.1</b> Interaction.</a></li>
<li class="chapter" data-level="20.1.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#traditional-anova."><i class="fa fa-check"></i><b>20.1.2</b> Traditional ANOVA.</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#hierarchical-bayesian-approach-1"><i class="fa fa-check"></i><b>20.2</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="20.2.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>20.2.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="20.2.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#example-its-only-money."><i class="fa fa-check"></i><b>20.2.2</b> Example: It’s only money.</a></li>
<li class="chapter" data-level="20.2.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#main-effect-contrasts."><i class="fa fa-check"></i><b>20.2.3</b> Main effect contrasts.</a></li>
<li class="chapter" data-level="20.2.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction-contrasts-and-simple-effects."><i class="fa fa-check"></i><b>20.2.4</b> Interaction contrasts and simple effects.</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#rescaling-can-change-interactions-homogeneity-and-normality"><i class="fa fa-check"></i><b>20.3</b> Rescaling can change interactions, homogeneity, and normality</a></li>
<li class="chapter" data-level="20.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1"><i class="fa fa-check"></i><b>20.4</b> Heterogeneous variances and robustness against outliers</a></li>
<li class="chapter" data-level="20.5" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#within-subject-designs"><i class="fa fa-check"></i><b>20.5</b> Within-subject designs</a><ul>
<li class="chapter" data-level="20.5.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#why-use-a-within-subject-design-and-why-not"><i class="fa fa-check"></i><b>20.5.1</b> Why use a within-subject design? And why not?</a></li>
<li class="chapter" data-level="20.5.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#split-plot-design."><i class="fa fa-check"></i><b>20.5.2</b> Split-plot design.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#session-info-19"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html"><i class="fa fa-check"></i><b>21</b> Dichotomous Predicted Variable</a><ul>
<li class="chapter" data-level="21.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-metric-predictors"><i class="fa fa-check"></i><b>21.1</b> Multiple metric predictors</a><ul>
<li class="chapter" data-level="21.1.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#the-model-and-implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>21.1.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="21.1.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#example-height-weight-and-gender."><i class="fa fa-check"></i><b>21.1.2</b> Example: Height, weight, and gender.</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interpreting-the-regression-coefficients"><i class="fa fa-check"></i><b>21.2</b> Interpreting the regression coefficients</a><ul>
<li class="chapter" data-level="21.2.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#log-odds."><i class="fa fa-check"></i><b>21.2.1</b> Log odds.</a></li>
<li class="chapter" data-level="21.2.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#when-there-are-few-1s-or-0s-in-the-data."><i class="fa fa-check"></i><b>21.2.2</b> When there are few 1’s or 0’s in the data.</a></li>
<li class="chapter" data-level="21.2.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#correlated-predictors."><i class="fa fa-check"></i><b>21.2.3</b> Correlated predictors.</a></li>
<li class="chapter" data-level="21.2.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interaction-of-metric-predictors."><i class="fa fa-check"></i><b>21.2.4</b> Interaction of metric predictors.</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#robust-logistic-regression"><i class="fa fa-check"></i><b>21.3</b> Robust logistic regression</a></li>
<li class="chapter" data-level="21.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#nominal-predictors"><i class="fa fa-check"></i><b>21.4</b> Nominal predictors</a><ul>
<li class="chapter" data-level="21.4.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#single-group."><i class="fa fa-check"></i><b>21.4.1</b> Single group.</a></li>
<li class="chapter" data-level="21.4.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-groups."><i class="fa fa-check"></i><b>21.4.2</b> Multiple groups.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#session-info-20"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html"><i class="fa fa-check"></i><b>22</b> Nominal Predicted Variable</a><ul>
<li class="chapter" data-level="22.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-regression"><i class="fa fa-check"></i><b>22.1</b> Softmax regression</a><ul>
<li class="chapter" data-level="22.1.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-reduces-to-logistic-for-two-outcomes."><i class="fa fa-check"></i><b>22.1.1</b> Softmax reduces to logistic for two outcomes.</a></li>
<li class="chapter" data-level="22.1.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#independence-from-irrelevant-attributes."><i class="fa fa-check"></i><b>22.1.2</b> Independence from irrelevant attributes.</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>22.2</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="22.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#implementation-in-jags-brms"><i class="fa fa-check"></i><b>22.3</b> Implementation in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="22.3.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-model."><i class="fa fa-check"></i><b>22.3.1</b> Softmax model.</a></li>
<li class="chapter" data-level="22.3.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-model."><i class="fa fa-check"></i><b>22.3.2</b> Conditional logistic model.</a></li>
<li class="chapter" data-level="22.3.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#results-interpreting-the-regression-coefficients."><i class="fa fa-check"></i><b>22.3.3</b> Results: Interpreting the regression coefficients.</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#generalizations-and-variations-of-the-models"><i class="fa fa-check"></i><b>22.4</b> Generalizations and variations of the models</a></li>
<li class="chapter" data-level="" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#session-info-21"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html"><i class="fa fa-check"></i><b>23</b> Ordinal Predicted Variable</a><ul>
<li class="chapter" data-level="23.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#modeling-ordinal-data-with-an-underlying-metric-variable"><i class="fa fa-check"></i><b>23.1</b> Modeling ordinal data with an underlying metric variable</a></li>
<li class="chapter" data-level="23.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-a-single-group"><i class="fa fa-check"></i><b>23.2</b> The case of a single group</a><ul>
<li class="chapter" data-level="23.2.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-3"><i class="fa fa-check"></i><b>23.2.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.2.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-bayesian-estimation-recovers-true-parameter-values."><i class="fa fa-check"></i><b>23.2.2</b> Examples: Bayesian estimation recovers true parameter values.</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-two-groups"><i class="fa fa-check"></i><b>23.3</b> The case of two groups</a><ul>
<li class="chapter" data-level="23.3.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-4"><i class="fa fa-check"></i><b>23.3.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.3.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-not-funny."><i class="fa fa-check"></i><b>23.3.2</b> Examples: Not funny.</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-metric-predictors"><i class="fa fa-check"></i><b>23.4</b> The Case of metric predictors</a><ul>
<li class="chapter" data-level="23.4.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-5"><i class="fa fa-check"></i><b>23.4.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="23.4.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-happiness-and-money."><i class="fa fa-check"></i><b>23.4.2</b> Example: Happiness and money.</a></li>
<li class="chapter" data-level="23.4.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-moviesthey-dont-make-em-like-they-used-to."><i class="fa fa-check"></i><b>23.4.3</b> Example: Movies–They don’t make ’em like they used to.</a></li>
<li class="chapter" data-level="23.4.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#why-are-some-thresholds-outside-the-data"><i class="fa fa-check"></i><b>23.4.4</b> Why are some thresholds outside the data?</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#posterior-prediction"><i class="fa fa-check"></i><b>23.5</b> Posterior prediction</a></li>
<li class="chapter" data-level="23.6" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#generalizations-and-extensions"><i class="fa fa-check"></i><b>23.6</b> Generalizations and extensions</a></li>
<li class="chapter" data-level="" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#session-info-22"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html"><i class="fa fa-check"></i><b>24</b> Count Predicted Variable</a><ul>
<li class="chapter" data-level="24.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-exponential-model"><i class="fa fa-check"></i><b>24.1</b> Poisson exponential model</a><ul>
<li class="chapter" data-level="24.1.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#data-structure."><i class="fa fa-check"></i><b>24.1.1</b> Data structure.</a></li>
<li class="chapter" data-level="24.1.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#exponential-link-function."><i class="fa fa-check"></i><b>24.1.2</b> Exponential link function.</a></li>
<li class="chapter" data-level="24.1.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-noise-distribution."><i class="fa fa-check"></i><b>24.1.3</b> Poisson noise distribution.</a></li>
<li class="chapter" data-level="24.1.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#the-complete-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>24.1.4</b> The complete model and implementation in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-hair-eye-go-again"><i class="fa fa-check"></i><b>24.2</b> Example: Hair eye go again</a></li>
<li class="chapter" data-level="24.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-interaction-contrasts-shrinkage-and-omnibus-test"><i class="fa fa-check"></i><b>24.3</b> Example: Interaction contrasts, shrinkage, and omnibus test</a></li>
<li class="chapter" data-level="24.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#log-linear-models-for-contingency-tables-bonus-alternative-parameterization"><i class="fa fa-check"></i><b>24.4</b> <del>Log-linear models for contingency tables</del> Bonus: Alternative parameterization</a></li>
<li class="chapter" data-level="" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#session-info-23"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html"><i class="fa fa-check"></i><b>25</b> Tools in the Trunk</a><ul>
<li class="chapter" data-level="25.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reporting-a-bayesian-analysis"><i class="fa fa-check"></i><b>25.1</b> Reporting a Bayesian analysis</a><ul>
<li class="chapter" data-level="25.1.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#essential-points."><i class="fa fa-check"></i><b>25.1.1</b> Essential points.</a></li>
<li class="chapter" data-level="25.1.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#optional-points."><i class="fa fa-check"></i><b>25.1.2</b> Optional points.</a></li>
<li class="chapter" data-level="25.1.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#helpful-points."><i class="fa fa-check"></i><b>25.1.3</b> Helpful points.</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#functions-for-computing-highest-density-intervals"><i class="fa fa-check"></i><b>25.2</b> Functions for computing highest density intervals</a><ul>
<li class="chapter" data-level="25.2.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-grid-approximation."><i class="fa fa-check"></i><b>25.2.1</b> R code for computing HDI of a grid approximation.</a></li>
<li class="chapter" data-level="25.2.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#hdi-of-unimodal-distribution-is-shortest-interval."><i class="fa fa-check"></i><b>25.2.2</b> HDI of unimodal distribution is shortest interval.</a></li>
<li class="chapter" data-level="25.2.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-mcmc-sample."><i class="fa fa-check"></i><b>25.2.3</b> R code for computing HDI of a MCMC sample.</a></li>
<li class="chapter" data-level="25.2.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-function."><i class="fa fa-check"></i><b>25.2.4</b> R code for computing HDI of a function.</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reparameterization"><i class="fa fa-check"></i><b>25.3</b> Reparameterization</a></li>
<li class="chapter" data-level="25.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#censored-data-in-jags-brms"><i class="fa fa-check"></i><b>25.4</b> Censored Data in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="25.5" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#what-next"><i class="fa fa-check"></i><b>25.5</b> What Next?</a></li>
<li class="chapter" data-level="" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#session-info-24"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Doing Bayesian Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="goals-power-and-sample-size" class="section level1">
<h1><span class="header-section-number">13</span> Goals, Power, and Sample Size</h1>
<blockquote>
<p>Researchers collect data in order to achieve a goal. Sometimes the goal is to show that a suspected underlying state of the world is credible; other times the goal is to achieve a minimal degree of precision on whatever trends are observed. Whatever the goal, it can only be probabilistically achieved, as opposed to definitely achieved, because data are replete with random noise that can obscure the underlying state of the world. Statistical <em>power</em> is the probability of achieving the goal of a planned empirical study, if a suspected underlying state of the world is true. <span class="citation">(Kruschke, <a href="#ref-kruschkeDoingBayesianData2015">2015</a>, p. 359, <em>emphasis</em> in the original)</span></p>
</blockquote>
<div id="the-will-to-power" class="section level2">
<h2><span class="header-section-number">13.1</span> The will to power</h2>
<p>“In this section, [Kruschke laid out a] framework for research and data analysis [that might lead] to a more precise definition of power and how to compute it” (p. 360).</p>
<div id="goals-and-obstacles." class="section level3">
<h3><span class="header-section-number">13.1.1</span> Goals and obstacles.</h3>
<p>The three research goals Kruschke dealt with in this chapter were:</p>
<ul>
<li>to reject a null value for a parameter,</li>
<li>to confirm the legitimacy of a particular parameter value, and</li>
<li>to estimate a parameter with reasonable precision.</li>
</ul>
<p>All these could, of course, be extended to contexts involving multiple parameters and all of these were dealt with using 95% HDIs.</p>
</div>
<div id="power." class="section level3">
<h3><span class="header-section-number">13.1.2</span> Power.</h3>
<blockquote>
<p>Because of random noise, the goal of a study can be achieved only probabilistically. The probability of achieving the goal, given the hypothetical state of the world and the sampling plan, is called the <em>power</em> of the planned research. In traditional null hypothesis significance testing (NHST), power has only one goal (rejecting the null hypothesis), and there is one conventional sampling plan (stop at predetermined sample size) and the hypothesis is only a single specific value of the parameter. In traditional statistics, that is <em>the</em> definition of power. That definition is generalized in this book to include other goals, other sampling plans, and hypotheses that involve an entire distribution on parameters. (p. 361, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Three primary methods to increase power are:</p>
<ul>
<li>reducing measurement error,</li>
<li>increasing the effect size, and</li>
<li>increasing the sample size.</li>
</ul>
<p>Kruschke then laid out a five-step procedure to compute power within a Bayesian workflow.</p>
<ol style="list-style-type: decimal">
<li>Use theory/prior information to specify hypothetical distributions for all parameter values in the model.</li>
<li>Use those distributions to generate synthetic data according to the planned sampling method.</li>
<li>Fit the proposed model–including the relevant priors–with the synthetic data.</li>
<li>Use the posterior to determine whether we attained the research goal.</li>
<li>Repeat the procedure many times (i.e., using different <code>set.seed()</code> values) to get a distribution of results.</li>
</ol>
</div>
<div id="sample-size." class="section level3">
<h3><span class="header-section-number">13.1.3</span> Sample size.</h3>
<blockquote>
<p><em>The best that a large sample can do is exactly reflect the data-generating distribution.</em> If the data-generating distribution has considerable mass straddling the null value, then the best we can do is get estimates that include and straddle the null value. As a simple example, suppose that we think that a coin may be biased, and the data-generating hypothesis entertains four possible values of <span class="math inline">\(\theta\)</span> , with <span class="math inline">\(p (\theta = 0.5) = 25 \%\)</span>, <span class="math inline">\(p (\theta = 0.6) = 25 \%\)</span>, <span class="math inline">\(p (\theta = 0.7) = 25 \%\)</span>, and <span class="math inline">\(p (\theta = 0.8) = 25 \%\)</span>. Because <span class="math inline">\(25 \%\)</span> of the simulated data come from a fair coin, the maximum probability of excluding <span class="math inline">\(\theta = 0.5\)</span>, even with a huge sample, is <span class="math inline">\(75 \%\)</span>.</p>
<p>Therefore, when planning the sample size for an experiment, it is crucial to decide what a realistic goal is. If there are good reasons to posit a highly certain data-generating hypothesis, perhaps because of extensive previous results, then a viable goal may be to exclude a null value. On the other hand, if the data-generating hypothesis is somewhat vague, then a more reasonable goal is to attain a desired degree of precision in the posterior. (p. 364, <em>emphasis</em> in the original)</p>
</blockquote>
</div>
<div id="other-expressions-of-goals." class="section level3">
<h3><span class="header-section-number">13.1.4</span> Other expressions of goals.</h3>
<p>I’m going to skip over these.</p>
<blockquote>
<p>In the remainder of the chapter, it will be assumed that the goal of the research is estimation of the parameter values, starting with a viable prior. The resulting posterior distribution is then used to assess whether the goal was achieved. (p. 366)</p>
</blockquote>
</div>
</div>
<div id="computing-power-and-sample-size" class="section level2">
<h2><span class="header-section-number">13.2</span> Computing power and sample size</h2>
<blockquote>
<p>As our first worked-out example, consider the simplest case: Data from a single coin. Perhaps we are polling a population and we want to precisely estimate the preferences for candidates A or B. Perhaps we want to know if a drug has more than a 50% cure rate. (p. 366)</p>
</blockquote>
<div id="when-the-goal-is-to-exclude-a-null-value." class="section level3">
<h3><span class="header-section-number">13.2.1</span> When the goal is to exclude a null value.</h3>
<blockquote>
<p>Usually it is more intuitively accessible to get prior data, or to think of idealized prior data, than to directly specify a distribution over parameter values. For example, based on knowledge about the application domain, we might have 2000 actual or idealized flips of the coin for which the result showed 65% heads. Therefore we’ll describe the data-generating hypothesis as a beta distribution with a mode of 0.65 and concentration based on 2000 flips after a uniform “proto-prior”: <span class="math inline">\(\operatorname{beta} (\theta | 0.65 \cdot (2000 - 2) + 1, (1 - 0.65) \cdot (2000 - 2) + 1)\)</span>.</p>
</blockquote>
<p>We might express that in code like this.</p>
<div class="sourceCode" id="cb1069"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1069-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1069-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1069-3" data-line-number="3">kappa &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb1069-4" data-line-number="4">omega &lt;-<span class="st"> </span><span class="fl">.65</span></a>
<a class="sourceLine" id="cb1069-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1069-6" data-line-number="6"><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.001</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1069-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior =</span> <span class="kw">dbeta</span>(theta,</a>
<a class="sourceLine" id="cb1069-8" data-line-number="8">                       <span class="dt">shape1 =</span>      omega  <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1069-9" data-line-number="9">                       <span class="dt">shape2 =</span> (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>omega) <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1069-10" data-line-number="10"><span class="st">  </span></a>
<a class="sourceLine" id="cb1069-11" data-line-number="11"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> prior)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1069-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1069-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1069-14" data-line-number="14"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Behold our prior. It&#39;s rather peaked.&quot;</span>,</a>
<a class="sourceLine" id="cb1069-15" data-line-number="15">       <span class="dt">x =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1069-16" data-line-number="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="13_files/figure-gfm/unnamed-chunk-2-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>If we wanted to take some random draws from that prior, say 5, we’d do something like this.</p>
<div class="sourceCode" id="cb1070"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1070-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb1070-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1070-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">13</span>)</a>
<a class="sourceLine" id="cb1070-4" data-line-number="4"><span class="kw">rbeta</span>(n,</a>
<a class="sourceLine" id="cb1070-5" data-line-number="5">      <span class="dt">shape1 =</span>      omega  <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1070-6" data-line-number="6">      <span class="dt">shape2 =</span> (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>omega) <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 0.6430548 0.6532279 0.6250891 0.6475884 0.6351476</code></pre>
<p>Now let’s just take one draw and call it <code>bias</code>.</p>
<div class="sourceCode" id="cb1072"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1072-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1072-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1072-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">13</span>)</a>
<a class="sourceLine" id="cb1072-4" data-line-number="4">bias &lt;-</a>
<a class="sourceLine" id="cb1072-5" data-line-number="5"><span class="st">  </span><span class="kw">rbeta</span>(n,</a>
<a class="sourceLine" id="cb1072-6" data-line-number="6">        <span class="dt">shape1 =</span>      omega  <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1072-7" data-line-number="7">        <span class="dt">shape2 =</span> (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>omega) <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1072-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1072-9" data-line-number="9"><span class="kw">print</span>(bias)</a></code></pre></div>
<pre><code>## [1] 0.6430548</code></pre>
<p>Do note that whereas Kruschke based his discussion on a bias of 0.638, we’re moving forward with our randomly-drawn 0.643. Anyways, now we</p>
<blockquote>
<p>simulate flipping a coin with that bias <span class="math inline">\(N\)</span> times. The simulated data have <span class="math inline">\(z\)</span> heads and <span class="math inline">\(N − z\)</span> tails. The proportion of heads, <span class="math inline">\(z/N\)</span>, will tend to be around [0.643], but will be higher or lower because of randomness in the flips. (p. 367)</p>
</blockquote>
<div class="sourceCode" id="cb1074"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1074-1" data-line-number="1"><span class="co"># pick some large number</span></a>
<a class="sourceLine" id="cb1074-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="fl">1e3</span></a>
<a class="sourceLine" id="cb1074-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1074-4" data-line-number="4"><span class="kw">set.seed</span>(<span class="dv">13</span>)</a>
<a class="sourceLine" id="cb1074-5" data-line-number="5"><span class="kw">tibble</span>(<span class="dt">flips =</span> <span class="kw">rbernoulli</span>(<span class="dt">n =</span> n, <span class="dt">p =</span> bias)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1074-6" data-line-number="6"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb1074-7" data-line-number="7">            <span class="dt">z =</span> <span class="kw">sum</span>(flips)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1074-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">proportion of heads</span><span class="st">`</span> =<span class="st"> </span>z <span class="op">/</span><span class="st"> </span>n)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##       n     z `proportion of heads`
##   &lt;int&gt; &lt;int&gt;                 &lt;dbl&gt;
## 1  1000   652                 0.652</code></pre>
<p>And indeed our samples did tend around <span class="math inline">\(\theta =.643\)</span>. Had we increased our number of draws by an order of magnitude or two, it our proportion of heads would have been even closer to the true data-generating value.</p>
<p>Though he presented Table 13.1 in this section, Kruschke walked out how he came to those values in the following sections. We’ll get to them in just a bit.</p>
</div>
<div id="formal-solution-and-implementation-in-r." class="section level3">
<h3><span class="header-section-number">13.2.2</span> Formal solution and implementation in R.</h3>
<p>I’ve been playing around with this a bit. If you look closely at the code block on page 369, you’ll see that Kruschke’s <code>minNforHDIpower()</code> function requires the <code>HDIofICDF()</code> function from his <code>DBDA2E-utilities.R</code> file, which we usually recast as <code>hdi_of_icdf()</code>.</p>
<div class="sourceCode" id="cb1076"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1076-1" data-line-number="1">hdi_of_icdf &lt;-<span class="st"> </span><span class="cf">function</span>(name, <span class="dt">width =</span> <span class="fl">.95</span>, <span class="dt">tol =</span> <span class="fl">1e-8</span>, ... ) {</a>
<a class="sourceLine" id="cb1076-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb1076-3" data-line-number="3">  incredible_mass &lt;-<span class="st"> </span><span class="fl">1.0</span> <span class="op">-</span><span class="st"> </span>width</a>
<a class="sourceLine" id="cb1076-4" data-line-number="4">  interval_width &lt;-<span class="st"> </span><span class="cf">function</span>(low_tail_prob, name, width, ...) {</a>
<a class="sourceLine" id="cb1076-5" data-line-number="5">    <span class="kw">name</span>(width <span class="op">+</span><span class="st"> </span>low_tail_prob, ...) <span class="op">-</span><span class="st"> </span><span class="kw">name</span>(low_tail_prob, ...)</a>
<a class="sourceLine" id="cb1076-6" data-line-number="6">  }</a>
<a class="sourceLine" id="cb1076-7" data-line-number="7">  opt_info &lt;-<span class="st"> </span><span class="kw">optimize</span>(interval_width, <span class="kw">c</span>(<span class="dv">0</span>, incredible_mass), </a>
<a class="sourceLine" id="cb1076-8" data-line-number="8">                       <span class="dt">name =</span> name, <span class="dt">width =</span> width, </a>
<a class="sourceLine" id="cb1076-9" data-line-number="9">                       <span class="dt">tol =</span> tol, ...)</a>
<a class="sourceLine" id="cb1076-10" data-line-number="10">  hdi_lower_tail_prob &lt;-<span class="st"> </span>opt_info<span class="op">$</span>minimum</a>
<a class="sourceLine" id="cb1076-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb1076-12" data-line-number="12">  <span class="kw">return</span>(<span class="kw">c</span>(<span class="kw">name</span>(hdi_lower_tail_prob, ...),</a>
<a class="sourceLine" id="cb1076-13" data-line-number="13">           <span class="kw">name</span>(width <span class="op">+</span><span class="st"> </span>hdi_lower_tail_prob, ...)))</a>
<a class="sourceLine" id="cb1076-14" data-line-number="14">  </a>
<a class="sourceLine" id="cb1076-15" data-line-number="15">}</a></code></pre></div>
<p>Just to warm up, consider a beta distribution for which <span class="math inline">\(\omega = .5\)</span> and <span class="math inline">\(\kappa = 2000\)</span>. Here are the 95% HDIs.</p>
<div class="sourceCode" id="cb1077"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1077-1" data-line-number="1">omega &lt;-<span class="st"> </span><span class="fl">.5</span></a>
<a class="sourceLine" id="cb1077-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1077-3" data-line-number="3"><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</a>
<a class="sourceLine" id="cb1077-4" data-line-number="4">            <span class="dt">shape1 =</span>      omega  <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1077-5" data-line-number="5">            <span class="dt">shape2 =</span> (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>omega) <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 0.4780947 0.5219053</code></pre>
<p>Those look a whole lot like the ROPE values Kruschke specified in his example at the bottom of page 370. But we’re getting ahead of ourselves. Now that we have our <code>hdi_of_icdf()</code> function, we’re ready to define our version of <code>minNforHDIpower()</code>, which I’m calling <code>min_n_for_hdi_power()</code>.</p>
<div class="sourceCode" id="cb1079"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1079-1" data-line-number="1">min_n_for_hdi_power &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1079-2" data-line-number="2"><span class="st">  </span><span class="cf">function</span>(gen_prior_mode, gen_prior_n,</a>
<a class="sourceLine" id="cb1079-3" data-line-number="3">           <span class="dt">hdi_max_width =</span> <span class="ot">NULL</span>, <span class="dt">null_value =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb1079-4" data-line-number="4">           <span class="dt">rope =</span> <span class="kw">c</span>(<span class="kw">max</span>(<span class="dv">0</span>, null_value <span class="op">-</span><span class="st"> </span><span class="fl">0.02</span>), <span class="kw">min</span>(<span class="dv">1</span>, null_value <span class="op">+</span><span class="st"> </span><span class="fl">0.02</span>)),</a>
<a class="sourceLine" id="cb1079-5" data-line-number="5">           <span class="dt">desired_power =</span> <span class="fl">0.8</span>, <span class="dt">aud_prior_mode =</span> <span class="fl">0.5</span>, <span class="dt">aud_prior_n =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1079-6" data-line-number="6">           <span class="dt">hdi_mass =</span> <span class="fl">0.95</span>, <span class="dt">init_samp_size =</span> <span class="dv">20</span>, <span class="dt">verbose =</span> <span class="ot">TRUE</span>) {</a>
<a class="sourceLine" id="cb1079-7" data-line-number="7">    <span class="co"># Check for argument consistency:</span></a>
<a class="sourceLine" id="cb1079-8" data-line-number="8">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">xor</span>(<span class="kw">is.null</span>(hdi_max_width), <span class="kw">is.null</span>(null_value))) {</a>
<a class="sourceLine" id="cb1079-9" data-line-number="9">      <span class="kw">stop</span>(<span class="st">&quot;One and only one of `hdi_max_width` and `null_value` must be specified.&quot;</span>)</a>
<a class="sourceLine" id="cb1079-10" data-line-number="10">    }</a>
<a class="sourceLine" id="cb1079-11" data-line-number="11">    <span class="co"># Convert prior mode and N to a, b parameters of beta distribution:</span></a>
<a class="sourceLine" id="cb1079-12" data-line-number="12">    gen_prior_a &lt;-<span class="st">        </span>gen_prior_mode  <span class="op">*</span><span class="st"> </span>(gen_prior_n <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1079-13" data-line-number="13">    gen_prior_b &lt;-<span class="st"> </span>(<span class="fl">1.0</span> <span class="op">-</span><span class="st"> </span>gen_prior_mode) <span class="op">*</span><span class="st"> </span>(gen_prior_n <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1079-14" data-line-number="14">    aud_prior_a &lt;-<span class="st">        </span>aud_prior_mode  <span class="op">*</span><span class="st"> </span>(aud_prior_n <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1079-15" data-line-number="15">    aud_prior_b &lt;-<span class="st"> </span>(<span class="fl">1.0</span> <span class="op">-</span><span class="st"> </span>aud_prior_mode) <span class="op">*</span><span class="st"> </span>(aud_prior_n <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1079-16" data-line-number="16">    <span class="co"># Initialize loop for incrementing `sample_size`:</span></a>
<a class="sourceLine" id="cb1079-17" data-line-number="17">    sample_size &lt;-<span class="st"> </span>init_samp_size</a>
<a class="sourceLine" id="cb1079-18" data-line-number="18">    not_powerful_enough =<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb1079-19" data-line-number="19">    <span class="co"># Increment `sample_size` until desired power is achieved:</span></a>
<a class="sourceLine" id="cb1079-20" data-line-number="20">    <span class="cf">while</span>(not_powerful_enough) {</a>
<a class="sourceLine" id="cb1079-21" data-line-number="21">      z_vec &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span>sample_size <span class="co"># vector of all possible z values for N flips.</span></a>
<a class="sourceLine" id="cb1079-22" data-line-number="22">      <span class="co"># Compute probability of each z value for data-generating prior:</span></a>
<a class="sourceLine" id="cb1079-23" data-line-number="23">      p_z_vec &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">lchoose</span>(sample_size, z_vec)</a>
<a class="sourceLine" id="cb1079-24" data-line-number="24">                     <span class="op">+</span><span class="st"> </span><span class="kw">lbeta</span>(z_vec <span class="op">+</span><span class="st"> </span>gen_prior_a, sample_size <span class="op">-</span><span class="st"> </span>z_vec <span class="op">+</span><span class="st"> </span>gen_prior_b)</a>
<a class="sourceLine" id="cb1079-25" data-line-number="25">                     <span class="op">-</span><span class="st"> </span><span class="kw">lbeta</span>(gen_prior_a, gen_prior_b))</a>
<a class="sourceLine" id="cb1079-26" data-line-number="26">      <span class="co"># For each z value, compute posterior HDI:</span></a>
<a class="sourceLine" id="cb1079-27" data-line-number="27">      <span class="co"># `hdi_matrix` will hold HDI limits for each z:</span></a>
<a class="sourceLine" id="cb1079-28" data-line-number="28">      hdi_matrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="kw">length</span>(z_vec), <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1079-29" data-line-number="29">      <span class="cf">for</span> (z_id_x <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(z_vec)) {</a>
<a class="sourceLine" id="cb1079-30" data-line-number="30">        z &lt;-<span class="st"> </span>z_vec[z_id_x]</a>
<a class="sourceLine" id="cb1079-31" data-line-number="31">        hdi_matrix[z_id_x, ] &lt;-<span class="st"> </span><span class="kw">hdi_of_icdf</span>(qbeta,</a>
<a class="sourceLine" id="cb1079-32" data-line-number="32">                                            <span class="dt">shape1 =</span> z <span class="op">+</span><span class="st"> </span>aud_prior_a,</a>
<a class="sourceLine" id="cb1079-33" data-line-number="33">                                            <span class="dt">shape2 =</span> sample_size <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>aud_prior_b,</a>
<a class="sourceLine" id="cb1079-34" data-line-number="34">                                            <span class="dt">width  =</span> hdi_mass)</a>
<a class="sourceLine" id="cb1079-35" data-line-number="35">      }</a>
<a class="sourceLine" id="cb1079-36" data-line-number="36">      <span class="co"># Compute HDI widths:</span></a>
<a class="sourceLine" id="cb1079-37" data-line-number="37">      hdi_width &lt;-<span class="st"> </span>hdi_matrix[, <span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>hdi_matrix[, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1079-38" data-line-number="38">      <span class="co"># Sum the probabilities of outcomes with satisfactory HDI widths:</span></a>
<a class="sourceLine" id="cb1079-39" data-line-number="39">      <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(hdi_max_width)) {</a>
<a class="sourceLine" id="cb1079-40" data-line-number="40">        power_hdi &lt;-<span class="st"> </span><span class="kw">sum</span>(p_z_vec[hdi_width <span class="op">&lt;</span><span class="st"> </span>hdi_max_width])</a>
<a class="sourceLine" id="cb1079-41" data-line-number="41">      }</a>
<a class="sourceLine" id="cb1079-42" data-line-number="42">      <span class="co"># Sum the probabilities of outcomes with HDI excluding `rope`:</span></a>
<a class="sourceLine" id="cb1079-43" data-line-number="43">      <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(null_value)) {</a>
<a class="sourceLine" id="cb1079-44" data-line-number="44">        power_hdi &lt;-<span class="st"> </span><span class="kw">sum</span>(p_z_vec[hdi_matrix[, <span class="dv">1</span>] <span class="op">&gt;</span><span class="st"> </span>rope[<span class="dv">2</span>] <span class="op">|</span><span class="st"> </span>hdi_matrix[, <span class="dv">2</span>] <span class="op">&lt;</span><span class="st"> </span>rope[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb1079-45" data-line-number="45">      }</a>
<a class="sourceLine" id="cb1079-46" data-line-number="46">      <span class="cf">if</span> (verbose) {</a>
<a class="sourceLine" id="cb1079-47" data-line-number="47">        <span class="kw">cat</span>(<span class="st">&quot; For sample size = &quot;</span>, sample_size, <span class="st">&quot;, power = &quot;</span>, power_hdi,</a>
<a class="sourceLine" id="cb1079-48" data-line-number="48">            <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>); <span class="kw">flush.console</span>() </a>
<a class="sourceLine" id="cb1079-49" data-line-number="49">      }</a>
<a class="sourceLine" id="cb1079-50" data-line-number="50">      <span class="cf">if</span> (power_hdi <span class="op">&gt;</span><span class="st"> </span>desired_power) {  <span class="co"># If desired power is attained,</span></a>
<a class="sourceLine" id="cb1079-51" data-line-number="51">        not_powerful_enough =<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb1079-52" data-line-number="52">      } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb1079-53" data-line-number="53">        sample_size &lt;-<span class="st"> </span>sample_size <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1079-54" data-line-number="54">        <span class="co"># set flag to stop,</span></a>
<a class="sourceLine" id="cb1079-55" data-line-number="55">        <span class="co"># otherwise</span></a>
<a class="sourceLine" id="cb1079-56" data-line-number="56">        <span class="co"># increment the sample size.</span></a>
<a class="sourceLine" id="cb1079-57" data-line-number="57">      }</a>
<a class="sourceLine" id="cb1079-58" data-line-number="58">    } <span class="co"># End while( not_powerful_enough ).</span></a>
<a class="sourceLine" id="cb1079-59" data-line-number="59">    <span class="co"># Return the sample size that achieved the desired power:</span></a>
<a class="sourceLine" id="cb1079-60" data-line-number="60">    <span class="kw">return</span>(sample_size)</a>
<a class="sourceLine" id="cb1079-61" data-line-number="61">}</a></code></pre></div>
<p>Other than altering Kruschke’s formatting a little bit, the only meaningful change I made to the code was removing the line that checked for the <code>HDIofICD()</code> function and then <code>source()</code>ed it, if necessary. Following along with Kruschke on page 370, here’s an example for which <span class="math inline">\(\omega_\text{data generating} = .75\)</span>, <span class="math inline">\(\kappa = 2000\)</span>, the ROPE is <span class="math inline">\([.48, .52]\)</span>, and the desired power is the conventional .8.</p>
<div class="sourceCode" id="cb1080"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1080-1" data-line-number="1"><span class="kw">min_n_for_hdi_power</span>(<span class="dt">gen_prior_mode =</span> <span class="fl">.75</span>, </a>
<a class="sourceLine" id="cb1080-2" data-line-number="2">                    <span class="dt">gen_prior_n    =</span> <span class="dv">2000</span>,</a>
<a class="sourceLine" id="cb1080-3" data-line-number="3">                    <span class="dt">hdi_max_width  =</span> <span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb1080-4" data-line-number="4">                    <span class="dt">null_value     =</span> <span class="fl">.5</span>, </a>
<a class="sourceLine" id="cb1080-5" data-line-number="5">                    <span class="dt">rope           =</span> <span class="kw">c</span>(.<span class="dv">48</span>, <span class="fl">.52</span>),</a>
<a class="sourceLine" id="cb1080-6" data-line-number="6">                    <span class="dt">desired_power  =</span> <span class="fl">.8</span>,</a>
<a class="sourceLine" id="cb1080-7" data-line-number="7">                    <span class="dt">aud_prior_mode =</span> <span class="fl">.5</span>, </a>
<a class="sourceLine" id="cb1080-8" data-line-number="8">                    <span class="dt">aud_prior_n    =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1080-9" data-line-number="9">                    <span class="dt">hdi_mass       =</span> <span class="fl">.95</span>, </a>
<a class="sourceLine" id="cb1080-10" data-line-number="10">                    <span class="dt">init_samp_size =</span> <span class="dv">20</span>, </a>
<a class="sourceLine" id="cb1080-11" data-line-number="11">                    <span class="dt">verbose        =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>##  For sample size = 20, power = 0.6159196
##  For sample size = 21, power = 0.5655352
##  For sample size = 22, power = 0.6976802
##  For sample size = 23, power = 0.6521637
##  For sample size = 24, power = 0.606033
##  For sample size = 25, power = 0.7245362
##  For sample size = 26, power = 0.6832871
##  For sample size = 27, power = 0.7836981
##  For sample size = 28, power = 0.7479021
##  For sample size = 29, power = 0.7103786
##  For sample size = 30, power = 0.8009259</code></pre>
<pre><code>## [1] 30</code></pre>
<p>Just like in the text, the necessary <span class="math inline">\(N = 30\)</span>.</p>
<p>Unlike in the text, I increased the value of <code>init_samp_size</code> from 5 to 20 to keep the output a reasonable length. To clarify what we just did,</p>
<blockquote>
<p>in that function call, the data-generating distribution has a mode of 0.75 and concentration of 2000, which means that the hypothesized world is pretty certain that coins have a bias of 0.75. The goal is to exclude a null value of 0.5 with a ROPE from 0.48 to 0.52. The desired power [is] 80%. The audience prior is uniform. When the function is executed, it displays the power for increasing values of sample size, until stopping at <span class="math inline">\(N = 30\)</span>. (p. 370)</p>
</blockquote>
<p>If it’s unclear why the “audience prior is uniform”, consider this.</p>
<div class="sourceCode" id="cb1083"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1083-1" data-line-number="1">kappa &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1083-2" data-line-number="2">omega &lt;-<span class="st"> </span><span class="fl">.5</span></a>
<a class="sourceLine" id="cb1083-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1083-4" data-line-number="4"><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.01</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1083-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior =</span> <span class="kw">dbeta</span>(theta,</a>
<a class="sourceLine" id="cb1083-6" data-line-number="6">                       <span class="dt">shape1 =</span>      omega  <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1083-7" data-line-number="7">                       <span class="dt">shape2 =</span> (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>omega) <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1083-8" data-line-number="8"><span class="st">  </span></a>
<a class="sourceLine" id="cb1083-9" data-line-number="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> prior)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1083-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1083-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1083-12" data-line-number="12"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.25</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1083-13" data-line-number="13"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Behold the uniform audience prior.&quot;</span>,</a>
<a class="sourceLine" id="cb1083-14" data-line-number="14">       <span class="dt">x =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1083-15" data-line-number="15"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="13_files/figure-gfm/unnamed-chunk-10-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>If you work out the algebra with <code>omega</code> and <code>kappa</code>, you’ll see this is a <span class="math inline">\(\operatorname{beta} (1, 1)\)</span>. Thus, <code>aud_prior_n</code> is <span class="math inline">\(\kappa\)</span> and <code>aud_prior_mode</code> is <span class="math inline">\(\omega\)</span>.</p>
<p>Here we’ll wrap our <code>min_n_for_hdi_power()</code> function into a simple <code>sim_power()</code> function for use with <code>purrr::map2()</code>.</p>
<div class="sourceCode" id="cb1084"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1084-1" data-line-number="1">sim_power &lt;-<span class="st"> </span><span class="cf">function</span>(mode, power) {</a>
<a class="sourceLine" id="cb1084-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb1084-3" data-line-number="3">  <span class="kw">min_n_for_hdi_power</span>(<span class="dt">gen_prior_mode =</span> mode, </a>
<a class="sourceLine" id="cb1084-4" data-line-number="4">                      <span class="dt">gen_prior_n    =</span> <span class="dv">2000</span>,</a>
<a class="sourceLine" id="cb1084-5" data-line-number="5">                      <span class="dt">hdi_max_width  =</span> <span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb1084-6" data-line-number="6">                      <span class="dt">null_value     =</span> <span class="fl">.5</span>, </a>
<a class="sourceLine" id="cb1084-7" data-line-number="7">                      <span class="dt">rope           =</span> <span class="kw">c</span>(.<span class="dv">48</span>, <span class="fl">.52</span>),</a>
<a class="sourceLine" id="cb1084-8" data-line-number="8">                      <span class="dt">desired_power  =</span> power,</a>
<a class="sourceLine" id="cb1084-9" data-line-number="9">                      <span class="dt">aud_prior_mode =</span> <span class="fl">.5</span>, </a>
<a class="sourceLine" id="cb1084-10" data-line-number="10">                      <span class="dt">aud_prior_n    =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1084-11" data-line-number="11">                      <span class="dt">hdi_mass       =</span> <span class="fl">.95</span>, </a>
<a class="sourceLine" id="cb1084-12" data-line-number="12">                      <span class="dt">init_samp_size =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb1084-13" data-line-number="13">                      <span class="dt">verbose        =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1084-14" data-line-number="14">  </a>
<a class="sourceLine" id="cb1084-15" data-line-number="15">}</a></code></pre></div>
<p>Here we use the two functions to compute the values in Table 13.1 on page 367.</p>
<div class="sourceCode" id="cb1085"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1085-1" data-line-number="1">sim &lt;-</a>
<a class="sourceLine" id="cb1085-2" data-line-number="2"><span class="st">  </span><span class="kw">crossing</span>(<span class="dt">mode  =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">.6</span>, <span class="dt">to =</span> <span class="fl">.85</span>, <span class="dt">by =</span> <span class="fl">.05</span>),</a>
<a class="sourceLine" id="cb1085-3" data-line-number="3">           <span class="dt">power =</span> <span class="kw">c</span>(.<span class="dv">7</span>, <span class="fl">.8</span>, <span class="fl">.9</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1085-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">results =</span> <span class="kw">map2_dbl</span>(mode, power, sim_power))</a></code></pre></div>
<p>The results look like this.</p>
<div class="sourceCode" id="cb1086"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1086-1" data-line-number="1"><span class="kw">print</span>(sim)</a></code></pre></div>
<pre><code>## # A tibble: 18 x 3
##     mode power results
##    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1  0.6    0.7     238
##  2  0.6    0.8     309
##  3  0.6    0.9     430
##  4  0.65   0.7      83
##  5  0.65   0.8     109
##  6  0.65   0.9     150
##  7  0.7    0.7      40
##  8  0.7    0.8      52
##  9  0.7    0.9      74
## 10  0.75   0.7      25
## 11  0.75   0.8      30
## 12  0.75   0.9      43
## 13  0.8    0.7      16
## 14  0.8    0.8      19
## 15  0.8    0.9      27
## 16  0.85   0.7       7
## 17  0.85   0.8      14
## 18  0.85   0.9      16</code></pre>
<p>It takes just a tiny bit of wrangling to reproduce Table 13.1.</p>
<div class="sourceCode" id="cb1088"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1088-1" data-line-number="1">sim <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1088-2" data-line-number="2"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> mode,</a>
<a class="sourceLine" id="cb1088-3" data-line-number="3">              <span class="dt">values_from =</span> results) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1088-4" data-line-number="4"><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">power</th>
<th align="right">0.6</th>
<th align="right">0.65</th>
<th align="right">0.7</th>
<th align="right">0.75</th>
<th align="right">0.8</th>
<th align="right">0.85</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.7</td>
<td align="right">238</td>
<td align="right">83</td>
<td align="right">40</td>
<td align="right">25</td>
<td align="right">16</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="right">0.8</td>
<td align="right">309</td>
<td align="right">109</td>
<td align="right">52</td>
<td align="right">30</td>
<td align="right">19</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="right">0.9</td>
<td align="right">430</td>
<td align="right">150</td>
<td align="right">74</td>
<td align="right">43</td>
<td align="right">27</td>
<td align="right">16</td>
</tr>
</tbody>
</table>
</div>
<div id="when-the-goal-is-precision." class="section level3">
<h3><span class="header-section-number">13.2.3</span> When the goal is precision.</h3>
<p>Recall that if we have <span class="math inline">\(\operatorname{beta} (a, b)\)</span> prior for <span class="math inline">\(\theta\)</span> of the Bernoulli likelihood function, then the analytic solution for the posterior is <span class="math inline">\(\operatorname{beta} (\theta | z + a, N – z + b)\)</span>. In our first example, <span class="math inline">\(z = 6\)</span> out of <span class="math inline">\(N = 10\)</span> randomly selected voters preferred candidate A and we started with a flat <span class="math inline">\(\operatorname{beta} (\theta | 1, 1)\)</span> prior. We can check that our posterior is indeed <span class="math inline">\(\operatorname{beta} (7, 5)\)</span> by working through the algebra.</p>
<div class="sourceCode" id="cb1089"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1089-1" data-line-number="1">z &lt;-<span class="st"> </span><span class="dv">6</span></a>
<a class="sourceLine" id="cb1089-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb1089-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1089-4" data-line-number="4"><span class="co"># posterior alpha</span></a>
<a class="sourceLine" id="cb1089-5" data-line-number="5">z <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb1091"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1091-1" data-line-number="1"><span class="co"># posterior beta</span></a>
<a class="sourceLine" id="cb1091-2" data-line-number="2">n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a></code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>Here’s how we compute the 95% HDIs.</p>
<div class="sourceCode" id="cb1093"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1093-1" data-line-number="1">(</a>
<a class="sourceLine" id="cb1093-2" data-line-number="2">  h &lt;-</a>
<a class="sourceLine" id="cb1093-3" data-line-number="3"><span class="st">    </span><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</a>
<a class="sourceLine" id="cb1093-4" data-line-number="4">                <span class="dt">shape1 =</span> <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb1093-5" data-line-number="5">                <span class="dt">shape2 =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb1093-6" data-line-number="6">)</a></code></pre></div>
<pre><code>## [1] 0.3182322 0.8414276</code></pre>
<p>The <span class="math inline">\(\operatorname{beta} (7, 5)\)</span> distribution looks like this.</p>
<div class="sourceCode" id="cb1095"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1095-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.01</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1095-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dbeta</span>(theta,</a>
<a class="sourceLine" id="cb1095-3" data-line-number="3">                         <span class="dt">shape1 =</span> <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb1095-4" data-line-number="4">                         <span class="dt">shape2 =</span> <span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1095-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb1095-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> density)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1095-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1095-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">x =</span> h[<span class="dv">1</span>], <span class="dt">xend =</span> h[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb1095-9" data-line-number="9">               <span class="dt">y =</span> <span class="dv">0</span>,    <span class="dt">yend =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb1095-10" data-line-number="10">               <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1095-11" data-line-number="11"><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.6</span>, <span class="dt">y =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">label =</span> <span class="st">&quot;95% HDI&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1095-12" data-line-number="12"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, h[<span class="dv">1</span>], z <span class="op">/</span><span class="st"> </span>n, h[<span class="dv">2</span>], <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1095-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1095-14" data-line-number="14"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="kw">expression</span>(<span class="st">&quot;beta&quot;</span><span class="op">*</span>(<span class="dv">7</span><span class="op">*</span><span class="st">&quot;, &quot;</span><span class="op">*</span><span class="dv">5</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1095-15" data-line-number="15"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="13_files/figure-gfm/unnamed-chunk-16-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>“It turns out, in this case, that we can never have a sample size large enough to achieve the goal of 80% of the HDIs falling above <span class="math inline">\(\theta = 0.5\)</span>. To see why,” keep reading in the text (p. 371). Happily,</p>
<blockquote>
<p>there is a more useful goal, however. Instead of trying to reject a particular value of <span class="math inline">\(\theta\)</span>, we set as our goal a desired degree of precision in the posterior estimate. For example, our goal might be that the 95% HDI has width less than 0.2, at least 80% of the time. (p. 371)</p>
</blockquote>
<p>If you look back up at our <code>min_n_for_hdi_power()</code> defining code, above, you’ll see that “One and only one of <code>hdi_max_width</code> and <code>null_value</code> must be specified.” So if we want to determine the necessary <span class="math inline">\(N\)</span> for an 95% HDI width of less than .2, we need to set <code>hdi_max_width = .2</code> and <code>null_value = NULL</code>.</p>
<div class="sourceCode" id="cb1096"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1096-1" data-line-number="1"><span class="kw">min_n_for_hdi_power</span>(<span class="dt">gen_prior_mode =</span> <span class="fl">.75</span>, </a>
<a class="sourceLine" id="cb1096-2" data-line-number="2">                    <span class="dt">gen_prior_n    =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1096-3" data-line-number="3">                    <span class="dt">hdi_max_width  =</span> <span class="fl">.2</span>,  <span class="co"># look here</span></a>
<a class="sourceLine" id="cb1096-4" data-line-number="4">                    <span class="dt">null_value     =</span> <span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb1096-5" data-line-number="5">                    <span class="dt">rope           =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb1096-6" data-line-number="6">                    <span class="dt">desired_power  =</span> <span class="fl">.8</span>,</a>
<a class="sourceLine" id="cb1096-7" data-line-number="7">                    <span class="dt">aud_prior_mode =</span> <span class="fl">.5</span>, </a>
<a class="sourceLine" id="cb1096-8" data-line-number="8">                    <span class="dt">aud_prior_n    =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1096-9" data-line-number="9">                    <span class="dt">hdi_mass       =</span> <span class="fl">.95</span>, </a>
<a class="sourceLine" id="cb1096-10" data-line-number="10">                    <span class="dt">init_samp_size =</span> <span class="dv">75</span>, </a>
<a class="sourceLine" id="cb1096-11" data-line-number="11">                    <span class="dt">verbose        =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>##  For sample size = 75, power = 0.5089359
##  For sample size = 76, power = 0.5337822
##  For sample size = 77, power = 0.5235513
##  For sample size = 78, power = 0.5474934
##  For sample size = 79, power = 0.5706373
##  For sample size = 80, power = 0.5929882
##  For sample size = 81, power = 0.6145578
##  For sample size = 82, power = 0.6353626
##  For sample size = 83, power = 0.6554231
##  For sample size = 84, power = 0.6747629
##  For sample size = 85, power = 0.6934076
##  For sample size = 86, power = 0.7113842
##  For sample size = 87, power = 0.7287209
##  For sample size = 88, power = 0.7716517
##  For sample size = 89, power = 0.787177
##  For sample size = 90, power = 0.8266938</code></pre>
<pre><code>## [1] 90</code></pre>
<p>Just like in the last section, here I set <code>init_samp_size</code> to a higher value than in the text in order to keep the output reasonably short. To reproduce the results in Table 13.2, we’ll need to adjust the <code>min_n_for_hdi_power()</code> parameters within our <code>sim_power()</code> function.</p>
<div class="sourceCode" id="cb1099"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1099-1" data-line-number="1">sim_power &lt;-<span class="st"> </span><span class="cf">function</span>(mode, power) {</a>
<a class="sourceLine" id="cb1099-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb1099-3" data-line-number="3">  <span class="kw">min_n_for_hdi_power</span>(<span class="dt">gen_prior_mode =</span> mode, </a>
<a class="sourceLine" id="cb1099-4" data-line-number="4">                      <span class="dt">gen_prior_n    =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1099-5" data-line-number="5">                      <span class="dt">hdi_max_width  =</span> <span class="fl">.2</span>, </a>
<a class="sourceLine" id="cb1099-6" data-line-number="6">                      <span class="dt">null_value     =</span> <span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb1099-7" data-line-number="7">                      <span class="dt">rope           =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb1099-8" data-line-number="8">                      <span class="dt">desired_power  =</span> power,</a>
<a class="sourceLine" id="cb1099-9" data-line-number="9">                      <span class="dt">aud_prior_mode =</span> <span class="fl">.5</span>, </a>
<a class="sourceLine" id="cb1099-10" data-line-number="10">                      <span class="dt">aud_prior_n    =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1099-11" data-line-number="11">                      <span class="dt">hdi_mass       =</span> <span class="fl">.95</span>, </a>
<a class="sourceLine" id="cb1099-12" data-line-number="12">                      <span class="dt">init_samp_size =</span> <span class="dv">50</span>, </a>
<a class="sourceLine" id="cb1099-13" data-line-number="13">                      <span class="dt">verbose        =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1099-14" data-line-number="14">  </a>
<a class="sourceLine" id="cb1099-15" data-line-number="15">}</a>
<a class="sourceLine" id="cb1099-16" data-line-number="16"></a>
<a class="sourceLine" id="cb1099-17" data-line-number="17">sim &lt;-</a>
<a class="sourceLine" id="cb1099-18" data-line-number="18"><span class="st">  </span><span class="kw">crossing</span>(<span class="dt">mode  =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">.6</span>, <span class="dt">to =</span> <span class="fl">.85</span>, <span class="dt">by =</span> <span class="fl">.05</span>),</a>
<a class="sourceLine" id="cb1099-19" data-line-number="19">           <span class="dt">power =</span> <span class="kw">c</span>(.<span class="dv">7</span>, <span class="fl">.8</span>, <span class="fl">.9</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1099-20" data-line-number="20"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">results =</span> <span class="kw">map2_dbl</span>(mode, power, sim_power))</a></code></pre></div>
<p>Let’s make that table.</p>
<div class="sourceCode" id="cb1100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1100-1" data-line-number="1">sim <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1100-2" data-line-number="2"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> mode,</a>
<a class="sourceLine" id="cb1100-3" data-line-number="3">              <span class="dt">values_from =</span> results) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1100-4" data-line-number="4"><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">power</th>
<th align="right">0.6</th>
<th align="right">0.65</th>
<th align="right">0.7</th>
<th align="right">0.75</th>
<th align="right">0.8</th>
<th align="right">0.85</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.7</td>
<td align="right">91</td>
<td align="right">90</td>
<td align="right">88</td>
<td align="right">86</td>
<td align="right">81</td>
<td align="right">75</td>
</tr>
<tr class="even">
<td align="right">0.8</td>
<td align="right">92</td>
<td align="right">92</td>
<td align="right">91</td>
<td align="right">90</td>
<td align="right">87</td>
<td align="right">82</td>
</tr>
<tr class="odd">
<td align="right">0.9</td>
<td align="right">93</td>
<td align="right">93</td>
<td align="right">93</td>
<td align="right">92</td>
<td align="right">91</td>
<td align="right">89</td>
</tr>
</tbody>
</table>
<p>What did that audience prior look like?</p>
<div class="sourceCode" id="cb1101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1101-1" data-line-number="1">kappa &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1101-2" data-line-number="2">omega &lt;-<span class="st"> </span><span class="fl">.5</span></a>
<a class="sourceLine" id="cb1101-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1101-4" data-line-number="4"><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1101-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dbeta</span>(theta,</a>
<a class="sourceLine" id="cb1101-6" data-line-number="6">                         <span class="dt">shape1 =</span>      omega  <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1101-7" data-line-number="7">                         <span class="dt">shape2 =</span> (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>omega) <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1101-8" data-line-number="8"><span class="st">  </span></a>
<a class="sourceLine" id="cb1101-9" data-line-number="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> density)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1101-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1101-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.25</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1101-12" data-line-number="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Behold the uniform audience prior.&quot;</span>,</a>
<a class="sourceLine" id="cb1101-13" data-line-number="13">       <span class="dt">x =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1101-14" data-line-number="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="13_files/figure-gfm/unnamed-chunk-20-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Here are what the beta distributions based on the <code>sim</code> look like.</p>
<div class="sourceCode" id="cb1102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1102-1" data-line-number="1">sim <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1102-2" data-line-number="2"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">n =</span> results) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1102-3" data-line-number="3"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(mode, power, n), </a>
<a class="sourceLine" id="cb1102-4" data-line-number="4">         <span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.01</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1102-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dbeta</span>(theta,</a>
<a class="sourceLine" id="cb1102-6" data-line-number="6">                         <span class="dt">shape1 =</span>      mode  <span class="op">*</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1102-7" data-line-number="7">                         <span class="dt">shape2 =</span> (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>mode) <span class="op">*</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1102-8" data-line-number="8">         <span class="dt">mode    =</span> <span class="kw">str_c</span>(<span class="st">&quot;omega == &quot;</span>, mode)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1102-9" data-line-number="9"><span class="st">  </span></a>
<a class="sourceLine" id="cb1102-10" data-line-number="10"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> density)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1102-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">.5</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1102-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1102-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="kw">expression</span>(theta), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;.5&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;1&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1102-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1102-15" data-line-number="15"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;The power and mode values are in the rows and columns, respectively.&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1102-16" data-line-number="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb1102-17" data-line-number="17"><span class="st">  </span><span class="kw">facet_grid</span>(power <span class="op">~</span><span class="st"> </span>mode, <span class="dt">labeller =</span> label_parsed)</a></code></pre></div>
<p><img src="13_files/figure-gfm/unnamed-chunk-21-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Toward the end of the section, Kruschke mentioned the required sample size shoots up if our desired HDI width is 0.1. Here’s the simulation.</p>
<div class="sourceCode" id="cb1103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1103-1" data-line-number="1">sim_power &lt;-<span class="st"> </span><span class="cf">function</span>(mode, power) {</a>
<a class="sourceLine" id="cb1103-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb1103-3" data-line-number="3">    <span class="kw">min_n_for_hdi_power</span>(<span class="dt">gen_prior_mode =</span> mode, </a>
<a class="sourceLine" id="cb1103-4" data-line-number="4">                        <span class="dt">gen_prior_n    =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1103-5" data-line-number="5">                        <span class="dt">hdi_max_width  =</span> <span class="fl">.1</span>, </a>
<a class="sourceLine" id="cb1103-6" data-line-number="6">                        <span class="dt">null_value     =</span> <span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb1103-7" data-line-number="7">                        <span class="dt">rope           =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb1103-8" data-line-number="8">                        <span class="dt">desired_power  =</span> power,</a>
<a class="sourceLine" id="cb1103-9" data-line-number="9">                        <span class="dt">aud_prior_mode =</span> <span class="fl">.5</span>, </a>
<a class="sourceLine" id="cb1103-10" data-line-number="10">                        <span class="dt">aud_prior_n    =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1103-11" data-line-number="11">                        <span class="dt">hdi_mass       =</span> <span class="fl">.95</span>, </a>
<a class="sourceLine" id="cb1103-12" data-line-number="12">                        <span class="dt">init_samp_size =</span> <span class="dv">300</span>,  <span class="co"># save some time and up this parameter </span></a>
<a class="sourceLine" id="cb1103-13" data-line-number="13">                        <span class="dt">verbose        =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1103-14" data-line-number="14">  </a>
<a class="sourceLine" id="cb1103-15" data-line-number="15">}</a>
<a class="sourceLine" id="cb1103-16" data-line-number="16"></a>
<a class="sourceLine" id="cb1103-17" data-line-number="17">sim &lt;-</a>
<a class="sourceLine" id="cb1103-18" data-line-number="18"><span class="st">  </span><span class="kw">crossing</span>(<span class="dt">mode  =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">.6</span>, <span class="dt">to =</span> <span class="fl">.85</span>, <span class="dt">by =</span> <span class="fl">.05</span>), </a>
<a class="sourceLine" id="cb1103-19" data-line-number="19">           <span class="dt">power =</span> <span class="kw">c</span>(.<span class="dv">7</span>, <span class="fl">.8</span>, <span class="fl">.9</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1103-20" data-line-number="20"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">results =</span> <span class="kw">map2_dbl</span>(mode, power, sim_power))</a></code></pre></div>
<p>Display the results in a table like before.</p>
<div class="sourceCode" id="cb1104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1104-1" data-line-number="1">sim <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1104-2" data-line-number="2"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> mode,</a>
<a class="sourceLine" id="cb1104-3" data-line-number="3">              <span class="dt">values_from =</span> results) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1104-4" data-line-number="4"><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">power</th>
<th align="right">0.6</th>
<th align="right">0.65</th>
<th align="right">0.7</th>
<th align="right">0.75</th>
<th align="right">0.8</th>
<th align="right">0.85</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.7</td>
<td align="right">373</td>
<td align="right">370</td>
<td align="right">364</td>
<td align="right">352</td>
<td align="right">332</td>
<td align="right">303</td>
</tr>
<tr class="even">
<td align="right">0.8</td>
<td align="right">378</td>
<td align="right">376</td>
<td align="right">373</td>
<td align="right">367</td>
<td align="right">354</td>
<td align="right">334</td>
</tr>
<tr class="odd">
<td align="right">0.9</td>
<td align="right">380</td>
<td align="right">380</td>
<td align="right">379</td>
<td align="right">378</td>
<td align="right">373</td>
<td align="right">363</td>
</tr>
</tbody>
</table>
</div>
<div id="monte-carlo-approximation-of-power." class="section level3">
<h3><span class="header-section-number">13.2.4</span> Monte Carlo approximation of power.</h3>
<blockquote>
<p>The previous sections illustrated the ideas of power and sample size for a simple case in which the power could be computed by mathematical derivation. [If your field is like mine, this will not be the norm for your research projects.] In this section, we approximate the power by Monte Carlo simulation. The R script for this simple case serves as a template for more realistic applications. The R script is named <code>Jags-Ydich-Xnom1subj-MbernBeta-Power.R</code>, which is the name for the JAGS program for dichotomous data from a single “subject” suffixed with the word “Power.” As you read through the script, presented below, remember that you can find information about any general R command by using the help function in R, as explained in Section 3.3.1 (p. 39). (p. 372)</p>
</blockquote>
<p>The code in Kruschke’s <code>Jags-Ydich-Xnom1subj-MbernBeta-Power.R</code> file also makes use of the content in his <code>Jags-Ydich-Xnom1subj-MbernBeta.R</code> file. As is often the case, the code in both is JAGS and base-<strong>R</strong> centric. We’ll be taking a different approach. I’ll walk you through. First, let’s fire up <strong>brms</strong>.</p>
<div class="sourceCode" id="cb1105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1105-1" data-line-number="1"><span class="kw">library</span>(brms)</a></code></pre></div>
<p>This won’t be of much concern for some of the complex models we’ll be fitting in later chapters. But for simple models like this, a lot of the time you spend waiting for <code>brms::brm()</code> to return your posterior and its summary has to do with compilation time. The issue of compilation goes into technical details I just don’t have the will to go through right now. But if we can avoid or minimize compilation time, it’ll be a boon for our power simulations. As it turns out, we can. The first time we fit our desired model, we have to compile. But once we have that initial fit object in hand, we can reuse it with the <code>update()</code> function, which will allow us to avoid further compilation. So that’s what we’re going to do, here. We’re going to fit the model once and save it.</p>
<div class="sourceCode" id="cb1106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1106-1" data-line-number="1"><span class="co"># how many rows of 0s and 1s should we have in the data?</span></a>
<a class="sourceLine" id="cb1106-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">74</span></a>
<a class="sourceLine" id="cb1106-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1106-4" data-line-number="4"><span class="co"># should the values in the data be of single draws (i.e., 1), or summaries?</span></a>
<a class="sourceLine" id="cb1106-5" data-line-number="5">size &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1106-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1106-7" data-line-number="7"><span class="co"># what is the population mode for theta we&#39;d like to base this all on?</span></a>
<a class="sourceLine" id="cb1106-8" data-line-number="8">omega &lt;-<span class="st"> </span><span class="fl">.7</span></a>
<a class="sourceLine" id="cb1106-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1106-10" data-line-number="10"><span class="co"># fit that joint</span></a>
<a class="sourceLine" id="cb1106-11" data-line-number="11">fit13<span class="fl">.1</span> &lt;-</a>
<a class="sourceLine" id="cb1106-12" data-line-number="12"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">y =</span> <span class="kw">rbinom</span>(n, size, omega)),</a>
<a class="sourceLine" id="cb1106-13" data-line-number="13">      <span class="dt">family =</span> <span class="kw">bernoulli</span>(<span class="dt">link =</span> identity),</a>
<a class="sourceLine" id="cb1106-14" data-line-number="14">      y <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1106-15" data-line-number="15">      <span class="kw">prior</span>(<span class="kw">beta</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1106-16" data-line-number="16">      <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">iter =</span> <span class="dv">3000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1106-17" data-line-number="17">      <span class="dt">seed =</span> <span class="dv">13</span>,</a>
<a class="sourceLine" id="cb1106-18" data-line-number="18">      <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">.9</span>),</a>
<a class="sourceLine" id="cb1106-19" data-line-number="19">      <span class="dt">file =</span> <span class="st">&quot;fits/fit13.01&quot;</span>)</a></code></pre></div>
<p>You may (or not) recall that at the end of Chapter 3, we covered how to time an operation in <strong>R</strong>. When you’re setting up a Monte Carlo power study, it can be important to use those time-tracking skills to get a sense of how long it takes to fit your models. While I was setting this model up, I experimented with keeping the default <code>cores = 1</code> or setting my typical <code>cores = 4</code>. As it turns out, with a very simple model like this, <code>cores = 1</code> was a little faster. If you’re fitting one model, that’s no big deal. But in a situation where you’re fitting 100 or 1000, you’ll want to make sure you’re fitting them as efficiently as possible.</p>
<p>But anyway, our practice will be to keep all the specifications in <code>fit</code> constant across the simulations. So choose them wisely. If you look deep into the bowels of the <code>Jags-Ydich-Xnom1subj-MbernBeta.R</code> file, you’ll see Kruschke used the flat <span class="math inline">\(\operatorname{beta}(1, 1)\)</span> prior, which is where our <code>prior(beta(1, 1), class = Intercept)</code> code came from. This is the audience prior. We aren’t particularly concerned about the data we simulated with the <code>data = tibble(y = rbinom(n, size, omega))</code> line. The main thing is that they follow the same basic structure our subsequent data will.</p>
<p>To make sure we’re not setting ourselves up to fail, we might make sure the chains look okay.</p>
<div class="sourceCode" id="cb1107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1107-1" data-line-number="1"><span class="kw">plot</span>(fit13<span class="fl">.1</span>)</a></code></pre></div>
<p><img src="13_files/figure-gfm/unnamed-chunk-24-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Looks like a dream. Let’s move forward and run the simulation proper. In his script file, Kruschke suggested we simulate with large <span class="math inline">\(N\)</span>s like 1000 or so. Since this is just an example, I’m gonna cut that to 100.</p>
<div class="sourceCode" id="cb1108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1108-1" data-line-number="1"><span class="co"># how many simulations would you like?</span></a>
<a class="sourceLine" id="cb1108-2" data-line-number="2">n_sim &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1108-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1108-4" data-line-number="4"><span class="co"># specify omega and kappa of the hypothetical parameter distribution</span></a>
<a class="sourceLine" id="cb1108-5" data-line-number="5">omega &lt;-<span class="st"> </span><span class="fl">.7</span></a>
<a class="sourceLine" id="cb1108-6" data-line-number="6">kappa &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb1108-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1108-8" data-line-number="8"><span class="co"># make it reproducible</span></a>
<a class="sourceLine" id="cb1108-9" data-line-number="9"><span class="kw">set.seed</span>(<span class="dv">13</span>)</a>
<a class="sourceLine" id="cb1108-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1108-11" data-line-number="11">sim1 &lt;-</a>
<a class="sourceLine" id="cb1108-12" data-line-number="12"><span class="st">  </span><span class="co"># define some of the parameters</span></a>
<a class="sourceLine" id="cb1108-13" data-line-number="13"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">n     =</span> n,</a>
<a class="sourceLine" id="cb1108-14" data-line-number="14">         <span class="dt">size  =</span> size,</a>
<a class="sourceLine" id="cb1108-15" data-line-number="15">         <span class="dt">theta =</span> <span class="kw">rbeta</span>(n_sim, </a>
<a class="sourceLine" id="cb1108-16" data-line-number="16">                       <span class="dt">shape1 =</span>      omega  <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1108-17" data-line-number="17">                       <span class="dt">shape2 =</span> (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>omega) <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1108-18" data-line-number="18"><span class="st">  </span><span class="co"># simulate the data</span></a>
<a class="sourceLine" id="cb1108-19" data-line-number="19"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">data =</span> <span class="kw">pmap</span>(<span class="kw">list</span>(n, size, theta), rbinom)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1108-20" data-line-number="20"><span class="st">  </span><span class="co"># fit the models on the simulated data</span></a>
<a class="sourceLine" id="cb1108-21" data-line-number="21"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="kw">update</span>(fit13<span class="fl">.1</span>, <span class="dt">newdata =</span> <span class="kw">list</span>(<span class="dt">y =</span> .))))</a></code></pre></div>
<p><em>What have we done?</em> you might ask.</p>
<div class="sourceCode" id="cb1109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1109-1" data-line-number="1"><span class="kw">head</span>(sim1)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##       n  size theta data       fit      
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;     &lt;list&gt;   
## 1    74     1 0.693 &lt;int [74]&gt; &lt;brmsfit&gt;
## 2    74     1 0.703 &lt;int [74]&gt; &lt;brmsfit&gt;
## 3    74     1 0.676 &lt;int [74]&gt; &lt;brmsfit&gt;
## 4    74     1 0.698 &lt;int [74]&gt; &lt;brmsfit&gt;
## 5    74     1 0.686 &lt;int [74]&gt; &lt;brmsfit&gt;
## 6    74     1 0.695 &lt;int [74]&gt; &lt;brmsfit&gt;</code></pre>
<p>The <code>theta</code> column contains the draws from the hypothesized parameter distribution, which we’ve indicated is hovering tightly around .7. The <code>data</code> column is nested in that within each row, we’ve saved an entire <span class="math inline">\(N = 74\)</span> row tibble. Most importantly, the <code>fit</code> column contains the <code>brms::brm()</code> objects for each of our 100 simulations. See that last <code>mutate()</code> line, above? That’s where those came from. Within the <code>purrr::map()</code> function, we fed our simulated data sets, one row at a time, into the <code>update()</code> function via the <code>newdata</code> argument. Because we used <code>update()</code> based on our initial <code>fit</code>, we avoided subsequent compilation times and just sampled like a boss.</p>
<p>Before we move on, I should give some credit. The foundations of this workflow come from Wickham’s talk, <a href="https://www.youtube.com/watch?time_continue=426&amp;v=rz3_FDVt9eg"><em>Managing many models with R</em></a>. I got some additional <a href="https://twitter.com/PStrafo/status/1107447953709383681">help on twitter</a> from <a href="https://twitter.com/PStrafo">Phil Straforelli</a>.</p>
<p>We still have some work to do. Next, we’ll want to make a custom function that will make it easy to compute the intercept HDIs for each of our fits.</p>
<div class="sourceCode" id="cb1111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1111-1" data-line-number="1"><span class="kw">library</span>(tidybayes)</a>
<a class="sourceLine" id="cb1111-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1111-3" data-line-number="3">get_hdi &lt;-<span class="st"> </span><span class="cf">function</span>(fit) {</a>
<a class="sourceLine" id="cb1111-4" data-line-number="4">  fit <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1111-5" data-line-number="5"><span class="st">    </span><span class="kw">posterior_samples</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1111-6" data-line-number="6"><span class="st">    </span><span class="kw">mode_hdi</span>(b_Intercept) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1111-7" data-line-number="7"><span class="st">    </span><span class="kw">select</span>(.lower<span class="op">:</span>.upper)</a>
<a class="sourceLine" id="cb1111-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb1111-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1111-10" data-line-number="10"><span class="co"># how does it work?</span></a>
<a class="sourceLine" id="cb1111-11" data-line-number="11"><span class="kw">get_hdi</span>(fit13<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>##      .lower    .upper
## 1 0.6218496 0.8236595</code></pre>
<p>Now we’ll apply that function to our <code>fits</code> tibble to pull those simulated HDIs. Then we’ll program in the markers for the ROPE and HDI width criteria, perform logical tests to see whether they were passes within each of the 100 simulations, and summarize the tests.</p>
<div class="sourceCode" id="cb1113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1113-1" data-line-number="1">sim1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1113-2" data-line-number="2"><span class="st">  </span><span class="co"># get those HDIs and `unnest()`</span></a>
<a class="sourceLine" id="cb1113-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">hdi =</span> <span class="kw">map</span>(fit, get_hdi)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1113-4" data-line-number="4"><span class="st">  </span><span class="kw">unnest</span>(hdi) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1113-5" data-line-number="5"><span class="st">  </span><span class="co"># define our test criteria</span></a>
<a class="sourceLine" id="cb1113-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rope_ll   =</span> <span class="fl">.48</span>,</a>
<a class="sourceLine" id="cb1113-7" data-line-number="7">         <span class="dt">rope_ul   =</span> <span class="fl">.52</span>,</a>
<a class="sourceLine" id="cb1113-8" data-line-number="8">         <span class="dt">hdi_width =</span> <span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1113-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pass_rope  =</span> .lower <span class="op">&gt;</span><span class="st"> </span>rope_ul <span class="op">|</span><span class="st"> </span>.upper <span class="op">&lt;</span><span class="st"> </span>rope_ll,</a>
<a class="sourceLine" id="cb1113-10" data-line-number="10">         <span class="dt">pass_width =</span> (.upper <span class="op">-</span><span class="st"> </span>.lower) <span class="op">&lt;</span><span class="st"> </span>hdi_width) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1113-11" data-line-number="11"><span class="st">  </span></a>
<a class="sourceLine" id="cb1113-12" data-line-number="12"><span class="st">  </span><span class="co"># summarize those joints</span></a>
<a class="sourceLine" id="cb1113-13" data-line-number="13"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">power_rope  =</span> <span class="kw">mean</span>(pass_rope),</a>
<a class="sourceLine" id="cb1113-14" data-line-number="14">            <span class="dt">power_width =</span> <span class="kw">mean</span>(pass_width))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   power_rope power_width
##        &lt;dbl&gt;       &lt;dbl&gt;
## 1       0.92        0.35</code></pre>
<p>Those are our power estimates. To compute their HDIS, just increase them by a factor of 100 and plug them into the formulas within the shape arguments in <code>hdi_of_icdf()</code>.</p>
<div class="sourceCode" id="cb1115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1115-1" data-line-number="1"><span class="co"># HDIs for the ROPE power estimate</span></a>
<a class="sourceLine" id="cb1115-2" data-line-number="2"><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</a>
<a class="sourceLine" id="cb1115-3" data-line-number="3">            <span class="dt">shape1 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">92</span>,</a>
<a class="sourceLine" id="cb1115-4" data-line-number="4">            <span class="dt">shape2 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_sim <span class="op">-</span><span class="st"> </span><span class="dv">92</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1115-5" data-line-number="5"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.86 0.96</code></pre>
<div class="sourceCode" id="cb1117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1117-1" data-line-number="1"><span class="co"># HDIs for the width power estimate</span></a>
<a class="sourceLine" id="cb1117-2" data-line-number="2"><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</a>
<a class="sourceLine" id="cb1117-3" data-line-number="3">            <span class="dt">shape1 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">35</span>,</a>
<a class="sourceLine" id="cb1117-4" data-line-number="4">            <span class="dt">shape2 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_sim <span class="op">-</span><span class="st"> </span><span class="dv">35</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1117-5" data-line-number="5"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.26 0.45</code></pre>
<p>Following the middle of page 375, we’ll want to do the whole thing again with <span class="math inline">\(\kappa = 10\)</span> and <span class="math inline">\(N = 91\)</span>.</p>
<p>Before we run the next simulation, notice how our first approach had us saving the model fits within our <code>sim1</code> object. When the models are simple and based on small data and when you’re only simulating 100 times, this isn’t a huge deal. But saving 1000+ <code>brms::brm()</code> fit objects of hierarchical models will bog you down. So for our next simulation, we’ll only save the HDIs from our <code>get_hdi()</code> function.</p>
<div class="sourceCode" id="cb1119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1119-1" data-line-number="1"><span class="co"># how many rows of 0s and 1s should we have in the data?</span></a>
<a class="sourceLine" id="cb1119-2" data-line-number="2">n     &lt;-<span class="st"> </span><span class="dv">91</span></a>
<a class="sourceLine" id="cb1119-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1119-4" data-line-number="4"><span class="co"># how many simulations would you like?</span></a>
<a class="sourceLine" id="cb1119-5" data-line-number="5">n_sim &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1119-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1119-7" data-line-number="7"><span class="co"># specify omega and kappa of the hypothetical parameter distribution</span></a>
<a class="sourceLine" id="cb1119-8" data-line-number="8">omega &lt;-<span class="st"> </span><span class="fl">.7</span></a>
<a class="sourceLine" id="cb1119-9" data-line-number="9">kappa &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb1119-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1119-11" data-line-number="11"><span class="co"># make it reproducible</span></a>
<a class="sourceLine" id="cb1119-12" data-line-number="12"><span class="kw">set.seed</span>(<span class="dv">13</span>)</a>
<a class="sourceLine" id="cb1119-13" data-line-number="13"></a>
<a class="sourceLine" id="cb1119-14" data-line-number="14"><span class="co"># simulate</span></a>
<a class="sourceLine" id="cb1119-15" data-line-number="15">sim2 &lt;-</a>
<a class="sourceLine" id="cb1119-16" data-line-number="16"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">n     =</span> n,</a>
<a class="sourceLine" id="cb1119-17" data-line-number="17">         <span class="dt">size  =</span> size,</a>
<a class="sourceLine" id="cb1119-18" data-line-number="18">         <span class="dt">theta =</span> <span class="kw">rbeta</span>(n_sim, </a>
<a class="sourceLine" id="cb1119-19" data-line-number="19">                       <span class="dt">shape1 =</span>      omega  <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1119-20" data-line-number="20">                       <span class="dt">shape2 =</span> (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>omega) <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1119-21" data-line-number="21"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">data =</span> <span class="kw">pmap</span>(<span class="kw">list</span>(n, size, theta), rbinom)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1119-22" data-line-number="22"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">hdi =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="kw">update</span>(fit13<span class="fl">.1</span>, <span class="dt">newdata =</span> <span class="kw">list</span>(<span class="dt">y =</span> .)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">get_hdi</span>()))</a></code></pre></div>
<p>Since we saved the HDI estimates in the <code>hdi</code> column, we can just <code>unnest()</code> then and summarize our power results.</p>
<div class="sourceCode" id="cb1120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1120-1" data-line-number="1">sim2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1120-2" data-line-number="2"><span class="st">  </span><span class="kw">unnest</span>(hdi) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1120-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rope_ll   =</span> <span class="fl">.48</span>,</a>
<a class="sourceLine" id="cb1120-4" data-line-number="4">         <span class="dt">rope_ul   =</span> <span class="fl">.52</span>,</a>
<a class="sourceLine" id="cb1120-5" data-line-number="5">         <span class="dt">hdi_width =</span> <span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1120-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pass_rope  =</span> .lower <span class="op">&gt;</span><span class="st"> </span>rope_ul <span class="op">|</span><span class="st"> </span>.upper <span class="op">&lt;</span><span class="st"> </span>rope_ll,</a>
<a class="sourceLine" id="cb1120-7" data-line-number="7">         <span class="dt">pass_width =</span> (.upper <span class="op">-</span><span class="st"> </span>.lower) <span class="op">&lt;</span><span class="st"> </span>hdi_width) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1120-8" data-line-number="8"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">power_rope  =</span> <span class="kw">mean</span>(pass_rope),</a>
<a class="sourceLine" id="cb1120-9" data-line-number="9">            <span class="dt">power_width =</span> <span class="kw">mean</span>(pass_width))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   power_rope power_width
##        &lt;dbl&gt;       &lt;dbl&gt;
## 1       0.71        0.91</code></pre>
<p>Compute the corresponding HDIs.</p>
<div class="sourceCode" id="cb1122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1122-1" data-line-number="1"><span class="co"># HDIs for the ROPE power estimate</span></a>
<a class="sourceLine" id="cb1122-2" data-line-number="2"><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</a>
<a class="sourceLine" id="cb1122-3" data-line-number="3">            <span class="dt">shape1 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">71</span>,</a>
<a class="sourceLine" id="cb1122-4" data-line-number="4">            <span class="dt">shape2 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_sim <span class="op">-</span><span class="st"> </span><span class="dv">71</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1122-5" data-line-number="5"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.62 0.79</code></pre>
<div class="sourceCode" id="cb1124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1124-1" data-line-number="1"><span class="co"># HDIs for the width power estimate</span></a>
<a class="sourceLine" id="cb1124-2" data-line-number="2"><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</a>
<a class="sourceLine" id="cb1124-3" data-line-number="3">            <span class="dt">shape1 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">91</span>,</a>
<a class="sourceLine" id="cb1124-4" data-line-number="4">            <span class="dt">shape2 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_sim <span class="op">-</span><span class="st"> </span><span class="dv">91</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1124-5" data-line-number="5"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.84 0.96</code></pre>
</div>
<div id="power-from-idealized-or-actual-data." class="section level3">
<h3><span class="header-section-number">13.2.5</span> Power from idealized or actual data.</h3>
<blockquote>
<p>In practice, it is often more intuitive to specify actual or idealized <em>data</em> that express the hypothesis, than it is to specify top-level parameter properties. The idea is that we start with the actual or idealized data and then use Bayes’ rule to generate the corresponding distribution on parameter values. (p. 376, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Here are the idealized parameters Kruschke outlied on pages 376–377.</p>
<div class="sourceCode" id="cb1126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1126-1" data-line-number="1"><span class="co"># specify idealized hypothesis:</span></a>
<a class="sourceLine" id="cb1126-2" data-line-number="2">ideal_group_mean &lt;-<span class="st"> </span><span class="fl">0.65</span></a>
<a class="sourceLine" id="cb1126-3" data-line-number="3">ideal_group_sd   &lt;-<span class="st"> </span><span class="fl">0.07</span></a>
<a class="sourceLine" id="cb1126-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1126-5" data-line-number="5">ideal_n_subj         &lt;-<span class="st"> </span><span class="dv">100</span>  <span class="co"># more subjects =&gt; higher confidence in hypothesis</span></a>
<a class="sourceLine" id="cb1126-6" data-line-number="6">ideal_n_trl_per_subj &lt;-<span class="st"> </span><span class="dv">100</span>  <span class="co"># more trials =&gt; higher confidence in hypothesis</span></a></code></pre></div>
<p>These parameters are for binomial data. To parameterize <span class="math inline">\(\theta\)</span> in terms of a mean and standard deviation, we need to define the <code>beta_ab_from_mean_sd()</code> function.</p>
<div class="sourceCode" id="cb1127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1127-1" data-line-number="1">beta_ab_from_mean_sd &lt;-<span class="st"> </span><span class="cf">function</span>(mean, sd) {</a>
<a class="sourceLine" id="cb1127-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb1127-3" data-line-number="3">  <span class="cf">if</span> (mean <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">|</span><span class="st"> </span>mean <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">stop</span>(<span class="st">&quot;must have 0 &lt; mean &lt; 1&quot;</span>)</a>
<a class="sourceLine" id="cb1127-4" data-line-number="4">  <span class="cf">if</span> (sd <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="kw">stop</span>(<span class="st">&quot;sd must be &gt; 0&quot;</span>)</a>
<a class="sourceLine" id="cb1127-5" data-line-number="5">  kappa &lt;-<span class="st"> </span>mean <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>mean) <span class="op">/</span><span class="st"> </span>sd<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1127-6" data-line-number="6">  <span class="cf">if</span> (kappa <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="kw">stop</span>(<span class="st">&quot;invalid combination of mean and sd&quot;</span>)</a>
<a class="sourceLine" id="cb1127-7" data-line-number="7">  a &lt;-<span class="st"> </span>mean <span class="op">*</span><span class="st"> </span>kappa</a>
<a class="sourceLine" id="cb1127-8" data-line-number="8">  b &lt;-<span class="st"> </span>(<span class="fl">1.0</span> <span class="op">-</span><span class="st"> </span>mean) <span class="op">*</span><span class="st"> </span>kappa</a>
<a class="sourceLine" id="cb1127-9" data-line-number="9">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">a =</span> a, <span class="dt">b =</span> b))</a>
<a class="sourceLine" id="cb1127-10" data-line-number="10">  </a>
<a class="sourceLine" id="cb1127-11" data-line-number="11">}</a></code></pre></div>
<p>Now generate data consistent with these values using a <strong>tidyverse</strong>-style workflow.</p>
<div class="sourceCode" id="cb1128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1128-1" data-line-number="1">b &lt;-<span class="st"> </span><span class="kw">beta_ab_from_mean_sd</span>(ideal_group_mean, ideal_group_sd)</a>
<a class="sourceLine" id="cb1128-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1128-3" data-line-number="3"><span class="co"># make the results reproducible</span></a>
<a class="sourceLine" id="cb1128-4" data-line-number="4"><span class="kw">set.seed</span>(<span class="dv">13</span>)</a>
<a class="sourceLine" id="cb1128-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1128-6" data-line-number="6">d &lt;-</a>
<a class="sourceLine" id="cb1128-7" data-line-number="7"><span class="st">  </span><span class="co"># make a subject index and generate random theta values for idealized subjects</span></a>
<a class="sourceLine" id="cb1128-8" data-line-number="8"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">s     =</span> <span class="dv">1</span><span class="op">:</span>ideal_n_subj,</a>
<a class="sourceLine" id="cb1128-9" data-line-number="9">         <span class="dt">theta =</span> <span class="kw">rbeta</span>(ideal_n_subj, b<span class="op">$</span>a, b<span class="op">$</span>b)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1128-10" data-line-number="10"><span class="st">  </span><span class="co"># transform the theta values to exactly match idealized mean and SD</span></a>
<a class="sourceLine" id="cb1128-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">theta_transformed =</span> ((theta <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta)) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(theta)) <span class="op">*</span><span class="st"> </span>ideal_group_sd <span class="op">+</span><span class="st"> </span>ideal_group_mean) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1128-12" data-line-number="12"><span class="st">  </span><span class="co"># `theta_transformed` must be between 0 and 1</span></a>
<a class="sourceLine" id="cb1128-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">theta_transformed =</span> <span class="kw">ifelse</span>(theta_transformed <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.999</span>, <span class="fl">0.999</span>,</a>
<a class="sourceLine" id="cb1128-14" data-line-number="14">                                    <span class="kw">ifelse</span>(theta_transformed <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.001</span>, <span class="fl">0.001</span>,</a>
<a class="sourceLine" id="cb1128-15" data-line-number="15">                                           theta_transformed))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1128-16" data-line-number="16"><span class="st">  </span><span class="co"># generate idealized data very close to thetas</span></a>
<a class="sourceLine" id="cb1128-17" data-line-number="17"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z =</span> <span class="kw">round</span>(theta_transformed <span class="op">*</span><span class="st"> </span>ideal_n_trl_per_subj)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1128-18" data-line-number="18"><span class="st">  </span><span class="co"># create vector of 0&#39;s and 1&#39;s matching the z values generated above</span></a>
<a class="sourceLine" id="cb1128-19" data-line-number="19"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">map</span>(z, <span class="op">~</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, .), <span class="kw">rep</span>(<span class="dv">0</span>, ideal_n_trl_per_subj <span class="op">-</span><span class="st"> </span>.)))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1128-20" data-line-number="20"><span class="st">  </span><span class="kw">unnest</span>(y)</a></code></pre></div>
<p>Our main variables are <code>s</code> and <code>y</code>. You can think of the rest as showing our work. Here’s a peek.</p>
<div class="sourceCode" id="cb1129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1129-1" data-line-number="1"><span class="kw">str</span>(d)</a></code></pre></div>
<pre><code>## tibble [10,000 × 5] (S3: tbl_df/tbl/data.frame)
##  $ s                : int [1:10000] 1 1 1 1 1 1 1 1 1 1 ...
##  $ theta            : num [1:10000] 0.604 0.604 0.604 0.604 0.604 ...
##  $ theta_transformed: num [1:10000] 0.601 0.601 0.601 0.601 0.601 ...
##  $ z                : num [1:10000] 60 60 60 60 60 60 60 60 60 60 ...
##  $ y                : num [1:10000] 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<p>We are going to follow the same procedure we did when we originally fit the model to the therapeutic touch data in Chapter 9. Instead of reproducing the model Kruschke presented in his scripts, we are going to fit a hierarchical logistic regression model.</p>
<div class="sourceCode" id="cb1131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1131-1" data-line-number="1">fit13<span class="fl">.2</span> &lt;-</a>
<a class="sourceLine" id="cb1131-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> d,</a>
<a class="sourceLine" id="cb1131-3" data-line-number="3">      <span class="dt">family =</span> <span class="kw">bernoulli</span>(<span class="dt">link =</span> logit),</a>
<a class="sourceLine" id="cb1131-4" data-line-number="4">      y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>s),</a>
<a class="sourceLine" id="cb1131-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1131-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sd)),</a>
<a class="sourceLine" id="cb1131-7" data-line-number="7">      <span class="dt">iter =</span> <span class="dv">2000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1131-8" data-line-number="8">      <span class="dt">seed =</span> <span class="dv">13</span>,</a>
<a class="sourceLine" id="cb1131-9" data-line-number="9">      <span class="dt">file =</span> <span class="st">&quot;fits/fit13.02&quot;</span>)</a></code></pre></div>
<p>Unlike in the text, we had no need for thinning our chains. The effective number of samples was fine.</p>
<div class="sourceCode" id="cb1132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1132-1" data-line-number="1"><span class="kw">print</span>(fit13<span class="fl">.2</span>)</a></code></pre></div>
<pre><code>##  Family: bernoulli 
##   Links: mu = logit 
## Formula: y ~ 1 + (1 | s) 
##    Data: d (Number of observations: 10000) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Group-Level Effects: 
## ~s (Number of levels: 100) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)     0.23      0.03     0.17     0.29 1.00     1604     2206
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     0.63      0.03     0.57     0.69 1.00     4212     2778
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Here’s a look at our two main parameters, our version of the top panels of Figure 13.3.</p>
<div class="sourceCode" id="cb1134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1134-1" data-line-number="1"><span class="kw">posterior_samples</span>(fit13<span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1134-2" data-line-number="2"><span class="st">  </span><span class="kw">pivot_longer</span>(b_Intercept<span class="op">:</span>sd_s__Intercept) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1134-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1134-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1134-5" data-line-number="5"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb1134-6" data-line-number="6">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1134-7" data-line-number="7">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1134-8" data-line-number="8">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1134-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1134-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;Remember, these are in the log-odds metric.&quot;</span>,</a>
<a class="sourceLine" id="cb1134-11" data-line-number="11">       <span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1134-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb1134-13" data-line-number="13"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="13_files/figure-gfm/unnamed-chunk-39-1.png" width="576" style="display: block; margin: auto;" /></p>
<blockquote>
<p>Now we have a distribution of parameter values consistent with our idealized hypothesis, but we did not have to figure out the top-level constants in the model. We merely specified the idealized tendencies in the data and expressed our confidence by its amount… So we now have a large set of representative parameter values for conducting a power analysis. (pp. 378–379)</p>
</blockquote>
<p>With <strong>brms</strong>, you can sample from those model-implied parameter values with the <code>fitted()</code> function. By default, it will return values in the probability metric for our logistic model. Here we’ll specify a group-level (i.e., <code>s</code>) value that was not in the data. We’ll feed that new value into the <code>newdata</code> argument and set <code>allow_new_levels = T</code>. We’ll also set <code>summary = F</code>, which will return actual probability values rather than a summary.</p>
<div class="sourceCode" id="cb1135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1135-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">13</span>)</a>
<a class="sourceLine" id="cb1135-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1135-3" data-line-number="3">f &lt;-</a>
<a class="sourceLine" id="cb1135-4" data-line-number="4"><span class="st">  </span><span class="kw">fitted</span>(fit13<span class="fl">.2</span>,</a>
<a class="sourceLine" id="cb1135-5" data-line-number="5">        <span class="dt">newdata =</span> <span class="kw">tibble</span>(<span class="dt">s =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1135-6" data-line-number="6">        <span class="dt">allow_new_levels =</span> T,</a>
<a class="sourceLine" id="cb1135-7" data-line-number="7">        <span class="dt">summary =</span> F) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1135-8" data-line-number="8"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1135-9" data-line-number="9"><span class="st">  </span><span class="kw">set_names</span>(<span class="st">&quot;theta&quot;</span>)</a>
<a class="sourceLine" id="cb1135-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1135-11" data-line-number="11"><span class="kw">str</span>(f)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    4000 obs. of  1 variable:
##  $ theta: num  0.672 0.564 0.657 0.643 0.552 ...</code></pre>
<p>Here’s what that looks like.</p>
<div class="sourceCode" id="cb1137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1137-1" data-line-number="1">f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1137-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1137-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb1137-4" data-line-number="4">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1137-5" data-line-number="5">                     <span class="dt">breaks =</span> <span class="dv">20</span>, <span class="dt">slab_size =</span> <span class="fl">.2</span>, <span class="dt">outline_bars =</span> T) <span class="op">+</span></a>
<a class="sourceLine" id="cb1137-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1137-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;Behold our </span><span class="ch">\&quot;</span><span class="st">distribution of parameter values consistent</span><span class="ch">\n</span><span class="st">with our idealized hypothesis.</span><span class="ch">\&quot;</span><span class="st">&quot;</span>,</a>
<a class="sourceLine" id="cb1137-8" data-line-number="8">       <span class="dt">x =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1137-9" data-line-number="9"><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1137-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="13_files/figure-gfm/unnamed-chunk-41-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>We can make a custom function to sample from <span class="math inline">\(\theta\)</span>. We might call it <code>sample_theta()</code>.</p>
<div class="sourceCode" id="cb1138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1138-1" data-line-number="1">sample_theta &lt;-<span class="st"> </span><span class="cf">function</span>(seed, n_subj) {</a>
<a class="sourceLine" id="cb1138-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb1138-3" data-line-number="3">  <span class="kw">set.seed</span>(seed)</a>
<a class="sourceLine" id="cb1138-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb1138-5" data-line-number="5">  <span class="kw">bind_cols</span>(<span class="dt">s =</span> <span class="dv">1</span><span class="op">:</span>n_subj,</a>
<a class="sourceLine" id="cb1138-6" data-line-number="6">            <span class="kw">sample_n</span>(f, <span class="dt">size =</span> n_subj, <span class="dt">replace =</span> T))</a>
<a class="sourceLine" id="cb1138-7" data-line-number="7">  </a>
<a class="sourceLine" id="cb1138-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb1138-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1138-10" data-line-number="10"><span class="co"># take it for a spin</span></a>
<a class="sourceLine" id="cb1138-11" data-line-number="11"><span class="kw">sample_theta</span>(<span class="dt">seed =</span> <span class="dv">13</span>, <span class="dt">n_subj =</span> <span class="dv">5</span>)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##       s theta
##   &lt;int&gt; &lt;dbl&gt;
## 1     1 0.658
## 2     2 0.615
## 3     3 0.693
## 4     4 0.554
## 5     5 0.684</code></pre>
<p>Now let’s say I wanted to use our little <code>sample_theta()</code> function to sample <span class="math inline">\(\theta\)</span> values for three people <code>s</code> and then use those <span class="math inline">\(\theta\)</span> values to sample three draws from the corresponding Bernoulli distribution. We might do that like this.</p>
<div class="sourceCode" id="cb1140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1140-1" data-line-number="1"><span class="kw">sample_theta</span>(<span class="dt">seed =</span> <span class="dv">13</span>, <span class="dt">n_subj =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1140-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">map</span>(theta, rbinom, <span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">size =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1140-3" data-line-number="3"><span class="st">  </span><span class="kw">unnest</span>(y)</a></code></pre></div>
<pre><code>## # A tibble: 9 x 3
##       s theta     y
##   &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
## 1     1 0.658     1
## 2     1 0.658     0
## 3     1 0.658     1
## 4     2 0.615     1
## 5     2 0.615     0
## 6     2 0.615     0
## 7     3 0.693     1
## 8     3 0.693     1
## 9     3 0.693     0</code></pre>
<p>Notice how after we sampled from <span class="math inline">\(\theta\)</span>, we still needed to take two more steps to simulate the desired data. So perhaps a better approach would be to wrap all those steps into one function and call it something like <code>sample_data()</code>.</p>
<div class="sourceCode" id="cb1142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1142-1" data-line-number="1">sample_data &lt;-<span class="st"> </span><span class="cf">function</span>(seed, n_subj, n_trial) {</a>
<a class="sourceLine" id="cb1142-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb1142-3" data-line-number="3">  <span class="kw">set.seed</span>(seed)</a>
<a class="sourceLine" id="cb1142-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb1142-5" data-line-number="5">  <span class="kw">bind_cols</span>(<span class="dt">s =</span> <span class="dv">1</span><span class="op">:</span>n_subj,</a>
<a class="sourceLine" id="cb1142-6" data-line-number="6">            <span class="kw">sample_n</span>(f, <span class="dt">size =</span> n_subj, <span class="dt">replace =</span> T)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1142-7" data-line-number="7"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">map</span>(theta, rbinom, <span class="dt">n =</span> n_trial, <span class="dt">size =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1142-8" data-line-number="8"><span class="st">    </span><span class="kw">unnest</span>(y)</a>
<a class="sourceLine" id="cb1142-9" data-line-number="9">  </a>
<a class="sourceLine" id="cb1142-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb1142-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1142-12" data-line-number="12"><span class="co"># test it out</span></a>
<a class="sourceLine" id="cb1142-13" data-line-number="13"><span class="kw">sample_data</span>(<span class="dt">seed =</span> <span class="dv">13</span>, <span class="dt">n_subj =</span> <span class="dv">3</span>, <span class="dt">n_trial =</span> <span class="dv">3</span>) </a></code></pre></div>
<pre><code>## # A tibble: 9 x 3
##       s theta     y
##   &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
## 1     1 0.658     1
## 2     1 0.658     0
## 3     1 0.658     1
## 4     2 0.615     1
## 5     2 0.615     0
## 6     2 0.615     0
## 7     3 0.693     1
## 8     3 0.693     1
## 9     3 0.693     0</code></pre>
<p>Here’s how we’d use our <code>sample_data()</code> function to make several data sets within the context of a nested tibble.</p>
<div class="sourceCode" id="cb1144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1144-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">seed =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1144-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">data =</span> <span class="kw">map</span>(seed, sample_data, <span class="dt">n_subj =</span> <span class="dv">14</span>, <span class="dt">n_trial =</span> <span class="dv">47</span>))</a></code></pre></div>
<pre><code>## # A tibble: 4 x 2
##    seed data              
##   &lt;int&gt; &lt;list&gt;            
## 1     1 &lt;tibble [658 × 3]&gt;
## 2     2 &lt;tibble [658 × 3]&gt;
## 3     3 &lt;tibble [658 × 3]&gt;
## 4     4 &lt;tibble [658 × 3]&gt;</code></pre>
<p>With this data type, Kruschke indicated he ran</p>
<blockquote>
<p>the power analysis twice, using different selections of subjects and trials. In both cases there [was] a total of 658 trials, but in the first case there [were] 14 subjects with 47 trials per subject, and in the second case there [were] seven subjects with 94 trials per subject. (p. 381)</p>
</blockquote>
<p>Before running the simulations in full, we fit the model once and save that fit to iteratively reuse with <code>update()</code>.</p>
<div class="sourceCode" id="cb1146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1146-1" data-line-number="1"><span class="co"># how many subjects should we have?</span></a>
<a class="sourceLine" id="cb1146-2" data-line-number="2">n_subj &lt;-<span class="st"> </span><span class="dv">14</span></a>
<a class="sourceLine" id="cb1146-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1146-4" data-line-number="4"><span class="co"># how many trials should we have?</span></a>
<a class="sourceLine" id="cb1146-5" data-line-number="5">n     &lt;-<span class="st"> </span><span class="dv">47</span></a>
<a class="sourceLine" id="cb1146-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1146-7" data-line-number="7"><span class="co"># fit that joint</span></a>
<a class="sourceLine" id="cb1146-8" data-line-number="8">fit13<span class="fl">.3</span> &lt;-</a>
<a class="sourceLine" id="cb1146-9" data-line-number="9"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> <span class="kw">sample_theta</span>(<span class="dt">seed =</span> <span class="dv">13</span>, <span class="dt">n_subj =</span> <span class="dv">14</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1146-10" data-line-number="10"><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">map</span>(theta, rbinom, <span class="dt">n =</span> n, <span class="dt">size =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1146-11" data-line-number="11"><span class="st">        </span><span class="kw">unnest</span>(y),</a>
<a class="sourceLine" id="cb1146-12" data-line-number="12">      <span class="dt">family =</span> <span class="kw">bernoulli</span>(<span class="dt">link =</span> logit),</a>
<a class="sourceLine" id="cb1146-13" data-line-number="13">      y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>s),</a>
<a class="sourceLine" id="cb1146-14" data-line-number="14">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1146-15" data-line-number="15">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sd)),</a>
<a class="sourceLine" id="cb1146-16" data-line-number="16">      <span class="dt">iter =</span> <span class="dv">2000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1146-17" data-line-number="17">      <span class="dt">seed =</span> <span class="dv">13</span>,</a>
<a class="sourceLine" id="cb1146-18" data-line-number="18">      <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">.9</span>),</a>
<a class="sourceLine" id="cb1146-19" data-line-number="19">      <span class="dt">file =</span> <span class="st">&quot;fits/fit13.03&quot;</span>)</a></code></pre></div>
<p>Check real quick to make sure the fit turned out okay.</p>
<div class="sourceCode" id="cb1147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1147-1" data-line-number="1"><span class="kw">print</span>(fit13<span class="fl">.3</span>)</a></code></pre></div>
<pre><code>##  Family: bernoulli 
##   Links: mu = logit 
## Formula: y ~ 1 + (1 | s) 
##    Data: sample_theta(seed = 13, n_subj = 14) %&gt;% mutate(y  (Number of observations: 658) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Group-Level Effects: 
## ~s (Number of levels: 14) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)     0.16      0.11     0.01     0.42 1.00     1427     1381
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     0.73      0.10     0.55     0.93 1.00     3403     2876
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Looks fine. Our new model simulation carries with it some new goals.</p>
<blockquote>
<p>In this example, [Kruschke] considered goals for achieving precision and exceeding a ROPE around the null value, at both the group level and individual level. For the group level, the goals are for the 95% HDI on the group mode, <span class="math inline">\(\omega\)</span>, to fall above the ROPE around the null value, and for the width of the HDI to be less than 0.2. For the individual level, the goals are for at least one of the <span class="math inline">\(\theta_s\)</span>s 95% HDIs to exceed the ROPE with none that fall below the ROPE, and for all the <span class="math inline">\(\theta_s\)</span>s 95% HDIs to have widths less than 0.2. (pp. 379–380)</p>
</blockquote>
<p>Now since we used an aggregated binomial model, we don’t have a population-level <span class="math inline">\(\omega\)</span> parameter. Rather, we have a population <span class="math inline">\(\theta\)</span>. So like before, our first goal is for the population <span class="math inline">\(\theta\)</span> to fall above the range <span class="math inline">\([.48, .52]\)</span>. The second corresponding width goal is also like before; we want <span class="math inline">\(\theta\)</span> to have a width of less than 0.2. But since our aggregated binomial model parameterized <span class="math inline">\(\theta\)</span> in the log-odds metric, we’ll have to update our <code>get_hdi()</code> function, which we’ll strategically rename <code>get_theta_hdi()</code>.</p>
<div class="sourceCode" id="cb1149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1149-1" data-line-number="1">get_theta_hdi &lt;-<span class="st"> </span><span class="cf">function</span>(fit) {</a>
<a class="sourceLine" id="cb1149-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb1149-3" data-line-number="3">  fit <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1149-4" data-line-number="4"><span class="st">    </span><span class="kw">posterior_samples</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1149-5" data-line-number="5"><span class="st">    </span><span class="kw">transmute</span>(<span class="dt">theta =</span> <span class="kw">inv_logit_scaled</span>(b_Intercept)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1149-6" data-line-number="6"><span class="st">    </span><span class="kw">mode_hdi</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1149-7" data-line-number="7"><span class="st">    </span><span class="kw">select</span>(.lower<span class="op">:</span>.upper)</a>
<a class="sourceLine" id="cb1149-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb1149-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb1149-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1149-11" data-line-number="11"><span class="co"># how does it work?</span></a>
<a class="sourceLine" id="cb1149-12" data-line-number="12"><span class="kw">get_theta_hdi</span>(fit13<span class="fl">.3</span>)</a></code></pre></div>
<pre><code>##      .lower    .upper
## 1 0.6315379 0.7144742</code></pre>
<p>As for the individual-level goals, the two Kruschke outlined in the text apply to our model in a straightforward way. But we will need one more custom function designed to pull the <span class="math inline">\(\theta_s\)</span>s for the <span class="math inline">\(\theta_s\)</span>s. Let’s call this one <code>get_theta_s_hdi()</code>.</p>
<div class="sourceCode" id="cb1151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1151-1" data-line-number="1">get_theta_s_hdi &lt;-<span class="st"> </span><span class="cf">function</span>(fit) {</a>
<a class="sourceLine" id="cb1151-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb1151-3" data-line-number="3">  n_col &lt;-</a>
<a class="sourceLine" id="cb1151-4" data-line-number="4"><span class="st">    </span><span class="kw">coef</span>(fit, <span class="dt">summary =</span> F)<span class="op">$</span>s[, , <span class="st">&quot;Intercept&quot;</span>] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1151-5" data-line-number="5"><span class="st">    </span><span class="kw">ncol</span>()</a>
<a class="sourceLine" id="cb1151-6" data-line-number="6">    </a>
<a class="sourceLine" id="cb1151-7" data-line-number="7">  <span class="kw">coef</span>(fit, <span class="dt">summary =</span> F)<span class="op">$</span>s[, , <span class="st">&quot;Intercept&quot;</span>] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1151-8" data-line-number="8"><span class="st">    </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1151-9" data-line-number="9"><span class="st">    </span><span class="kw">set_names</span>(<span class="dv">1</span><span class="op">:</span>n_col) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1151-10" data-line-number="10"><span class="st">    </span><span class="kw">mutate_all</span>(inv_logit_scaled) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1151-11" data-line-number="11"><span class="st">    </span><span class="kw">gather</span>(s, value) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1151-12" data-line-number="12"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">s =</span> <span class="kw">as.numeric</span>(s)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1151-13" data-line-number="13"><span class="st">    </span><span class="kw">group_by</span>(s) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1151-14" data-line-number="14"><span class="st">    </span><span class="kw">mode_hdi</span>(value) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1151-15" data-line-number="15"><span class="st">    </span><span class="kw">select</span>(s, .lower<span class="op">:</span>.upper) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1151-16" data-line-number="16"><span class="st">    </span><span class="kw">rename</span>(<span class="dt">.lower_s =</span> .lower,</a>
<a class="sourceLine" id="cb1151-17" data-line-number="17">           <span class="dt">.upper_s =</span> .upper)</a>
<a class="sourceLine" id="cb1151-18" data-line-number="18">  </a>
<a class="sourceLine" id="cb1151-19" data-line-number="19">}</a>
<a class="sourceLine" id="cb1151-20" data-line-number="20"></a>
<a class="sourceLine" id="cb1151-21" data-line-number="21"><span class="co"># how does it work?</span></a>
<a class="sourceLine" id="cb1151-22" data-line-number="22"><span class="kw">get_theta_s_hdi</span>(fit13<span class="fl">.3</span>)</a></code></pre></div>
<pre><code>## # A tibble: 14 x 3
##        s .lower_s .upper_s
##    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1     1    0.622    0.776
##  2     2    0.599    0.750
##  3     3    0.606    0.753
##  4     4    0.510    0.715
##  5     5    0.606    0.756
##  6     6    0.610    0.765
##  7     7    0.591    0.741
##  8     8    0.611    0.754
##  9     9    0.577    0.730
## 10    10    0.605    0.753
## 11    11    0.603    0.754
## 12    12    0.584    0.739
## 13    13    0.617    0.766
## 14    14    0.614    0.757</code></pre>
<p>With <code>sim2</code>, we avoided saving our model <code>brms::brm()</code> fit objects by using <code>map(data, ~update(fit1, newdata = list(y = .)) %&gt;% get_hdi())</code>. That is, within the <code>purrr::map()</code> function, we first used <code>update()</code> to update the fit to the new data and then pumped that directly into <code>get_hdi()</code>, which simply returned our intervals. Though slick, this approach won’t work here because we want to pump our updated model fit into two functions, both <code>get_theta_hdi()</code> and <code>get_theta_s_hdi()</code>. Our work-around will be to make a custom function that updates the fit, saves it as an object, inserts that fit object into both <code>get_theta_hdi()</code> and <code>get_theta_s_hdi()</code>, binds their results together, and the only returns the intervals. We’ll call this function <code>fit_then_hdis()</code>.</p>
<div class="sourceCode" id="cb1153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1153-1" data-line-number="1">fit_then_hdis &lt;-<span class="st"> </span><span class="cf">function</span>(data, seed) {</a>
<a class="sourceLine" id="cb1153-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb1153-3" data-line-number="3">  fit &lt;-<span class="st"> </span><span class="kw">update</span>(fit13<span class="fl">.3</span>, </a>
<a class="sourceLine" id="cb1153-4" data-line-number="4">                <span class="dt">newdata =</span> data, </a>
<a class="sourceLine" id="cb1153-5" data-line-number="5">                <span class="dt">seed =</span> seed)</a>
<a class="sourceLine" id="cb1153-6" data-line-number="6">  </a>
<a class="sourceLine" id="cb1153-7" data-line-number="7">  <span class="kw">cbind</span>(<span class="kw">get_theta_hdi</span>(fit),</a>
<a class="sourceLine" id="cb1153-8" data-line-number="8">        <span class="kw">get_theta_s_hdi</span>(fit))</a>
<a class="sourceLine" id="cb1153-9" data-line-number="9">}</a></code></pre></div>
<p>Now we’re ready to simulate.</p>
<div class="sourceCode" id="cb1154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1154-1" data-line-number="1"><span class="co"># how many subjects should we have?</span></a>
<a class="sourceLine" id="cb1154-2" data-line-number="2">n_subj &lt;-<span class="st"> </span><span class="dv">14</span></a>
<a class="sourceLine" id="cb1154-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1154-4" data-line-number="4"><span class="co"># how many trials should we have?</span></a>
<a class="sourceLine" id="cb1154-5" data-line-number="5">n_trial &lt;-<span class="st"> </span><span class="dv">47</span></a>
<a class="sourceLine" id="cb1154-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1154-7" data-line-number="7"><span class="co"># how many simulations would you like?</span></a>
<a class="sourceLine" id="cb1154-8" data-line-number="8">n_sim &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1154-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1154-10" data-line-number="10">sim3 &lt;-</a>
<a class="sourceLine" id="cb1154-11" data-line-number="11"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">seed =</span> <span class="dv">1</span><span class="op">:</span>n_sim) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1154-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">data =</span> <span class="kw">map</span>(seed, sample_data, <span class="dt">n_subj =</span> n_subj, <span class="dt">n_trial =</span> n_trial)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1154-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">hdi =</span> <span class="kw">map2</span>(data, seed, fit_then_hdis))</a></code></pre></div>
<p>If we hold these by the criteria of each <span class="math inline">\(\text{HDI}_{\theta_s} &gt; \text{ROPE}\)</span> and all to have widths less than 0.2, It looks like our initial data-generating <code>fit13.3</code> is in the ballpark. Here are the results for the full power analysis, <code>sim3</code>.</p>
<div class="sourceCode" id="cb1155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1155-1" data-line-number="1">sim3 &lt;-</a>
<a class="sourceLine" id="cb1155-2" data-line-number="2"><span class="st">  </span>sim3 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1155-3" data-line-number="3"><span class="st">  </span><span class="kw">unnest</span>(hdi) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1155-4" data-line-number="4"><span class="st">  </span><span class="co"># here we determine whether we passed at the group level</span></a>
<a class="sourceLine" id="cb1155-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pass_rope_theta  =</span> .lower <span class="op">&gt;</span><span class="st"> </span><span class="fl">.52</span> <span class="op">|</span><span class="st"> </span>.upper <span class="op">&lt;</span><span class="st"> </span><span class="fl">.48</span>,</a>
<a class="sourceLine" id="cb1155-6" data-line-number="6">         <span class="dt">pass_width_theta =</span> (.upper <span class="op">-</span><span class="st"> </span>.lower) <span class="op">&lt;</span><span class="st"> </span><span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1155-7" data-line-number="7"><span class="st">  </span><span class="co"># the s-level thetas require two steps.</span></a>
<a class="sourceLine" id="cb1155-8" data-line-number="8"><span class="st">  </span><span class="co"># first, we&#39;ll outline the three criteria</span></a>
<a class="sourceLine" id="cb1155-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">exceed_rope_theta_s  =</span> .lower_s <span class="op">&gt;</span><span class="st"> </span><span class="fl">.52</span>,</a>
<a class="sourceLine" id="cb1155-10" data-line-number="10">         <span class="dt">below_rope_theta_s   =</span> .upper_s <span class="op">&lt;</span><span class="st"> </span><span class="fl">.48</span>,</a>
<a class="sourceLine" id="cb1155-11" data-line-number="11">         <span class="dt">narrow_width_theta_s =</span> (.upper_s <span class="op">-</span><span class="st"> </span>.lower_s) <span class="op">&lt;</span><span class="st"> </span><span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1155-12" data-line-number="12"><span class="st">  </span><span class="co"># second, we&#39;ll evaluate those criteria by group</span></a>
<a class="sourceLine" id="cb1155-13" data-line-number="13"><span class="st">  </span><span class="kw">group_by</span>(seed) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1155-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pass_rope_theta_s  =</span> <span class="kw">sum</span>(exceed_rope_theta_s) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">sum</span>(below_rope_theta_s) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb1155-15" data-line-number="15">         <span class="dt">pass_width_theta_s =</span> <span class="kw">mean</span>(narrow_width_theta_s) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1155-16" data-line-number="16"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb1155-17" data-line-number="17"></a>
<a class="sourceLine" id="cb1155-18" data-line-number="18"><span class="kw">head</span>(sim3)</a></code></pre></div>
<div class="sourceCode" id="cb1156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1156-1" data-line-number="1"><span class="kw">head</span>(sim3)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 14
##    seed data  .lower .upper     s .lower_s .upper_s pass_rope_theta
##   &lt;int&gt; &lt;lis&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;lgl&gt;          
## 1     1 &lt;tib…  0.617  0.709     1    0.616    0.784 TRUE           
## 2     1 &lt;tib…  0.617  0.709     2    0.519    0.707 TRUE           
## 3     1 &lt;tib…  0.617  0.709     3    0.605    0.767 TRUE           
## 4     1 &lt;tib…  0.617  0.709     4    0.604    0.768 TRUE           
## 5     1 &lt;tib…  0.617  0.709     5    0.593    0.752 TRUE           
## 6     1 &lt;tib…  0.617  0.709     6    0.621    0.795 TRUE           
## # … with 6 more variables: pass_width_theta &lt;lgl&gt;, exceed_rope_theta_s &lt;lgl&gt;,
## #   below_rope_theta_s &lt;lgl&gt;, narrow_width_theta_s &lt;lgl&gt;,
## #   pass_rope_theta_s &lt;lgl&gt;, pass_width_theta_s &lt;lgl&gt;</code></pre>
<p>Summarize the results.</p>
<div class="sourceCode" id="cb1158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1158-1" data-line-number="1">sim3 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1158-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">power_rope_theta  =</span> <span class="kw">mean</span>(pass_rope_theta),</a>
<a class="sourceLine" id="cb1158-3" data-line-number="3">            <span class="dt">power_width_theta =</span> <span class="kw">mean</span>(pass_width_theta))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   power_rope_theta power_width_theta
##              &lt;dbl&gt;             &lt;dbl&gt;
## 1                1                 1</code></pre>
<div class="sourceCode" id="cb1160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1160-1" data-line-number="1">sim3 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1160-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">power_rope_theta_s  =</span> <span class="kw">mean</span>(pass_rope_theta_s),</a>
<a class="sourceLine" id="cb1160-3" data-line-number="3">            <span class="dt">power_width_theta_s =</span> <span class="kw">mean</span>(pass_width_theta_s))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   power_rope_theta_s power_width_theta_s
##                &lt;dbl&gt;               &lt;dbl&gt;
## 1                  1               0.472</code></pre>
<p>The power estimates for <code>power_rope_theta</code>, <code>power_width_theta</code>, and <code>power_rope_theta_s</code> were all the same, 1. Only the estimate for <code>power_width_theta_s</code> was unique. Here are the two sets of HDIs for the power estimate values.</p>
<div class="sourceCode" id="cb1162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1162-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</a>
<a class="sourceLine" id="cb1162-2" data-line-number="2">            <span class="dt">shape1 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb1162-3" data-line-number="3">            <span class="dt">shape2 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_sim <span class="op">-</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1162-4" data-line-number="4"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.97 1.00</code></pre>
<div class="sourceCode" id="cb1164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1164-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</a>
<a class="sourceLine" id="cb1164-2" data-line-number="2">            <span class="dt">shape1 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">47</span>,</a>
<a class="sourceLine" id="cb1164-3" data-line-number="3">            <span class="dt">shape2 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_sim <span class="op">-</span><span class="st"> </span><span class="dv">47</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1164-4" data-line-number="4"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.37 0.57</code></pre>
<p>Hopefully it isn’t a surprise our values differ from those in the text. We (a) used a different model and (b) used fewer simulation iterations. But I trust you get the overall idea. Like in the text, let’s do the simulation again.</p>
<div class="sourceCode" id="cb1166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1166-1" data-line-number="1"><span class="co"># how many subjects should we have?</span></a>
<a class="sourceLine" id="cb1166-2" data-line-number="2">n_subj &lt;-<span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb1166-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1166-4" data-line-number="4"><span class="co"># how many trials should we have?</span></a>
<a class="sourceLine" id="cb1166-5" data-line-number="5">n_trial &lt;-<span class="st"> </span><span class="dv">94</span></a>
<a class="sourceLine" id="cb1166-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1166-7" data-line-number="7"><span class="co"># how many simulations would you like?</span></a>
<a class="sourceLine" id="cb1166-8" data-line-number="8">n_sim &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1166-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1166-10" data-line-number="10">sim4 &lt;-</a>
<a class="sourceLine" id="cb1166-11" data-line-number="11"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">seed =</span> <span class="dv">1</span><span class="op">:</span>n_sim) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1166-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">data =</span> <span class="kw">map</span>(seed, sample_data, <span class="dt">n_subj =</span> n_subj, <span class="dt">n_trial =</span> n_trial)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1166-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">hdi =</span> <span class="kw">map2</span>(data, seed, fit_then_hdis))</a></code></pre></div>
<p>Wrangle before summarizing.</p>
<div class="sourceCode" id="cb1167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1167-1" data-line-number="1">sim4 &lt;-</a>
<a class="sourceLine" id="cb1167-2" data-line-number="2"><span class="st">  </span>sim4 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1167-3" data-line-number="3"><span class="st">  </span><span class="kw">unnest</span>(hdi) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1167-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pass_rope_theta  =</span> .lower <span class="op">&gt;</span><span class="st"> </span><span class="fl">.52</span> <span class="op">|</span><span class="st"> </span>.upper <span class="op">&lt;</span><span class="st"> </span><span class="fl">.48</span>,</a>
<a class="sourceLine" id="cb1167-5" data-line-number="5">         <span class="dt">pass_width_theta =</span> (.upper <span class="op">-</span><span class="st"> </span>.lower) <span class="op">&lt;</span><span class="st"> </span><span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1167-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">exceed_rope_theta_s  =</span> .lower_s <span class="op">&gt;</span><span class="st"> </span><span class="fl">.52</span>,</a>
<a class="sourceLine" id="cb1167-7" data-line-number="7">         <span class="dt">below_rope_theta_s   =</span> .upper_s <span class="op">&lt;</span><span class="st"> </span><span class="fl">.48</span>,</a>
<a class="sourceLine" id="cb1167-8" data-line-number="8">         <span class="dt">narrow_width_theta_s =</span> (.upper_s <span class="op">-</span><span class="st"> </span>.lower_s) <span class="op">&lt;</span><span class="st"> </span><span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1167-9" data-line-number="9"><span class="st">  </span><span class="kw">group_by</span>(seed) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1167-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pass_rope_theta_s  =</span> <span class="kw">sum</span>(exceed_rope_theta_s) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">sum</span>(below_rope_theta_s) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb1167-11" data-line-number="11">         <span class="dt">pass_width_theta_s =</span> <span class="kw">mean</span>(narrow_width_theta_s) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1167-12" data-line-number="12"><span class="st">  </span><span class="kw">ungroup</span>()</a></code></pre></div>
<p>Summarize the results.</p>
<div class="sourceCode" id="cb1168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1168-1" data-line-number="1">sim4 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1168-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">power_rope_theta  =</span> <span class="kw">mean</span>(pass_rope_theta),</a>
<a class="sourceLine" id="cb1168-3" data-line-number="3">            <span class="dt">power_width_theta =</span> <span class="kw">mean</span>(pass_width_theta))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   power_rope_theta power_width_theta
##              &lt;dbl&gt;             &lt;dbl&gt;
## 1            0.990             0.940</code></pre>
<div class="sourceCode" id="cb1170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1170-1" data-line-number="1">sim4 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1170-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">power_rope_theta_s  =</span> <span class="kw">mean</span>(pass_rope_theta_s),</a>
<a class="sourceLine" id="cb1170-3" data-line-number="3">            <span class="dt">power_width_theta_s =</span> <span class="kw">mean</span>(pass_width_theta_s))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   power_rope_theta_s power_width_theta_s
##                &lt;dbl&gt;               &lt;dbl&gt;
## 1                  1               0.930</code></pre>
<p>Now compute the HDIs for <code>power_rope_theta</code> and <code>power_width_theta</code>.</p>
<div class="sourceCode" id="cb1172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1172-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</a>
<a class="sourceLine" id="cb1172-2" data-line-number="2">            <span class="dt">shape1 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">99</span>,</a>
<a class="sourceLine" id="cb1172-3" data-line-number="3">            <span class="dt">shape2 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_sim <span class="op">-</span><span class="st"> </span><span class="dv">99</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1172-4" data-line-number="4"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.95 1.00</code></pre>
<div class="sourceCode" id="cb1174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1174-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</a>
<a class="sourceLine" id="cb1174-2" data-line-number="2">            <span class="dt">shape1 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">94</span>,</a>
<a class="sourceLine" id="cb1174-3" data-line-number="3">            <span class="dt">shape2 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_sim <span class="op">-</span><span class="st"> </span><span class="dv">94</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1174-4" data-line-number="4"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.88 0.98</code></pre>
<p>Second, we now compute the HDIs for <code>power_rope_theta_s</code> and <code>power_width_theta_s</code>.</p>
<div class="sourceCode" id="cb1176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1176-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</a>
<a class="sourceLine" id="cb1176-2" data-line-number="2">            <span class="dt">shape1 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1176-3" data-line-number="3">            <span class="dt">shape2 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_sim <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1176-4" data-line-number="4"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.00 0.05</code></pre>
<div class="sourceCode" id="cb1178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1178-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</a>
<a class="sourceLine" id="cb1178-2" data-line-number="2">            <span class="dt">shape1 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">93</span>,</a>
<a class="sourceLine" id="cb1178-3" data-line-number="3">            <span class="dt">shape2 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_sim <span class="op">-</span><span class="st"> </span><span class="dv">93</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1178-4" data-line-number="4"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.87 0.97</code></pre>
<p>The results from our simulations contrast with those in the text. Though the results are similar with respect to <span class="math inline">\(\theta_s\)</span>, they are markedly different with regards to our <span class="math inline">\(\theta\)</span> versus the text’s <span class="math inline">\(\omega\)</span>. But Kruschke’s point is still sound:</p>
<blockquote>
<p>This example illustrates a general trend in hierarchical estimates. If you want high precision at the individual level, you need lots of data within individuals. If you want high precision at the group level, you need lots of individuals (without necessarily lots of data per individual, but more is better). (p. 382)</p>
</blockquote>
<div class="sourceCode" id="cb1180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1180-1" data-line-number="1">ideal_group_mean &lt;-<span class="st"> </span><span class="fl">0.65</span></a>
<a class="sourceLine" id="cb1180-2" data-line-number="2">ideal_group_sd   &lt;-<span class="st"> </span><span class="fl">0.07</span></a>
<a class="sourceLine" id="cb1180-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1180-4" data-line-number="4">ideal_n_subj         &lt;-<span class="st"> </span><span class="dv">10</span>  <span class="co"># instead of 100</span></a>
<a class="sourceLine" id="cb1180-5" data-line-number="5">ideal_n_trl_per_subj &lt;-<span class="st"> </span><span class="dv">10</span>  <span class="co"># instead of 100</span></a>
<a class="sourceLine" id="cb1180-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1180-7" data-line-number="7">b &lt;-<span class="st"> </span><span class="kw">beta_ab_from_mean_sd</span>(ideal_group_mean, ideal_group_sd)</a>
<a class="sourceLine" id="cb1180-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1180-9" data-line-number="9"><span class="kw">set.seed</span>(<span class="dv">13</span>)</a>
<a class="sourceLine" id="cb1180-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1180-11" data-line-number="11">d &lt;-</a>
<a class="sourceLine" id="cb1180-12" data-line-number="12"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">s     =</span> <span class="dv">1</span><span class="op">:</span>ideal_n_subj,</a>
<a class="sourceLine" id="cb1180-13" data-line-number="13">         <span class="dt">theta =</span> <span class="kw">rbeta</span>(ideal_n_subj, b<span class="op">$</span>a, b<span class="op">$</span>b)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1180-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">theta_transformed =</span> ((theta <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta)) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(theta)) <span class="op">*</span><span class="st"> </span>ideal_group_sd <span class="op">+</span><span class="st"> </span>ideal_group_mean) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1180-15" data-line-number="15"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">theta_transformed =</span> <span class="kw">ifelse</span>(theta_transformed <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.999</span>, <span class="fl">0.999</span>,</a>
<a class="sourceLine" id="cb1180-16" data-line-number="16">                                    <span class="kw">ifelse</span>(theta_transformed <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.001</span>, <span class="fl">0.001</span>,</a>
<a class="sourceLine" id="cb1180-17" data-line-number="17">                                           theta_transformed))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1180-18" data-line-number="18"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z =</span> <span class="kw">round</span>(theta_transformed <span class="op">*</span><span class="st"> </span>ideal_n_trl_per_subj)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1180-19" data-line-number="19"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">map</span>(z, <span class="op">~</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, .), <span class="kw">rep</span>(<span class="dv">0</span>, ideal_n_trl_per_subj <span class="op">-</span><span class="st"> </span>.)))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1180-20" data-line-number="20"><span class="st">  </span><span class="kw">unnest</span>(y)</a>
<a class="sourceLine" id="cb1180-21" data-line-number="21"></a>
<a class="sourceLine" id="cb1180-22" data-line-number="22"><span class="kw">head</span>(d)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##       s theta theta_transformed     z     y
##   &lt;int&gt; &lt;dbl&gt;             &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1 0.604             0.659     7     1
## 2     1 0.604             0.659     7     1
## 3     1 0.604             0.659     7     1
## 4     1 0.604             0.659     7     1
## 5     1 0.604             0.659     7     1
## 6     1 0.604             0.659     7     1</code></pre>
<p>Fit the <span class="math inline">\(\theta\)</span>-generating model.</p>
<div class="sourceCode" id="cb1182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1182-1" data-line-number="1">fit13<span class="fl">.4</span> &lt;-</a>
<a class="sourceLine" id="cb1182-2" data-line-number="2"><span class="st">  </span><span class="kw">update</span>(fit13<span class="fl">.2</span>,</a>
<a class="sourceLine" id="cb1182-3" data-line-number="3">         <span class="dt">newdata =</span> d,</a>
<a class="sourceLine" id="cb1182-4" data-line-number="4">         <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1182-5" data-line-number="5">         <span class="dt">seed =</span> <span class="dv">13</span>,</a>
<a class="sourceLine" id="cb1182-6" data-line-number="6">         <span class="dt">file =</span> <span class="st">&quot;fits/fit13.04&quot;</span>)</a></code></pre></div>
<p>Check to make sure things look alright.</p>
<div class="sourceCode" id="cb1183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1183-1" data-line-number="1"><span class="kw">print</span>(fit13<span class="fl">.4</span>)</a></code></pre></div>
<pre><code>##  Family: bernoulli 
##   Links: mu = logit 
## Formula: y ~ 1 + (1 | s) 
##    Data: d (Number of observations: 100) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Group-Level Effects: 
## ~s (Number of levels: 10) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)     0.23      0.19     0.01     0.72 1.00     2262     1562
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     0.62      0.23     0.17     1.07 1.00     3776     2600
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Here’s a look at our two main parameters, our version of the bottom panels of Figure 13.3.</p>
<div class="sourceCode" id="cb1185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1185-1" data-line-number="1"><span class="kw">posterior_samples</span>(fit13<span class="fl">.4</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1185-2" data-line-number="2"><span class="st">  </span><span class="kw">pivot_longer</span>(b_Intercept<span class="op">:</span>sd_s__Intercept) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1185-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1185-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1185-5" data-line-number="5"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb1185-6" data-line-number="6">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1185-7" data-line-number="7">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1185-8" data-line-number="8">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1185-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1185-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;Remember, these are in the log-odds metric.&quot;</span>,</a>
<a class="sourceLine" id="cb1185-11" data-line-number="11">       <span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1185-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb1185-13" data-line-number="13"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="13_files/figure-gfm/unnamed-chunk-61-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Now redefine our <code>fitted()</code> object, <code>f</code>, which gets pumped into the <code>sample_data()</code> function.</p>
<div class="sourceCode" id="cb1186"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1186-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">13</span>)</a>
<a class="sourceLine" id="cb1186-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1186-3" data-line-number="3">f &lt;-</a>
<a class="sourceLine" id="cb1186-4" data-line-number="4"><span class="st">  </span><span class="kw">fitted</span>(fit13<span class="fl">.4</span>,</a>
<a class="sourceLine" id="cb1186-5" data-line-number="5">         <span class="dt">newdata =</span> <span class="kw">tibble</span>(<span class="dt">s =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1186-6" data-line-number="6">         <span class="dt">allow_new_levels =</span> T,</a>
<a class="sourceLine" id="cb1186-7" data-line-number="7">         <span class="dt">summary =</span> F) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1186-8" data-line-number="8"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1186-9" data-line-number="9"><span class="st">  </span><span class="kw">set_names</span>(<span class="st">&quot;theta&quot;</span>)</a></code></pre></div>
<p>Here’s what our updated distribution of <span class="math inline">\(\theta\)</span> values looks like.</p>
<div class="sourceCode" id="cb1187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1187-1" data-line-number="1">f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1187-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1187-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb1187-4" data-line-number="4">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1187-5" data-line-number="5">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T) <span class="op">+</span></a>
<a class="sourceLine" id="cb1187-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1187-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;Behold our </span><span class="ch">\&quot;</span><span class="st">distribution of parameter values consistent</span><span class="ch">\n</span><span class="st">with our idealized hypothesis.</span><span class="ch">\&quot;</span><span class="st">&quot;</span>,</a>
<a class="sourceLine" id="cb1187-8" data-line-number="8">       <span class="dt">x =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1187-9" data-line-number="9"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1187-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="13_files/figure-gfm/unnamed-chunk-63-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Note the distribution is wider than the previous one. Anyway, now we’re good to go. Here’s our version of the first power analysis.</p>
<div class="sourceCode" id="cb1188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1188-1" data-line-number="1"><span class="co"># how many subjects should we have?</span></a>
<a class="sourceLine" id="cb1188-2" data-line-number="2">n_subj &lt;-<span class="st"> </span><span class="dv">14</span></a>
<a class="sourceLine" id="cb1188-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1188-4" data-line-number="4"><span class="co"># how many trials should we have?</span></a>
<a class="sourceLine" id="cb1188-5" data-line-number="5">n_trial &lt;-<span class="st"> </span><span class="dv">47</span></a>
<a class="sourceLine" id="cb1188-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1188-7" data-line-number="7"><span class="co"># how many simulations would you like?</span></a>
<a class="sourceLine" id="cb1188-8" data-line-number="8">n_sim &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1188-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1188-10" data-line-number="10">sim5 &lt;-</a>
<a class="sourceLine" id="cb1188-11" data-line-number="11"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">seed =</span> <span class="dv">1</span><span class="op">:</span>n_sim) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1188-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">data =</span> <span class="kw">map</span>(seed, sample_data, <span class="dt">n_subj =</span> n_subj, <span class="dt">n_trial =</span> n_trial)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1188-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">hdi =</span> <span class="kw">map2</span>(data, seed, fit_then_hdis))</a></code></pre></div>
<p>Wrangle before summarizing.</p>
<div class="sourceCode" id="cb1189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1189-1" data-line-number="1">sim5 &lt;-</a>
<a class="sourceLine" id="cb1189-2" data-line-number="2"><span class="st">  </span>sim5 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1189-3" data-line-number="3"><span class="st">  </span><span class="kw">unnest</span>(hdi) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1189-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pass_rope_theta  =</span> .lower <span class="op">&gt;</span><span class="st"> </span><span class="fl">.52</span> <span class="op">|</span><span class="st"> </span>.upper <span class="op">&lt;</span><span class="st"> </span><span class="fl">.48</span>,</a>
<a class="sourceLine" id="cb1189-5" data-line-number="5">         <span class="dt">pass_width_theta =</span> (.upper <span class="op">-</span><span class="st"> </span>.lower) <span class="op">&lt;</span><span class="st"> </span><span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1189-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">exceed_rope_theta_s  =</span> .lower_s <span class="op">&gt;</span><span class="st"> </span><span class="fl">.52</span>,</a>
<a class="sourceLine" id="cb1189-7" data-line-number="7">         <span class="dt">below_rope_theta_s   =</span> .upper_s <span class="op">&lt;</span><span class="st"> </span><span class="fl">.48</span>,</a>
<a class="sourceLine" id="cb1189-8" data-line-number="8">         <span class="dt">narrow_width_theta_s =</span> (.upper_s <span class="op">-</span><span class="st"> </span>.lower_s) <span class="op">&lt;</span><span class="st"> </span><span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1189-9" data-line-number="9"><span class="st">  </span><span class="kw">group_by</span>(seed) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1189-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pass_rope_theta_s  =</span> <span class="kw">sum</span>(exceed_rope_theta_s) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">sum</span>(below_rope_theta_s) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb1189-11" data-line-number="11">         <span class="dt">pass_width_theta_s =</span> <span class="kw">mean</span>(narrow_width_theta_s) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1189-12" data-line-number="12"><span class="st">  </span><span class="kw">ungroup</span>()</a></code></pre></div>
<p>Summarize the results.</p>
<div class="sourceCode" id="cb1190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1190-1" data-line-number="1">sim5 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1190-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">power_rope_theta  =</span> <span class="kw">mean</span>(pass_rope_theta),</a>
<a class="sourceLine" id="cb1190-3" data-line-number="3">            <span class="dt">power_width_theta =</span> <span class="kw">mean</span>(pass_width_theta))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   power_rope_theta power_width_theta
##              &lt;dbl&gt;             &lt;dbl&gt;
## 1                1                 1</code></pre>
<div class="sourceCode" id="cb1192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1192-1" data-line-number="1">sim5 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1192-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">power_rope_theta_s  =</span> <span class="kw">mean</span>(pass_rope_theta_s),</a>
<a class="sourceLine" id="cb1192-3" data-line-number="3">            <span class="dt">power_width_theta_s =</span> <span class="kw">mean</span>(pass_width_theta_s))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   power_rope_theta_s power_width_theta_s
##                &lt;dbl&gt;               &lt;dbl&gt;
## 1                  1                0.27</code></pre>
<p>Here are the two interval types.</p>
<div class="sourceCode" id="cb1194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1194-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</a>
<a class="sourceLine" id="cb1194-2" data-line-number="2">            <span class="dt">shape1 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb1194-3" data-line-number="3">            <span class="dt">shape2 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_sim <span class="op">-</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1194-4" data-line-number="4"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.97 1.00</code></pre>
<div class="sourceCode" id="cb1196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1196-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</a>
<a class="sourceLine" id="cb1196-2" data-line-number="2">            <span class="dt">shape1 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">27</span>,</a>
<a class="sourceLine" id="cb1196-3" data-line-number="3">            <span class="dt">shape2 =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_sim <span class="op">-</span><span class="st"> </span><span class="dv">27</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1196-4" data-line-number="4"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.19 0.36</code></pre>
<blockquote>
<p>The classical definition of power in NHST assumes a specific value for the parameters without any uncertainty. The classical approach can compute power for different specific parameter values, but the approach does not weigh the different values by their credibility. One consequence is that for the classical approach, retrospective power is extremely uncertain, rendering it virtually useless, because the estimated powers at the two ends of the confidence interval are close to the baseline false alarm rate and 100% <span class="citation">(Gerard, Smith, &amp; Weerakkody, <a href="#ref-millerWhatProbabilityReplicating2009">2009</a>; Nakagawa &amp; Foster, <a href="#ref-nakagawaCaseRetrospectiveStatistical2004">2004</a>; O’Keefe, <a href="#ref-okeefeBriefReportPost2007">2007</a>; Steidl, Hayes, &amp; Schauber, <a href="#ref-steidlStatisticalPowerAnalysis1997">1997</a>; Sun, Pan, &amp; Wang, <a href="#ref-sunRethinkingObservedPower2011">2011</a>; L. Thomas, <a href="#ref-thomasRetrospectivePowerAnalysis1997">1997</a>)</span>. (p. 383)</p>
</blockquote>
</div>
</div>
<div id="sequential-testing-and-the-goal-of-precision" class="section level2">
<h2><span class="header-section-number">13.3</span> Sequential testing and the goal of precision</h2>
<blockquote>
<p>In classical power analysis, it is assumed that the goal is to reject the null hypothesis. For many researchers, the <em>sine qua non</em> of research is to reject the null hypothesis. The practice of NHST is so deeply institutionalized in scientific journals that it is difficult to get research findings published without showing “significant” results, in the sense of <span class="math inline">\(p &lt; 0.05\)</span>. As a consequence, many researchers will monitor data as they are being collected and stop collecting data only when <span class="math inline">\(p &lt; 0.05\)</span> (conditionalizing on the current sample size) or when their patience runs out. This practice seems intuitively not to be problematic because the data collected after testing previous data are not affected by the previously collected data. For example, if I flip a coin repeatedly, the probability of heads on the next flip is not affected by whether or not I happened to check whether <span class="math inline">\(p &lt; 0.05\)</span> on the previous flip.</p>
<p>Unfortunately, that intuition about independence across flips only tells part of story. What’s missing is the realization that the stopping procedure biases which data are sampled, because the procedure stops only when extreme values happen to be randomly sampled…</p>
<p>The remainder of this section shows examples of sequential testing with different decision criteria. We consider decisions by <span class="math inline">\(p\)</span> values, BFs, HDIs with ROPEs, and precision. We will see that decisions by <span class="math inline">\(p\)</span> values not only lead to 100% false alarms (with infinite patience), but also lead to biased estimates that are more extreme than the true value. The two Bayesian methods both can decide to accept the null hypothesis, and therefore do not lead to 100% false alarms, but both do produce biased estimates because they stop when extreme values are sampled. Stopping when precision is achieved produces accurate estimates. (pp. 383–385, <em>emphasis</em> in the original)</p>
</blockquote>
<div id="examples-ofsequential-tests." class="section level3">
<h3><span class="header-section-number">13.3.1</span> Examples ofsequential tests.</h3>
<p>To start our sequence of simulated coin flips, we’ll set the total number of trials we’d like, <code>n_trial</code>, specify our <code>bias</code>, and set out seed. Like Kruschke did in the text we’ll do <code>bias &lt;- .5</code>, first.</p>
<div class="sourceCode" id="cb1198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1198-1" data-line-number="1">n_trial &lt;-<span class="st"> </span><span class="dv">700</span></a>
<a class="sourceLine" id="cb1198-2" data-line-number="2">bias    &lt;-<span class="st"> </span><span class="fl">.5</span></a>
<a class="sourceLine" id="cb1198-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1198-4" data-line-number="4"><span class="kw">set.seed</span>(<span class="dv">13</span>)</a>
<a class="sourceLine" id="cb1198-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1198-6" data-line-number="6">coin<span class="fl">.5</span> &lt;-</a>
<a class="sourceLine" id="cb1198-7" data-line-number="7"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">n    =</span> <span class="dv">1</span><span class="op">:</span>n_trial,</a>
<a class="sourceLine" id="cb1198-8" data-line-number="8">         <span class="dt">flip =</span> <span class="kw">rbinom</span>(<span class="dt">n =</span> n_trial, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> bias)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1198-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z =</span> <span class="kw">cumsum</span>(flip))</a>
<a class="sourceLine" id="cb1198-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1198-11" data-line-number="11"><span class="kw">head</span>(coin<span class="fl">.5</span>)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##       n  flip     z
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1     1     1     1
## 2     2     0     1
## 3     3     0     1
## 4     4     0     1
## 5     5     1     2
## 6     6     0     2</code></pre>
<p>Here’s a little custom function that will fit frequentist logistic regression models for each combination of <code>n</code> and <code>z</code> and then extract the associated <span class="math inline">\(p\)</span>-value.</p>
<div class="sourceCode" id="cb1200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1200-1" data-line-number="1">fit_glm &lt;-<span class="st"> </span><span class="cf">function</span>(n, z) {</a>
<a class="sourceLine" id="cb1200-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb1200-3" data-line-number="3">  d &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">y =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(z, n <span class="op">-</span><span class="st"> </span>z)))</a>
<a class="sourceLine" id="cb1200-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb1200-5" data-line-number="5">  <span class="kw">glm</span>(<span class="dt">data =</span> d, y <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1200-6" data-line-number="6"><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1200-7" data-line-number="7"><span class="st">    </span><span class="kw">select</span>(p.value) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1200-8" data-line-number="8"><span class="st">    </span><span class="kw">pull</span>()</a>
<a class="sourceLine" id="cb1200-9" data-line-number="9">  </a>
<a class="sourceLine" id="cb1200-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb1200-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1200-12" data-line-number="12"><span class="co"># here&#39;s how it works</span></a>
<a class="sourceLine" id="cb1200-13" data-line-number="13"><span class="kw">fit_glm</span>(<span class="dt">n =</span> <span class="dv">5</span>, <span class="dt">z =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.6569235</code></pre>
<p>Use <code>fit_glm()</code> to compute the <span class="math inline">\(p\)</span>-values.</p>
<div class="sourceCode" id="cb1202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1202-1" data-line-number="1">coin<span class="fl">.5</span> &lt;-</a>
<a class="sourceLine" id="cb1202-2" data-line-number="2"><span class="st">  </span>coin<span class="fl">.5</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1202-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p =</span> <span class="kw">map2_dbl</span>(n, z, fit_glm))</a>
<a class="sourceLine" id="cb1202-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1202-5" data-line-number="5"><span class="kw">head</span>(coin<span class="fl">.5</span>)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##       n  flip     z     p
##   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
## 1     1     1     1 1.00 
## 2     2     0     1 1    
## 3     3     0     1 0.571
## 4     4     0     1 0.341
## 5     5     1     2 0.657
## 6     6     0     2 0.423</code></pre>
<p>For the Bayes factors, Kruschke indicated these were computed based on Equation 12.3 from page 344. That equation followed the form</p>
<p><span class="math display">\[
\frac{p(z, N | M_\text{alt})}{p(z, N | M_\text{null})} = \frac{B (z + a_\text{alt}, N - z + b_\text{alt}) / B (a_\text{alt}, b_\text{alt})}{\theta_\text{null}^z (1 - \theta_\text{null})^{(N - z)}}.
\]</span></p>
<p>To ground ourselves a bit, here’s some of the content from that page that followed the equation.</p>
<blockquote>
<p>For a default alternative prior, the beta distribution is supposed to be uninformed, according to particular mathematical criteria. Intuition might suggest that a uniform distribution suits this requirement, that is, <span class="math inline">\(\operatorname{beta} (\theta | 1, 1)\)</span>. Instead, some argue that the most appropriate uninformed beta distribution is <span class="math inline">\(\operatorname{beta} (\theta | \epsilon, \epsilon)\)</span>, where <span class="math inline">\(\epsilon\)</span> is a small number approaching zero (p. 344)</p>
</blockquote>
<p>The <span class="math inline">\(\operatorname{beta} (\epsilon, \epsilon)\)</span>, recall, is the Haldane prior. Often times, <span class="math inline">\(\epsilon = 0.01\)</span>. That will be our approach here, too. Let’s make another custom function.</p>
<div class="sourceCode" id="cb1204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1204-1" data-line-number="1">log_bf &lt;-<span class="st"> </span><span class="cf">function</span>(n, z, theta) { </a>
<a class="sourceLine" id="cb1204-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb1204-3" data-line-number="3">  <span class="co"># define epsilon for the Haldane prior</span></a>
<a class="sourceLine" id="cb1204-4" data-line-number="4">  e &lt;-<span class="st"> </span><span class="fl">0.01</span></a>
<a class="sourceLine" id="cb1204-5" data-line-number="5">  </a>
<a class="sourceLine" id="cb1204-6" data-line-number="6">  <span class="co"># compute p(d | H_0)</span></a>
<a class="sourceLine" id="cb1204-7" data-line-number="7">  p_d_null &lt;-<span class="st"> </span>theta <span class="op">^</span><span class="st"> </span>z <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta) <span class="op">^</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span>z)</a>
<a class="sourceLine" id="cb1204-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb1204-9" data-line-number="9">  <span class="co"># compute p(d | H_1)</span></a>
<a class="sourceLine" id="cb1204-10" data-line-number="10">  p_d_alt &lt;-<span class="st"> </span><span class="kw">beta</span>(z <span class="op">+</span><span class="st"> </span>e, n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>e) <span class="op">/</span><span class="st"> </span><span class="kw">beta</span>(e, e) </a>
<a class="sourceLine" id="cb1204-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb1204-12" data-line-number="12">  <span class="co"># compute BF</span></a>
<a class="sourceLine" id="cb1204-13" data-line-number="13">  bf &lt;-<span class="st"> </span>p_d_alt <span class="op">/</span><span class="st"> </span>p_d_null</a>
<a class="sourceLine" id="cb1204-14" data-line-number="14">  </a>
<a class="sourceLine" id="cb1204-15" data-line-number="15">  <span class="co"># take the log</span></a>
<a class="sourceLine" id="cb1204-16" data-line-number="16">  <span class="kw">log</span>(bf)</a>
<a class="sourceLine" id="cb1204-17" data-line-number="17">  </a>
<a class="sourceLine" id="cb1204-18" data-line-number="18">}</a></code></pre></div>
<p>Here’s how it works.</p>
<div class="sourceCode" id="cb1205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1205-1" data-line-number="1"><span class="kw">log_bf</span>(<span class="dt">n =</span> <span class="dv">6</span>, <span class="dt">z =</span> <span class="dv">2</span>, <span class="dt">theta =</span> bias)</a></code></pre></div>
<pre><code>## [1] -4.152328</code></pre>
<p>Now we’ll use it in bulk.</p>
<div class="sourceCode" id="cb1207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1207-1" data-line-number="1">coin<span class="fl">.5</span> &lt;-</a>
<a class="sourceLine" id="cb1207-2" data-line-number="2"><span class="st">  </span>coin<span class="fl">.5</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1207-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log_bf =</span> <span class="kw">map2_dbl</span>(n, z, log_bf, <span class="dt">theta =</span> <span class="fl">.5</span>))</a>
<a class="sourceLine" id="cb1207-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1207-5" data-line-number="5"><span class="kw">head</span>(coin<span class="fl">.5</span>)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##       n  flip     z     p log_bf
##   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1     1     1     1 1.00    0   
## 2     2     0     1 1      -3.93
## 3     3     0     1 0.571  -3.93
## 4     4     0     1 0.341  -3.65
## 5     5     1     2 0.657  -4.33
## 6     6     0     2 0.423  -4.15</code></pre>
<p>To compute the HDIs for each iteration, we’ll want to use the <code>hdi_of_qbeta()</code> function from Chapters 10 and 12.</p>
<div class="sourceCode" id="cb1209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1209-1" data-line-number="1">hdi_of_qbeta &lt;-<span class="st"> </span><span class="cf">function</span>(shape1, shape2) {</a>
<a class="sourceLine" id="cb1209-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb1209-3" data-line-number="3">  <span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</a>
<a class="sourceLine" id="cb1209-4" data-line-number="4">              <span class="dt">shape1 =</span> shape1,</a>
<a class="sourceLine" id="cb1209-5" data-line-number="5">              <span class="dt">shape2 =</span> shape2) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1209-6" data-line-number="6"><span class="st">    </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1209-7" data-line-number="7"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">level =</span> <span class="kw">c</span>(<span class="st">&quot;ll&quot;</span>, <span class="st">&quot;ul&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1209-8" data-line-number="8"><span class="st">    </span><span class="kw">spread</span>(<span class="dt">key =</span> level, <span class="dt">value =</span> <span class="st">&quot;.&quot;</span>)</a>
<a class="sourceLine" id="cb1209-9" data-line-number="9">  </a>
<a class="sourceLine" id="cb1209-10" data-line-number="10">}</a></code></pre></div>
<p>Here’s how it works.</p>
<div class="sourceCode" id="cb1210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1210-1" data-line-number="1"><span class="kw">hdi_of_qbeta</span>(<span class="dv">3</span>, <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##          ll        ul
## 1 0.1466328 0.8533672</code></pre>
<p>Put it to use.</p>
<div class="sourceCode" id="cb1212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1212-1" data-line-number="1">coin<span class="fl">.5</span> &lt;-</a>
<a class="sourceLine" id="cb1212-2" data-line-number="2"><span class="st">  </span>coin<span class="fl">.5</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1212-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">hdi =</span> <span class="kw">map2</span>(n, z, <span class="op">~</span><span class="kw">hdi_of_qbeta</span>(.y <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, .x <span class="op">-</span><span class="st"> </span>.y <span class="op">+</span><span class="st"> </span><span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1212-4" data-line-number="4"><span class="st">  </span><span class="kw">unnest</span>(hdi) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1212-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">width =</span> ul <span class="op">-</span><span class="st"> </span>ll)</a>
<a class="sourceLine" id="cb1212-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1212-7" data-line-number="7"><span class="kw">head</span>(coin<span class="fl">.5</span>)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 8
##       n  flip     z     p log_bf     ll    ul width
##   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1     1     1 1.00    0    0.224  1.00  0.776
## 2     2     0     1 1      -3.93 0.0943 0.906 0.811
## 3     3     0     1 0.571  -3.93 0.0438 0.772 0.729
## 4     4     0     1 0.341  -3.65 0.0260 0.670 0.644
## 5     5     1     2 0.657  -4.33 0.105  0.761 0.656
## 6     6     0     2 0.423  -4.15 0.0805 0.685 0.604</code></pre>
<p>We’re finally ready to define the five subplots for our version of Figure 13.4.</p>
<div class="sourceCode" id="cb1214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1214-1" data-line-number="1">p1 &lt;-</a>
<a class="sourceLine" id="cb1214-2" data-line-number="2"><span class="st">  </span>coin<span class="fl">.5</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1214-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> z <span class="op">/</span><span class="st"> </span>n)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">.5</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">7</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-8" data-line-number="8"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1214-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1214-10" data-line-number="10">p2 &lt;-</a>
<a class="sourceLine" id="cb1214-11" data-line-number="11"><span class="st">  </span>coin<span class="fl">.5</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1214-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> p)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">.05</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">7</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(p)<span class="op">*</span><span class="st">&quot;-value&quot;</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1214-18" data-line-number="18">  </a>
<a class="sourceLine" id="cb1214-19" data-line-number="19">p3 &lt;-</a>
<a class="sourceLine" id="cb1214-20" data-line-number="20"><span class="st">  </span>coin<span class="fl">.5</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1214-21" data-line-number="21"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> log_bf)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-22" data-line-number="22"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">-1.1</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-23" data-line-number="23"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-24" data-line-number="24"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> log_bf <span class="op">&lt;</span><span class="st"> </span><span class="fl">-1.1</span> <span class="op">|</span><span class="st"> </span>log_bf <span class="op">&gt;</span><span class="st"> </span><span class="fl">1.1</span>),</a>
<a class="sourceLine" id="cb1214-25" data-line-number="25">             <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">show.legend =</span> F) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-26" data-line-number="26"><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">60</span>, <span class="dt">y =</span> <span class="fl">-1.5</span>, </a>
<a class="sourceLine" id="cb1214-27" data-line-number="27">           <span class="dt">label =</span> <span class="st">&quot;accept the null&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-28" data-line-number="28"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">end =</span> <span class="fl">.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-29" data-line-number="29"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">7</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-30" data-line-number="30"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;log(BF)&quot;</span>)</a>
<a class="sourceLine" id="cb1214-31" data-line-number="31"></a>
<a class="sourceLine" id="cb1214-32" data-line-number="32">p4 &lt;-</a>
<a class="sourceLine" id="cb1214-33" data-line-number="33"><span class="st">  </span>coin<span class="fl">.5</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1214-34" data-line-number="34"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-35" data-line-number="35"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">c</span>(.<span class="dv">45</span>, <span class="fl">.55</span>), <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-36" data-line-number="36"><span class="st">  </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> ll, <span class="dt">ymax =</span> ul,</a>
<a class="sourceLine" id="cb1214-37" data-line-number="37">                     <span class="dt">color =</span> ll <span class="op">&gt;</span><span class="st"> </span><span class="fl">.45</span> <span class="op">&amp;</span><span class="st"> </span>ul <span class="op">&lt;</span><span class="st"> </span><span class="fl">.55</span>),</a>
<a class="sourceLine" id="cb1214-38" data-line-number="38">                 <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">show.legend =</span> F) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-39" data-line-number="39"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">end =</span> <span class="fl">.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-40" data-line-number="40"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">7</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-41" data-line-number="41"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;95% HDI&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-42" data-line-number="42"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1214-43" data-line-number="43"></a>
<a class="sourceLine" id="cb1214-44" data-line-number="44">p5 &lt;-</a>
<a class="sourceLine" id="cb1214-45" data-line-number="45"><span class="st">  </span>coin<span class="fl">.5</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1214-46" data-line-number="46"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> width)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-47" data-line-number="47"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">.08</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-48" data-line-number="48"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-49" data-line-number="49"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> width <span class="op">&lt;</span><span class="st"> </span><span class="fl">.08</span>),</a>
<a class="sourceLine" id="cb1214-50" data-line-number="50">             <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">show.legend =</span> F) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-51" data-line-number="51"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">end =</span> <span class="fl">.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-52" data-line-number="52"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">7</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-53" data-line-number="53"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;HDI width&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1214-54" data-line-number="54"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</a></code></pre></div>
<p>With syntax from the <strong>patchwork</strong> package, we’ll arrange them one atop another.</p>
<div class="sourceCode" id="cb1215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1215-1" data-line-number="1"><span class="kw">library</span>(patchwork)</a>
<a class="sourceLine" id="cb1215-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1215-3" data-line-number="3">(p1 <span class="op">/</span><span class="st"> </span>p2 <span class="op">/</span><span class="st"> </span>p3 <span class="op">/</span><span class="st"> </span>p4 <span class="op">/</span><span class="st"> </span>p5) <span class="op">&amp;</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="13_files/figure-gfm/unnamed-chunk-78-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Now let’s compute data of the same form, but based on <span class="math inline">\(\theta = .65\)</span>. This time we’ll do all the data wrangling steps in one code block.</p>
<div class="sourceCode" id="cb1216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1216-1" data-line-number="1">n_trial &lt;-<span class="st"> </span><span class="dv">700</span></a>
<a class="sourceLine" id="cb1216-2" data-line-number="2">bias    &lt;-<span class="st"> </span><span class="fl">.65</span></a>
<a class="sourceLine" id="cb1216-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1216-4" data-line-number="4"><span class="kw">set.seed</span>(<span class="dv">13</span>)</a>
<a class="sourceLine" id="cb1216-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1216-6" data-line-number="6">coin<span class="fl">.65</span> &lt;-</a>
<a class="sourceLine" id="cb1216-7" data-line-number="7"><span class="st">  </span><span class="co"># n, flip, and z</span></a>
<a class="sourceLine" id="cb1216-8" data-line-number="8"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">n    =</span> <span class="dv">1</span><span class="op">:</span>n_trial,</a>
<a class="sourceLine" id="cb1216-9" data-line-number="9">         <span class="dt">flip =</span> <span class="kw">rbinom</span>(<span class="dt">n =</span> n_trial, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> bias)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1216-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z =</span> <span class="kw">cumsum</span>(flip)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1216-11" data-line-number="11"><span class="st">  </span><span class="co"># p-values</span></a>
<a class="sourceLine" id="cb1216-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p =</span> <span class="kw">map2_dbl</span>(n, z, fit_glm)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1216-13" data-line-number="13"><span class="st">  </span><span class="co"># log(BF)</span></a>
<a class="sourceLine" id="cb1216-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log_bf =</span> <span class="kw">map2_dbl</span>(n, z, log_bf, <span class="dt">theta =</span> <span class="fl">.5</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1216-15" data-line-number="15"><span class="st">  </span><span class="co"># HDIs</span></a>
<a class="sourceLine" id="cb1216-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">hdi =</span> <span class="kw">map2</span>(n, z, <span class="op">~</span><span class="kw">hdi_of_qbeta</span>(.y <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, .x <span class="op">-</span><span class="st"> </span>.y <span class="op">+</span><span class="st"> </span><span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1216-17" data-line-number="17"><span class="st">  </span><span class="kw">unnest</span>(hdi) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1216-18" data-line-number="18"><span class="st">  </span><span class="co"># HDI width</span></a>
<a class="sourceLine" id="cb1216-19" data-line-number="19"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">width =</span> ul <span class="op">-</span><span class="st"> </span>ll)</a>
<a class="sourceLine" id="cb1216-20" data-line-number="20"></a>
<a class="sourceLine" id="cb1216-21" data-line-number="21"><span class="kw">head</span>(coin<span class="fl">.65</span>)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 8
##       n  flip     z     p    log_bf            ll    ul width
##   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1     0     0 1.00   2.22e-16 0.00000000317 0.776 0.776
## 2     2     1     1 1     -3.93e+ 0 0.0943        0.906 0.811
## 3     3     1     2 0.571 -3.93e+ 0 0.228         0.956 0.729
## 4     4     1     3 0.341 -3.65e+ 0 0.330         0.974 0.644
## 5     5     0     3 0.657 -4.33e+ 0 0.239         0.895 0.656
## 6     6     1     4 0.423 -4.15e+ 0 0.315         0.919 0.604</code></pre>
<p>Here is the code for our version of Figure 13.5.</p>
<div class="sourceCode" id="cb1218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1218-1" data-line-number="1">p1 &lt;-</a>
<a class="sourceLine" id="cb1218-2" data-line-number="2"><span class="st">  </span>coin<span class="fl">.65</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1218-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> z <span class="op">/</span><span class="st"> </span>n)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">.65</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1218-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1218-9" data-line-number="9">p2 &lt;-</a>
<a class="sourceLine" id="cb1218-10" data-line-number="10"><span class="st">  </span>coin<span class="fl">.65</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1218-11" data-line-number="11"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> p)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">.05</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> p <span class="op">&lt;</span><span class="st"> </span><span class="fl">.05</span>),</a>
<a class="sourceLine" id="cb1218-15" data-line-number="15">             <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">show.legend =</span> F) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">end =</span> <span class="fl">.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(p)<span class="op">*</span><span class="st">&quot;-value&quot;</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) </a>
<a class="sourceLine" id="cb1218-18" data-line-number="18"></a>
<a class="sourceLine" id="cb1218-19" data-line-number="19">p3 &lt;-</a>
<a class="sourceLine" id="cb1218-20" data-line-number="20"><span class="st">  </span>coin<span class="fl">.65</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1218-21" data-line-number="21"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> log_bf)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-22" data-line-number="22"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>), <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-23" data-line-number="23"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-24" data-line-number="24"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> log_bf <span class="op">&lt;</span><span class="st"> </span><span class="fl">-1.1</span> <span class="op">|</span><span class="st"> </span>log_bf <span class="op">&gt;</span><span class="st"> </span><span class="fl">1.1</span>),</a>
<a class="sourceLine" id="cb1218-25" data-line-number="25">             <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">show.legend =</span> F) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-26" data-line-number="26"><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">60</span>, <span class="dt">y =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>, <span class="dv">28</span>), </a>
<a class="sourceLine" id="cb1218-27" data-line-number="27">           <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;accept the null&quot;</span>, <span class="st">&quot;reject the null&quot;</span>), <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-28" data-line-number="28"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">end =</span> <span class="fl">.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-29" data-line-number="29"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;log(BF)&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">30</span>))</a>
<a class="sourceLine" id="cb1218-30" data-line-number="30"></a>
<a class="sourceLine" id="cb1218-31" data-line-number="31">p4 &lt;-</a>
<a class="sourceLine" id="cb1218-32" data-line-number="32"><span class="st">  </span>coin<span class="fl">.65</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1218-33" data-line-number="33"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-34" data-line-number="34"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">c</span>(.<span class="dv">45</span>, <span class="fl">.55</span>), <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-35" data-line-number="35"><span class="st">  </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> ll, <span class="dt">ymax =</span> ul,</a>
<a class="sourceLine" id="cb1218-36" data-line-number="36">                     <span class="dt">color =</span> ll <span class="op">&gt;</span><span class="st"> </span><span class="fl">.55</span> <span class="op">|</span><span class="st"> </span>ul <span class="op">&lt;</span><span class="st"> </span><span class="fl">.45</span>),</a>
<a class="sourceLine" id="cb1218-37" data-line-number="37">                 <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">show.legend =</span> F) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-38" data-line-number="38"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">end =</span> <span class="fl">.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-39" data-line-number="39"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;95% HDI&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1218-40" data-line-number="40"></a>
<a class="sourceLine" id="cb1218-41" data-line-number="41">p5 &lt;-</a>
<a class="sourceLine" id="cb1218-42" data-line-number="42"><span class="st">  </span>coin<span class="fl">.65</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1218-43" data-line-number="43"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> width)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-44" data-line-number="44"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">.08</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-45" data-line-number="45"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-46" data-line-number="46"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> width <span class="op">&lt;</span><span class="st"> </span><span class="fl">.08</span>),</a>
<a class="sourceLine" id="cb1218-47" data-line-number="47">             <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">show.legend =</span> F) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-48" data-line-number="48"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">end =</span> <span class="fl">.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1218-49" data-line-number="49"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;HDI width&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1218-50" data-line-number="50"></a>
<a class="sourceLine" id="cb1218-51" data-line-number="51">(p1 <span class="op">/</span><span class="st"> </span>p2 <span class="op">/</span><span class="st"> </span>p3 <span class="op">/</span><span class="st"> </span>p4 <span class="op">/</span><span class="st"> </span>p5) <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1218-52" data-line-number="52"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">7</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb1218-53" data-line-number="53"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="13_files/figure-gfm/unnamed-chunk-80-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="average-behavior-of-sequential-tests." class="section level3">
<h3><span class="header-section-number">13.3.2</span> Average behavior of sequential tests.</h3>
<p><strong>This section is still in the works</strong>. In short, I’m not quite sure how to pull off the simulations. If you’ve got the chops, please share your code in my <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/issues/20">GitHub issue #20</a>.</p>
</div>
</div>
<div id="discussion" class="section level2">
<h2><span class="header-section-number">13.4</span> Discussion</h2>
<div id="power-and-multiple-comparisons." class="section level3">
<h3><span class="header-section-number">13.4.1</span> Power and multiple comparisons.</h3>
<blockquote>
<p>In NHST, the overall p value for any particular test is increased when the test is considered in the space of all other intended tests…</p>
<p>Bayesian power analysis is not affected by intending multiple tests. In Bayesian analysis, the decision is based on the posterior distribution, which is determined by the data in hand, whether actual or simulated, and not by what other tests are intended. In Bayesian analysis, the probability of achieving a goal, that is the power, is determined only by the data-generating process (which includes the stopping rule) and not by the cloud of counterfactual samples (which includes other tests). (p. 393)</p>
</blockquote>
<p>For more thoughts on the multiple comparisons issue, check out <a href="https://statmodeling.stat.columbia.edu/2017/06/25/analyze-comparisons-thats-better-looking-max-difference-trying-multiple-comparisons-correction/">this post</a> from Gelman’s blog.</p>
</div>
<div id="power-prospective-retrospective-and-replication." class="section level3">
<h3><span class="header-section-number">13.4.2</span> Power: prospective, retrospective, and replication.</h3>
<blockquote>
<p>There are different types of power analysis, depending on the source of the hypothetical distribution over parameter values and the prior used for analyzing the simulated data. The most typical and useful type is <em>prospective</em> power analysis. In prospective power analysis, research is being planned for which there has not yet been any data collected. The hypothetical distribution over parameter values comes from either theory or idealized data or actual data from related research. (p. 393, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Prospective is probably the type that comes to mind with you think of “power analyses.”</p>
<blockquote>
<p>On the other hand, <em>retrospective</em> power analysis refers to a situation in which we have already collected data from a research project, and we want to determine the power of the research we conducted. In this case, we can use the posterior distribution, derived from the actual data, as the representative parameter values for generating new simulated data. (This is tantamount to a posterior predictive check.) In other words, at a step in the posterior MCMC chain, the parameter values are used to generate simulated data. The simulated data are then analyzed with the same Bayesian model as the actual data, and the posterior from the simulated data is examined for whether or not the goals are achieved. (p. 393, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Though researchers sometimes use retrospective power analyses and are sometimes asked to perform them during the peer-review process, they are generally looked down upon within methodological circles. A recent controversy arose on the issue within the surgical literature. To dip your toes into the topic, check out this post by <a href="https://retractionwatch.com/2019/06/19/statisticians-clamor-for-retraction-of-paper-by-harvard-researchers-they-say-uses-a-nonsense-statistic/">Reaction Watch</a> or <a href="https://lesslikely.com/statistics/observed-power-magic/">this post</a> by <a href="https://twitter.com/dailyzad">Zad Chow</a> or these two (<a href="https://statmodeling.stat.columbia.edu/2018/09/24/dont-calculate-post-hoc-power-using-observed-estimate-effect-size/">here</a>, <a href="https://statmodeling.stat.columbia.edu/2019/01/13/post-hoc-power-calculation-like-shit-sandwich/">here</a>) posts from Gelman’s blog.</p>
<blockquote>
<p>Finally, suppose that we have already collected some data, and we want to know the probability that we would achieve our goal if we exactly replicated the experiment. In other words, if we were simply to collect a new batch of data, what is the probability that we would achieve our goal in the replicated study, also taking into account the results of the first set of data? This is the <em>replication</em> power. As with retrospective power analysis, we use the actual posterior derived from the first sample of data as the data generator. But for analysis of the simulated data, we again use the actual posterior from first sample of data, because that is the best-informed prior for the follow-up experiment. An easy way to execute this analysis by MCMC is as follows: Use the actual set of data with a skeptical- audience prior to generate representative parameter values and representative simulated data. Then, <em>concatenate the original data with the novel simulated data</em> and update the original skeptical-audience prior with the enlarged data set. This technique is tantamount to using the posterior of the original data set as the prior for the novel simulated data. (p. 394, <em>emphasis</em> in the original)</p>
</blockquote>
</div>
<div id="power-analysis-requires-verisimilitude-of-simulated-data." class="section level3">
<h3><span class="header-section-number">13.4.3</span> Power analysis requires verisimilitude of simulated data.</h3>
<blockquote>
<p>Power analysis is only useful when the simulated data imitate actual data. We generate simulated data from a descriptive model that has uncertainty in its parameter values, but we assume that the model is a reasonably good description of the actual data. If the model is instead a poor description of the actual data, then the simulated data do not imitate actual data, and inferences from the simulated data are not very meaningful. It is advisable, therefore, to check that the simulated data accurately reflect the actual data. (p. 394)</p>
</blockquote>
</div>
<div id="the-importance-of-planning." class="section level3">
<h3><span class="header-section-number">13.4.4</span> The importance of planning.</h3>
<blockquote>
<p>Conducting a power analysis in advance of collecting data is very important and valuable. Often in real research, a fascinating theory and clever experimental manipulation imply a subtle effect. It can come as a shock to the researcher when power analysis reveals that detecting the subtle effect would take many hundreds of subjects! But the shock of power analysis is far less than the pain of actually running dozens of subjects and finding highly uncertain estimates of the sought-after effect. (p. 395)</p>
</blockquote>
<p>For more handy uses of power analyses, keep reading in the text. For more practice with simulation approaches to Bayesian power analyses with <strong>brms</strong>, check out my blog series on the topic. You might start with the first post, <a href="https://solomonkurz.netlify.com/post/bayesian-power-analysis-part-i/"><em>Bayesian power analysis: Part I. Prepare to reject</em> <span class="math inline">\(H_0\)</span> <em>with simulation</em></a>.</p>
</div>
</div>
<div id="session-info-12" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb1219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1219-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.3 (2020-02-29)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Catalina 10.15.3
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] patchwork_1.0.0      tidybayes_2.0.3.9000 brms_2.12.0         
##  [4] Rcpp_1.0.4.6         forcats_0.5.0        stringr_1.4.0       
##  [7] dplyr_0.8.5          purrr_0.3.4          readr_1.3.1         
## [10] tidyr_1.0.2          tibble_3.0.1         ggplot2_3.3.0       
## [13] tidyverse_1.3.0     
## 
## loaded via a namespace (and not attached):
##   [1] colorspace_1.4-1     ellipsis_0.3.0       ggridges_0.5.2      
##   [4] rsconnect_0.8.16     markdown_1.1         base64enc_0.1-3     
##   [7] fs_1.4.1             rstudioapi_0.11      farver_2.0.3        
##  [10] rstan_2.19.3         svUnit_1.0.3         DT_0.13             
##  [13] fansi_0.4.1          mvtnorm_1.1-0        lubridate_1.7.8     
##  [16] xml2_1.3.1           bridgesampling_1.0-0 knitr_1.28          
##  [19] shinythemes_1.1.2    bayesplot_1.7.1      jsonlite_1.6.1      
##  [22] broom_0.5.5          dbplyr_1.4.2         shiny_1.4.0.2       
##  [25] compiler_3.6.3       httr_1.4.1           backports_1.1.6     
##  [28] assertthat_0.2.1     Matrix_1.2-18        fastmap_1.0.1       
##  [31] cli_2.0.2            later_1.0.0          htmltools_0.4.0     
##  [34] prettyunits_1.1.1    tools_3.6.3          igraph_1.2.5        
##  [37] coda_0.19-3          gtable_0.3.0         glue_1.4.0          
##  [40] reshape2_1.4.4       cellranger_1.1.0     vctrs_0.3.0         
##  [43] nlme_3.1-144         crosstalk_1.1.0.1    xfun_0.13           
##  [46] ps_1.3.3             rvest_0.3.5          mime_0.9            
##  [49] miniUI_0.1.1.1       lifecycle_0.2.0      gtools_3.8.2        
##  [52] zoo_1.8-7            scales_1.1.1         colourpicker_1.0    
##  [55] hms_0.5.3            promises_1.1.0       Brobdingnag_1.2-6   
##  [58] parallel_3.6.3       inline_0.3.15        shinystan_2.5.0     
##  [61] yaml_2.2.1           gridExtra_2.3        StanHeaders_2.21.0-1
##  [64] loo_2.2.0            stringi_1.4.6        highr_0.8           
##  [67] dygraphs_1.1.1.6     pkgbuild_1.0.8       rlang_0.4.6         
##  [70] pkgconfig_2.0.3      matrixStats_0.56.0   HDInterval_0.2.0    
##  [73] evaluate_0.14        lattice_0.20-38      rstantools_2.0.0    
##  [76] htmlwidgets_1.5.1    labeling_0.3         tidyselect_1.0.0    
##  [79] processx_3.4.2       plyr_1.8.6           magrittr_1.5        
##  [82] bookdown_0.18        R6_2.4.1             generics_0.0.2      
##  [85] DBI_1.1.0            pillar_1.4.4         haven_2.2.0         
##  [88] withr_2.2.0          xts_0.12-0           abind_1.4-5         
##  [91] modelr_0.1.6         crayon_1.3.4         arrayhelpers_1.1-0  
##  [94] utf8_1.1.4           rmarkdown_2.1        grid_3.6.3          
##  [97] readxl_1.3.1         callr_3.4.3          threejs_0.3.3       
## [100] reprex_0.3.0         digest_0.6.25        xtable_1.8-4        
## [103] httpuv_1.5.2         stats4_3.6.3         munsell_0.5.0       
## [106] viridisLite_0.3.0    shinyjs_1.1</code></pre>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-kruschkeDoingBayesianData2015">
<p>Kruschke, J. K. (2015). <em>Doing Bayesian data analysis: A tutorial with R, JAGS, and Stan</em>. Academic Press. <a href="https://sites.google.com/site/doingbayesiandataanalysis/">https://sites.google.com/site/doingbayesiandataanalysis/</a></p>
</div>
<div id="ref-millerWhatProbabilityReplicating2009">
<p>Miller, J. (2009). What is the probability of replicating a statistically significant effect? <em>Psychonomic Bulletin &amp; Review</em>, <em>16</em>(4), 617–640. <a href="https://doi.org/10.3758/PBR.16.4.617">https://doi.org/10.3758/PBR.16.4.617</a></p>
</div>
<div id="ref-nakagawaCaseRetrospectiveStatistical2004">
<p>Nakagawa, S., &amp; Foster, T. M. (2004). The case against retrospective statistical power analyses with an introduction to power analysis. <em>Acta Ethologica</em>, <em>7</em>(2), 103–108. <a href="https://doi.org/10.1007/s10211-004-0095-z">https://doi.org/10.1007/s10211-004-0095-z</a></p>
</div>
<div id="ref-okeefeBriefReportPost2007">
<p>O’Keefe, D. J. (2007). Brief report: Post hoc power, observed power, a priori power, retrospective power, prospective power, achieved power: Sorting out appropriate uses of statistical power analyses. <em>Communication Methods and Measures</em>, <em>1</em>(4), 291–299. <a href="https://doi.org/10.1080/19312450701641375">https://doi.org/10.1080/19312450701641375</a></p>
</div>
<div id="ref-steidlStatisticalPowerAnalysis1997">
<p>Steidl, R. J., Hayes, J. P., &amp; Schauber, E. (1997). Statistical power analysis in wildlife research. <em>The Journal of Wildlife Management</em>, <em>61</em>(2), 270. <a href="https://doi.org/10.2307/3802582">https://doi.org/10.2307/3802582</a></p>
</div>
<div id="ref-sunRethinkingObservedPower2011">
<p>Sun, S., Pan, W., &amp; Wang, L. L. (2011). Rethinking observed power: Concept, practice, and implications. <em>Methodology</em>, <em>7</em>(3), 81–87. <a href="https://doi.org/10.1027/1614-2241/a000025">https://doi.org/10.1027/1614-2241/a000025</a></p>
</div>
<div id="ref-thomasRetrospectivePowerAnalysis1997">
<p>Thomas, L. (1997). Retrospective power analysis. <em>Conservation Biology</em>, <em>11</em>(1), 276–280. <a href="https://doi.org/10.1046/j.1523-1739.1997.96102.x">https://doi.org/10.1046/j.1523-1739.1997.96102.x</a></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stan.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
