<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>20 Metric Predicted Variable with Multiple Nominal Predictors | Doing Bayesian Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="20 Metric Predicted Variable with Multiple Nominal Predictors | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="20 Metric Predicted Variable with Multiple Nominal Predictors | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2022-05-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="metric-predicted-variable-with-one-nominal-predictor.html"/>
<link rel="next" href="dichotomous-predicted-variable.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-setup"><i class="fa fa-check"></i><strong>R</strong> setup</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#we-have-updates"><i class="fa fa-check"></i>We have updates</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.1.0."><i class="fa fa-check"></i>Version 0.1.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.2.0."><i class="fa fa-check"></i>Version 0.2.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.3.0."><i class="fa fa-check"></i>Version 0.3.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.4.0."><i class="fa fa-check"></i>Version 0.4.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-1.0.0."><i class="fa fa-check"></i>Version 1.0.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#some-minor-issues-remain."><i class="fa fa-check"></i>Some minor issues remain.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thank-yous-are-in-order"><i class="fa fa-check"></i>Thank-you’s are in order</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-citation"><i class="fa fa-check"></i>License and citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html"><i class="fa fa-check"></i><b>1</b> What’s in This Book (Read This First!)</a>
<ul>
<li class="chapter" data-level="1.1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#real-people-can-read-this-book"><i class="fa fa-check"></i><b>1.1</b> Real people can read this book</a></li>
<li class="chapter" data-level="1.2" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-in-this-book"><i class="fa fa-check"></i><b>1.2</b> What’s in this book</a></li>
<li class="chapter" data-level="1.3" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-new-in-the-second-edition"><i class="fa fa-check"></i><b>1.3</b> What’s new in the second edition</a></li>
<li class="chapter" data-level="1.4" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#gimme-feedback-be-polite"><i class="fa fa-check"></i><b>1.4</b> Gimme feedback (be polite)</a></li>
<li class="chapter" data-level="1.5" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#thank-you"><i class="fa fa-check"></i><b>1.5</b> Thank you!</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Introduction: Credibility, Models, and Parameters</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#bayesian-inference-is-reallocation-of-credibility-across-possibilities"><i class="fa fa-check"></i><b>2.1</b> Bayesian inference is reallocation of credibility across possibilities</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#data-are-noisy-and-inferences-are-probabilistic."><i class="fa fa-check"></i><b>2.1.1</b> Data are noisy and inferences are probabilistic.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#possibilities-are-parameter-values-in-descriptive-models"><i class="fa fa-check"></i><b>2.2</b> Possibilities are parameter values in descriptive models</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.3</b> The steps of Bayesian data analysis</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html"><i class="fa fa-check"></i><b>3</b> The R Programming Language</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-software"><i class="fa fa-check"></i><b>3.1</b> Get the software</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-look-at-rstudio."><i class="fa fa-check"></i><b>3.1.1</b> A look at RStudio.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-simple-example-of-r-in-action"><i class="fa fa-check"></i><b>3.2</b> A simple example of R in action</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-programs-used-with-this-book."><i class="fa fa-check"></i><b>3.2.1</b> Get the programs used with this book.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#basic-commands-and-operators-in-r"><i class="fa fa-check"></i><b>3.3</b> Basic commands and operators in R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#getting-help-in-r."><i class="fa fa-check"></i><b>3.3.1</b> Getting help in R.</a></li>
<li class="chapter" data-level="3.3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#arithmetic-and-logical-operators."><i class="fa fa-check"></i><b>3.3.2</b> Arithmetic and logical operators.</a></li>
<li class="chapter" data-level="3.3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#assignment-relational-operators-and-tests-of-equality."><i class="fa fa-check"></i><b>3.3.3</b> Assignment, relational operators, and tests of equality.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-types"><i class="fa fa-check"></i><b>3.4</b> Variable types</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#vector."><i class="fa fa-check"></i><b>3.4.1</b> Vector.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#factor."><i class="fa fa-check"></i><b>3.4.2</b> Factor.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#matrix-and-array."><i class="fa fa-check"></i><b>3.4.3</b> Matrix and array.</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#list-and-data-frame."><i class="fa fa-check"></i><b>3.4.4</b> List and data frame.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#loading-and-saving-data"><i class="fa fa-check"></i><b>3.5</b> Loading and saving data</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#the-read.csv-read_csv-and-read.table-read_table-functions."><i class="fa fa-check"></i><b>3.5.1</b> The <del>read.csv</del> <code>read_csv()</code> and <del>read.table</del> <code>read_table()</code> functions.</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#saving-data-from-r."><i class="fa fa-check"></i><b>3.5.2</b> Saving data from R.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#some-utility-functions"><i class="fa fa-check"></i><b>3.6</b> Some utility functions</a></li>
<li class="chapter" data-level="3.7" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-in-r"><i class="fa fa-check"></i><b>3.7</b> Programming in R</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-names-in-r."><i class="fa fa-check"></i><b>3.7.1</b> Variable names in R.</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#running-a-program."><i class="fa fa-check"></i><b>3.7.2</b> Running a program.</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-a-function."><i class="fa fa-check"></i><b>3.7.3</b> Programming a function.</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conditions-and-loops."><i class="fa fa-check"></i><b>3.7.4</b> Conditions and loops.</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#measuring-processing-time."><i class="fa fa-check"></i><b>3.7.5</b> Measuring processing time.</a></li>
<li class="chapter" data-level="3.7.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#debugging."><i class="fa fa-check"></i><b>3.7.6</b> Debugging.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#graphical-plots-opening-and-saving"><i class="fa fa-check"></i><b>3.8</b> Graphical plots: Opening and saving</a></li>
<li class="chapter" data-level="3.9" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conclusion-brms-related-needs"><i class="fa fa-check"></i><b>3.9</b> <del>Conclusion</del> <strong>brms</strong>-related needs</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html"><i class="fa fa-check"></i><b>4</b> What is This Stuff Called Probability?</a>
<ul>
<li class="chapter" data-level="4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#the-set-of-all-possible-events"><i class="fa fa-check"></i><b>4.1</b> The set of all possible events</a></li>
<li class="chapter" data-level="4.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-outside-or-inside-the-head"><i class="fa fa-check"></i><b>4.2</b> Probability: Outside or inside the head</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#outside-the-head-long-run-relative-frequency."><i class="fa fa-check"></i><b>4.2.1</b> Outside the head: Long-run relative frequency.</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#inside-the-head-subjective-belief."><i class="fa fa-check"></i><b>4.2.2</b> Inside the head: Subjective belief.</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probabilities-assign-numbers-to-possibilities."><i class="fa fa-check"></i><b>4.2.3</b> Probabilities assign numbers to possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Probability distributions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#discrete-distributions-probability-mass."><i class="fa fa-check"></i><b>4.3.1</b> Discrete distributions: Probability mass.</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#continuous-distributions-rendezvous-with-density."><i class="fa fa-check"></i><b>4.3.2</b> Continuous distributions: Rendezvous with density.</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#mean-and-variance-of-a-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Mean and variance of a distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#highest-density-interval-hdi."><i class="fa fa-check"></i><b>4.3.4</b> Highest density interval (HDI).</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#two-way-distributions"><i class="fa fa-check"></i><b>4.4</b> Two-way distributions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#conditional-probability."><i class="fa fa-check"></i><b>4.4.1</b> Conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule</a>
<ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-rule-1"><i class="fa fa-check"></i><b>5.1</b> Bayes’ rule</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#derived-from-definitions-of-conditional-probability."><i class="fa fa-check"></i><b>5.1.1</b> Derived from definitions of conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule.html"><a href="bayes-rule.html#applied-to-parameters-and-data"><i class="fa fa-check"></i><b>5.2</b> Applied to parameters and data</a></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule.html"><a href="bayes-rule.html#complete-examples-estimating-bias-in-a-coin"><i class="fa fa-check"></i><b>5.3</b> Complete examples: Estimating bias in a coin</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-sample-size-on-the-posterior."><i class="fa fa-check"></i><b>5.3.1</b> Influence of sample size on the posterior.</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-prior-on-the-posterior."><i class="fa fa-check"></i><b>5.3.2</b> Influence of prior on the posterior.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule.html"><a href="bayes-rule.html#why-bayesian-inference-can-be-difficult"><i class="fa fa-check"></i><b>5.4</b> Why Bayesian inference can be difficult</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-likelihood-function-the-bernoulli-distribution"><i class="fa fa-check"></i><b>6.1</b> The likelihood function: The Bernoulli distribution</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-description-of-credibilities-the-beta-distribution"><i class="fa fa-check"></i><b>6.2</b> A description of credibilities: The beta distribution</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#specifying-a-beta-prior."><i class="fa fa-check"></i><b>6.2.1</b> Specifying a beta prior.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-posterior-beta"><i class="fa fa-check"></i><b>6.3</b> The posterior beta</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#posterior-is-compromise-of-prior-and-likelihood."><i class="fa fa-check"></i><b>6.3.1</b> Posterior is compromise of prior and likelihood.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.1</b> Prior knowledge expressed as a beta distribution.</a></li>
<li class="chapter" data-level="6.4.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.2</b> Prior knowledge that cannot be expressed as a beta distribution.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#approximating-a-distribution-with-a-large-sample"><i class="fa fa-check"></i><b>7.1</b> Approximating a distribution with a large sample</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-simple-case-of-the-metropolis-algorithm"><i class="fa fa-check"></i><b>7.2</b> A simple case of the Metropolis algorithm</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-politician-stumbles-upon-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.2.1</b> A politician stumbles upon the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-random-walk."><i class="fa fa-check"></i><b>7.2.2</b> A random walk.</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#general-properties-of-a-random-walk."><i class="fa fa-check"></i><b>7.2.3</b> General properties of a random walk.</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#why-we-care."><i class="fa fa-check"></i><b>7.2.4</b> Why we care.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-metropolis-algorithm-more-generally"><i class="fa fa-check"></i><b>7.3</b> The Metropolis algorithm more generally</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithm-applied-to-bernoulli-likelihood-and-beta-prior."><i class="fa fa-check"></i><b>7.3.1</b> Metropolis algorithm applied to Bernoulli likelihood and beta prior.</a></li>
<li class="chapter" data-level="7.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-of-metropolis-algorithm."><i class="fa fa-check"></i><b>7.3.2</b> Summary of Metropolis algorithm.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#toward-gibbs-sampling-estimating-two-coin-biases"><i class="fa fa-check"></i><b>7.4</b> Toward Gibbs sampling: Estimating two coin biases</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#prior-likelihood-and-posterior-for-two-biases."><i class="fa fa-check"></i><b>7.4.1</b> Prior, likelihood and posterior for two biases.</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-exact-formal-analysis."><i class="fa fa-check"></i><b>7.4.2</b> The posterior via exact formal analysis.</a></li>
<li class="chapter" data-level="7.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.4.3</b> The posterior via the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-hamiltonian-monte-carlo-sampling."><i class="fa fa-check"></i><b>7.4.4</b> <del>Gibbs</del> Hamiltonian Monte Carlo sampling.</a></li>
<li class="chapter" data-level="7.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#is-there-a-difference-between-biases"><i class="fa fa-check"></i><b>7.4.5</b> Is there a difference between biases?</a></li>
<li class="chapter" data-level="7.4.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#terminology-mcmc."><i class="fa fa-check"></i><b>7.4.6</b> Terminology: MCMC.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness-accuracy-and-efficiency"><i class="fa fa-check"></i><b>7.5</b> MCMC representativeness, accuracy, and efficiency</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness."><i class="fa fa-check"></i><b>7.5.1</b> MCMC representativeness.</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-accuracy."><i class="fa fa-check"></i><b>7.5.2</b> MCMC accuracy.</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-efficiency."><i class="fa fa-check"></i><b>7.5.3</b> MCMC efficiency.</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-1"><i class="fa fa-check"></i><b>7.6</b> Summary</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#footnote-1"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-brms.html"><a href="jags-brms.html"><i class="fa fa-check"></i><b>8</b> <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="8.1" data-path="jags-brms.html"><a href="jags-brms.html#jags-brms-and-its-relation-to-r"><i class="fa fa-check"></i><b>8.1</b> <del>JAGS</del> brms and its relation to R</a></li>
<li class="chapter" data-level="8.2" data-path="jags-brms.html"><a href="jags-brms.html#a-complete-example"><i class="fa fa-check"></i><b>8.2</b> A complete example</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="jags-brms.html"><a href="jags-brms.html#load-data."><i class="fa fa-check"></i><b>8.2.1</b> Load data.</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-brms.html"><a href="jags-brms.html#specify-model."><i class="fa fa-check"></i><b>8.2.2</b> Specify model.</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-brms.html"><a href="jags-brms.html#initialize-chains."><i class="fa fa-check"></i><b>8.2.3</b> Initialize chains.</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-brms.html"><a href="jags-brms.html#generate-chains."><i class="fa fa-check"></i><b>8.2.4</b> Generate chains.</a></li>
<li class="chapter" data-level="8.2.5" data-path="jags-brms.html"><a href="jags-brms.html#examine-chains."><i class="fa fa-check"></i><b>8.2.5</b> Examine chains.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-brms.html"><a href="jags-brms.html#simplified-scripts-for-frequently-used-analyses"><i class="fa fa-check"></i><b>8.3</b> Simplified scripts for frequently used analyses</a></li>
<li class="chapter" data-level="8.4" data-path="jags-brms.html"><a href="jags-brms.html#example-difference-of-biases"><i class="fa fa-check"></i><b>8.4</b> Example: Difference of biases</a></li>
<li class="chapter" data-level="8.5" data-path="jags-brms.html"><a href="jags-brms.html#sampling-from-the-prior-distribution-in-jags-brms"><i class="fa fa-check"></i><b>8.5</b> Sampling from the prior distribution in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="8.6" data-path="jags-brms.html"><a href="jags-brms.html#probability-distributions-available-in-jags-brms"><i class="fa fa-check"></i><b>8.6</b> Probability distributions available in <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="jags-brms.html"><a href="jags-brms.html#defining-new-likelihood-functions."><i class="fa fa-check"></i><b>8.6.1</b> Defining new likelihood functions.</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="jags-brms.html"><a href="jags-brms.html#faster-sampling-with-parallel-processing-in-runjags-brmsbrm"><i class="fa fa-check"></i><b>8.7</b> Faster sampling with parallel processing in <del>runjags</del> <code>brms::brm()</code></a></li>
<li class="chapter" data-level="8.8" data-path="jags-brms.html"><a href="jags-brms.html#tips-for-expanding-jags-brms-models"><i class="fa fa-check"></i><b>8.8</b> Tips for expanding <del>JAGS</del> brms models</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Hierarchical Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-single-coin-from-a-single-mint"><i class="fa fa-check"></i><b>9.1</b> A single coin from a single mint</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation."><i class="fa fa-check"></i><b>9.1.1</b> Posterior via grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#multiple-coins-from-a-single-mint"><i class="fa fa-check"></i><b>9.2</b> Multiple coins from a single mint</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation.-1"><i class="fa fa-check"></i><b>9.2.1</b> Posterior via grid approximation.</a></li>
<li class="chapter" data-level="9.2.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-realistic-model-with-mcmc."><i class="fa fa-check"></i><b>9.2.2</b> A realistic model with MCMC.</a></li>
<li class="chapter" data-level="9.2.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#doing-it-with-jags-brms."><i class="fa fa-check"></i><b>9.2.3</b> Doing it with <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="9.2.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-therapeutic-touch."><i class="fa fa-check"></i><b>9.2.4</b> Example: Therapeutic touch.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#shrinkage-in-hierarchical-models"><i class="fa fa-check"></i><b>9.3</b> Shrinkage in hierarchical models</a></li>
<li class="chapter" data-level="9.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#speeding-up-jags-brms"><i class="fa fa-check"></i><b>9.4</b> Speeding up <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="9.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#extending-the-hierarchy-subjects-within-categories"><i class="fa fa-check"></i><b>9.5</b> Extending the hierarchy: Subjects within categories</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-batting-abilities-by-position."><i class="fa fa-check"></i><b>9.5.1</b> Example: Baseball batting abilities by position.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html"><i class="fa fa-check"></i><b>10</b> Model Comparison and Hierarchical Modeling</a>
<ul>
<li class="chapter" data-level="10.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#general-formula-and-the-bayes-factor"><i class="fa fa-check"></i><b>10.1</b> General formula and the Bayes factor</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#example-two-factories-of-coins"><i class="fa fa-check"></i><b>10.2</b> Example: Two factories of coins</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-formal-analysis."><i class="fa fa-check"></i><b>10.2.1</b> Solution by formal analysis.</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-grid-approximation."><i class="fa fa-check"></i><b>10.2.2</b> Solution by grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-mcmc"><i class="fa fa-check"></i><b>10.3</b> Solution by MCMC</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#nonhierarchical-mcmc-computation-of-each-models-marginal-likelihood."><i class="fa fa-check"></i><b>10.3.1</b> Nonhierarchical MCMC computation of each model’s marginal likelihood.</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#hierarchical-mcmc-computation-of-relative-model-probability-is-not-available-in-brms-well-cover-information-criteria-instead."><i class="fa fa-check"></i><b>10.3.2</b> Hierarchical MCMC computation <del>of relative model probability</del> is not available in brms: We’ll cover information criteria instead.</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#models-with-different-noise-distributions-in-jags-brms."><i class="fa fa-check"></i><b>10.3.3</b> Models with different “noise” distributions in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#prediction-model-averaging"><i class="fa fa-check"></i><b>10.4</b> Prediction: Model averaging</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#model-complexity-naturally-accounted-for"><i class="fa fa-check"></i><b>10.5</b> Model complexity naturally accounted for</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#caveats-regarding-nested-model-comparison."><i class="fa fa-check"></i><b>10.5.1</b> Caveats regarding nested model comparison.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#extreme-sensitivity-to-prior-distribution"><i class="fa fa-check"></i><b>10.6</b> Extreme sensitivity to prior distribution</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#priors-of-different-models-should-be-equally-informed."><i class="fa fa-check"></i><b>10.6.1</b> Priors of different models should be equally informed.</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#bonus-theres-danger-ahead"><i class="fa fa-check"></i><b>10.7</b> Bonus: There’s danger ahead</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#footnote-2"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>11</b> Null Hypothesis Significance Testing</a>
<ul>
<li class="chapter" data-level="11.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#paved-with-good-intentions"><i class="fa fa-check"></i><b>11.1</b> Paved with good intentions</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#definition-of-p-value."><i class="fa fa-check"></i><b>11.1.1</b> Definition of <span class="math inline">\(p\)</span> value.</a></li>
<li class="chapter" data-level="11.1.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-n."><i class="fa fa-check"></i><b>11.1.2</b> With intention to fix <span class="math inline">\(N\)</span>.</a></li>
<li class="chapter" data-level="11.1.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-z."><i class="fa fa-check"></i><b>11.1.3</b> With intention to fix <span class="math inline">\(z\)</span>.</a></li>
<li class="chapter" data-level="11.1.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-duration."><i class="fa fa-check"></i><b>11.1.4</b> With intention to fix duration.</a></li>
<li class="chapter" data-level="11.1.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-make-multiple-tests."><i class="fa fa-check"></i><b>11.1.5</b> With intention to make multiple tests.</a></li>
<li class="chapter" data-level="11.1.6" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#soul-searching."><i class="fa fa-check"></i><b>11.1.6</b> Soul searching.</a></li>
<li class="chapter" data-level="11.1.7" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis."><i class="fa fa-check"></i><b>11.1.7</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#prior-knowledge"><i class="fa fa-check"></i><b>11.2</b> Prior knowledge</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-analysis."><i class="fa fa-check"></i><b>11.2.1</b> NHST analysis.</a></li>
<li class="chapter" data-level="11.2.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis.-1"><i class="fa fa-check"></i><b>11.2.2</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#confidence-interval-and-highest-density-interval"><i class="fa fa-check"></i><b>11.3</b> Confidence interval and highest density interval</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#ci-depends-on-intention."><i class="fa fa-check"></i><b>11.3.1</b> CI depends on intention.</a></li>
<li class="chapter" data-level="11.3.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-hdi."><i class="fa fa-check"></i><b>11.3.2</b> Bayesian HDI.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#multiple-comparisons"><i class="fa fa-check"></i><b>11.4</b> Multiple comparisons</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-correction-for-experiment-wise-error."><i class="fa fa-check"></i><b>11.4.1</b> NHST correction for experiment wise error.</a></li>
<li class="chapter" data-level="11.4.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#just-one-bayesian-posterior-no-matter-how-you-look-at-it."><i class="fa fa-check"></i><b>11.4.2</b> Just one Bayesian posterior no matter how you look at it.</a></li>
<li class="chapter" data-level="11.4.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#how-bayesian-analysis-mitigates-false-alarms."><i class="fa fa-check"></i><b>11.4.3</b> How Bayesian analysis mitigates false alarms.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#what-a-sampling-distribution-is-good-for"><i class="fa fa-check"></i><b>11.5</b> What a sampling distribution is good for</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#planning-an-experiment."><i class="fa fa-check"></i><b>11.5.1</b> Planning an experiment.</a></li>
<li class="chapter" data-level="11.5.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#exploring-model-predictions-posterior-predictive-check."><i class="fa fa-check"></i><b>11.5.2</b> Exploring model predictions (posterior predictive check).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#footnote-3"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><i class="fa fa-check"></i><b>12</b> Bayesian Approaches to Testing a Point (“Null”) Hypothesis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-estimation-approach"><i class="fa fa-check"></i><b>12.1</b> The estimation approach</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#region-of-practical-equivalence."><i class="fa fa-check"></i><b>12.1.1</b> Region of practical equivalence.</a></li>
<li class="chapter" data-level="12.1.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#some-examples."><i class="fa fa-check"></i><b>12.1.2</b> Some examples.</a></li>
<li class="chapter" data-level="12.1.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#differences-of-correlated-parameters."><i class="fa fa-check"></i><b>12.1.3</b> Differences of correlated parameters.</a></li>
<li class="chapter" data-level="12.1.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#why-hdi-and-not-equal-tailed-interval"><i class="fa fa-check"></i><b>12.1.4</b> Why HDI and not equal-tailed interval?</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-model-comparison-approach"><i class="fa fa-check"></i><b>12.2</b> The model-comparison approach</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#is-a-coin-fair-or-not"><i class="fa fa-check"></i><b>12.2.1</b> Is a coin fair or not?</a></li>
<li class="chapter" data-level="12.2.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#are-different-groups-equal-or-not"><i class="fa fa-check"></i><b>12.2.2</b> Are different groups equal or not?</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#relations-of-parameter-estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.3</b> Relations of parameter estimation and model comparison</a></li>
<li class="chapter" data-level="12.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.4</b> Estimation and model comparison?</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html"><i class="fa fa-check"></i><b>13</b> Goals, Power, and Sample Size</a>
<ul>
<li class="chapter" data-level="13.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-will-to-power"><i class="fa fa-check"></i><b>13.1</b> The will to power</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#goals-and-obstacles."><i class="fa fa-check"></i><b>13.1.1</b> Goals and obstacles.</a></li>
<li class="chapter" data-level="13.1.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power."><i class="fa fa-check"></i><b>13.1.2</b> Power.</a></li>
<li class="chapter" data-level="13.1.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sample-size."><i class="fa fa-check"></i><b>13.1.3</b> Sample size.</a></li>
<li class="chapter" data-level="13.1.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#other-expressions-of-goals."><i class="fa fa-check"></i><b>13.1.4</b> Other expressions of goals.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#computing-power-and-sample-size"><i class="fa fa-check"></i><b>13.2</b> Computing power and sample size</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-to-exclude-a-null-value."><i class="fa fa-check"></i><b>13.2.1</b> When the goal is to exclude a null value.</a></li>
<li class="chapter" data-level="13.2.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#formal-solution-and-implementation-in-r."><i class="fa fa-check"></i><b>13.2.2</b> Formal solution and implementation in R.</a></li>
<li class="chapter" data-level="13.2.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-precision."><i class="fa fa-check"></i><b>13.2.3</b> When the goal is precision.</a></li>
<li class="chapter" data-level="13.2.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#monte-carlo-approximation-of-power."><i class="fa fa-check"></i><b>13.2.4</b> Monte Carlo approximation of power.</a></li>
<li class="chapter" data-level="13.2.5" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-from-idealized-or-actual-data."><i class="fa fa-check"></i><b>13.2.5</b> Power from idealized or actual data.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sequential-testing-and-the-goal-of-precision"><i class="fa fa-check"></i><b>13.3</b> Sequential testing and the goal of precision</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#examples-of-sequential-tests."><i class="fa fa-check"></i><b>13.3.1</b> Examples of sequential tests.</a></li>
<li class="chapter" data-level="13.3.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#average-behavior-of-sequential-tests."><i class="fa fa-check"></i><b>13.3.2</b> Average behavior of sequential tests.</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#discussion"><i class="fa fa-check"></i><b>13.4</b> Discussion</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-and-multiple-comparisons."><i class="fa fa-check"></i><b>13.4.1</b> Power and multiple comparisons.</a></li>
<li class="chapter" data-level="13.4.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-prospective-retrospective-and-replication."><i class="fa fa-check"></i><b>13.4.2</b> Power: prospective, retrospective, and replication.</a></li>
<li class="chapter" data-level="13.4.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-analysis-requires-verisimilitude-of-simulated-data."><i class="fa fa-check"></i><b>13.4.3</b> Power analysis requires verisimilitude of simulated data.</a></li>
<li class="chapter" data-level="13.4.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-importance-of-planning."><i class="fa fa-check"></i><b>13.4.4</b> The importance of planning.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a>
<ul>
<li class="chapter" data-level="14.1" data-path="stan.html"><a href="stan.html#hmc-sampling"><i class="fa fa-check"></i><b>14.1</b> HMC sampling</a></li>
<li class="chapter" data-level="14.2" data-path="stan.html"><a href="stan.html#installing-stan"><i class="fa fa-check"></i><b>14.2</b> Installing Stan</a></li>
<li class="chapter" data-level="14.3" data-path="stan.html"><a href="stan.html#a-complete-example-1"><i class="fa fa-check"></i><b>14.3</b> A Complete example</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="stan.html"><a href="stan.html#reusing-the-compiled-model."><i class="fa fa-check"></i><b>14.3.1</b> Reusing the compiled model.</a></li>
<li class="chapter" data-level="14.3.2" data-path="stan.html"><a href="stan.html#general-structure-of-stan-model-specification."><i class="fa fa-check"></i><b>14.3.2</b> General structure of Stan model specification.</a></li>
<li class="chapter" data-level="14.3.3" data-path="stan.html"><a href="stan.html#think-log-probability-to-think-like-stan."><i class="fa fa-check"></i><b>14.3.3</b> Think log probability to think like Stan.</a></li>
<li class="chapter" data-level="14.3.4" data-path="stan.html"><a href="stan.html#sampling-the-prior-in-stan."><i class="fa fa-check"></i><b>14.3.4</b> Sampling the prior in Stan.</a></li>
<li class="chapter" data-level="14.3.5" data-path="stan.html"><a href="stan.html#simplified-scripts-for-frequently-used-analyses."><i class="fa fa-check"></i><b>14.3.5</b> Simplified scripts for frequently used analyses.</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="stan.html"><a href="stan.html#specify-models-top-down-in-stan"><i class="fa fa-check"></i><b>14.4</b> Specify models top-down in Stan</a></li>
<li class="chapter" data-level="14.5" data-path="stan.html"><a href="stan.html#limitations-and-extras"><i class="fa fa-check"></i><b>14.5</b> Limitations and extras</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#footnote-4"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>15</b> Overview of the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="15.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#types-of-variables"><i class="fa fa-check"></i><b>15.1</b> Types of variables</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#predictor-and-predicted-variables."><i class="fa fa-check"></i><b>15.1.1</b> Predictor and predicted variables.</a></li>
<li class="chapter" data-level="15.1.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#scale-types-metric-ordinal-nominal-and-count."><i class="fa fa-check"></i><b>15.1.2</b> Scale types: metric, ordinal, nominal, and count.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-combination-of-predictors"><i class="fa fa-check"></i><b>15.2</b> Linear combination of predictors</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-function-of-a-single-metric-predictor."><i class="fa fa-check"></i><b>15.2.1</b> Linear function of a single metric predictor.</a></li>
<li class="chapter" data-level="15.2.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#additive-combination-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.2</b> Additive combination of metric predictors.</a></li>
<li class="chapter" data-level="15.2.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nonadditive-interaction-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.3</b> Nonadditive interaction of metric predictors.</a></li>
<li class="chapter" data-level="15.2.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nominal-predictors."><i class="fa fa-check"></i><b>15.2.4</b> Nominal predictors.</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linking-from-combined-predictors-to-noisy-predicted-data"><i class="fa fa-check"></i><b>15.3</b> Linking from combined predictors to noisy predicted data</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predictors-to-predicted-central-tendency."><i class="fa fa-check"></i><b>15.3.1</b> From predictors to predicted central tendency.</a></li>
<li class="chapter" data-level="15.3.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predicted-central-tendency-to-noisy-data."><i class="fa fa-check"></i><b>15.3.2</b> From predicted central tendency to noisy data.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#formal-expression-of-the-glm"><i class="fa fa-check"></i><b>15.4</b> Formal expression of the GLM</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#cases-of-the-glm."><i class="fa fa-check"></i><b>15.4.1</b> Cases of the GLM.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html"><i class="fa fa-check"></i><b>16</b> Metric-Predicted Variable on One or Two Groups</a>
<ul>
<li class="chapter" data-level="16.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#estimating-the-mean-and-standard-deviation-of-a-normal-distribution"><i class="fa fa-check"></i><b>16.1</b> Estimating the mean and standard deviation of a normal distribution</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#solution-by-mathematical-analysis-heads-up-on-precision."><i class="fa fa-check"></i><b>16.1.1</b> <del>Solution by mathematical analysis</del> Heads up on precision.</a></li>
<li class="chapter" data-level="16.1.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#approximation-by-mcmc-in-jags-hmc-in-brms."><i class="fa fa-check"></i><b>16.1.2</b> Approximation by <del>MCMC in JAGS</del> HMC in brms.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#outliers-and-robust-estimation-the-t-distribution"><i class="fa fa-check"></i><b>16.2</b> Outliers and robust estimation: The <span class="math inline">\(t\)</span> distribution</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-jags-brms."><i class="fa fa-check"></i><b>16.2.1</b> Using the <span class="math inline">\(t\)</span> distribution in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="16.2.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-stan."><i class="fa fa-check"></i><b>16.2.2</b> Using the <span class="math inline">\(t\)</span> distribution in Stan.</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#two-groups"><i class="fa fa-check"></i><b>16.3</b> Two groups</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#analysis-by-nhst."><i class="fa fa-check"></i><b>16.3.1</b> Analysis by NHST.</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#other-noise-distributions-and-transforming-data"><i class="fa fa-check"></i><b>16.4</b> Other noise distributions and transforming data</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#session-info-15"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html"><i class="fa fa-check"></i><b>17</b> Metric Predicted Variable with One Metric Predictor</a>
<ul>
<li class="chapter" data-level="17.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#simple-linear-regression"><i class="fa fa-check"></i><b>17.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="17.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Robust linear regression</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-jags-brms."><i class="fa fa-check"></i><b>17.2.1</b> Robust linear regression in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.2.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-stan."><i class="fa fa-check"></i><b>17.2.2</b> Robust linear regression in Stan.</a></li>
<li class="chapter" data-level="17.2.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#stan-or-jags"><i class="fa fa-check"></i><b>17.2.3</b> Stan or JAGS?</a></li>
<li class="chapter" data-level="17.2.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>17.2.4</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#hierarchical-regression-on-individuals-within-groups"><i class="fa fa-check"></i><b>17.3</b> Hierarchical regression on individuals within groups</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>17.3.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.3.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-posterior-distribution-shrinkage-and-prediction."><i class="fa fa-check"></i><b>17.3.2</b> The posterior distribution: Shrinkage and prediction.</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#quadratic-trend-and-weighted-data"><i class="fa fa-check"></i><b>17.4</b> Quadratic trend and weighted data</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#results-and-interpretation."><i class="fa fa-check"></i><b>17.4.1</b> Results and interpretation.</a></li>
<li class="chapter" data-level="17.4.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#further-extensions."><i class="fa fa-check"></i><b>17.4.2</b> Further extensions.</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#procedure-and-perils-for-expanding-a-model"><i class="fa fa-check"></i><b>17.5</b> Procedure and perils for expanding a model</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#session-info-16"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Metric Predicted Variable with Multiple Metric Predictors</a>
<ul>
<li class="chapter" data-level="18.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiple-linear-regression"><i class="fa fa-check"></i><b>18.1</b> Multiple linear regression</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-perils-of-correlated-predictors."><i class="fa fa-check"></i><b>18.1.1</b> The perils of correlated predictors.</a></li>
<li class="chapter" data-level="18.1.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-model-and-implementation."><i class="fa fa-check"></i><b>18.1.2</b> The model and implementation.</a></li>
<li class="chapter" data-level="18.1.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-posterior-distribution."><i class="fa fa-check"></i><b>18.1.3</b> The posterior distribution.</a></li>
<li class="chapter" data-level="18.1.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#redundant-predictors."><i class="fa fa-check"></i><b>18.1.4</b> Redundant predictors.</a></li>
<li class="chapter" data-level="18.1.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#informative-priors-sparse-data-and-correlated-predictors."><i class="fa fa-check"></i><b>18.1.5</b> Informative priors, sparse data, and correlated predictors.</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiplicative-interaction-of-metric-predictors"><i class="fa fa-check"></i><b>18.2</b> Multiplicative interaction of metric predictors</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#an-example."><i class="fa fa-check"></i><b>18.2.1</b> An example.</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#shrinkage-of-regression-coefficients"><i class="fa fa-check"></i><b>18.3</b> Shrinkage of regression coefficients</a></li>
<li class="chapter" data-level="18.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection"><i class="fa fa-check"></i><b>18.4</b> Variable selection</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#inclusion-probability-is-strongly-affected-by-vagueness-of-prior."><i class="fa fa-check"></i><b>18.4.1</b> Inclusion probability is strongly affected by vagueness of prior.</a></li>
<li class="chapter" data-level="18.4.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection-with-hierarchical-shrinkage."><i class="fa fa-check"></i><b>18.4.2</b> Variable selection with hierarchical shrinkage.</a></li>
<li class="chapter" data-level="18.4.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#what-to-report-and-what-to-conclude."><i class="fa fa-check"></i><b>18.4.3</b> What to report and what to conclude.</a></li>
<li class="chapter" data-level="18.4.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-computational-methods."><i class="fa fa-check"></i><b>18.4.4</b> Caution: Computational methods.</a></li>
<li class="chapter" data-level="18.4.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-interaction-variables."><i class="fa fa-check"></i><b>18.4.5</b> Caution: Interaction variables.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#session-info-17"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#footnote-5"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html"><i class="fa fa-check"></i><b>19</b> Metric Predicted Variable with One Nominal Predictor</a>
<ul>
<li class="chapter" data-level="19.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#describing-multiple-groups-of-metric-data"><i class="fa fa-check"></i><b>19.1</b> Describing multiple groups of metric data</a></li>
<li class="chapter" data-level="19.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#traditional-analysis-of-variance"><i class="fa fa-check"></i><b>19.2</b> Traditional analysis of variance</a></li>
<li class="chapter" data-level="19.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#hierarchical-bayesian-approach"><i class="fa fa-check"></i><b>19.3</b> Hierarchical Bayesian approach</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#implementation-in-jags-brms."><i class="fa fa-check"></i><b>19.3.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="19.3.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-and-death."><i class="fa fa-check"></i><b>19.3.2</b> Example: Sex and death.</a></li>
<li class="chapter" data-level="19.3.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#contrasts."><i class="fa fa-check"></i><b>19.3.3</b> Contrasts.</a></li>
<li class="chapter" data-level="19.3.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#multiple-comparisons-and-shrinkage."><i class="fa fa-check"></i><b>19.3.4</b> Multiple comparisons and shrinkage.</a></li>
<li class="chapter" data-level="19.3.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#the-two-group-case."><i class="fa fa-check"></i><b>19.3.5</b> The two-group case.</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#including-a-metric-predictor"><i class="fa fa-check"></i><b>19.4</b> Including a metric predictor</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-death-and-size."><i class="fa fa-check"></i><b>19.4.1</b> Example: Sex, death, and size.</a></li>
<li class="chapter" data-level="19.4.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#analogous-to-traditional-ancova."><i class="fa fa-check"></i><b>19.4.2</b> Analogous to traditional ANCOVA.</a></li>
<li class="chapter" data-level="19.4.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#relation-to-hierarchical-linear-regression."><i class="fa fa-check"></i><b>19.4.3</b> Relation to hierarchical linear regression.</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#heterogeneous-variances-and-robustness-against-outliers"><i class="fa fa-check"></i><b>19.5</b> Heterogeneous variances and robustness against outliers</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-contrast-of-means-with-different-variances."><i class="fa fa-check"></i><b>19.5.1</b> Example: Contrast of means with different variances.</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#exercises-walk-out-an-effect-size"><i class="fa fa-check"></i><b>19.6</b> <del>Exercises</del> Walk out an effect size</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#your-sample-sizes-may-differ."><i class="fa fa-check"></i><b>19.6.1</b> Your sample sizes may differ.</a></li>
<li class="chapter" data-level="19.6.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#populations-and-samples."><i class="fa fa-check"></i><b>19.6.2</b> Populations and samples.</a></li>
<li class="chapter" data-level="19.6.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#report-your-effect-sizes-effectively."><i class="fa fa-check"></i><b>19.6.3</b> Report your effect sizes effectively.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#session-info-18"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Metric Predicted Variable with Multiple Nominal Predictors</a>
<ul>
<li class="chapter" data-level="20.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#describing-groups-of-metric-data-with-multiple-nominal-predictors"><i class="fa fa-check"></i><b>20.1</b> Describing groups of metric data with multiple nominal predictors</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction."><i class="fa fa-check"></i><b>20.1.1</b> Interaction.</a></li>
<li class="chapter" data-level="20.1.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#traditional-anova."><i class="fa fa-check"></i><b>20.1.2</b> Traditional ANOVA.</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#hierarchical-bayesian-approach-1"><i class="fa fa-check"></i><b>20.2</b> Hierarchical Bayesian approach</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>20.2.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="20.2.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#example-its-only-money."><i class="fa fa-check"></i><b>20.2.2</b> Example: It’s only money.</a></li>
<li class="chapter" data-level="20.2.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#main-effect-contrasts."><i class="fa fa-check"></i><b>20.2.3</b> Main effect contrasts.</a></li>
<li class="chapter" data-level="20.2.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction-contrasts-and-simple-effects."><i class="fa fa-check"></i><b>20.2.4</b> Interaction contrasts and simple effects.</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#rescaling-can-change-interactions-homogeneity-and-normality"><i class="fa fa-check"></i><b>20.3</b> Rescaling can change interactions, homogeneity, and normality</a></li>
<li class="chapter" data-level="20.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1"><i class="fa fa-check"></i><b>20.4</b> Heterogeneous variances and robustness against outliers</a></li>
<li class="chapter" data-level="20.5" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#within-subject-designs"><i class="fa fa-check"></i><b>20.5</b> Within-subject designs</a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#why-use-a-within-subject-design-and-why-not"><i class="fa fa-check"></i><b>20.5.1</b> Why use a within-subject design? And why not?</a></li>
<li class="chapter" data-level="20.5.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#split-plot-design."><i class="fa fa-check"></i><b>20.5.2</b> Split-plot design.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#session-info-19"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#footnote-6"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html"><i class="fa fa-check"></i><b>21</b> Dichotomous Predicted Variable</a>
<ul>
<li class="chapter" data-level="21.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-metric-predictors"><i class="fa fa-check"></i><b>21.1</b> Multiple metric predictors</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#the-model-and-implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>21.1.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="21.1.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#example-height-weight-and-gender."><i class="fa fa-check"></i><b>21.1.2</b> Example: Height, weight, and gender.</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interpreting-the-regression-coefficients"><i class="fa fa-check"></i><b>21.2</b> Interpreting the regression coefficients</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#log-odds."><i class="fa fa-check"></i><b>21.2.1</b> Log odds.</a></li>
<li class="chapter" data-level="21.2.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#when-there-are-few-1s-or-0s-in-the-data."><i class="fa fa-check"></i><b>21.2.2</b> When there are few 1’s or 0’s in the data.</a></li>
<li class="chapter" data-level="21.2.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#correlated-predictors."><i class="fa fa-check"></i><b>21.2.3</b> Correlated predictors.</a></li>
<li class="chapter" data-level="21.2.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interaction-of-metric-predictors."><i class="fa fa-check"></i><b>21.2.4</b> Interaction of metric predictors.</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#robust-logistic-regression"><i class="fa fa-check"></i><b>21.3</b> Robust logistic regression</a></li>
<li class="chapter" data-level="21.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#nominal-predictors"><i class="fa fa-check"></i><b>21.4</b> Nominal predictors</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#single-group."><i class="fa fa-check"></i><b>21.4.1</b> Single group.</a></li>
<li class="chapter" data-level="21.4.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-groups."><i class="fa fa-check"></i><b>21.4.2</b> Multiple groups.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#session-info-20"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html"><i class="fa fa-check"></i><b>22</b> Nominal Predicted Variable</a>
<ul>
<li class="chapter" data-level="22.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-regression"><i class="fa fa-check"></i><b>22.1</b> Softmax regression</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-reduces-to-logistic-for-two-outcomes."><i class="fa fa-check"></i><b>22.1.1</b> Softmax reduces to logistic for two outcomes.</a></li>
<li class="chapter" data-level="22.1.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#independence-from-irrelevant-attributes."><i class="fa fa-check"></i><b>22.1.2</b> Independence from irrelevant attributes.</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>22.2</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="22.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#implementation-in-jags-brms"><i class="fa fa-check"></i><b>22.3</b> Implementation in <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-model."><i class="fa fa-check"></i><b>22.3.1</b> Softmax model.</a></li>
<li class="chapter" data-level="22.3.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-model."><i class="fa fa-check"></i><b>22.3.2</b> Conditional logistic model.</a></li>
<li class="chapter" data-level="22.3.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#results-interpreting-the-regression-coefficients."><i class="fa fa-check"></i><b>22.3.3</b> Results: Interpreting the regression coefficients.</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#generalizations-and-variations-of-the-models"><i class="fa fa-check"></i><b>22.4</b> Generalizations and variations of the models</a></li>
<li class="chapter" data-level="" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#session-info-21"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html"><i class="fa fa-check"></i><b>23</b> Ordinal Predicted Variable</a>
<ul>
<li class="chapter" data-level="23.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#modeling-ordinal-data-with-an-underlying-metric-variable"><i class="fa fa-check"></i><b>23.1</b> Modeling ordinal data with an underlying metric variable</a></li>
<li class="chapter" data-level="23.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-a-single-group"><i class="fa fa-check"></i><b>23.2</b> The case of a single group</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-3"><i class="fa fa-check"></i><b>23.2.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.2.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-bayesian-estimation-recovers-true-parameter-values."><i class="fa fa-check"></i><b>23.2.2</b> Examples: Bayesian estimation recovers true parameter values.</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-two-groups"><i class="fa fa-check"></i><b>23.3</b> The case of two groups</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-4"><i class="fa fa-check"></i><b>23.3.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.3.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-not-funny."><i class="fa fa-check"></i><b>23.3.2</b> Examples: Not funny.</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-metric-predictors"><i class="fa fa-check"></i><b>23.4</b> The Case of metric predictors</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-5"><i class="fa fa-check"></i><b>23.4.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="23.4.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-happiness-and-money."><i class="fa fa-check"></i><b>23.4.2</b> Example: Happiness and money.</a></li>
<li class="chapter" data-level="23.4.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-moviesthey-dont-make-em-like-they-used-to."><i class="fa fa-check"></i><b>23.4.3</b> Example: Movies–They don’t make ’em like they used to.</a></li>
<li class="chapter" data-level="23.4.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#why-are-some-thresholds-outside-the-data"><i class="fa fa-check"></i><b>23.4.4</b> Why are some thresholds outside the data?</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#posterior-prediction"><i class="fa fa-check"></i><b>23.5</b> Posterior prediction</a></li>
<li class="chapter" data-level="23.6" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#generalizations-and-extensions"><i class="fa fa-check"></i><b>23.6</b> Generalizations and extensions</a></li>
<li class="chapter" data-level="" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#session-info-22"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html"><i class="fa fa-check"></i><b>24</b> Count Predicted Variable</a>
<ul>
<li class="chapter" data-level="24.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-exponential-model"><i class="fa fa-check"></i><b>24.1</b> Poisson exponential model</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#data-structure."><i class="fa fa-check"></i><b>24.1.1</b> Data structure.</a></li>
<li class="chapter" data-level="24.1.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#exponential-link-function."><i class="fa fa-check"></i><b>24.1.2</b> Exponential link function.</a></li>
<li class="chapter" data-level="24.1.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-noise-distribution."><i class="fa fa-check"></i><b>24.1.3</b> Poisson noise distribution.</a></li>
<li class="chapter" data-level="24.1.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#the-complete-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>24.1.4</b> The complete model and implementation in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-hair-eye-go-again"><i class="fa fa-check"></i><b>24.2</b> Example: Hair eye go again</a></li>
<li class="chapter" data-level="24.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-interaction-contrasts-shrinkage-and-omnibus-test"><i class="fa fa-check"></i><b>24.3</b> Example: Interaction contrasts, shrinkage, and omnibus test</a></li>
<li class="chapter" data-level="24.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#log-linear-models-for-contingency-tables-bonus-alternative-parameterization"><i class="fa fa-check"></i><b>24.4</b> <del>Log-linear models for contingency tables</del> Bonus: Alternative parameterization</a></li>
<li class="chapter" data-level="" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#session-info-23"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html"><i class="fa fa-check"></i><b>25</b> Tools in the Trunk</a>
<ul>
<li class="chapter" data-level="25.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reporting-a-bayesian-analysis"><i class="fa fa-check"></i><b>25.1</b> Reporting a Bayesian analysis</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#essential-points."><i class="fa fa-check"></i><b>25.1.1</b> Essential points.</a></li>
<li class="chapter" data-level="25.1.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#optional-points."><i class="fa fa-check"></i><b>25.1.2</b> Optional points.</a></li>
<li class="chapter" data-level="25.1.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#helpful-points."><i class="fa fa-check"></i><b>25.1.3</b> Helpful points.</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#functions-for-computing-highest-density-intervals"><i class="fa fa-check"></i><b>25.2</b> Functions for computing highest density intervals</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-grid-approximation."><i class="fa fa-check"></i><b>25.2.1</b> R code for computing HDI of a grid approximation.</a></li>
<li class="chapter" data-level="25.2.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#hdi-of-unimodal-distribution-is-shortest-interval."><i class="fa fa-check"></i><b>25.2.2</b> HDI of unimodal distribution is shortest interval.</a></li>
<li class="chapter" data-level="25.2.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-mcmc-sample."><i class="fa fa-check"></i><b>25.2.3</b> R code for computing HDI of a MCMC sample.</a></li>
<li class="chapter" data-level="25.2.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-function."><i class="fa fa-check"></i><b>25.2.4</b> R code for computing HDI of a function.</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reparameterization"><i class="fa fa-check"></i><b>25.3</b> Reparameterization</a></li>
<li class="chapter" data-level="25.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#censored-data-in-jags-brms"><i class="fa fa-check"></i><b>25.4</b> Censored data in <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="25.4.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#right-censoring-when-youre-uncertain-beyond-a-single-threshold."><i class="fa fa-check"></i><b>25.4.1</b> Right censoring: When you’re uncertain beyond a single threshold.</a></li>
<li class="chapter" data-level="25.4.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#interval-censoring-when-your-values-are-somewhere-in-the-middle."><i class="fa fa-check"></i><b>25.4.2</b> Interval censoring: When your values are somewhere in the middle.</a></li>
<li class="chapter" data-level="25.4.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#complex-censoring-when-the-going-gets-tough"><i class="fa fa-check"></i><b>25.4.3</b> Complex censoring: When the going gets tough…</a></li>
<li class="chapter" data-level="25.4.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#bonus-truncation."><i class="fa fa-check"></i><b>25.4.4</b> Bonus: Truncation.</a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#what-next"><i class="fa fa-check"></i><b>25.5</b> What Next?</a></li>
<li class="chapter" data-level="" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#session-info-24"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Doing Bayesian Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="metric-predicted-variable-with-multiple-nominal-predictors" class="section level1 hasAnchor" number="20">
<h1><span class="header-section-number">20</span> Metric Predicted Variable with Multiple Nominal Predictors<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#metric-predicted-variable-with-multiple-nominal-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>This chapter considers data structures that consist of a metric predicted variable and two (or more) nominal predictors. This chapter extends ideas introduced in the previous chapter, so please read the previous chapter if you have not already…</p>
<p>The traditional treatment of this sort of data structure is called multifactor analysis of variance (ANOVA). Our Bayesian approach will be a hierarchical generalization of the traditional ANOVA model. The chapter also considers generalizations of the traditional models, because it is straight forward in Bayesian software to implement heavy-tailed distributions to accommodate outliers, along with hierarchical structure to accommodate heterogeneous variances in the different groups. <span class="citation">(<a href="#ref-kruschkeDoingBayesianData2015" role="doc-biblioref">Kruschke, 2015, pp. 583–584</a>)</span></p>
</blockquote>
<div id="describing-groups-of-metric-data-with-multiple-nominal-predictors" class="section level2 hasAnchor" number="20.1">
<h2><span class="header-section-number">20.1</span> Describing groups of metric data with multiple nominal predictors<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#describing-groups-of-metric-data-with-multiple-nominal-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Quick reprise:</p>
<blockquote>
<p>Suppose we have two nominal predictors, denoted <span class="math inline">\(\overrightarrow x_1\)</span> and <span class="math inline">\(\overrightarrow x_2\)</span>. A datum from the <span class="math inline">\(j\)</span>th level of <span class="math inline">\(\overrightarrow x_1\)</span> is denoted <span class="math inline">\(x_{1[j]}\)</span>, and analogously for the second factor. The predicted value is a baseline plus a deflection due to the level of factor <span class="math inline">\(1\)</span> plus a deflection due to the level of factor <span class="math inline">\(2\)</span> plus a residual deflection due to the interaction of factors:</p>
<p><span class="math display">\[\begin{align*}
\mu &amp; = \beta_0 + \overrightarrow \beta_1 \cdot \overrightarrow x_1 + \overrightarrow \beta_2 \cdot \overrightarrow x_2 + \overrightarrow \beta_{1 \times 2} \cdot \overrightarrow x_{1 \times 2} \\
&amp; = \beta_0 + \sum_j \beta_{1[j]} x_{1[j]} + \sum_k \beta_{2[k]} x_{2[k]} + \sum_{j, k} \beta_{1 \times 2[j, k]} x_{1 \times 2[j, k]}
\end{align*}\]</span></p>
<p>The deflections within factors and within the interaction are constrained to sum to zero:</p>
<p><span class="math display">\[\begin{align*}
\sum_j \beta_{1[j]} = 0                                &amp;&amp;&amp; \text{and} &amp;&amp; \sum_k \beta_{2[k]} = 0 \;\;\; \text{and} \\
\sum_j \beta_{1 \times 2[j, k]} = 0 \text{ for all } k &amp;&amp;&amp; \text{and} &amp;&amp; \sum_k \beta_{1 \times 2[j, k]} = 0 \text{ for all } j
\end{align*}\]</span></p>
<p>([these equations] are repetitions of Equations 15.9 and 15.10, p. 434). The actual data are assumed to be randomly distributed around the predicted value. (pp. 584–585)</p>
</blockquote>
<div id="interaction." class="section level3 hasAnchor" number="20.1.1">
<h3><span class="header-section-number">20.1.1</span> Interaction.<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>An important concept of models with multiple predictors is interaction. Interaction means that the effect of a predictor depends on the level of another predictor. A little more technically, interaction is what is left over after the main effects of the factors are added: interaction is the nonadditive influence of the factors. (p. 585)</p>
</blockquote>
<p>Here are the data necessary for our version of Figure 20.1, which displays an interaction of two 2-level factors.</p>
<div class="sourceCode" id="cb1975"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1975-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1975-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1975-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-3" aria-hidden="true" tabindex="-1"></a>grand_mean            <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb1975-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-4" aria-hidden="true" tabindex="-1"></a>deflection_1          <span class="ot">&lt;-</span> <span class="fl">1.8</span></span>
<span id="cb1975-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-5" aria-hidden="true" tabindex="-1"></a>deflection_2          <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb1975-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-6" aria-hidden="true" tabindex="-1"></a>nonadditive_component <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb1975-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1975-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-8" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb1975-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-9" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span></span>
<span id="cb1975-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x1 =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb1975-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">x2 =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="at">times =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1975-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mu_additive =</span> grand_mean <span class="sc">+</span> (x1 <span class="sc">*</span> deflection_1) <span class="sc">+</span> (x2 <span class="sc">*</span> deflection_2)) <span class="sc">%&gt;%</span> </span>
<span id="cb1975-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mu_multiplicative =</span> mu_additive <span class="sc">+</span> (x1 <span class="sc">*</span> x2 <span class="sc">*</span> nonadditive_component),</span>
<span id="cb1975-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-14" aria-hidden="true" tabindex="-1"></a>         <span class="co"># we&#39;ll need this to accommodate `position = &quot;dodge&quot;` within `geom_col()`</span></span>
<span id="cb1975-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">x1_offset         =</span> x1 <span class="sc">+</span> x2 <span class="sc">*</span> <span class="sc">-</span>.<span class="dv">45</span>,</span>
<span id="cb1975-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-16" aria-hidden="true" tabindex="-1"></a>         <span class="co"># we&#39;ll need this for the fill</span></span>
<span id="cb1975-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">x2_c              =</span> <span class="fu">factor</span>(x2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb1975-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1975-18" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 6
##      x1    x2 mu_additive mu_multiplicative x1_offset x2_c 
##   &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;             &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;
## 1    -1     1         3.4               4.4     -1.45 1    
## 2    -1    -1         3                 2       -0.55 -1   
## 3     1     1         7                 6        0.55 1    
## 4     1    -1         6.6               7.6      1.45 -1</code></pre>
<p>There’s enough going on with the lines, arrows, and titles across the three panels that to my mind it seems easier to make three distinct plots and them join them at the end with syntax from the <strong>patchwork</strong> package. But enough of the settings are common among the panels that it also makes sense to keep from repeating that part of the code. So we’ll take a three-step solution. For the first step, we’ll make the baseline or foundational plot, which we’ll call <code>p</code>.</p>
<p>Before we make <code>p</code>, let’s talk color and theme. For this chapter, we’ll carry forward our practice from <a href="metric-predicted-variable-with-one-nominal-predictor.html#metric-predicted-variable-with-one-nominal-predictor">Chapter 19</a> and take our color palette from the <strong>palettetown</strong> package. Our color palette will be #15, which is based on <a href="https://www.pokemon.com/us/pokedex/beedrill">Beedrill</a>.</p>
<div class="sourceCode" id="cb1977"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1977-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1977-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palettetown)</span>
<span id="cb1977-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1977-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1977-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1977-3" aria-hidden="true" tabindex="-1"></a>scales<span class="sc">::</span><span class="fu">show_col</span>(<span class="fu">pokepal</span>(<span class="at">pokemon =</span> <span class="dv">15</span>))</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1978"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1978-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1978-1" aria-hidden="true" tabindex="-1"></a>bd <span class="ot">&lt;-</span> <span class="fu">pokepal</span>(<span class="at">pokemon =</span> <span class="dv">15</span>)</span>
<span id="cb1978-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1978-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1978-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1978-3" aria-hidden="true" tabindex="-1"></a>bd</span></code></pre></div>
<pre><code>##  [1] &quot;#181818&quot; &quot;#D8C8F0&quot; &quot;#F8F8F8&quot; &quot;#B8A8C0&quot; &quot;#606060&quot; &quot;#E8A030&quot; &quot;#A090A8&quot; &quot;#F8C848&quot; &quot;#885000&quot;
## [10] &quot;#980008&quot; &quot;#E8E0F8&quot; &quot;#F8F0A0&quot; &quot;#F89068&quot; &quot;#D01830&quot;</code></pre>
<p>Also like in the last chapter, our overall plot theme will be based on the default <code>theme_grey()</code> with a good number of adjustments. This time, it will have more of a <a href="https://jonlefcheck.net/2013/03/11/black-theme-for-ggplot2-2/"><code>theme_black()</code></a> vibe.</p>
<div class="sourceCode" id="cb1980"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1980-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1980-1" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(</span>
<span id="cb1980-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1980-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_grey</span>() <span class="sc">+</span></span>
<span id="cb1980-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1980-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> bd[<span class="dv">3</span>]),</span>
<span id="cb1980-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1980-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> bd[<span class="dv">3</span>]),</span>
<span id="cb1980-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1980-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> bd[<span class="dv">3</span>]),</span>
<span id="cb1980-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1980-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1980-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1980-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.box.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1980-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1980-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> bd[<span class="dv">1</span>]),</span>
<span id="cb1980-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1980-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> bd[<span class="dv">1</span>], <span class="at">color =</span> bd[<span class="dv">3</span>]),</span>
<span id="cb1980-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1980-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1980-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1980-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> bd[<span class="dv">1</span>], <span class="at">color =</span> bd[<span class="dv">1</span>]),</span>
<span id="cb1980-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1980-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="fu">alpha</span>(bd[<span class="dv">5</span>], <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), <span class="at">color =</span> <span class="fu">alpha</span>(bd[<span class="dv">5</span>], <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)),</span>
<span id="cb1980-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1980-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> bd[<span class="dv">3</span>]))</span>
<span id="cb1980-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1980-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Okay, it’s time to make <code>p</code>, the baseline or foundational plot for our Figure 20.1.</p>
<div class="sourceCode" id="cb1981"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1981-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1981-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span></span>
<span id="cb1981-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1981-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1981-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1981-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> mu_multiplicative)) <span class="sc">+</span></span>
<span id="cb1981-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1981-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> x2_c),</span>
<span id="cb1981-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1981-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb1981-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1981-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="cn">NULL</span>, <span class="at">values =</span> bd[<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">6</span>)], <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;x2[1]&quot;</span>, <span class="st">&quot;x2[2]&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1981-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1981-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;x1[1]&quot;</span>, <span class="st">&quot;x1[2]&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1981-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1981-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(mu), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>), </span>
<span id="cb1981-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1981-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))) <span class="sc">+</span></span>
<span id="cb1981-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1981-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb1981-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1981-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1981-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1981-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">17</span>, .<span class="dv">875</span>))</span>
<span id="cb1981-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1981-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1981-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1981-14" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-5-1.png" width="264" style="display: block; margin: auto;" /></p>
<p>Now we have <code>p</code>, we’ll add panel-specific elements to it, which we’ll save as individual objects, <code>p1</code>, <code>p2</code>, and <code>p3</code>. That’s step 2. Then for step 3, we’ll bring them all together with <strong>patchwork</strong>.</p>
<div class="sourceCode" id="cb1982"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1982-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-1" aria-hidden="true" tabindex="-1"></a><span class="co"># deflection from additive</span></span>
<span id="cb1982-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1982-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-3" aria-hidden="true" tabindex="-1"></a>  p <span class="sc">+</span></span>
<span id="cb1982-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_offset, <span class="at">xend =</span> x1_offset,</span>
<span id="cb1982-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> mu_additive, <span class="at">yend =</span> mu_multiplicative),</span>
<span id="cb1982-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">1.25</span>, <span class="at">color =</span> bd[<span class="dv">5</span>],</span>
<span id="cb1982-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(.<span class="dv">275</span>, <span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span></span>
<span id="cb1982-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_offset, <span class="at">y =</span> mu_additive, <span class="at">group =</span> x2),</span>
<span id="cb1982-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> bd[<span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb1982-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_offset, <span class="at">y =</span> mu_additive, <span class="at">group =</span> x1),</span>
<span id="cb1982-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> bd[<span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb1982-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb1982-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Deflection from additive&quot;</span>)</span>
<span id="cb1982-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1982-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-15" aria-hidden="true" tabindex="-1"></a><span class="co"># effect of x1 depends on x2</span></span>
<span id="cb1982-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-16" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1982-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-17" aria-hidden="true" tabindex="-1"></a>  p <span class="sc">+</span></span>
<span id="cb1982-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_offset, <span class="at">xend =</span> x1_offset,</span>
<span id="cb1982-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> mu_additive, <span class="at">yend =</span> mu_multiplicative),</span>
<span id="cb1982-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">5</span>, <span class="at">color =</span> bd[<span class="dv">5</span>],</span>
<span id="cb1982-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(.<span class="dv">15</span>, <span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span></span>
<span id="cb1982-22"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_offset, <span class="at">y =</span> mu_additive, <span class="at">group =</span> x2),</span>
<span id="cb1982-23"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> bd[<span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb1982-24"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_offset, <span class="at">y =</span> mu_multiplicative, <span class="at">group =</span> x2),</span>
<span id="cb1982-25"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">1.25</span>, <span class="at">color =</span> bd[<span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb1982-26"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Effect of x1 depends on x2&quot;</span>)</span>
<span id="cb1982-27"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1982-28"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-28" aria-hidden="true" tabindex="-1"></a><span class="co"># effect of x2 depends on x1</span></span>
<span id="cb1982-29"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-29" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb1982-30"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-30" aria-hidden="true" tabindex="-1"></a>  p <span class="sc">+</span></span>
<span id="cb1982-31"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_offset, <span class="at">xend =</span> x1_offset,</span>
<span id="cb1982-32"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-32" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> mu_additive, <span class="at">yend =</span> mu_multiplicative),</span>
<span id="cb1982-33"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-33" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> .<span class="dv">5</span>, <span class="at">color =</span> bd[<span class="dv">5</span>],</span>
<span id="cb1982-34"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-34" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(.<span class="dv">15</span>, <span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span></span>
<span id="cb1982-35"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_offset, <span class="at">y =</span> mu_multiplicative, <span class="at">group =</span> x1),</span>
<span id="cb1982-36"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">1.25</span>, <span class="at">color =</span> bd[<span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb1982-37"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1_offset, <span class="at">y =</span> mu_additive, <span class="at">group =</span> x1),</span>
<span id="cb1982-38"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> bd[<span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb1982-39"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Effect of x2 depends on x1&quot;</span>)</span>
<span id="cb1982-40"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1982-41"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1982-42"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1982-43"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1982-43" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-6-1.png" width="792" style="display: block; margin: auto;" /></p>
<p>And in case it’s not clear, “the average deflection from baseline due to a predictor… is called the main effect of the predictor. The main effects of the predictors correspond to the dashed lines in the left panel of Figure 20.1” (p. 587). And further</p>
<blockquote>
<p>The left panel of Figure 20.1 highlights the interaction as the nonadditive component, emphasized by the heavy vertical arrows that mark the departure from additivity. The middle panel of Figure 20.1 highlights the interaction by emphasizing that the effect of <span class="math inline">\(x_1\)</span> depends on the level of <span class="math inline">\(x_2\)</span>. The heavy lines mark the effect of <span class="math inline">\(x_1\)</span>, that is, the changes from level <span class="math inline">\(1\)</span> of <span class="math inline">\(x_1\)</span> to level <span class="math inline">\(2\)</span> of <span class="math inline">\(x_1\)</span>. Notice that the heavy lines have different slopes: The heavy line for level <span class="math inline">\(1\)</span> of <span class="math inline">\(x_2\)</span> has a shallower slope than the heavy line for level <span class="math inline">\(2\)</span> of <span class="math inline">\(x_2\)</span>. The right panel of Figure 20.1 highlights the interaction by emphasizing that the effect of <span class="math inline">\(x_2\)</span> depends on the level of <span class="math inline">\(x_1\)</span>. (p. 587)</p>
</blockquote>
</div>
<div id="traditional-anova." class="section level3 hasAnchor" number="20.1.2">
<h3><span class="header-section-number">20.1.2</span> Traditional ANOVA.<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#traditional-anova." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>As was explained in <a href="metric-predicted-variable-with-one-nominal-predictor.html#traditional-analysis-of-variance">Section 19.2</a> (p. 556), the terminology, “analysis of variance,” comes from a decomposition of overall data variance into within-group variance and between-group variance… The Bayesian approach is not ANOVA, but is analogous to ANOVA. Traditional ANOVA makes decisions about equality of groups (i.e., null hypotheses) on the basis of <span class="math inline">\(p\)</span> values using a null hypothesis that assumes (i) the data are normally distributed within groups, and (ii) the standard deviation of the data within each group is the same for all groups. The second assumption is sometimes called “homogeneity of variance.” The entrenched precedent of ANOVA is why basic models of grouped data make those assumptions, and why the basic models presented in this chapter will also make those assumptions. Later in the chapter, those constraints will be relaxed. (pp. 587–588)</p>
</blockquote>
</div>
</div>
<div id="hierarchical-bayesian-approach-1" class="section level2 hasAnchor" number="20.2">
<h2><span class="header-section-number">20.2</span> Hierarchical Bayesian approach<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#hierarchical-bayesian-approach-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>“Our goal is to estimate the main and interaction deflections, and other parameters, based on the observed data” (p. 588).</p>
<p>Figure 20.2 will provides a generic model diagram of how this can work.</p>
<div class="sourceCode" id="cb1983"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1983-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bracket</span></span>
<span id="cb1983-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1983-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> .<span class="dv">99</span>,</span>
<span id="cb1983-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> .<span class="dv">5</span>,</span>
<span id="cb1983-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;{_}&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1983-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1983-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1983-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">color =</span> bd[<span class="dv">2</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1983-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1983-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1983-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1983-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1983-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  plain arrow</span></span>
<span id="cb1983-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-14" aria-hidden="true" tabindex="-1"></a><span class="co"># save our custom arrow settings</span></span>
<span id="cb1983-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-15" aria-hidden="true" tabindex="-1"></a>my_arrow <span class="ot">&lt;-</span> <span class="fu">arrow</span>(<span class="at">angle =</span> <span class="dv">20</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.35</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">type =</span> <span class="st">&quot;closed&quot;</span>)</span>
<span id="cb1983-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-16" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1983-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> .<span class="dv">68</span>,</span>
<span id="cb1983-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="dv">1</span>,</span>
<span id="cb1983-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> .<span class="dv">68</span>,</span>
<span id="cb1983-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> .<span class="dv">25</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1983-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1983-22"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb1983-23"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1983-24"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb1983-25"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1983-26"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1983-27"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1983-28"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-28" aria-hidden="true" tabindex="-1"></a><span class="co"># normal density</span></span>
<span id="cb1983-29"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-29" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb1983-30"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1983-31"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1983-32"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bd[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1983-33"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1983-34"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1983-35"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1983-36"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb1983-37"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1983-38"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.45</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1983-39"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb1983-40"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;italic(M)[0]&quot;</span>, <span class="st">&quot;italic(S)[0]&quot;</span>), </span>
<span id="cb1983-41"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1983-42"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1983-43"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1983-44"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]))</span>
<span id="cb1983-45"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1983-46"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-46" aria-hidden="true" tabindex="-1"></a><span class="co"># normal density</span></span>
<span id="cb1983-47"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-47" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb1983-48"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1983-49"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1983-50"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bd[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1983-51"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1983-52"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1983-53"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1983-54"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb1983-55"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1983-56"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-56" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.15</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1983-57"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-57" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;sigma[beta][1]&quot;</span>), </span>
<span id="cb1983-58"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-58" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb1983-59"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-59" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1983-60"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1983-61"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1983-62"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]))</span>
<span id="cb1983-63"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1983-64"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-64" aria-hidden="true" tabindex="-1"></a><span class="co"># normal density</span></span>
<span id="cb1983-65"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-65" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span></span>
<span id="cb1983-66"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1983-67"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1983-68"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bd[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1983-69"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1983-70"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-70" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1983-71"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-71" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1983-72"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-72" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb1983-73"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1983-74"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-74" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.15</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1983-75"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-75" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;sigma[beta][2]&quot;</span>), </span>
<span id="cb1983-76"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-76" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb1983-77"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-77" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1983-78"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1983-79"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1983-80"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]))</span>
<span id="cb1983-81"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1983-82"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-82" aria-hidden="true" tabindex="-1"></a><span class="co"># normal density</span></span>
<span id="cb1983-83"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-83" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span></span>
<span id="cb1983-84"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1983-85"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1983-86"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bd[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1983-87"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1983-88"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-88" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1983-89"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-89" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1983-90"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-90" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb1983-91"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1983-92"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-92" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.67</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1983-93"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-93" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb1983-94"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-94" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;sigma[beta][1%*%2]&quot;</span>), </span>
<span id="cb1983-95"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-95" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1983-96"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1983-97"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1983-98"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]))</span>
<span id="cb1983-99"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1983-100"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-100" aria-hidden="true" tabindex="-1"></a><span class="co"># four annotated arrows</span></span>
<span id="cb1983-101"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-101" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span></span>
<span id="cb1983-102"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">34</span>, .<span class="dv">64</span>, .<span class="dv">945</span>),</span>
<span id="cb1983-103"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-103" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1983-104"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-104" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">18</span>, .<span class="dv">45</span>, .<span class="dv">74</span>),</span>
<span id="cb1983-105"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-105" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1983-106"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb1983-107"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-107" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1983-108"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb1983-109"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1983-110"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-110" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">23</span>, .<span class="dv">30</span>, .<span class="dv">52</span>, .<span class="dv">585</span>, .<span class="dv">81</span>, .<span class="dv">91</span>), <span class="at">y =</span> .<span class="dv">5</span>,</span>
<span id="cb1983-111"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-111" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(j)&quot;</span>, <span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(k)&quot;</span>, <span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(jk)&quot;</span>),</span>
<span id="cb1983-112"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-112" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">7</span>), </span>
<span id="cb1983-113"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-113" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1983-114"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1983-115"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1983-116"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1983-117"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-117" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood formula</span></span>
<span id="cb1983-118"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-118" aria-hidden="true" tabindex="-1"></a>p8 <span class="ot">&lt;-</span></span>
<span id="cb1983-119"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> .<span class="dv">5</span>,</span>
<span id="cb1983-120"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-120" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb1983-121"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-121" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;beta[0]+sum()[italic(j)]*beta[1][&#39;[&#39;*italic(j)*&#39;]&#39;]*italic(x)[1][&#39;[&#39;*italic(j)*&#39;]&#39;](italic(i))+sum()[italic(k)]*beta[2][&#39;[&#39;*italic(k)*&#39;]&#39;]*italic(x)[2][&#39;[&#39;*italic(k)*&#39;]&#39;](italic(i))+sum()[italic(jk)]*beta[1%*%2][&#39;[&#39;*italic(jk)*&#39;]&#39;]*italic(x)[1%*%2][&#39;[&#39;*italic(jk)*&#39;]&#39;](italic(i))&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1983-122"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-122" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1983-123"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1983-124"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1983-125"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1983-126"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1983-127"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1983-128"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1983-129"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-129" aria-hidden="true" tabindex="-1"></a><span class="co"># half-normal density</span></span>
<span id="cb1983-130"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-130" aria-hidden="true" tabindex="-1"></a>p9 <span class="ot">&lt;-</span></span>
<span id="cb1983-131"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1983-132"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1983-133"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bd[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1983-134"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1983-135"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-135" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1983-136"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-136" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;half-normal&quot;</span>,</span>
<span id="cb1983-137"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-137" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb1983-138"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1983-139"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-139" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1983-140"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-140" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;0*&#39;,&#39;*~italic(S)[sigma]&quot;</span>, </span>
<span id="cb1983-141"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-141" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1983-142"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1983-143"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1983-144"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]))</span>
<span id="cb1983-145"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1983-146"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-146" aria-hidden="true" tabindex="-1"></a><span class="co"># the final normal density</span></span>
<span id="cb1983-147"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-147" aria-hidden="true" tabindex="-1"></a>p10 <span class="ot">&lt;-</span></span>
<span id="cb1983-148"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1983-149"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb1983-150"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bd[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb1983-151"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1983-152"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-152" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb1983-153"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-153" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb1983-154"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-154" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb1983-155"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb1983-156"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-156" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.15</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb1983-157"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-157" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;mu[italic(i)]&quot;</span>, <span class="st">&quot;sigma[italic(y)]&quot;</span>), </span>
<span id="cb1983-158"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-158" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb1983-159"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-159" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1983-160"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1983-161"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb1983-162"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]))</span>
<span id="cb1983-163"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1983-164"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-164" aria-hidden="true" tabindex="-1"></a><span class="co"># an annotated arrow</span></span>
<span id="cb1983-165"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-165" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span></span>
<span id="cb1983-166"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">4</span>,</span>
<span id="cb1983-167"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-167" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> .<span class="dv">5</span>,</span>
<span id="cb1983-168"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-168" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;&#39;=&#39;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1983-169"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-169" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1983-170"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1983-171"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1983-172"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">5</span>, <span class="at">xend =</span> .<span class="dv">5</span>,</span>
<span id="cb1983-173"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-173" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> .<span class="dv">1</span>, </span>
<span id="cb1983-174"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-174" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb1983-175"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1983-176"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1983-177"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1983-178"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-178" aria-hidden="true" tabindex="-1"></a><span class="co"># another annotated arrow</span></span>
<span id="cb1983-179"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-179" aria-hidden="true" tabindex="-1"></a>p12 <span class="ot">&lt;-</span></span>
<span id="cb1983-180"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">49</span>,</span>
<span id="cb1983-181"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-181" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> .<span class="dv">55</span>,</span>
<span id="cb1983-182"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-182" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;&#39;~&#39;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1983-183"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-183" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1983-184"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1983-185"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1983-186"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">79</span>, <span class="at">xend =</span> .<span class="dv">4</span>,</span>
<span id="cb1983-187"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-187" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> .<span class="dv">2</span>, </span>
<span id="cb1983-188"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-188" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb1983-189"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1983-190"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1983-191"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1983-192"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-192" aria-hidden="true" tabindex="-1"></a><span class="co"># the final annotated arrow</span></span>
<span id="cb1983-193"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-193" aria-hidden="true" tabindex="-1"></a>p13 <span class="ot">&lt;-</span></span>
<span id="cb1983-194"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="fu">c</span>(.<span class="dv">375</span>, .<span class="dv">625</span>),</span>
<span id="cb1983-195"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-195" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb1983-196"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-196" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(i)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1983-197"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-197" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1983-198"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1983-199"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>), </span>
<span id="cb1983-200"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-200" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1983-201"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">5</span>, <span class="at">xend =</span> .<span class="dv">5</span>,</span>
<span id="cb1983-202"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-202" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> <span class="dv">0</span>, </span>
<span id="cb1983-203"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-203" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb1983-204"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1983-205"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1983-206"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1983-207"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-207" aria-hidden="true" tabindex="-1"></a><span class="co"># some text</span></span>
<span id="cb1983-208"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-208" aria-hidden="true" tabindex="-1"></a>p14 <span class="ot">&lt;-</span></span>
<span id="cb1983-209"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">5</span>,</span>
<span id="cb1983-210"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-210" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> .<span class="dv">5</span>,</span>
<span id="cb1983-211"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-211" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;italic(y[i])&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1983-212"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-212" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1983-213"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb1983-214"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb1983-215"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1983-216"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb1983-217"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1983-218"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-218" aria-hidden="true" tabindex="-1"></a><span class="co"># define the layout</span></span>
<span id="cb1983-219"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-219" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1983-220"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">6</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1983-221"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb1983-222"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">14</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb1983-223"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">3</span>),</span>
<span id="cb1983-224"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1983-225"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">9</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb1983-226"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">13</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb1983-227"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">b =</span> <span class="dv">3</span>, <span class="at">l =</span> <span class="dv">6</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb1983-228"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">b =</span> <span class="dv">3</span>, <span class="at">l =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb1983-229"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">b =</span> <span class="dv">3</span>, <span class="at">l =</span> <span class="dv">14</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb1983-230"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">6</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb1983-231"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">5</span>, <span class="at">b =</span> <span class="dv">6</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb1983-232"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">9</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">12</span>),</span>
<span id="cb1983-233"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">12</span>, <span class="at">b =</span> <span class="dv">13</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb1983-234"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">8</span>, <span class="at">b =</span> <span class="dv">12</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb1983-235"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">11</span>, <span class="at">b =</span> <span class="dv">12</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">12</span>),</span>
<span id="cb1983-236"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">14</span>, <span class="at">b =</span> <span class="dv">14</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb1983-237"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">15</span>, <span class="at">b =</span> <span class="dv">15</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>)</span>
<span id="cb1983-238"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-238" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1983-239"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1983-240"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-240" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot!</span></span>
<span id="cb1983-241"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-241" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p1 <span class="sc">+</span> p1 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p5 <span class="sc">+</span> p6 <span class="sc">+</span> p2 <span class="sc">+</span> p2 <span class="sc">+</span> p2 <span class="sc">+</span> p8 <span class="sc">+</span> p7 <span class="sc">+</span> p9 <span class="sc">+</span> p10 <span class="sc">+</span> p11 <span class="sc">+</span> p12 <span class="sc">+</span> p13 <span class="sc">+</span> p14) <span class="sc">+</span> </span>
<span id="cb1983-242"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout) <span class="sc">&amp;</span></span>
<span id="cb1983-243"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb1983-244"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1983-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>, <span class="fl">5.5</span>))</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-7-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Wow that plot has a lot of working parts! 😮</p>
<div id="implementation-in-jags-brms.-1" class="section level3 hasAnchor" number="20.2.1">
<h3><span class="header-section-number">20.2.1</span> Implementation in <del>JAGS</del> brms.<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Below is how to implement the model based on the code from Kruschke’s <code>Jags-Ymet-Xnom2fac-MnormalHom.R</code> and <code>Jags-Ymet-Xnom2fac-MnormalHom-Example.R</code> scripts. With <strong>brms</strong>, we’ll need to specify the <code>stanvars</code>.</p>
<div class="sourceCode" id="cb1984"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1984-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1984-1" aria-hidden="true" tabindex="-1"></a>mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(my_data<span class="sc">$</span>y)</span>
<span id="cb1984-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1984-2" aria-hidden="true" tabindex="-1"></a>sd_y   <span class="ot">&lt;-</span> <span class="fu">sd</span>(my_data<span class="sc">$</span>y)</span>
<span id="cb1984-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1984-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1984-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1984-4" aria-hidden="true" tabindex="-1"></a>omega <span class="ot">&lt;-</span> sd_y <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb1984-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1984-5" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> sd_y</span>
<span id="cb1984-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1984-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1984-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1984-7" aria-hidden="true" tabindex="-1"></a>s_r <span class="ot">&lt;-</span> <span class="fu">gamma_a_b_from_omega_sigma</span>(<span class="at">mode =</span> omega, <span class="at">sd =</span> sigma)</span>
<span id="cb1984-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1984-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1984-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1984-9" aria-hidden="true" tabindex="-1"></a>stanvars <span class="ot">&lt;-</span> </span>
<span id="cb1984-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1984-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(mean_y,    <span class="at">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1984-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1984-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(sd_y,      <span class="at">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb1984-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1984-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>shape, <span class="at">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">+</span></span>
<span id="cb1984-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1984-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>rate,  <span class="at">name =</span> <span class="st">&quot;beta&quot;</span>)</span></code></pre></div>
<p>And before that, of course, make sure you’ve defined the <code>gamma_a_b_from_omega_sigma()</code> function. E.g.,</p>
<div class="sourceCode" id="cb1985"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1985-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1985-1" aria-hidden="true" tabindex="-1"></a>gamma_a_b_from_omega_sigma <span class="ot">&lt;-</span> <span class="cf">function</span>(mode, sd) {</span>
<span id="cb1985-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1985-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (mode <span class="sc">&lt;=</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">&quot;mode must be &gt; 0&quot;</span>)</span>
<span id="cb1985-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1985-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (sd   <span class="sc">&lt;=</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">&quot;sd must be &gt; 0&quot;</span>)</span>
<span id="cb1985-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1985-4" aria-hidden="true" tabindex="-1"></a>  rate <span class="ot">&lt;-</span> (mode <span class="sc">+</span> <span class="fu">sqrt</span>(mode<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sd<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sd<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1985-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1985-5" aria-hidden="true" tabindex="-1"></a>  shape <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> mode <span class="sc">*</span> rate</span>
<span id="cb1985-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1985-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">shape =</span> shape, <span class="at">rate =</span> rate))</span>
<span id="cb1985-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1985-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>With the preparatory work done, now all we’d need to do is run the <code>brm()</code> code.</p>
<div class="sourceCode" id="cb1986"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1986-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1986-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span></span>
<span id="cb1986-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1986-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1986-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1986-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1986-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1986-4" aria-hidden="true" tabindex="-1"></a>      y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> factor_1) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> factor_2) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> factor_1<span class="sc">:</span>factor_2),</span>
<span id="cb1986-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1986-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1986-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1986-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">gamma</span>(alpha, beta), <span class="at">class =</span> sd),</span>
<span id="cb1986-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1986-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb1986-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1986-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars)</span></code></pre></div>
<p>If you have reason to use different priors for the random effects, you can always specify multiple lines of <code>class = sd</code>, each with the appropriate <code>coef</code> argument.</p>
<p>The big new element is multiple <code>(|)</code> parts in the <code>formula</code>. In this simple model type, we’re only working random intercepts, in this case with two factors and their interaction. The <code>formula</code> above presumes the interaction is not itself coded within the data. But consider the case you have data including a term for the interaction of the two lower-level factors, called <code>interaction</code>. In that case, you’d have that last part of the <code>formula</code> read <code>(1 | interaction)</code>, instead.</p>
</div>
<div id="example-its-only-money." class="section level3 hasAnchor" number="20.2.2">
<h3><span class="header-section-number">20.2.2</span> Example: It’s only money.<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#example-its-only-money." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Load the salary data<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>.</p>
<div class="sourceCode" id="cb1987"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1987-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1987-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data.R/Salary.csv&quot;</span>)</span>
<span id="cb1987-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1987-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1987-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1987-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(my_data)</span></code></pre></div>
<pre><code>## Rows: 1,080
## Columns: 6
## $ Org     &lt;chr&gt; &quot;PL&quot;, &quot;MUTH&quot;, &quot;ENG&quot;, &quot;CMLT&quot;, &quot;LGED&quot;, &quot;MGMT&quot;, &quot;INFO&quot;, &quot;CRIN&quot;, &quot;CRIN&quot;, &quot;PSY&quot;, &quot;SOC&quot;,…
## $ OrgName &lt;chr&gt; &quot;Philosophy&quot;, &quot;Music Theory&quot;, &quot;English&quot;, &quot;Comparative Literature&quot;, &quot;Language Educa…
## $ Cla     &lt;chr&gt; &quot;PC&quot;, &quot;PC&quot;, &quot;PC&quot;, &quot;PC&quot;, &quot;PT&quot;, &quot;PR&quot;, &quot;PT&quot;, &quot;PR&quot;, &quot;PR&quot;, &quot;PR&quot;, &quot;PR&quot;, &quot;PR&quot;, &quot;PR&quot;, &quot;PC&quot;…
## $ Pos     &lt;chr&gt; &quot;FT2&quot;, &quot;FT2&quot;, &quot;FT2&quot;, &quot;FT2&quot;, &quot;FT3&quot;, &quot;NDW&quot;, &quot;FT3&quot;, &quot;FT1&quot;, &quot;NDW&quot;, &quot;FT1&quot;, &quot;FT1&quot;, &quot;FT1&quot;…
## $ ClaPos  &lt;chr&gt; &quot;PC.FT2&quot;, &quot;PC.FT2&quot;, &quot;PC.FT2&quot;, &quot;PC.FT2&quot;, &quot;PT.FT3&quot;, &quot;PR.NDW&quot;, &quot;PT.FT3&quot;, &quot;PR.FT1&quot;, &quot;P…
## $ Salary  &lt;dbl&gt; 72395, 61017, 82370, 68805, 63796, 219600, 98814, 107745, 114275, 173302, 117240, …</code></pre>
<p>We’ll follow Kruschke’s example on page 593 and modify the <code>Pos</code> variable a bit.</p>
<div class="sourceCode" id="cb1989"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1989-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1989-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span></span>
<span id="cb1989-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1989-2" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1989-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1989-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pos =</span> <span class="fu">factor</span>(Pos,</span>
<span id="cb1989-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1989-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;FT3&quot;</span>, <span class="st">&quot;FT2&quot;</span>, <span class="st">&quot;FT1&quot;</span>, <span class="st">&quot;NDW&quot;</span>, <span class="st">&quot;DST&quot;</span>) ,</span>
<span id="cb1989-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1989-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ordered =</span> T,</span>
<span id="cb1989-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1989-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Assis&quot;</span>, <span class="st">&quot;Assoc&quot;</span>, <span class="st">&quot;Full&quot;</span>, <span class="st">&quot;Endow&quot;</span>, <span class="st">&quot;Disting&quot;</span>)))</span></code></pre></div>
<p>With 1,080 cases, two factors, and a criterion, these data are a little too unwieldy to look at the individual case level. But if we’re tricky on how we aggregate, we can get a good sense of their structure with a <code>geom_tile()</code> plot. Here our strategy is to aggregate by our two factors, <code>Pos</code> and <code>Org</code>. Since our criterion is <code>Salary</code>, we’ll compute the mean value of the cases within each unique paring, encoded as <code>m_salary</code>. Also, we’ll get a sense of how many cases there are within each factor pairing with <code>n</code>.</p>
<div class="sourceCode" id="cb1990"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1990-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1990-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Pos, Org) <span class="sc">%&gt;%</span> </span>
<span id="cb1990-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">m_salary =</span> <span class="fu">mean</span>(Salary),</span>
<span id="cb1990-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">n        =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1990-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1990-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Org =</span> <span class="fu">fct_reorder</span>(Org, m_salary),</span>
<span id="cb1990-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Pos =</span> <span class="fu">fct_reorder</span>(Pos, m_salary)) <span class="sc">%&gt;%</span> </span>
<span id="cb1990-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1990-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Org, <span class="at">y =</span> Pos, <span class="at">fill =</span> m_salary, <span class="at">label =</span> n)) <span class="sc">+</span></span>
<span id="cb1990-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb1990-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="fl">2.75</span>) <span class="sc">+</span></span>
<span id="cb1990-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># everything below this is really just aesthetic flourish</span></span>
<span id="cb1990-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> bd[<span class="dv">9</span>], <span class="at">high =</span> bd[<span class="dv">12</span>],</span>
<span id="cb1990-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">55e3</span>, <span class="fl">15e4</span>, <span class="fl">26e4</span>), </span>
<span id="cb1990-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;$55K&quot;</span>, <span class="st">&quot;$150K&quot;</span>, <span class="st">&quot;$260K&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1990-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;Org&quot;</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1990-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="st">&quot;Pos&quot;</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1990-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1990-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1990-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1990-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1990-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-13-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Hopefully it’s clear that each cell is a unique pairing of <code>Org</code> and <code>Pos</code>. The cells are color coded by the mean <code>Salary</code>. The numbers in the cells give the <span class="math inline">\(n\)</span> cases they represent. When there’s no data for a unique combination of <code>Org</code> and <code>Pos</code>, the cells are left blank charcoal.</p>
<p>Load <strong>brms</strong>.</p>
<div class="sourceCode" id="cb1991"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1991-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1991-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span></code></pre></div>
<p>Define our <code>stanvars</code>.</p>
<div class="sourceCode" id="cb1992"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1992-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1992-1" aria-hidden="true" tabindex="-1"></a>mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(my_data<span class="sc">$</span>Salary)</span>
<span id="cb1992-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1992-2" aria-hidden="true" tabindex="-1"></a>sd_y   <span class="ot">&lt;-</span> <span class="fu">sd</span>(my_data<span class="sc">$</span>Salary)</span>
<span id="cb1992-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1992-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1992-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1992-4" aria-hidden="true" tabindex="-1"></a>omega <span class="ot">&lt;-</span> sd_y <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb1992-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1992-5" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> sd_y</span>
<span id="cb1992-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1992-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1992-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1992-7" aria-hidden="true" tabindex="-1"></a>s_r <span class="ot">&lt;-</span> <span class="fu">gamma_a_b_from_omega_sigma</span>(<span class="at">mode =</span> omega, <span class="at">sd =</span> sigma)</span>
<span id="cb1992-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1992-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1992-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1992-9" aria-hidden="true" tabindex="-1"></a>stanvars <span class="ot">&lt;-</span> </span>
<span id="cb1992-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1992-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(mean_y,    <span class="at">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1992-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1992-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(sd_y,      <span class="at">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb1992-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1992-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>shape, <span class="at">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">+</span></span>
<span id="cb1992-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1992-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>rate,  <span class="at">name =</span> <span class="st">&quot;beta&quot;</span>)</span></code></pre></div>
<p>Now fit the model.</p>
<div class="sourceCode" id="cb1993"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1993-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1993-1" aria-hidden="true" tabindex="-1"></a>fit20<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb1993-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1993-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb1993-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1993-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1993-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1993-4" aria-hidden="true" tabindex="-1"></a>      Salary <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Pos) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Org) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Pos<span class="sc">:</span>Org),</span>
<span id="cb1993-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1993-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1993-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1993-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">gamma</span>(alpha, beta), <span class="at">class =</span> sd),</span>
<span id="cb1993-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1993-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb1993-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1993-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">2000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1993-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1993-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">20</span>,</span>
<span id="cb1993-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1993-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>,</span>
<span id="cb1993-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1993-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">max_treedepth =</span> <span class="dv">13</span>),</span>
<span id="cb1993-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1993-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars,</span>
<span id="cb1993-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1993-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit20.01&quot;</span>)</span></code></pre></div>
<p>The chains look fine.</p>
<div class="sourceCode" id="cb1994"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1994-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1994-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">color_scheme_set</span>(<span class="at">scheme =</span> bd[<span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">11</span><span class="sc">:</span><span class="dv">12</span>)])</span>
<span id="cb1994-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1994-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1994-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1994-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit20<span class="fl">.1</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-16-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Here’s the model summary.</p>
<div class="sourceCode" id="cb1995"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1995-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1995-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit20<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Salary ~ 1 + (1 | Pos) + (1 | Org) + (1 | Pos:Org) 
##    Data: my_data (Number of observations: 1080) 
##   Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
##          total post-warmup draws = 8000
## 
## Group-Level Effects: 
## ~Org (Number of levels: 60) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept) 30652.56   3076.54 25214.54 37332.82 1.00     1626     2793
## 
## ~Pos (Number of levels: 5) 
##               Estimate Est.Error l-95% CI  u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept) 56421.66  26569.30 26666.69 125632.37 1.00     2545     3645
## 
## ~Pos:Org (Number of levels: 216) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)  9688.54   1197.77  7421.22 12108.03 1.00     2426     4739
## 
## Population-Level Effects: 
##            Estimate Est.Error l-95% CI  u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept 126114.36  27044.36 70278.60 180836.82 1.00     2425     3133
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma 17981.56    435.71 17138.37 18837.35 1.00     6201     5865
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>This was a difficult model to fit with <strong>brms</strong>. Stan does well when the criteria are on or close to a standardized metric and these <code>Salary</code> data are a far cry from that. Tuning <code>adapt_delta</code> and <code>max_treedepth</code> went a long way to help the model out.</p>
<p>Okay, let’s get ready for our version of Figure 20.3. First, we’ll use <code>tidybayes::add_epred_draws()</code> to help organize the necessary posterior draws.</p>
<div class="sourceCode" id="cb1997"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1997-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb1997-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1997-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-3" aria-hidden="true" tabindex="-1"></a><span class="co"># how many draws would you like?</span></span>
<span id="cb1997-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-4" aria-hidden="true" tabindex="-1"></a>n_draw <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb1997-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1997-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-6" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb1997-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-7" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb1997-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-8" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1997-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Pos) <span class="sc">%&gt;%</span> </span>
<span id="cb1997-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(Pos, </span>
<span id="cb1997-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">Org =</span> <span class="fu">c</span>(<span class="st">&quot;BFIN&quot;</span>, <span class="st">&quot;CHEM&quot;</span>, <span class="st">&quot;PSY&quot;</span>, <span class="st">&quot;ENG&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1997-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_epred_draws</span>(fit20<span class="fl">.1</span>, <span class="at">ndraws =</span> n_draw, <span class="at">seed =</span> <span class="dv">20</span>,</span>
<span id="cb1997-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">allow_new_levels =</span> T,</span>
<span id="cb1997-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dpar =</span> <span class="fu">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1997-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ll =</span> <span class="fu">qnorm</span>(.<span class="dv">025</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma),</span>
<span id="cb1997-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">ul =</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb1997-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Salary =</span> <span class="fu">map2</span>(ll, ul, seq, <span class="at">length.out =</span> <span class="dv">100</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1997-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(Salary) <span class="sc">%&gt;%</span> </span>
<span id="cb1997-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dnorm</span>(Salary, mu, sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb1997-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.draw) <span class="sc">%&gt;%</span> </span>
<span id="cb1997-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> density <span class="sc">/</span> <span class="fu">max</span>(density)) <span class="sc">%&gt;%</span> </span>
<span id="cb1997-22"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Org =</span> <span class="fu">factor</span>(Org, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;BFIN&quot;</span>, <span class="st">&quot;CHEM&quot;</span>, <span class="st">&quot;PSY&quot;</span>, <span class="st">&quot;ENG&quot;</span>)))</span>
<span id="cb1997-23"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1997-24"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1997-24" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(f)</span></code></pre></div>
<pre><code>## Rows: 40,000
## Columns: 13
## Groups: .draw [20]
## $ Pos        &lt;ord&gt; Assis, Assis, Assis, Assis, Assis, Assis, Assis, Assis, Assis, Assis, Assis, As…
## $ Org        &lt;fct&gt; BFIN, BFIN, BFIN, BFIN, BFIN, BFIN, BFIN, BFIN, BFIN, BFIN, BFIN, BFIN, BFIN, B…
## $ .row       &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ .chain     &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
## $ .iteration &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
## $ .draw      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ .epred     &lt;dbl&gt; 191748.1, 191748.1, 191748.1, 191748.1, 191748.1, 191748.1, 191748.1, 191748.1,…
## $ mu         &lt;dbl&gt; 191748.1, 191748.1, 191748.1, 191748.1, 191748.1, 191748.1, 191748.1, 191748.1,…
## $ sigma      &lt;dbl&gt; 18067.46, 18067.46, 18067.46, 18067.46, 18067.46, 18067.46, 18067.46, 18067.46,…
## $ ll         &lt;dbl&gt; 156336.5, 156336.5, 156336.5, 156336.5, 156336.5, 156336.5, 156336.5, 156336.5,…
## $ ul         &lt;dbl&gt; 227159.7, 227159.7, 227159.7, 227159.7, 227159.7, 227159.7, 227159.7, 227159.7,…
## $ Salary     &lt;dbl&gt; 156336.5, 157051.9, 157767.3, 158482.7, 159198.1, 159913.5, 160628.9, 161344.2,…
## $ density    &lt;dbl&gt; 0.1465288, 0.1582290, 0.1705958, 0.1836410, 0.1973740, 0.2118018, 0.2269281, 0.…</code></pre>
<p>We’re ready to plot.</p>
<div class="sourceCode" id="cb1999"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1999-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb1999-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1999-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-3" aria-hidden="true" tabindex="-1"></a>f <span class="sc">%&gt;%</span> </span>
<span id="cb1999-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Salary, <span class="at">y =</span> Pos)) <span class="sc">+</span></span>
<span id="cb1999-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">fixef</span>(fit20<span class="fl">.1</span>)[, <span class="dv">1</span>], <span class="at">color =</span> bd[<span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb1999-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ridgeline</span>(<span class="fu">aes</span>(<span class="at">height =</span> density, <span class="at">group =</span> <span class="fu">interaction</span>(Pos, .draw),</span>
<span id="cb1999-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> Pos),</span>
<span id="cb1999-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">show.legend =</span> F,</span>
<span id="cb1999-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">scale =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1999-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> my_data <span class="sc">%&gt;%</span> </span>
<span id="cb1999-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Org <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;BFIN&quot;</span>, <span class="st">&quot;CHEM&quot;</span>, <span class="st">&quot;PSY&quot;</span>, <span class="st">&quot;ENG&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1999-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">Org =</span> <span class="fu">factor</span>(Org, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;BFIN&quot;</span>, <span class="st">&quot;CHEM&quot;</span>, <span class="st">&quot;PSY&quot;</span>, <span class="st">&quot;ENG&quot;</span>))),</span>
<span id="cb1999-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">height =</span> .<span class="dv">025</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">size =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">color =</span> bd[<span class="dv">11</span>]) <span class="sc">+</span></span>
<span id="cb1999-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> bd[<span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">3</span>)]) <span class="sc">+</span></span>
<span id="cb1999-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">300000</span>, <span class="at">length.out =</span> <span class="dv">4</span>),</span>
<span id="cb1999-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;$0&quot;</span>, <span class="st">&quot;$100K&quot;</span>, <span class="st">&quot;200K&quot;</span>, <span class="st">&quot;$300K&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1999-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">35e4</span>),</span>
<span id="cb1999-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.25</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb1999-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Data with Posterior Predictive Distributions&quot;</span>, </span>
<span id="cb1999-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;The white vertical line is the model-implied grand mean.&quot;</span>,</span>
<span id="cb1999-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Pos&quot;</span>) <span class="sc">+</span></span>
<span id="cb1999-22"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1999-23"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb1999-24"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb1999-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Org, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-19-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The <strong>brms</strong> package doesn’t have a convenience function that returns output quite like what Kruschke displayed in his Table 20.2. But we can get close. The <code>posterior_summary()</code> will return posterior means, <span class="math inline">\(\textit{SD}\)</span>s, and percentile-based 95% intervals for all model parameters. Due to space concerns, I’ll just show the first ten lines.</p>
<div class="sourceCode" id="cb2000"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2000-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2000-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit20<span class="fl">.1</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span></code></pre></div>
<pre><code>##                         Estimate  Est.Error       Q2.5      Q97.5
## b_Intercept           126114.356 27044.3618  70278.603 180836.818
## sd_Org__Intercept      30652.564  3076.5357  25214.535  37332.825
## sd_Pos__Intercept      56421.662 26569.3026  26666.692 125632.368
## sd_Pos:Org__Intercept   9688.537  1197.7705   7421.223  12108.029
## sigma                  17981.559   435.7087  17138.368  18837.352
## r_Org[ACTG,Intercept]  80561.579  7593.5101  65644.819  95444.294
## r_Org[AFRO,Intercept] -14967.759  9681.3929 -34019.522   3944.769
## r_Org[AMST,Intercept] -16263.028 10147.5361 -36024.080   3939.405
## r_Org[ANTH,Intercept] -18562.858  7784.4292 -33771.714  -3096.282
## r_Org[APHS,Intercept]   3207.660  7957.3468 -12288.543  18766.078</code></pre>
<p>The <code>summarise_draws()</code> function from the <strong>posterior</strong> package <span class="citation">(<a href="#ref-R-posterior" role="doc-biblioref">Bürkner et al., 2021</a>)</span>, however, will take us a long ways towards making Table 20.2.</p>
<div class="sourceCode" id="cb2002"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2002-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2002-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb2002-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2002-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2002-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2002-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit20<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2002-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2002-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(b_Intercept, </span>
<span id="cb2002-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2002-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">starts_with</span>(<span class="st">&quot;r_Pos[&quot;</span>),</span>
<span id="cb2002-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2002-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">r_Org[ENG,Intercept]</span><span class="st">`</span>,</span>
<span id="cb2002-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2002-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">r_Org[PSY,Intercept]</span><span class="st">`</span>,</span>
<span id="cb2002-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2002-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">r_Org[CHEM,Intercept]</span><span class="st">`</span>,</span>
<span id="cb2002-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2002-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">r_Org[BFIN,Intercept]</span><span class="st">`</span>,</span>
<span id="cb2002-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2002-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">r_Pos:Org[Assis_PSY,Intercept]</span><span class="st">`</span>,</span>
<span id="cb2002-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2002-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">r_Pos:Org[Full_PSY,Intercept]</span><span class="st">`</span>,</span>
<span id="cb2002-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2002-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">r_Pos:Org[Assis_CHEM,Intercept]</span><span class="st">`</span>,</span>
<span id="cb2002-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2002-13" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">r_Pos:Org[Full_CHEM,Intercept]</span><span class="st">`</span>,</span>
<span id="cb2002-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2002-14" aria-hidden="true" tabindex="-1"></a>         sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb2002-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2002-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_draws</span>(mean, median, <span class="at">mode =</span> Mode, ess_bulk, ess_tail, <span class="sc">~</span> <span class="fu">quantile</span>(.x, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb2002-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2002-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## # A tibble: 15 × 8
##    variable                          mean median   mode ess_bulk ess_tail `2.5%` `97.5%`
##    &lt;chr&gt;                            &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1 b_Intercept                     126114 126147 123804     2400     3092  70279  180837
##  2 r_Pos[Assis,Intercept]          -45535 -45278 -43009     2497     3056 -99854    8979
##  3 r_Pos[Assoc,Intercept]          -32184 -32191 -31484     2491     3074 -86752   23303
##  4 r_Pos[Full,Intercept]            -2298  -2199   -838     2500     3092 -56764   53355
##  5 r_Pos[Endow,Intercept]           27809  27705  26852     2494     3106 -26850   83306
##  6 r_Pos[Disting,Intercept]         56395  56228  56547     2556     3207   1664  113164
##  7 r_Org[ENG,Intercept]            -18712 -18774 -19711     1439     3113 -32563   -4655
##  8 r_Org[PSY,Intercept]              6618   6617   6947     1216     2574  -6078   19895
##  9 r_Org[CHEM,Intercept]            18937  18884  17139     1371     2529   5266   32180
## 10 r_Org[BFIN,Intercept]           107306 107297 106996     1724     4125  92515  122262
## 11 r_Pos:Org[Assis_PSY,Intercept]   -3190  -3183  -3284     7648     6415 -17128   10004
## 12 r_Pos:Org[Full_PSY,Intercept]   -14945 -14797 -14825     5972     6236 -27430   -3039
## 13 r_Pos:Org[Assis_CHEM,Intercept] -12482 -12375 -12044     6820     6783 -25560     101
## 14 r_Pos:Org[Full_CHEM,Intercept]   13267  13211  12786     6850     5668    441   26096
## 15 sigma                            17982  17973  17996     6091     5725  17138   18837</code></pre>
<p>Note how we’ve used by kinds of effective-sample size estimates available for <strong>brms</strong> and note that we’ve used percentile-based intervals.</p>
<p>As Kruschke then pointed out, “individual salaries vary tremendously around the predicted cell mean” (p. 594), which you can quantify using <span class="math inline">\(\sigma_y\)</span>. Here it is using <code>posterior_summary()</code>.</p>
<div class="sourceCode" id="cb2004"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2004-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2004-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit20<span class="fl">.1</span>)[<span class="st">&quot;sigma&quot;</span>, ]</span></code></pre></div>
<pre><code>##   Estimate  Est.Error       Q2.5      Q97.5 
## 17981.5593   435.7087 17138.3682 18837.3524</code></pre>
<p>And we can get a better sense of the distribution with a dot plot.</p>
<div class="sourceCode" id="cb2006"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2006-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2006-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the posterior draws</span></span>
<span id="cb2006-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2006-2" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit20<span class="fl">.1</span>)</span>
<span id="cb2006-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2006-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2006-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2006-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb2006-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2006-5" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span></span>
<span id="cb2006-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2006-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sigma, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2006-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2006-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>, </span>
<span id="cb2006-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2006-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.04</span>,</span>
<span id="cb2006-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2006-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">stroke =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">point_size =</span> <span class="dv">3</span>, <span class="at">slab_size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>,</span>
<span id="cb2006-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2006-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> bd[<span class="dv">2</span>], <span class="at">point_color =</span> bd[<span class="dv">1</span>], <span class="at">slab_color =</span> bd[<span class="dv">1</span>],</span>
<span id="cb2006-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2006-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">point_fill =</span> bd[<span class="dv">2</span>], <span class="at">slab_fill =</span> bd[<span class="dv">6</span>], </span>
<span id="cb2006-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2006-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">quantiles =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb2006-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2006-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2006-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2006-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(sigma[y]))</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-23-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>As Kruschke pointed out, this parameter is held constant across all subgroups. That is, the subgroups are homogeneous with respect to their variances. We’ll relax this constraint later on.</p>
<p>Before we move on to the next section, look above at how many arguments we fiddled with to configure <code>stat_dotsinterval()</code>. Given how many more dot plots we have looming in our not-too-distant future, we might go ahead and save these settings as a new function. We’ll call it <code>stat_beedrill()</code>.</p>
<div class="sourceCode" id="cb2007"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2007-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2007-1" aria-hidden="true" tabindex="-1"></a>stat_beedrill <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">point_size =</span> <span class="dv">3</span>, </span>
<span id="cb2007-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2007-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">slab_color =</span> bd[<span class="dv">1</span>],</span>
<span id="cb2007-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2007-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">quantiles =</span> <span class="dv">100</span>, ...) {</span>
<span id="cb2007-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2007-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2007-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2007-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>, </span>
<span id="cb2007-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2007-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">stroke =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, </span>
<span id="cb2007-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2007-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">point_size =</span> point_size, <span class="at">slab_size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>,</span>
<span id="cb2007-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2007-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> bd[<span class="dv">2</span>], </span>
<span id="cb2007-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2007-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">point_color =</span> bd[<span class="dv">1</span>], <span class="at">point_fill =</span> bd[<span class="dv">2</span>],</span>
<span id="cb2007-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2007-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">slab_color =</span> slab_color, <span class="at">slab_fill =</span> bd[<span class="dv">6</span>], </span>
<span id="cb2007-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2007-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">quantiles =</span> quantiles,</span>
<span id="cb2007-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2007-12" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># learn more about this at https://github.com/mjskay/ggdist/issues/93</span></span>
<span id="cb2007-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2007-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.04</span>,</span>
<span id="cb2007-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2007-14" aria-hidden="true" tabindex="-1"></a>                    ...)</span>
<span id="cb2007-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2007-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Note how we hard coded the settings for some of the parameters within the function (e.g., <code>point_interval</code>) but allows others to be adjustable with new default settings (e.g., <code>point_size</code>).</p>
</div>
<div id="main-effect-contrasts." class="section level3 hasAnchor" number="20.2.3">
<h3><span class="header-section-number">20.2.3</span> Main effect contrasts.<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#main-effect-contrasts." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>In applications with multiple levels of the factors, it is virtually always the case that we are interested in comparing particular levels with each other…. These sorts of comparisons, which involve levels of a single factor and collapse across the other factor(s), are called main effect comparisons or contrasts.(p. 595)</p>
</blockquote>
<p>The <code>fitted()</code> function provides a versatile framework for contrasts among the main effects. In order to follow Kruschke’s aim to compare “levels of a single factor and collapse across the other factor(s)” when those factors are modeled in a hierarchical structure, one will have to make use of the <code>re_formula</code> argument within <code>fitted()</code>. Here’s how to do that for the first contrast.</p>
<div class="sourceCode" id="cb2008"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2008-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the new data</span></span>
<span id="cb2008-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-2" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Pos =</span> <span class="fu">c</span>(<span class="st">&quot;Assis&quot;</span>, <span class="st">&quot;Assoc&quot;</span>))</span>
<span id="cb2008-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2008-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-4" aria-hidden="true" tabindex="-1"></a><span class="co"># feed the new data into `fitted()`</span></span>
<span id="cb2008-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-5" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb2008-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(fit20<span class="fl">.1</span>,</span>
<span id="cb2008-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> nd,</span>
<span id="cb2008-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-8" aria-hidden="true" tabindex="-1"></a>         <span class="co"># this part is crucial</span></span>
<span id="cb2008-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> Pos),</span>
<span id="cb2008-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb2008-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2008-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="st">&quot;Assis&quot;</span>, <span class="st">&quot;Assoc&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2008-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Assoc vs Assis</span><span class="st">`</span> <span class="ot">=</span> Assoc <span class="sc">-</span> Assis)</span>
<span id="cb2008-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2008-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb2008-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-16" aria-hidden="true" tabindex="-1"></a>f <span class="sc">%&gt;%</span> </span>
<span id="cb2008-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Assoc vs Assis</span><span class="st">`</span>, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2008-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_beedrill</span>() <span class="sc">+</span></span>
<span id="cb2008-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2008-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb2008-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Assoc vs Assis&quot;</span>,</span>
<span id="cb2008-22"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2008-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Difference&quot;</span>)</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-25-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>In case you were curious, here are the summary statistics.</p>
<div class="sourceCode" id="cb2009"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2009-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2009-1" aria-hidden="true" tabindex="-1"></a>f <span class="sc">%&gt;%</span> </span>
<span id="cb2009-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2009-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mode_hdi</span>(<span class="st">`</span><span class="at">Assoc vs Assis</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2009-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2009-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Assoc vs Assis</span><span class="st">`</span><span class="sc">:</span>.upper) <span class="sc">%&gt;%</span> </span>
<span id="cb2009-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2009-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   `Assoc vs Assis` .lower .upper
##              &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1            13541   8424  17975</code></pre>
<p>Now make the next two contrasts.</p>
<div class="sourceCode" id="cb2011"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2011-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Org =</span> <span class="fu">c</span>(<span class="st">&quot;BFIN&quot;</span>, <span class="st">&quot;CHEM&quot;</span>, <span class="st">&quot;ENG&quot;</span>, <span class="st">&quot;PSY&quot;</span>))</span>
<span id="cb2011-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2011-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb2011-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(fit20<span class="fl">.1</span>,</span>
<span id="cb2011-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> nd,</span>
<span id="cb2011-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-6" aria-hidden="true" tabindex="-1"></a>         <span class="co"># note the change from above</span></span>
<span id="cb2011-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> Org),</span>
<span id="cb2011-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb2011-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2011-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">pull</span>(nd, Org)) <span class="sc">%&gt;%</span> </span>
<span id="cb2011-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="st">`</span><span class="at">CHEM vs PSY</span><span class="st">`</span>     <span class="ot">=</span> CHEM <span class="sc">-</span> PSY,</span>
<span id="cb2011-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">BFIN vs other 3</span><span class="st">`</span> <span class="ot">=</span> BFIN <span class="sc">-</span> ((CHEM <span class="sc">+</span> ENG <span class="sc">+</span> PSY) <span class="sc">/</span> <span class="dv">3</span>))</span>
<span id="cb2011-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2011-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-14" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb2011-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-15" aria-hidden="true" tabindex="-1"></a>f <span class="sc">%&gt;%</span> </span>
<span id="cb2011-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2011-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2011-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2011-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_beedrill</span>() <span class="sc">+</span></span>
<span id="cb2011-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2011-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Difference&quot;</span>) <span class="sc">+</span></span>
<span id="cb2011-22"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2011-23"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2011-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-27-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>And here are their numeric summaries.</p>
<div class="sourceCode" id="cb2012"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2012-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2012-1" aria-hidden="true" tabindex="-1"></a>f <span class="sc">%&gt;%</span> </span>
<span id="cb2012-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2012-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb2012-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2012-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;contrast&quot;</span>, </span>
<span id="cb2012-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2012-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;mode&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2012-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2012-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb2012-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2012-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mode_hdi</span>(mode) <span class="sc">%&gt;%</span> </span>
<span id="cb2012-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2012-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast<span class="sc">:</span>.upper) <span class="sc">%&gt;%</span> </span>
<span id="cb2012-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2012-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   contrast          mode .lower .upper
##   &lt;chr&gt;            &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 BFIN vs other 3 103597  90783 118831
## 2 CHEM vs PSY      12808  -2335  26865</code></pre>
<p>For more on marginal contrasts in <strong>brms</strong>, see the discussion in <a href="(https://github.com/paul-buerkner/brms/issues/552)">issue #552</a> in the <strong>brms</strong> GitHub repo and <a href="https://discourse.mc-stan.org/t/how-do-i-get-marginal-effects-for-categorical-variables-to-condition-on-an-average-rather-than-a-category/5323">this discussion thread</a> on the Stan forums.</p>
</div>
<div id="interaction-contrasts-and-simple-effects." class="section level3 hasAnchor" number="20.2.4">
<h3><span class="header-section-number">20.2.4</span> Interaction contrasts and simple effects.<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction-contrasts-and-simple-effects." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If we’d like to make the simple effects and interaction contrasts like Kruschke displayed in Figure 20.5 within our <strong>tidyverse</strong>/<strong>brms</strong> paradigm, it’ll be simplest to just redefine our <code>nd</code> data and use <code>fitted()</code>, again. This time, however, we won’t be using the <code>re_formula</code> argument.</p>
<div class="sourceCode" id="cb2014"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2014-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define our new data</span></span>
<span id="cb2014-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-2" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span></span>
<span id="cb2014-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">Pos =</span> <span class="fu">c</span>(<span class="st">&quot;Assis&quot;</span>, <span class="st">&quot;Full&quot;</span>),</span>
<span id="cb2014-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">Org =</span> <span class="fu">c</span>(<span class="st">&quot;CHEM&quot;</span>, <span class="st">&quot;PSY&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2014-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we&#39;ll need to update our column names</span></span>
<span id="cb2014-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col_names =</span> <span class="fu">str_c</span>(Pos, <span class="st">&quot;_&quot;</span>, Org))</span>
<span id="cb2014-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2014-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-8" aria-hidden="true" tabindex="-1"></a><span class="co"># get the draws with `fitted()`</span></span>
<span id="cb2014-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-9" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span></span>
<span id="cb2014-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(fit20<span class="fl">.1</span>, </span>
<span id="cb2014-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> nd,</span>
<span id="cb2014-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb2014-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># wrangle</span></span>
<span id="cb2014-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2014-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(nd <span class="sc">%&gt;%</span> <span class="fu">pull</span>(col_names)) <span class="sc">%&gt;%</span> </span>
<span id="cb2014-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Full - Assis @ PSY</span><span class="st">`</span>  <span class="ot">=</span> Full_PSY <span class="sc">-</span> Assis_PSY,</span>
<span id="cb2014-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Full - Assis @ CHEM</span><span class="st">`</span> <span class="ot">=</span> Full_CHEM <span class="sc">-</span> Assis_CHEM) <span class="sc">%&gt;%</span> </span>
<span id="cb2014-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Full.v.Assis</span><span class="sc">\n</span><span class="at">(x)</span><span class="sc">\n</span><span class="at">CHEM.v.PSY</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Full - Assis @ CHEM</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Full - Assis @ PSY</span><span class="st">`</span>)</span>
<span id="cb2014-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2014-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-20" aria-hidden="true" tabindex="-1"></a><span class="co"># what have we done?</span></span>
<span id="cb2014-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2014-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(f1)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
##   Assis_CHEM Assis_PSY Full_CHEM Full_PSY `Full - Assis @ PSY` `Full - Assis @ CH…` `Full.v.Assis\…`
##        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;                &lt;dbl&gt;                &lt;dbl&gt;            &lt;dbl&gt;
## 1     87493.    88399.   155861.  121368.               32969.               68368.           35399.
## 2     83595.    87960.   156152.  116363.               28403.               72558.           44155.
## 3     87712.    81965.   150321.  117377.               35412.               62609.           27197.
## 4     86297.    90932.   162834.  111897.               20966.               76538.           55572.
## 5     84765.    78174.   151399.  119107.               40933.               66634.           25701.
## 6     86740.    74535.   151253.  109501.               34966.               64513.           29548.</code></pre>
<p>It’ll take just a tiny bit more wrangling before we’re ready to plot.</p>
<div class="sourceCode" id="cb2016"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2016-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save the levels</span></span>
<span id="cb2016-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-2" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Full - Assis @ PSY&quot;</span>, <span class="st">&quot;Full - Assis @ CHEM&quot;</span>, <span class="st">&quot;Full.v.Assis</span><span class="sc">\n</span><span class="st">(x)</span><span class="sc">\n</span><span class="st">CHEM.v.PSY&quot;</span>)</span>
<span id="cb2016-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2016-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rope annotation</span></span>
<span id="cb2016-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-5" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb2016-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">name  =</span> <span class="st">&quot;Full - Assis @ PSY&quot;</span>,</span>
<span id="cb2016-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">value =</span> <span class="dv">15500</span>,</span>
<span id="cb2016-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> .<span class="dv">95</span>,</span>
<span id="cb2016-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;ROPE&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2016-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> levels))</span>
<span id="cb2016-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2016-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-12" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb2016-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-13" aria-hidden="true" tabindex="-1"></a>f1 <span class="sc">%&gt;%</span> </span>
<span id="cb2016-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2016-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb2016-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2016-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb2016-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2016-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for kicks and giggles we&#39;ll throw in the ROPE</span></span>
<span id="cb2016-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="fl">1e3</span>, <span class="at">xmax =</span> <span class="fl">1e3</span>,</span>
<span id="cb2016-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb2016-22"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">fill =</span> bd[<span class="dv">7</span>]) <span class="sc">+</span></span>
<span id="cb2016-23"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_beedrill</span>() <span class="sc">+</span></span>
<span id="cb2016-24"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb2016-25"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-25" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">label =</span> label),</span>
<span id="cb2016-26"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> bd[<span class="dv">7</span>], <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb2016-27"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2016-28"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Difference&quot;</span>) <span class="sc">+</span></span>
<span id="cb2016-29"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2016-30"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2016-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-30-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>If it was really important that the labels in the <span class="math inline">\(x\)</span>-axes were different, like they are in Kruschke’s Figure 20.5, you could always make the three plots separately and then bind them together with <strong>patchwork</strong> syntax.</p>
<p>Though he didn’t show the results, on page 598 Kruschke mentioned a few other contrasts we might consider. The example entailed comparing the differences within <code>BFIN</code> to the average of the other three. Let’s walk that out.</p>
<div class="sourceCode" id="cb2017"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2017-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define our new data</span></span>
<span id="cb2017-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-2" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span></span>
<span id="cb2017-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">Pos =</span> <span class="fu">c</span>(<span class="st">&quot;Assis&quot;</span>, <span class="st">&quot;Full&quot;</span>),</span>
<span id="cb2017-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">Org =</span> <span class="fu">c</span>(<span class="st">&quot;BFIN&quot;</span>, <span class="st">&quot;CHEM&quot;</span>, <span class="st">&quot;ENG&quot;</span>, <span class="st">&quot;PSY&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2017-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we&#39;ll need to update our column names</span></span>
<span id="cb2017-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col_names =</span> <span class="fu">str_c</span>(Pos, <span class="st">&quot;_&quot;</span>, Org))</span>
<span id="cb2017-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2017-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-8" aria-hidden="true" tabindex="-1"></a><span class="co"># get the draws with `fitted()`</span></span>
<span id="cb2017-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-9" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span></span>
<span id="cb2017-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(fit20<span class="fl">.1</span>, </span>
<span id="cb2017-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> nd,</span>
<span id="cb2017-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb2017-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># wrangle</span></span>
<span id="cb2017-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2017-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(nd <span class="sc">%&gt;%</span> <span class="fu">pull</span>(col_names)) <span class="sc">%&gt;%</span> </span>
<span id="cb2017-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Full - Assis @ BFIN</span><span class="st">`</span> <span class="ot">=</span> Full_BFIN <span class="sc">-</span> Assis_BFIN,</span>
<span id="cb2017-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Full - Assis @ CHEM</span><span class="st">`</span> <span class="ot">=</span> Full_CHEM <span class="sc">-</span> Assis_CHEM,</span>
<span id="cb2017-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Full - Assis @ ENG</span><span class="st">`</span>  <span class="ot">=</span> Full_ENG <span class="sc">-</span> Assis_ENG,</span>
<span id="cb2017-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-19" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Full - Assis @ PSY</span><span class="st">`</span>  <span class="ot">=</span> Full_PSY <span class="sc">-</span> Assis_PSY) <span class="sc">%&gt;%</span> </span>
<span id="cb2017-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Full.v.Assis</span><span class="sc">\n</span><span class="at">(x)</span><span class="sc">\n</span><span class="at">BFIN.v.the rest</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Full - Assis @ BFIN</span><span class="st">`</span> <span class="sc">-</span> (<span class="st">`</span><span class="at">Full - Assis @ CHEM</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Full - Assis @ ENG</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Full - Assis @ PSY</span><span class="st">`</span>) <span class="sc">/</span> <span class="dv">3</span>)</span>
<span id="cb2017-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2017-22"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-22" aria-hidden="true" tabindex="-1"></a><span class="co"># what have we done?</span></span>
<span id="cb2017-23"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2017-23" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(f2)</span></code></pre></div>
<pre><code>## Rows: 8,000
## Columns: 13
## $ Assis_BFIN                           &lt;dbl&gt; 200469.4, 191873.4, 198335.4, 191613.8, 195909.4, 206…
## $ Assis_CHEM                           &lt;dbl&gt; 87493.04, 83594.72, 87712.43, 86296.59, 84764.91, 867…
## $ Assis_ENG                            &lt;dbl&gt; 57860.04, 57409.70, 59502.40, 73364.35, 49609.69, 591…
## $ Assis_PSY                            &lt;dbl&gt; 88399.37, 87959.67, 81965.11, 90931.63, 78174.34, 745…
## $ Full_BFIN                            &lt;dbl&gt; 233435.4, 228240.2, 229553.3, 237348.6, 226177.0, 240…
## $ Full_CHEM                            &lt;dbl&gt; 155861.1, 156152.5, 150321.2, 162834.4, 151398.6, 151…
## $ Full_ENG                             &lt;dbl&gt; 104843.2, 103208.0, 107112.6, 109459.4, 105296.2, 116…
## $ Full_PSY                             &lt;dbl&gt; 121368.0, 116362.9, 117377.3, 111897.5, 119107.5, 109…
## $ `Full - Assis @ BFIN`                &lt;dbl&gt; 32966.06, 36366.78, 31217.95, 45734.81, 30267.68, 344…
## $ `Full - Assis @ CHEM`                &lt;dbl&gt; 68368.06, 72557.77, 62608.79, 76537.77, 66633.65, 645…
## $ `Full - Assis @ ENG`                 &lt;dbl&gt; 46983.13, 45798.29, 47610.24, 36095.04, 55686.55, 576…
## $ `Full - Assis @ PSY`                 &lt;dbl&gt; 32968.64, 28403.20, 35412.15, 20965.84, 40933.12, 349…
## $ `Full.v.Assis\n(x)\nBFIN.v.the rest` &lt;dbl&gt; -16473.8876, -12552.9692, -17325.7805, 1201.9276, -24…</code></pre>
<p>Now plot.</p>
<div class="sourceCode" id="cb2019"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2019-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2019-1" aria-hidden="true" tabindex="-1"></a>f2 <span class="sc">%&gt;%</span> </span>
<span id="cb2019-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2019-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2019-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2019-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2019-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2019-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2019-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2019-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="fl">1e3</span>, <span class="at">xmax =</span> <span class="fl">1e3</span>,</span>
<span id="cb2019-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2019-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb2019-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2019-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">fill =</span> bd[<span class="dv">7</span>]) <span class="sc">+</span></span>
<span id="cb2019-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2019-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_beedrill</span>() <span class="sc">+</span></span>
<span id="cb2019-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2019-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2019-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2019-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Difference&quot;</span>) <span class="sc">+</span></span>
<span id="cb2019-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2019-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2019-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2019-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-32-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>So while the overall pay averages for those in <code>BFIN</code> were larger than those in the other three departments, the differences between full and associate professors within <code>BFIN</code> wasn’t substantially different from the differences within the other three departments. To be sure, the interquartile range of that last difference distribution fell below both zero and the ROPE, but there’s still a lot of spread in the rest of the distribution.</p>
<div id="interaction-effects-high-uncertainty-and-shrinkage." class="section level4 hasAnchor" number="20.2.4.1">
<h4><span class="header-section-number">20.2.4.1</span> Interaction effects: High uncertainty and shrinkage.<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction-effects-high-uncertainty-and-shrinkage." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>“It is important to realize that the estimates of interaction contrasts are typically much more uncertain than the estimates of simple effects or main effects” (p. 598).</p>
<p>If we start with our <code>fitted()</code> object <code>f1</code>, we can wrangle a bit, compute the HDIs with <code>tidybayes::mode_hdi()</code> and then use simple subtraction to compute the interval range for each difference.</p>
<div class="sourceCode" id="cb2020"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2020-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2020-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="sc">%&gt;%</span> </span>
<span id="cb2020-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2020-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2020-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2020-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Full - Assis @ PSY&quot;</span>, <span class="st">&quot;Full - Assis @ CHEM&quot;</span>, <span class="st">&quot;Full.v.Assis</span><span class="sc">\n</span><span class="st">(x)</span><span class="sc">\n</span><span class="st">CHEM.v.PSY&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb2020-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2020-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb2020-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2020-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mode_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb2020-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2020-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name<span class="sc">:</span>.upper) <span class="sc">%&gt;%</span> </span>
<span id="cb2020-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2020-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">interval range</span><span class="st">`</span> <span class="ot">=</span> .upper <span class="sc">-</span> .lower)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##   name                             value .lower .upper `interval range`
##   &lt;fct&gt;                            &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;            &lt;dbl&gt;
## 1 &quot;Full - Assis @ PSY&quot;            29981. 17898. 45915.           28018.
## 2 &quot;Full - Assis @ CHEM&quot;           68436. 54681. 82383.           27702.
## 3 &quot;Full.v.Assis\n(x)\nCHEM.v.PSY&quot; 35847. 17241. 56792.           39551.</code></pre>
<p>Just like Kruschke pointed out in the text, the interval for the interaction estimate was quite larger than the intervals for the simple contrasts.</p>
<blockquote>
<p>This large uncertainty of an interaction contrast is caused by the fact that it involves at least four sources of uncertainty (i.e., at least four groups of data), unlike its component simple effects which each involve only half of those sources of uncertainty. In general, interaction contrasts require a lot of data to estimate accurately. (p. 598)</p>
</blockquote>
<p>Gelman has blogged on this, a bit (e.g., <a href="https://andrewgelman.com/2018/03/15/need-16-times-sample-size-estimate-interaction-estimate-main-effect/"><em>You need 16 times the sample size to estimate an interaction than to estimate a main effect</em></a>).</p>
<p>There is also shrinkage.</p>
<blockquote>
<p>The interaction contrasts also can experience notable shrinkage from the hierarchical model. In the present application, for example, there are <span class="math inline">\(300\)</span> interaction deflections (<span class="math inline">\(5\)</span> levels of seniority times <span class="math inline">\(60\)</span> departments) that are assumed to come from a higher-level distribution that has an estimated standard deviation, denoted <span class="math inline">\(\sigma_{\beta 1 \times 2}\)</span> in Figure 20.2. Chances are that most of the <span class="math inline">\(300\)</span> interaction deflections will be small, and therefore the estimated standard deviation of the interaction deflections will be small, and therefore the estimated deflections themselves will be shrunken toward zero. This shrinkage is inherently neither good nor bad; it is simply the correct consequence of the model assumptions. The shrinkage can be good insofar as it mitigates false alarms about interactions, but the shrinkage can be bad if it inappropriately obscures meaningful interactions. (p. 598)</p>
</blockquote>
<p>Here’s that <span class="math inline">\(\sigma_{\beta_{1 \times 2}}\)</span>.</p>
<div class="sourceCode" id="cb2022"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2022-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2022-1" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb2022-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2022-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">sd_Pos:Org__Intercept</span><span class="st">`</span>, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2022-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2022-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_beedrill</span>() <span class="sc">+</span></span>
<span id="cb2022-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2022-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(sigma[beta[<span class="dv">1</span><span class="sc">%*%</span><span class="dv">2</span>]])) <span class="sc">+</span></span>
<span id="cb2022-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2022-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-34-1.png" width="360" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="rescaling-can-change-interactions-homogeneity-and-normality" class="section level2 hasAnchor" number="20.3">
<h2><span class="header-section-number">20.3</span> Rescaling can change interactions, homogeneity, and normality<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#rescaling-can-change-interactions-homogeneity-and-normality" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>When interpreting interactions, it can be important to consider the scale on which the data are measured. This is because an interaction means non-additive effects when measured on the current scale. If the data are nonlinearly transformed to a different scale, then the non-additivity can also change. (p. 599)</p>
</blockquote>
<p>Here is Kruschke’s initial example of a possible interaction effect of sex and political party with respect to wages.</p>
<div class="sourceCode" id="cb2023"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2023-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2023-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb2023-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2023-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">monetary_units =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">18</span>),</span>
<span id="cb2023-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2023-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">politics       =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;democrat&quot;</span>, <span class="st">&quot;republican&quot;</span>), <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb2023-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2023-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">sex            =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;women&quot;</span>, <span class="st">&quot;men&quot;</span>), <span class="at">times =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2023-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2023-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_number =</span> <span class="fu">if_else</span>(sex <span class="sc">==</span> <span class="st">&quot;women&quot;</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb2023-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2023-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">politics   =</span> <span class="fu">factor</span>(politics, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;republican&quot;</span>, <span class="st">&quot;democrat&quot;</span>)))</span>
<span id="cb2023-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2023-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2023-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2023-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2023-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2023-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sex_number, <span class="at">y =</span> monetary_units, <span class="at">color =</span> politics)) <span class="sc">+</span></span>
<span id="cb2023-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2023-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb2023-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2023-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="cn">NULL</span>, <span class="at">values =</span> bd[<span class="dv">8</span><span class="sc">:</span><span class="dv">7</span>]) <span class="sc">+</span></span>
<span id="cb2023-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2023-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;sex&quot;</span>, <span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;women&quot;</span>, <span class="st">&quot;men&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2023-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2023-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb2023-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2023-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">15</span>))</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-35-1.png" width="312" style="display: block; margin: auto;" /></p>
<p>Because the pay discrepancy between men and women is not equal between Democrats and Republicans, in this example, it can be tempting to claim there is a subtle interaction. Not necessarily so.</p>
<div class="sourceCode" id="cb2024"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2024-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2024-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">politics      =</span> <span class="fu">c</span>(<span class="st">&quot;democrat&quot;</span>, <span class="st">&quot;republican&quot;</span>),</span>
<span id="cb2024-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2024-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">female_salary =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2024-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2024-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">male_salary =</span> <span class="fl">1.2</span> <span class="sc">*</span> female_salary)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   politics   female_salary male_salary
##   &lt;chr&gt;              &lt;dbl&gt;       &lt;dbl&gt;
## 1 democrat              10          12
## 2 republican            15          18</code></pre>
<p>If we take female salary as the baseline and then add 20% to it for the men, the salary difference between Republican men and women will be larger than that between Democratic men and women. Even though the rate increase from women to men was the same, the increase in absolute value was greater within Republicans because Republican women made more than Democratic women.</p>
<p>Look what happens to our original plot when we transform <code>monetary_units</code> with <code>log10()</code>.</p>
<div class="sourceCode" id="cb2026"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2026-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2026-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2026-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2026-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sex_number, <span class="at">y =</span> <span class="fu">log10</span>(monetary_units), <span class="at">color =</span> politics)) <span class="sc">+</span></span>
<span id="cb2026-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2026-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb2026-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2026-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="cn">NULL</span>, <span class="at">values =</span> bd[<span class="dv">8</span><span class="sc">:</span><span class="dv">7</span>]) <span class="sc">+</span></span>
<span id="cb2026-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2026-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;sex&quot;</span>, <span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;women&quot;</span>, <span class="st">&quot;men&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2026-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2026-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">4</span>))</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-37-1.png" width="312" style="display: block; margin: auto;" /></p>
<p>“Equal ratios are transformed to equal distances by a logarithmic transformation” (p. 599).</p>
<p>We can get a better sense of this with our version of Figure 20.6. Probably the easiest way to inset the offset labels will be with help from the <code>geom_dl()</code> function from the <a href="https://CRAN.R-project.org/package=directlabels"><strong>directlabels</strong> package</a> <span class="citation">(<a href="#ref-R-directlabels" role="doc-biblioref">Hocking, 2021</a>)</span>.</p>
<div class="sourceCode" id="cb2027"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2027-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(directlabels)</span>
<span id="cb2027-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2027-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-3" aria-hidden="true" tabindex="-1"></a><span class="co"># define the data</span></span>
<span id="cb2027-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb2027-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">int =</span> <span class="fu">c</span>(<span class="st">&quot;Non−crossover Interaction&quot;</span>, <span class="st">&quot;Crossover Interaction&quot;</span>),</span>
<span id="cb2027-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">x1  =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>),</span>
<span id="cb2027-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">x2  =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2027-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">15</span>, <span class="dv">48</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">15</span>, <span class="dv">48</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2027-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ly =</span> <span class="fu">log</span>(y))</span>
<span id="cb2027-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2027-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-11" aria-hidden="true" tabindex="-1"></a><span class="co"># save the subplots</span></span>
<span id="cb2027-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-12" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb2027-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-13" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2027-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(int <span class="sc">==</span> <span class="st">&quot;Non−crossover Interaction&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2027-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y, <span class="at">group =</span> x2, <span class="at">label =</span> x2)) <span class="sc">+</span></span>
<span id="cb2027-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> x2),</span>
<span id="cb2027-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2027-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dl</span>(<span class="at">method =</span> <span class="fu">list</span>(<span class="fu">dl.combine</span>(<span class="st">&quot;first.points&quot;</span>, <span class="st">&quot;last.points&quot;</span>)), </span>
<span id="cb2027-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2027-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> bd[<span class="dv">8</span><span class="sc">:</span><span class="dv">7</span>]) <span class="sc">+</span></span>
<span id="cb2027-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb2027-22"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Non−crossover Interaction&quot;</span>) <span class="sc">+</span></span>
<span id="cb2027-23"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">8</span>),</span>
<span id="cb2027-24"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb2027-25"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2027-26"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-26" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb2027-27"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-27" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2027-28"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(int <span class="sc">==</span> <span class="st">&quot;Crossover Interaction&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2027-29"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y, <span class="at">group =</span> x2, <span class="at">label =</span> x2)) <span class="sc">+</span></span>
<span id="cb2027-30"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> x2),</span>
<span id="cb2027-31"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2027-32"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dl</span>(<span class="at">method =</span> <span class="fu">list</span>(<span class="fu">dl.combine</span>(<span class="st">&quot;first.points&quot;</span>, <span class="st">&quot;last.points&quot;</span>)), </span>
<span id="cb2027-33"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2027-34"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> bd[<span class="dv">8</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2027-35"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb2027-36"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2027-37"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Crossover Interaction&quot;</span>)</span>
<span id="cb2027-38"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2027-39"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-39" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb2027-40"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-40" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2027-41"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(int <span class="sc">==</span> <span class="st">&quot;Crossover Interaction&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2027-42"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x2, <span class="at">y =</span> y, <span class="at">group =</span> x1, <span class="at">label =</span> x1)) <span class="sc">+</span></span>
<span id="cb2027-43"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> x1),</span>
<span id="cb2027-44"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-44" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2027-45"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dl</span>(<span class="at">method =</span> <span class="fu">list</span>(<span class="fu">dl.combine</span>(<span class="st">&quot;first.points&quot;</span>, <span class="st">&quot;last.points&quot;</span>)), </span>
<span id="cb2027-46"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-46" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2027-47"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> bd[<span class="dv">12</span><span class="sc">:</span><span class="dv">11</span>]) <span class="sc">+</span></span>
<span id="cb2027-48"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb2027-49"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2027-50"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Crossover Interaction&quot;</span>) <span class="sc">+</span></span>
<span id="cb2027-51"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">8</span>),</span>
<span id="cb2027-52"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb2027-53"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2027-54"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-54" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb2027-55"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-55" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2027-56"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(int <span class="sc">==</span> <span class="st">&quot;Non−crossover Interaction&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2027-57"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> ly, <span class="at">group =</span> x2, <span class="at">label =</span> x2)) <span class="sc">+</span></span>
<span id="cb2027-58"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> x2),</span>
<span id="cb2027-59"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2027-60"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dl</span>(<span class="at">method =</span> <span class="fu">list</span>(<span class="fu">dl.combine</span>(<span class="st">&quot;first.points&quot;</span>, <span class="st">&quot;last.points&quot;</span>)), </span>
<span id="cb2027-61"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2027-62"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> bd[<span class="dv">8</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2027-63"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb2027-64"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">log</span>(y)))</span>
<span id="cb2027-65"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2027-66"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-66" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span></span>
<span id="cb2027-67"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-67" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2027-68"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(int <span class="sc">==</span> <span class="st">&quot;Crossover Interaction&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2027-69"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> ly, <span class="at">group =</span> x2, <span class="at">label =</span> x2)) <span class="sc">+</span></span>
<span id="cb2027-70"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> x2),</span>
<span id="cb2027-71"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-71" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2027-72"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dl</span>(<span class="at">method =</span> <span class="fu">list</span>(<span class="fu">dl.combine</span>(<span class="st">&quot;first.points&quot;</span>, <span class="st">&quot;last.points&quot;</span>)), </span>
<span id="cb2027-73"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-73" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2027-74"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> bd[<span class="dv">8</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2027-75"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb2027-76"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2027-77"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">log</span>(y)))</span>
<span id="cb2027-78"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2027-79"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-79" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span></span>
<span id="cb2027-80"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-80" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2027-81"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(int <span class="sc">==</span> <span class="st">&quot;Crossover Interaction&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2027-82"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x2, <span class="at">y =</span> ly, <span class="at">group =</span> x1, <span class="at">label =</span> x1)) <span class="sc">+</span></span>
<span id="cb2027-83"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> x1),</span>
<span id="cb2027-84"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-84" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2027-85"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dl</span>(<span class="at">method =</span> <span class="fu">list</span>(<span class="fu">dl.combine</span>(<span class="st">&quot;first.points&quot;</span>, <span class="st">&quot;last.points&quot;</span>)), </span>
<span id="cb2027-86"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-86" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2027-87"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> bd[<span class="dv">12</span><span class="sc">:</span><span class="dv">11</span>], <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2027-88"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb2027-89"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2027-90"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">log</span>(y)))</span>
<span id="cb2027-91"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2027-92"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-92" aria-hidden="true" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb2027-93"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2027-93" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p5 <span class="sc">+</span> p6 </span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-38-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>“The transformability from interaction to non-interaction is only possible for non-crossover interactions. This terminology, ‘noncrossover,’ is merely a description of the graph: The lines do not cross over each other and they have the same sign slope” (p. 601). The plots in the leftmost column are examples of non-crossover interactions. The plots in the center column are examples of crossover interactions.</p>
<p>Kruschke then pointed out that transforming data can have unexpected consequences for summary values, such as variances:</p>
<blockquote>
<p>Suppose one condition has data values of <span class="math inline">\(100\)</span>, <span class="math inline">\(110\)</span>, and <span class="math inline">\(120\)</span>, while a second condition has data values of <span class="math inline">\(1100\)</span>, <span class="math inline">\(1110\)</span>, and <span class="math inline">\(1120\)</span>. For both conditions, the variance is <span class="math inline">\(66.7\)</span>, so there is homogeneity of variance. When the data are logarithmically transformed, the variance of the first group becomes <span class="math inline">\(1.05e−3\)</span>, but the variance of the second group becomes two orders of magnitude smaller, namely <span class="math inline">\(1.02e−5\)</span>. In the transformed data there is not homogeneity of variance. (p. 601)</p>
</blockquote>
<p>See for yourself.</p>
<div class="sourceCode" id="cb2028"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2028-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2028-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">110</span>, <span class="dv">120</span>, <span class="dv">1100</span>, <span class="dv">1110</span>, <span class="dv">1120</span>),</span>
<span id="cb2028-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2028-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2028-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2028-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(y) <span class="sc">%&gt;%</span> </span>
<span id="cb2028-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2028-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">variance_of_x     =</span> <span class="fu">var</span>(x),</span>
<span id="cb2028-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2028-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">variance_of_log_x =</span> <span class="fu">var</span>(<span class="fu">log</span>(x)))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   y     variance_of_x variance_of_log_x
##   &lt;chr&gt;         &lt;dbl&gt;             &lt;dbl&gt;
## 1 a               100         0.00832  
## 2 b               100         0.0000812</code></pre>
<p>Though it looks like the numbers Kruschke reported in the text are off, his overall point stands. While we had homogeneity of variance for <code>x</code>, the variance is heterogeneous when working with <code>log(x)</code>.</p>
</div>
<div id="heterogeneous-variances-and-robustness-against-outliers-1" class="section level2 hasAnchor" number="20.4">
<h2><span class="header-section-number">20.4</span> Heterogeneous variances and robustness against outliers<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As we will see in just a moment, our approach to the variant of this model with heterogeneous variances and robustness against outliers will differ slightly from the one Kruschke presented in the text. The two are the same in spirit, but ours differs in how we model <span class="math inline">\(\sigma_{[jk](i)}\)</span>. We’ll get a sense of that difference in our version of the hierarchical model diagram of Figure 20.7.</p>
<div class="sourceCode" id="cb2030"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2030-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bracket</span></span>
<span id="cb2030-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb2030-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">99</span>,</span>
<span id="cb2030-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> .<span class="dv">5</span>,</span>
<span id="cb2030-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;{_}&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2030-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2030-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb2030-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">color =</span> bd[<span class="dv">2</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb2030-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb2030-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2030-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb2030-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  plain arrow</span></span>
<span id="cb2030-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-14" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb2030-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> .<span class="dv">73</span>,</span>
<span id="cb2030-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="dv">1</span>,</span>
<span id="cb2030-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> .<span class="dv">68</span>,</span>
<span id="cb2030-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> .<span class="dv">25</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2030-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2030-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb2030-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb2030-22"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2030-23"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2030-24"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb2030-25"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2030-26"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-26" aria-hidden="true" tabindex="-1"></a><span class="co"># normal density</span></span>
<span id="cb2030-27"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-27" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb2030-28"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2030-29"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb2030-30"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bd[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb2030-31"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-32"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb2030-33"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb2030-34"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2030-35"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-36"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.45</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb2030-37"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb2030-38"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;italic(M)[0]&quot;</span>, <span class="st">&quot;italic(S)[0]&quot;</span>), </span>
<span id="cb2030-39"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb2030-40"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2030-41"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb2030-42"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]))</span>
<span id="cb2030-43"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2030-44"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-44" aria-hidden="true" tabindex="-1"></a><span class="co"># normal density</span></span>
<span id="cb2030-45"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-45" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb2030-46"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2030-47"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb2030-48"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bd[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb2030-49"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-50"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb2030-51"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb2030-52"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2030-53"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-54"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.15</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb2030-55"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;sigma[beta][1]&quot;</span>), </span>
<span id="cb2030-56"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-56" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb2030-57"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-57" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb2030-58"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2030-59"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb2030-60"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]))</span>
<span id="cb2030-61"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2030-62"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-62" aria-hidden="true" tabindex="-1"></a><span class="co"># normal density</span></span>
<span id="cb2030-63"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-63" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span></span>
<span id="cb2030-64"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2030-65"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb2030-66"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bd[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb2030-67"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-68"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-68" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb2030-69"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-69" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb2030-70"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-70" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2030-71"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-72"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-72" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.15</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb2030-73"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-73" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;sigma[beta][2]&quot;</span>), </span>
<span id="cb2030-74"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-74" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb2030-75"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-75" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb2030-76"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2030-77"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb2030-78"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]))</span>
<span id="cb2030-79"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-79" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2030-80"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-80" aria-hidden="true" tabindex="-1"></a><span class="co"># normal density</span></span>
<span id="cb2030-81"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-81" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span></span>
<span id="cb2030-82"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2030-83"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb2030-84"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bd[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb2030-85"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-86"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-86" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb2030-87"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-87" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb2030-88"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-88" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2030-89"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-90"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-90" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.75</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb2030-91"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-91" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb2030-92"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-92" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;sigma[beta][1%*%2]&quot;</span>), </span>
<span id="cb2030-93"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-93" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb2030-94"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2030-95"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb2030-96"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]))</span>
<span id="cb2030-97"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-98"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-98" aria-hidden="true" tabindex="-1"></a><span class="co"># four annotated arrows</span></span>
<span id="cb2030-99"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-99" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span></span>
<span id="cb2030-100"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">34</span>, .<span class="dv">64</span>, .<span class="dv">945</span>),</span>
<span id="cb2030-101"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-101" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb2030-102"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-102" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">18</span>, .<span class="dv">45</span>, .<span class="dv">75</span>),</span>
<span id="cb2030-103"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-103" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2030-104"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb2030-105"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-105" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb2030-106"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2030-107"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-108"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-108" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">03</span>, .<span class="dv">23</span>, .<span class="dv">30</span>, .<span class="dv">52</span>, .<span class="dv">585</span>, .<span class="dv">82</span>, .<span class="dv">90</span>), <span class="at">y =</span> .<span class="dv">5</span>,</span>
<span id="cb2030-109"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-109" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(j)&quot;</span>, <span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(k)&quot;</span>, <span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(jk)&quot;</span>),</span>
<span id="cb2030-110"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-110" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">7</span>), </span>
<span id="cb2030-111"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-111" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb2030-112"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2030-113"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb2030-114"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-115"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-115" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood formula</span></span>
<span id="cb2030-116"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-116" aria-hidden="true" tabindex="-1"></a>p8 <span class="ot">&lt;-</span></span>
<span id="cb2030-117"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> .<span class="dv">5</span>,</span>
<span id="cb2030-118"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-118" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb2030-119"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-119" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;beta[0]+sum()[italic(j)]*beta[1][&#39;[&#39;*italic(j)*&#39;]&#39;]*italic(x)[1][&#39;[&#39;*italic(j)*&#39;]&#39;](italic(i))+sum()[italic(k)]*beta[2][&#39;[&#39;*italic(k)*&#39;]&#39;]*italic(x)[2][&#39;[&#39;*italic(k)*&#39;]&#39;](italic(i))+sum()[italic(jk)]*beta[1%*%2][&#39;[&#39;*italic(jk)*&#39;]&#39;]*italic(x)[1%*%2][&#39;[&#39;*italic(jk)*&#39;]&#39;](italic(i))&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2030-120"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-120" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2030-121"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb2030-122"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb2030-123"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb2030-124"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2030-125"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb2030-126"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-127"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-127" aria-hidden="true" tabindex="-1"></a><span class="co"># normal density</span></span>
<span id="cb2030-128"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-128" aria-hidden="true" tabindex="-1"></a>p9 <span class="ot">&lt;-</span></span>
<span id="cb2030-129"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2030-130"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb2030-131"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bd[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb2030-132"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-133"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-133" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb2030-134"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-134" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb2030-135"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-135" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2030-136"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-137"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-137" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.15</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb2030-138"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-138" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;italic(M)[mu[sigma]]&quot;</span>, <span class="st">&quot;italic(S)[mu[sigma]]&quot;</span>), </span>
<span id="cb2030-139"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-139" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb2030-140"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-140" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb2030-141"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2030-142"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb2030-143"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]))</span>
<span id="cb2030-144"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-145"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-145" aria-hidden="true" tabindex="-1"></a><span class="co"># half-normal density</span></span>
<span id="cb2030-146"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-146" aria-hidden="true" tabindex="-1"></a>p10 <span class="ot">&lt;-</span></span>
<span id="cb2030-147"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2030-148"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb2030-149"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bd[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb2030-150"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-151"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-151" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb2030-152"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-152" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;half-normal&quot;</span>,</span>
<span id="cb2030-153"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-153" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2030-154"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-155"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-155" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb2030-156"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-156" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;0*&#39;,&#39;*~italic(S)[sigma[sigma]]&quot;</span>, </span>
<span id="cb2030-157"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-157" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb2030-158"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2030-159"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb2030-160"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]))</span>
<span id="cb2030-161"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-162"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-162" aria-hidden="true" tabindex="-1"></a><span class="co"># exponential density</span></span>
<span id="cb2030-163"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-163" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span></span>
<span id="cb2030-164"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2030-165"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dexp</span>(x, <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dexp</span>(x, <span class="dv">2</span>))))) <span class="sc">+</span></span>
<span id="cb2030-166"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bd[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb2030-167"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-168"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-168" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb2030-169"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-169" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;exp&quot;</span>,</span>
<span id="cb2030-170"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-170" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2030-171"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-172"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-172" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb2030-173"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-173" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;italic(K)&quot;</span>,</span>
<span id="cb2030-174"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-174" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb2030-175"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2030-176"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb2030-177"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]))</span>
<span id="cb2030-178"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-179"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-179" aria-hidden="true" tabindex="-1"></a><span class="co"># normal density</span></span>
<span id="cb2030-180"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-180" aria-hidden="true" tabindex="-1"></a>p12 <span class="ot">&lt;-</span></span>
<span id="cb2030-181"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2030-182"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb2030-183"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bd[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb2030-184"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-185"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-185" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb2030-186"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-186" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb2030-187"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-187" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2030-188"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-189"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-189" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.2</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb2030-190"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-190" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb2030-191"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-191" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;mu[sigma]&quot;</span>, <span class="st">&quot;sigma[sigma]&quot;</span>), </span>
<span id="cb2030-192"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-192" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb2030-193"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2030-194"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb2030-195"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]))</span>
<span id="cb2030-196"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-197"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-197" aria-hidden="true" tabindex="-1"></a><span class="co"># student-t density</span></span>
<span id="cb2030-198"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-198" aria-hidden="true" tabindex="-1"></a>p13 <span class="ot">&lt;-</span></span>
<span id="cb2030-199"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2030-200"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> (<span class="fu">dt</span>(x, <span class="dv">3</span>) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dt</span>(x, <span class="dv">3</span>))))) <span class="sc">+</span></span>
<span id="cb2030-201"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> bd[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb2030-202"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-203"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-203" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb2030-204"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-204" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;student t&quot;</span>,</span>
<span id="cb2030-205"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-205" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2030-206"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-207"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-207" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.4</span>, <span class="dv">0</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb2030-208"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-208" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;nu&quot;</span>, <span class="st">&quot;mu[italic(i)]&quot;</span>),</span>
<span id="cb2030-209"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-209" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb2030-210"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2030-211"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb2030-212"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bd[<span class="dv">3</span>]))</span>
<span id="cb2030-213"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-214"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-214" aria-hidden="true" tabindex="-1"></a><span class="co"># two annotated arrows</span></span>
<span id="cb2030-215"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-215" aria-hidden="true" tabindex="-1"></a>p14 <span class="ot">&lt;-</span></span>
<span id="cb2030-216"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">18</span>, .<span class="dv">82</span>),</span>
<span id="cb2030-217"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-217" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb2030-218"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-218" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">46</span>, .<span class="dv">66</span>),</span>
<span id="cb2030-219"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-219" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="fu">c</span>(.<span class="dv">28</span>, .<span class="dv">28</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2030-220"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb2030-221"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-221" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb2030-222"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2030-223"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-224"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-224" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">24</span>, .<span class="dv">69</span>), <span class="at">y =</span> .<span class="dv">62</span>,</span>
<span id="cb2030-225"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-225" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;&#39;~&#39;&quot;</span>,</span>
<span id="cb2030-226"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-226" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb2030-227"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2030-228"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb2030-229"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-230"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-230" aria-hidden="true" tabindex="-1"></a><span class="co"># log sigma</span></span>
<span id="cb2030-231"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-231" aria-hidden="true" tabindex="-1"></a>p15 <span class="ot">&lt;-</span></span>
<span id="cb2030-232"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> .<span class="dv">65</span>,</span>
<span id="cb2030-233"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-233" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb2030-234"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-234" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;log(sigma[&#39;[&#39;*italic(jk)*&#39;](&#39;*italic(i)*&#39;)&#39;])&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2030-235"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-235" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2030-236"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb2030-237"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb2030-238"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb2030-239"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2030-240"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb2030-241"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-242"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-242" aria-hidden="true" tabindex="-1"></a><span class="co"># two annotated arrows</span></span>
<span id="cb2030-243"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-243" aria-hidden="true" tabindex="-1"></a>p16 <span class="ot">&lt;-</span></span>
<span id="cb2030-244"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">18</span>, .<span class="dv">18</span>), <span class="co"># .2142857</span></span>
<span id="cb2030-245"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-245" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">45</span>),</span>
<span id="cb2030-246"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-246" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">18</span>, .<span class="dv">67</span>),</span>
<span id="cb2030-247"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-247" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="fu">c</span>(.<span class="dv">75</span>, .<span class="dv">14</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2030-248"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-248" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2030-249"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb2030-250"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-250" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb2030-251"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2030-252"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-253"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-253" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">13</span>, .<span class="dv">18</span>, .<span class="dv">26</span>), <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">92</span>, .<span class="dv">64</span>, .<span class="dv">22</span>),</span>
<span id="cb2030-254"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-254" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;nu*minute+1&quot;</span>, <span class="st">&quot;&#39;=&#39;&quot;</span>),</span>
<span id="cb2030-255"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-255" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">10</span>), <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb2030-256"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2030-257"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb2030-258"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-259"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-259" aria-hidden="true" tabindex="-1"></a><span class="co"># one annotated arrow</span></span>
<span id="cb2030-260"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-260" aria-hidden="true" tabindex="-1"></a>p17 <span class="ot">&lt;-</span></span>
<span id="cb2030-261"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> .<span class="dv">5</span>,</span>
<span id="cb2030-262"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-262" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="dv">1</span>,</span>
<span id="cb2030-263"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-263" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> .<span class="dv">5</span>,</span>
<span id="cb2030-264"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-264" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> .<span class="dv">03</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2030-265"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-265" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2030-266"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb2030-267"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-267" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb2030-268"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2030-269"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-270"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-270" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">4</span>, <span class="at">y =</span> .<span class="dv">5</span>,</span>
<span id="cb2030-271"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-271" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;&#39;=&#39;&quot;</span>,</span>
<span id="cb2030-272"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-272" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb2030-273"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2030-274"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb2030-275"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-276"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-276" aria-hidden="true" tabindex="-1"></a><span class="co"># another annotated arrow</span></span>
<span id="cb2030-277"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-277" aria-hidden="true" tabindex="-1"></a>p18 <span class="ot">&lt;-</span></span>
<span id="cb2030-278"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> .<span class="dv">87</span>,</span>
<span id="cb2030-279"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-279" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="dv">1</span>,</span>
<span id="cb2030-280"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-280" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> .<span class="dv">43</span>,</span>
<span id="cb2030-281"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-281" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> .<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2030-282"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-282" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2030-283"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb2030-284"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-284" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb2030-285"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2030-286"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb2030-287"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-287" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">56</span>, .<span class="dv">7</span>), <span class="at">y =</span> .<span class="dv">5</span>,</span>
<span id="cb2030-288"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-288" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(jk)&quot;</span>),</span>
<span id="cb2030-289"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-289" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>), <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb2030-290"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2030-291"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb2030-292"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-293"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-293" aria-hidden="true" tabindex="-1"></a><span class="co"># the final annotated arrow</span></span>
<span id="cb2030-294"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-294" aria-hidden="true" tabindex="-1"></a>p19 <span class="ot">&lt;-</span></span>
<span id="cb2030-295"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="fu">c</span>(.<span class="dv">375</span>, .<span class="dv">625</span>),</span>
<span id="cb2030-296"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-296" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb2030-297"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-297" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(i)&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2030-298"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-299"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb2030-300"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>),</span>
<span id="cb2030-301"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-301" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb2030-302"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">5</span>, <span class="at">xend =</span> .<span class="dv">5</span>,</span>
<span id="cb2030-303"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-303" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> <span class="dv">0</span>,</span>
<span id="cb2030-304"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-304" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bd[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2030-305"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2030-306"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb2030-307"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-308"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-308" aria-hidden="true" tabindex="-1"></a><span class="co"># some text</span></span>
<span id="cb2030-309"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-309" aria-hidden="true" tabindex="-1"></a>p20 <span class="ot">&lt;-</span></span>
<span id="cb2030-310"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">5</span>,</span>
<span id="cb2030-311"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-311" aria-hidden="true" tabindex="-1"></a>         <span class="at">y     =</span> .<span class="dv">5</span>,</span>
<span id="cb2030-312"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-312" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="st">&quot;italic(y[i])&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2030-313"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-314"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb2030-315"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="sc">+</span></span>
<span id="cb2030-316"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2030-317"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb2030-318"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-319"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-319" aria-hidden="true" tabindex="-1"></a><span class="co"># define the layout</span></span>
<span id="cb2030-320"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-320" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2030-321"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">6</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb2030-322"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb2030-323"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">14</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb2030-324"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">3</span>),</span>
<span id="cb2030-325"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb2030-326"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">9</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb2030-327"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">13</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb2030-328"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">b =</span> <span class="dv">3</span>, <span class="at">l =</span> <span class="dv">6</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb2030-329"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">b =</span> <span class="dv">3</span>, <span class="at">l =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb2030-330"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">b =</span> <span class="dv">3</span>, <span class="at">l =</span> <span class="dv">14</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb2030-331"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">6</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb2030-332"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">5</span>, <span class="at">b =</span> <span class="dv">6</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb2030-333"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">9</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">9</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb2030-334"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">9</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">13</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb2030-335"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">12</span>, <span class="at">b =</span> <span class="dv">13</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">3</span>),</span>
<span id="cb2030-336"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">12</span>, <span class="at">b =</span> <span class="dv">13</span>, <span class="at">l =</span> <span class="dv">11</span>, <span class="at">r =</span> <span class="dv">13</span>),</span>
<span id="cb2030-337"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">16</span>, <span class="at">b =</span> <span class="dv">17</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb2030-338"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">11</span>, <span class="at">b =</span> <span class="dv">12</span>, <span class="at">l =</span> <span class="dv">9</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb2030-339"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">16</span>, <span class="at">b =</span> <span class="dv">17</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">10</span>),</span>
<span id="cb2030-340"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">14</span>, <span class="at">b =</span> <span class="dv">16</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb2030-341"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">8</span>, <span class="at">b =</span> <span class="dv">16</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb2030-342"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">14</span>, <span class="at">b =</span> <span class="dv">16</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">13</span>),</span>
<span id="cb2030-343"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">18</span>, <span class="at">b =</span> <span class="dv">18</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb2030-344"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">19</span>, <span class="at">b =</span> <span class="dv">19</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>)</span>
<span id="cb2030-345"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-345" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2030-346"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2030-347"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-347" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot!</span></span>
<span id="cb2030-348"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-348" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p1 <span class="sc">+</span> p1 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p5 <span class="sc">+</span> p6 <span class="sc">+</span> p2 <span class="sc">+</span> p2 <span class="sc">+</span> p2 <span class="sc">+</span> p8 <span class="sc">+</span> p7 <span class="sc">+</span> p9 <span class="sc">+</span> p10 <span class="sc">+</span> p11 <span class="sc">+</span> p12 <span class="sc">+</span> p13 <span class="sc">+</span> p14 <span class="sc">+</span> p15 <span class="sc">+</span> p16 <span class="sc">+</span> p17 <span class="sc">+</span> p18 <span class="sc">+</span> p19 <span class="sc">+</span> p20) <span class="sc">+</span> </span>
<span id="cb2030-349"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout) <span class="sc">&amp;</span></span>
<span id="cb2030-350"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb2030-351"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2030-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>, <span class="fl">5.5</span>))</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-40-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Wow that’s a lot! If you compare our diagram with the one in the text, you’ll see the <span class="math inline">\(\nu\)</span> and <span class="math inline">\(\mu\)</span> structures are the same. If you look down toward the bottom of the diagram, the first big difference is that we’re modeling the log of <span class="math inline">\(\sigma_{[jk](i)}\)</span>, which is the typical <strong>brms</strong> strategy for avoiding negative values when modeling a <span class="math inline">\(\sigma\)</span> parameter. Then when you look up and to the right, you’ll see that we’re modeling <span class="math inline">\(\log(\sigma_{[jk](i)})\)</span> with a conventional hierarchical Gaussian structure. Keep this in mind when we get into our <strong>brms</strong> code, below.</p>
<p>Before we fit the robust hierarchical variances model, we need to define our <code>stanvars</code>.</p>
<div class="sourceCode" id="cb2031"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2031-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2031-1" aria-hidden="true" tabindex="-1"></a>stanvars <span class="ot">&lt;-</span> </span>
<span id="cb2031-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2031-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(mean_y,    <span class="at">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="sc">+</span> </span>
<span id="cb2031-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2031-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(sd_y,      <span class="at">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb2031-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2031-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>shape, <span class="at">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">+</span></span>
<span id="cb2031-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2031-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>rate,  <span class="at">name =</span> <span class="st">&quot;beta&quot;</span>) <span class="sc">+</span></span>
<span id="cb2031-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2031-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">29</span>,      <span class="at">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>)</span></code></pre></div>
<p>Recall that to fit a robust hierarchical variances model, we need to wrap our two formulas within the <code>bf()</code> function.</p>
<p>⚠️ <strong>Warning</strong>: This one took a few hours fit. ⚠️</p>
<div class="sourceCode" id="cb2032"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2032-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2032-1" aria-hidden="true" tabindex="-1"></a>fit20<span class="fl">.2</span> <span class="ot">&lt;-</span></span>
<span id="cb2032-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2032-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb2032-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2032-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> student,</span>
<span id="cb2032-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2032-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bf</span>(Salary <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Pos) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Org) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Pos<span class="sc">:</span>Org), </span>
<span id="cb2032-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2032-5" aria-hidden="true" tabindex="-1"></a>         sigma  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Pos<span class="sc">:</span>Org)),</span>
<span id="cb2032-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2032-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb2032-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2032-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fu">log</span>(sd_y), <span class="dv">1</span>),     <span class="at">class =</span> Intercept, <span class="at">dpar =</span> sigma),</span>
<span id="cb2032-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2032-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">gamma</span>(alpha, beta), <span class="at">class =</span> sd),</span>
<span id="cb2032-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2032-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>),       <span class="at">class =</span> sd, <span class="at">dpar =</span> sigma),</span>
<span id="cb2032-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2032-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(one_over_twentynine), <span class="at">class =</span> nu)),</span>
<span id="cb2032-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2032-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb2032-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2032-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">20</span>,</span>
<span id="cb2032-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2032-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.9995</span>,</span>
<span id="cb2032-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2032-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">max_treedepth =</span> <span class="dv">15</span>),</span>
<span id="cb2032-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2032-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars,</span>
<span id="cb2032-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2032-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit20.02&quot;</span>)</span></code></pre></div>
<p>Behold the summary.</p>
<div class="sourceCode" id="cb2033"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2033-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2033-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit20<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>##  Family: student 
##   Links: mu = identity; sigma = log; nu = identity 
## Formula: Salary ~ 1 + (1 | Pos) + (1 | Org) + (1 | Pos:Org) 
##          sigma ~ 1 + (1 | Pos:Org)
##    Data: my_data (Number of observations: 1080) 
##   Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup draws = 12000
## 
## Group-Level Effects: 
## ~Org (Number of levels: 60) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept) 31619.75   3093.75 26189.88 38368.83 1.00     1894     3299
## 
## ~Pos (Number of levels: 5) 
##               Estimate Est.Error l-95% CI  u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept) 51025.03  23822.65 23575.14 112757.06 1.00     5040     7211
## 
## ~Pos:Org (Number of levels: 216) 
##                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)        5305.30    870.86  3720.00  7146.09 1.00     1976     3567
## sd(sigma_Intercept)     0.97      0.07     0.84     1.11 1.00     2517     4486
## 
## Population-Level Effects: 
##                  Estimate Est.Error l-95% CI  u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept       122475.76  25189.06 71864.05 172894.55 1.00     3718     6007
## sigma_Intercept      9.11      0.09     8.93      9.29 1.00     2706     4775
## 
## Family Specific Parameters: 
##    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## nu     6.86      3.64     3.69    14.91 1.00     4761     4901
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>This time we’ll just feed the results of the wrangling code right into the plotting code for our version of the top panels of Figure 20.8.</p>
<div class="sourceCode" id="cb2035"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2035-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many draws would you like?</span></span>
<span id="cb2035-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-2" aria-hidden="true" tabindex="-1"></a>n_draw <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb2035-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2035-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-4" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb2035-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-5" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb2035-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Pos) <span class="sc">%&gt;%</span> </span>
<span id="cb2035-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(Pos, </span>
<span id="cb2035-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Org =</span> <span class="fu">c</span>(<span class="st">&quot;BFIN&quot;</span>, <span class="st">&quot;CHEM&quot;</span>, <span class="st">&quot;PSY&quot;</span>, <span class="st">&quot;ENG&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2035-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_epred_draws</span>(fit20<span class="fl">.2</span>, <span class="at">ndraws =</span> n_draw, <span class="at">seed =</span> <span class="dv">20</span>,</span>
<span id="cb2035-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">allow_new_levels =</span> T,</span>
<span id="cb2035-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dpar =</span> <span class="fu">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;nu&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2035-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ll =</span> <span class="fu">qt</span>(.<span class="dv">025</span>, <span class="at">df =</span> nu),</span>
<span id="cb2035-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">ul =</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="at">df =</span> nu)) <span class="sc">%&gt;%</span> </span>
<span id="cb2035-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Salary =</span> <span class="fu">map2</span>(ll, ul, seq, <span class="at">length.out =</span> <span class="dv">100</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2035-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(Salary) <span class="sc">%&gt;%</span></span>
<span id="cb2035-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dt</span>(Salary, nu)) <span class="sc">%&gt;%</span> </span>
<span id="cb2035-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># notice the conversion</span></span>
<span id="cb2035-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Salary =</span> mu <span class="sc">+</span> Salary <span class="sc">*</span> sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb2035-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.draw) <span class="sc">%&gt;%</span> </span>
<span id="cb2035-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> density <span class="sc">/</span> <span class="fu">max</span>(density)) <span class="sc">%&gt;%</span> </span>
<span id="cb2035-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Org =</span> <span class="fu">factor</span>(Org, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;BFIN&quot;</span>, <span class="st">&quot;CHEM&quot;</span>, <span class="st">&quot;PSY&quot;</span>, <span class="st">&quot;ENG&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb2035-22"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2035-23"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb2035-24"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Salary, <span class="at">y =</span> Pos)) <span class="sc">+</span></span>
<span id="cb2035-25"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">fixef</span>(fit20<span class="fl">.1</span>)[, <span class="dv">1</span>], <span class="at">color =</span> bd[<span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb2035-26"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ridgeline</span>(<span class="fu">aes</span>(<span class="at">height =</span> density, <span class="at">group =</span> <span class="fu">interaction</span>(Pos, .draw), <span class="at">color =</span> Pos),</span>
<span id="cb2035-27"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">show.legend =</span> F,</span>
<span id="cb2035-28"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">scale =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb2035-29"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> my_data <span class="sc">%&gt;%</span> </span>
<span id="cb2035-30"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-30" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(Org <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;BFIN&quot;</span>, <span class="st">&quot;CHEM&quot;</span>, <span class="st">&quot;PSY&quot;</span>, <span class="st">&quot;ENG&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2035-31"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-31" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">Org =</span> <span class="fu">factor</span>(Org, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;BFIN&quot;</span>, <span class="st">&quot;CHEM&quot;</span>, <span class="st">&quot;PSY&quot;</span>, <span class="st">&quot;ENG&quot;</span>))),</span>
<span id="cb2035-32"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">height =</span> .<span class="dv">025</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">size =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">color =</span> bd[<span class="dv">11</span>]) <span class="sc">+</span></span>
<span id="cb2035-33"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> bd[<span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">3</span>)]) <span class="sc">+</span></span>
<span id="cb2035-34"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">300000</span>, <span class="at">length.out =</span> <span class="dv">4</span>),</span>
<span id="cb2035-35"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-35" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;$0&quot;</span>, <span class="st">&quot;$100K&quot;</span>, <span class="st">&quot;200K&quot;</span>, <span class="st">&quot;$300K&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2035-36"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">35e4</span>),</span>
<span id="cb2035-37"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-37" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.25</span>, <span class="fl">5.5</span>)) <span class="sc">+</span></span>
<span id="cb2035-38"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Data with Posterior Predictive Distributions&quot;</span>, </span>
<span id="cb2035-39"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;The white vertical line is the model-implied grand mean.&quot;</span>,</span>
<span id="cb2035-40"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Pos&quot;</span>) <span class="sc">+</span></span>
<span id="cb2035-41"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb2035-42"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb2035-43"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2035-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Org, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-44-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Our results for the bottom panel of Figure 20.8 will differ substantially from Kruschke’s. Recall that Kruschke modeled <span class="math inline">\(\sigma_{[j, k](i)}\)</span> with a hierarchical gamma distribution and using the <span class="math inline">\(\omega + \sigma\)</span> parameterization. We, however, modeled our hierarchical <span class="math inline">\(\log (\sigma)\)</span> with the typical normal distribution. As such, we have posteriors for <span class="math inline">\(\sigma_\mu\)</span> and <span class="math inline">\(\sigma_\sigma\)</span>.</p>
<div class="sourceCode" id="cb2036"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2036-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2036-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb2036-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2036-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit20<span class="fl">.2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2036-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2036-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">Normality              =</span> <span class="fu">log10</span>(nu), </span>
<span id="cb2036-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2036-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Mean of Cell Sigma&#39;s</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">exp</span>(b_sigma_Intercept), </span>
<span id="cb2036-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2036-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">SD of Cell Sigma&#39;s</span><span class="st">`</span>   <span class="ot">=</span> <span class="fu">exp</span>(<span class="st">`</span><span class="at">sd_Pos:Org__sigma_Intercept</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2036-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2036-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2036-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2036-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Normality&quot;</span>, <span class="st">&quot;Mean of Cell Sigma&#39;s&quot;</span>, <span class="st">&quot;SD of Cell Sigma&#39;s&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb2036-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2036-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2036-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2036-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb2036-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2036-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2036-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2036-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_beedrill</span>() <span class="sc">+</span></span>
<span id="cb2036-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2036-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2036-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2036-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;param. value&quot;</span>) <span class="sc">+</span></span>
<span id="cb2036-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2036-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-45-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Though our <span class="math inline">\(\sigma_\mu\)</span> is on a similar metric to Kruschke’s <span class="math inline">\(\sigma_\omega\)</span>, our <span class="math inline">\(\sigma_\sigma\)</span> is just fundamentally different from his. So it goes. If you think I’m in error, here, <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/issues">share your insights</a>. Even though our hierarchical <span class="math inline">\(\sigma\)</span> parameters look different from Kruschke’s, it turns the contrast distributions are quite similar. Here’s the necessary wrangling to make our version for Figure 20.9.</p>
<div class="sourceCode" id="cb2037"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2037-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define our new data</span></span>
<span id="cb2037-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-2" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span></span>
<span id="cb2037-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">Pos =</span> <span class="fu">c</span>(<span class="st">&quot;Assis&quot;</span>, <span class="st">&quot;Full&quot;</span>),</span>
<span id="cb2037-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">Org =</span> <span class="fu">c</span>(<span class="st">&quot;CHEM&quot;</span>, <span class="st">&quot;PSY&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2037-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we&#39;ll need to update our column names</span></span>
<span id="cb2037-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col_names =</span> <span class="fu">str_c</span>(Pos, <span class="st">&quot;_&quot;</span>, Org))</span>
<span id="cb2037-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2037-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-8" aria-hidden="true" tabindex="-1"></a><span class="co"># get the draws with `fitted()`</span></span>
<span id="cb2037-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-9" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb2037-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(fit20<span class="fl">.2</span>, </span>
<span id="cb2037-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> nd,</span>
<span id="cb2037-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb2037-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># wrangle</span></span>
<span id="cb2037-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2037-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(nd <span class="sc">%&gt;%</span> <span class="fu">pull</span>(col_names)) <span class="sc">%&gt;%</span> </span>
<span id="cb2037-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="st">`</span><span class="at">Full - Assis @ CHEM</span><span class="st">`</span> <span class="ot">=</span> Full_CHEM <span class="sc">-</span> Assis_CHEM,</span>
<span id="cb2037-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Full - Assis @ PSY</span><span class="st">`</span>  <span class="ot">=</span> Full_PSY <span class="sc">-</span> Assis_PSY) <span class="sc">%&gt;%</span> </span>
<span id="cb2037-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Full.v.Assis</span><span class="sc">\n</span><span class="at">(x)</span><span class="sc">\n</span><span class="at">CHEM.v.PSY</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Full - Assis @ CHEM</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Full - Assis @ PSY</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2037-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2037-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Full - Assis @ PSY&quot;</span>, <span class="st">&quot;Full - Assis @ CHEM&quot;</span>, <span class="st">&quot;Full.v.Assis</span><span class="sc">\n</span><span class="st">(x)</span><span class="sc">\n</span><span class="st">CHEM.v.PSY&quot;</span>)))</span>
<span id="cb2037-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2037-22"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-22" aria-hidden="true" tabindex="-1"></a><span class="co"># what have we done?</span></span>
<span id="cb2037-23"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2037-23" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(f)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   name                             value
##   &lt;fct&gt;                            &lt;dbl&gt;
## 1 &quot;Full - Assis @ CHEM&quot;           54990.
## 2 &quot;Full - Assis @ PSY&quot;            34041.
## 3 &quot;Full.v.Assis\n(x)\nCHEM.v.PSY&quot; 20949.
## 4 &quot;Full - Assis @ CHEM&quot;           73406.
## 5 &quot;Full - Assis @ PSY&quot;            30839.
## 6 &quot;Full.v.Assis\n(x)\nCHEM.v.PSY&quot; 42567.</code></pre>
<p>Now plot.</p>
<div class="sourceCode" id="cb2039"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2039-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2039-1" aria-hidden="true" tabindex="-1"></a>f <span class="sc">%&gt;%</span> </span>
<span id="cb2039-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2039-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2039-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2039-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="fl">1e3</span>, <span class="at">xmax =</span> <span class="fl">1e3</span>,</span>
<span id="cb2039-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2039-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb2039-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2039-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">fill =</span> bd[<span class="dv">7</span>]) <span class="sc">+</span></span>
<span id="cb2039-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2039-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_beedrill</span>() <span class="sc">+</span></span>
<span id="cb2039-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2039-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2039-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2039-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Difference&quot;</span>) <span class="sc">+</span></span>
<span id="cb2039-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2039-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2039-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2039-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-47-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>See? Our contrast distributions are really close those in the text. Here are the numeric estimates.</p>
<div class="sourceCode" id="cb2040"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2040-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2040-1" aria-hidden="true" tabindex="-1"></a>f <span class="sc">%&gt;%</span> </span>
<span id="cb2040-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2040-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb2040-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2040-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mode_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb2040-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2040-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name<span class="sc">:</span>.upper) <span class="sc">%&gt;%</span> </span>
<span id="cb2040-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2040-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 4
##   name                            value .lower .upper
##   &lt;fct&gt;                           &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 &quot;Full - Assis @ PSY&quot;            33666  22720  43666
## 2 &quot;Full - Assis @ CHEM&quot;           53569  40288  67472
## 3 &quot;Full.v.Assis\n(x)\nCHEM.v.PSY&quot; 20329   3735  38571</code></pre>
<p>In the second half of the middle paragraph on page 605, Kruschke contrasted the <span class="math inline">\(\sigma_{\beta_{1 \times 2}}\)</span> parameter in the two models (i.e., our <code>fit20.1</code> and <code>fit20.2</code>). Recall that in the <strong>brms</strong> output, these are termed <code>sd_Pos:Org__Intercept</code>. Here are the comparisons from our <strong>brms</strong> models.</p>
<div class="sourceCode" id="cb2042"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2042-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2042-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit20<span class="fl">.1</span>)[<span class="st">&quot;sd_Pos:Org__Intercept&quot;</span>, ]</span></code></pre></div>
<pre><code>##  Estimate Est.Error      Q2.5     Q97.5 
##  9688.537  1197.771  7421.223 12108.029</code></pre>
<div class="sourceCode" id="cb2044"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2044-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2044-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit20<span class="fl">.2</span>)[<span class="st">&quot;sd_Pos:Org__Intercept&quot;</span>, ]</span></code></pre></div>
<pre><code>##  Estimate Est.Error      Q2.5     Q97.5 
## 5305.3025  870.8649 3719.9959 7146.0918</code></pre>
<p>They are similar to the values in the text. And recall, of course, the <code>brms::posterior_summary()</code> function returns posterior means. If you really wanted the posterior modes, like Kruschke reported in the text, you’ll have to work a little harder.</p>
<div class="sourceCode" id="cb2046"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2046-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2046-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">as_draws_df</span>(fit20<span class="fl">.1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">sd_Pos:Org__Intercept</span><span class="st">`</span>),</span>
<span id="cb2046-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2046-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">as_draws_df</span>(fit20<span class="fl">.2</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">sd_Pos:Org__Intercept</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2046-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2046-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;fit20.1&quot;</span>, <span class="st">&quot;fit20.2&quot;</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">8000</span>, <span class="dv">12000</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb2046-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2046-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fit) <span class="sc">%&gt;%</span> </span>
<span id="cb2046-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2046-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mode_hdi</span>(<span class="st">`</span><span class="at">sd_Pos:Org__Intercept</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2046-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2046-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fit<span class="sc">:</span>.upper) <span class="sc">%&gt;%</span> </span>
<span id="cb2046-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2046-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   fit     `sd_Pos:Org__Intercept` .lower .upper
##   &lt;chr&gt;                     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 fit20.1                    9725   7492  12170
## 2 fit20.2                    4965   3667   7064</code></pre>
<p>The curious might even look at those in a plot.</p>
<div class="sourceCode" id="cb2048"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2048-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2048-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">as_draws_df</span>(fit20<span class="fl">.1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">sd_Pos:Org__Intercept</span><span class="st">`</span>),</span>
<span id="cb2048-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2048-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">as_draws_df</span>(fit20<span class="fl">.2</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">sd_Pos:Org__Intercept</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2048-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2048-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;fit20.1&quot;</span>, <span class="st">&quot;fit20.2&quot;</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">8000</span>, <span class="dv">12000</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb2048-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2048-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2048-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2048-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">sd_Pos:Org__Intercept</span><span class="st">`</span>, <span class="at">y =</span> fit)) <span class="sc">+</span></span>
<span id="cb2048-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2048-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_beedrill</span>(<span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">point_size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2048-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2048-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(sigma[beta[<span class="dv">1</span><span class="sc">%*%</span><span class="dv">2</span>]]),</span>
<span id="cb2048-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2048-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2048-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2048-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="cn">NA</span>))</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-51-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>“Which model is a better description of the data?… In principle, an intrepid programmer could do a Bayesian model comparison…” (pp. 605–606). We could also examine information criteria, like the LOO.</p>
<div class="sourceCode" id="cb2049"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2049-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2049-1" aria-hidden="true" tabindex="-1"></a>fit20<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit20<span class="fl">.1</span>, <span class="st">&quot;loo&quot;</span>)</span>
<span id="cb2049-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2049-2" aria-hidden="true" tabindex="-1"></a>fit20<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit20<span class="fl">.2</span>, <span class="st">&quot;loo&quot;</span>)</span></code></pre></div>
<p><em>Sigh</em>. Both models had high <code>pareto_k</code> values, suggesting there were outliers relative to what was expected by their likelihoods. Just a little further in the text, Kruschke gives us hints why this might be so:</p>
<blockquote>
<p>Moreover, both models assume that the data within cells are distributed symmetrically above and below their central tendency, either as a normal distribution or a <span class="math inline">\(t\)</span>-distribution. The data instead seem to be skewed toward larger values, especially for advanced seniorities. (p. 606)</p>
</blockquote>
<p>Here’s the current LOO difference.</p>
<div class="sourceCode" id="cb2050"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2050-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2050-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit20<span class="fl">.1</span>, fit20<span class="fl">.2</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff  elpd_loo se_elpd_loo p_loo    se_p_loo looic    se_looic
## fit20.2      0.0       0.0 -11765.9     41.5       313.9     10.8  23531.8     82.9
## fit20.1   -429.6      34.4 -12195.4     43.1       141.4     12.2  24390.9     86.1</code></pre>
<p>But really, “we might want to create a model that describes the data within each cell as a skewed distribution such as a Weibull” (p. 606). Yes, <strong>brms</strong> can handle Weibull regression (e.g., <a href="https://discourse.mc-stan.org/t/fitting-time-to-event-data-with-weibull-hazard-using-brm-function/4638">here</a>).</p>
</div>
<div id="within-subject-designs" class="section level2 hasAnchor" number="20.5">
<h2><span class="header-section-number">20.5</span> Within-subject designs<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#within-subject-designs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>When every subject contributes many measurements to every cell, then the model of the situation is a straight-forward extension of the models we have already considered. We merely add “subject” as another nominal predictor in the model, with each individual subject being a level of the predictor. If there is one predictor other than subject, the model becomes</p>
<p><span class="math display">\[ y = \beta_0 + \overrightarrow \beta_1 \overrightarrow x_1 + \overrightarrow \beta_S \overrightarrow x_S + \overrightarrow \beta_{1 \times S} \overrightarrow x_{1 \times S} \]</span></p>
<p>This is exactly the two-predictor model we have already considered, with the second predictor being subject. When there are two predictors other than subject, the model becomes</p>
<p><span class="math display">\[\begin{align*}
y = &amp; \; \beta_0 &amp; \text{baseline} \\
&amp; + \overrightarrow \beta_1 \overrightarrow x_1 + \overrightarrow \beta_2 \overrightarrow x_2 + \overrightarrow \beta_S \overrightarrow x_S  &amp; \text{main effects} \\
&amp; + \overrightarrow \beta_{1 \times 2} \overrightarrow x_{1 \times 2} + \overrightarrow \beta_{1 \times S} \overrightarrow x_{1 \times S} + \overrightarrow \beta_{2 \times S} \overrightarrow x_{2 \times S} &amp; \text{two-way interactions} \\
&amp; + \overrightarrow \beta_{1 \times 2 \times S} \overrightarrow x_{1 \times 2 \times S} &amp; \text{three-way interactions}
\end{align*}\]</span></p>
<p>This model includes all the two-way interactions of the factors, plus the three-way interaction. (p. 607)</p>
</blockquote>
<p>In situations in which subjects only contribute one observation per condition/cell, we simplify the model to</p>
<p><span class="math display">\[\begin{align*}
y = &amp; \; \beta_0 \\
&amp; + \overrightarrow \beta_1 \overrightarrow x_1 + \overrightarrow \beta_2 \overrightarrow x_2 + \overrightarrow \beta_{1 \times 2} \overrightarrow x_{1 \times 2} \\
&amp; + \overrightarrow \beta_S \overrightarrow x_S
\end{align*}\]</span></p>
<p>“In other words, we assume a main effect of subject, but no interaction of subject with other predictors. In this model, the subject effect (deflection) is constant across treatments, and the treatment effects (deflections) are constant across subjects” (p. 608).</p>
<div id="why-use-a-within-subject-design-and-why-not" class="section level3 hasAnchor" number="20.5.1">
<h3><span class="header-section-number">20.5.1</span> Why use a within-subject design? And why not?<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#why-use-a-within-subject-design-and-why-not" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Kruschke opined “the primary reason to use a within-subject design is that you can achieve greater precision in the estimates of the effects than in a between-subject design” (p. 608). Well, to that I counterpoint: “No one goes to the circus to see the average dog jump through the hoop significantly oftener than untrained does raised under the same circumstances” <span class="citation">(<a href="#ref-skinnerCaseHistoryScientific1956" role="doc-biblioref">Skinner, 1956, p. 228</a>)</span>. And it’s unlikely you’ll make a skillful jumper of your dog without repeated trials. There’s also the related issue that between- and within-person processes aren’t necessarily the same. For an introduction to the issue, see Hamaker’s <span class="citation">(<a href="#ref-hamakerWhyResearchersShould2012" role="doc-biblioref">2012</a>)</span> chapter, <a href="https://www.researchgate.net/publication/266896375_Why_researchers_should_think_within-person_A_paradigmatic_rationale"><em>Why researchers should think “within-person”: A paradigmatic rationale</em></a>, or the paper from <span class="citation"><a href="#ref-bolgerCausalProcessesPsychology2019" role="doc-biblioref">Bolger et al.</a> (<a href="#ref-bolgerCausalProcessesPsychology2019" role="doc-biblioref">2019</a>)</span>, <a href="https://www.researchgate.net/profile/Niall_Bolger/publication/332358948_Causal_processes_in_psychology_are_heterogeneous/links/5cd9b471a6fdccc9ddaa7879/Causal-processes-in-psychology-are-heterogeneous.pdf"><em>Causal processes in psychology are heterogeneous</em></a>.</p>
<p>But we digress.</p>
<p>Here’s the 4-subject response time data.</p>
<div class="sourceCode" id="cb2052"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2052-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2052-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb2052-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2052-2" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span></span>
<span id="cb2052-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2052-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">response_time =</span> <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">320</span>, <span class="dv">350</span>, <span class="dv">370</span>, <span class="dv">400</span>, <span class="dv">420</span>, <span class="dv">450</span>, <span class="dv">470</span>),</span>
<span id="cb2052-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2052-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">subject       =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb2052-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2052-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">hand          =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;dominant&quot;</span>, <span class="st">&quot;nondominant&quot;</span>), <span class="at">times =</span> <span class="dv">4</span>))</span>
<span id="cb2052-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2052-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 8 × 3
##   response_time subject hand       
##           &lt;dbl&gt;   &lt;int&gt; &lt;chr&gt;      
## 1           300       1 dominant   
## 2           320       1 nondominant
## 3           350       2 dominant   
## 4           370       2 nondominant
## 5           400       3 dominant   
## 6           420       3 nondominant
## 7           450       4 dominant   
## 8           470       4 nondominant</code></pre>
<p>“For every subject, the difference between dominant and nondominant hands is exactly 20 ms, but there are big differences across subjects in overall response times” (p. 608). Here’s what that looks like.</p>
<div class="sourceCode" id="cb2054"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2054-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2054-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2054-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2054-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">subject =</span> <span class="fu">factor</span>(subject)) <span class="sc">%&gt;%</span> </span>
<span id="cb2054-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2054-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2054-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2054-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> response_time, <span class="at">y =</span> subject)) <span class="sc">+</span></span>
<span id="cb2054-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2054-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> subject), </span>
<span id="cb2054-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2054-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> bd[<span class="dv">3</span>], <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb2054-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2054-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> hand), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb2054-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2054-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> bd[<span class="dv">8</span><span class="sc">:</span><span class="dv">9</span>])</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-56-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Here there is more variability between subjects than within them, which you’d never detect without a within-subject design including multiple subjects.</p>
</div>
<div id="split-plot-design." class="section level3 hasAnchor" number="20.5.2">
<h3><span class="header-section-number">20.5.2</span> Split-plot design.<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#split-plot-design." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>“Split-plot experiments were invented by <span class="citation"><a href="#ref-fisherStatisticalMethodsResearch1925" role="doc-biblioref">Fisher</a> (<a href="#ref-fisherStatisticalMethodsResearch1925" role="doc-biblioref">1925</a>)</span> (p. 610).”</p>
<p>Kruschke then wrote this to set the stage for the next subsection:</p>
<blockquote>
<p>Consider an agricultural experiment investigating the productivity of different soil tilling methods and different fertilizers. It is relatively easy to provide all the farmers with the several different fertilizers. But it might be relatively difficult to provide all farmers with all the machinery for several different tilling methods. Therefore, any particular farmer will use a single (randomly assigned) tilling method on his whole plot, and tilling methods will differ between whole plots. Each farmer will split his field into subplots and apply all the fertilizers to different (randomly assigned) split plots, and fertilizers will differ across split plots within whole plots. This type of experiment inspires the name, split-plot design. The generic experiment-design term for the farmer’s field is “block.” Then, the factor that varies within every field is called the within-block factor and the factor that varies between fields is called the between-block factor. Notice also that each split plot yields a single measurement (in this case the productivity measured in bushels per acre), not multiple measurements. (p. 610)</p>
</blockquote>
<div id="example-knee-high-by-the-fourth-of-july." class="section level4 hasAnchor" number="20.5.2.1">
<h4><span class="header-section-number">20.5.2.1</span> Example: Knee high by the fourth of July.<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#example-knee-high-by-the-fourth-of-july." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Load the agronomy data.</p>
<div class="sourceCode" id="cb2055"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2055-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2055-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data.R/SplitPlotAgriData.csv&quot;</span>)</span>
<span id="cb2055-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2055-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2055-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2055-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(my_data)</span></code></pre></div>
<pre><code>## Rows: 99
## Columns: 4
## $ Field &lt;dbl&gt; 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5, 6, 6, 6, 7, 7, 7, 8, 8, 8, 9, 9, 9, 10,…
## $ Till  &lt;chr&gt; &quot;Chisel&quot;, &quot;Chisel&quot;, &quot;Chisel&quot;, &quot;Chisel&quot;, &quot;Chisel&quot;, &quot;Chisel&quot;, &quot;Chisel&quot;, &quot;Chisel&quot;, &quot;Chi…
## $ Fert  &lt;chr&gt; &quot;Broad&quot;, &quot;Deep&quot;, &quot;Surface&quot;, &quot;Broad&quot;, &quot;Deep&quot;, &quot;Surface&quot;, &quot;Broad&quot;, &quot;Deep&quot;, &quot;Surface&quot;, …
## $ Yield &lt;dbl&gt; 119, 130, 123, 135, 148, 134, 140, 146, 142, 126, 132, 131, 128, 141, 153, 117, 130,…</code></pre>
<p>We might use <code>geom_tile()</code> to visualize the data like this.</p>
<div class="sourceCode" id="cb2057"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2057-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2057-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb2057-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2057-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fert =</span> <span class="fu">str_c</span>(<span class="st">&quot;Fert: &quot;</span>, Fert)) <span class="sc">%&gt;%</span> </span>
<span id="cb2057-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2057-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2057-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2057-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Till, <span class="at">y =</span> Field)) <span class="sc">+</span></span>
<span id="cb2057-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2057-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Yield)) <span class="sc">+</span></span>
<span id="cb2057-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2057-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> bd[<span class="dv">1</span>], <span class="at">high =</span> bd[<span class="dv">12</span>]) <span class="sc">+</span></span>
<span id="cb2057-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2057-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2057-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2057-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2057-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2057-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> bd[<span class="dv">7</span>])) <span class="sc">+</span></span>
<span id="cb2057-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2057-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Fert)</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-58-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>As Kruschke pointed out in the text, notice how each <code>Field</code> has only one level of <code>Till</code>, but three levels of <code>Fert</code>.</p>
</div>
<div id="the-descriptive-model." class="section level4 hasAnchor" number="20.5.2.2">
<h4><span class="header-section-number">20.5.2.2</span> The descriptive model.<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#the-descriptive-model." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>In the classical ANOVA-style model for a split-plot design, the overall variance is conceptually decomposed into five components: the main effect of the between-subjects factor, the main effect of the within-subjects factor, the interaction of the two factors, the effect of subject within levels of the between-subject factor, and the interaction of subject with the within-subject factor. Unfortunately, because there is only a single datum per cell, the five components exactly match the data, which is to say that there are as many parameters as there are data points. (If every subject contributed multiple data points to every cell then the five-component model could be used.) Because there is no residual noise within cells, the classical approach is to treat the final component as noise, that is, treat the interaction of subject with the within-subject factor as noise. That component is not included in the model (at least, not distinct from noise). We will do the same for the descriptive model in our Bayesian analysis. (p. 612)</p>
</blockquote>
</div>
<div id="implementation-in-jags-brms.-2" class="section level4 hasAnchor" number="20.5.2.3">
<h4><span class="header-section-number">20.5.2.3</span> Implementation in <del>JAGS</del> brms.<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Define the <code>stanvars</code>.</p>
<div class="sourceCode" id="cb2058"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2058-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2058-1" aria-hidden="true" tabindex="-1"></a>mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(my_data<span class="sc">$</span>Yield)</span>
<span id="cb2058-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2058-2" aria-hidden="true" tabindex="-1"></a>sd_y   <span class="ot">&lt;-</span> <span class="fu">sd</span>(my_data<span class="sc">$</span>Yield)</span>
<span id="cb2058-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2058-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2058-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2058-4" aria-hidden="true" tabindex="-1"></a>omega <span class="ot">&lt;-</span> sd_y <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb2058-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2058-5" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> sd_y</span>
<span id="cb2058-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2058-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2058-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2058-7" aria-hidden="true" tabindex="-1"></a>s_r <span class="ot">&lt;-</span> <span class="fu">gamma_a_b_from_omega_sigma</span>(<span class="at">mode =</span> omega, <span class="at">sd =</span> sigma)</span>
<span id="cb2058-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2058-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2058-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2058-9" aria-hidden="true" tabindex="-1"></a>stanvars <span class="ot">&lt;-</span> </span>
<span id="cb2058-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2058-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(mean_y,    <span class="at">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="sc">+</span> </span>
<span id="cb2058-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2058-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(sd_y,      <span class="at">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb2058-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2058-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>shape, <span class="at">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">+</span></span>
<span id="cb2058-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2058-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(s_r<span class="sc">$</span>rate,  <span class="at">name =</span> <span class="st">&quot;beta&quot;</span>)</span></code></pre></div>
<p>Here’s how to fit the model with <code>brm()</code>.</p>
<div class="sourceCode" id="cb2059"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2059-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2059-1" aria-hidden="true" tabindex="-1"></a>fit20<span class="fl">.3</span> <span class="ot">&lt;-</span></span>
<span id="cb2059-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2059-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb2059-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2059-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb2059-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2059-4" aria-hidden="true" tabindex="-1"></a>      Yield <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Till) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Fert) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Field) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Till<span class="sc">:</span>Fert),</span>
<span id="cb2059-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2059-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb2059-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2059-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">gamma</span>(alpha, beta), <span class="at">class =</span> sd),</span>
<span id="cb2059-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2059-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb2059-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2059-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">2000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb2059-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2059-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">20</span>,</span>
<span id="cb2059-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2059-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.9999</span>,</span>
<span id="cb2059-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2059-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">max_treedepth =</span> <span class="dv">12</span>),</span>
<span id="cb2059-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2059-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars,</span>
<span id="cb2059-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2059-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit20.03&quot;</span>)</span></code></pre></div>
</div>
<div id="results." class="section level4 hasAnchor" number="20.5.2.4">
<h4><span class="header-section-number">20.5.2.4</span> Results.<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#results." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Check the summary.</p>
<div class="sourceCode" id="cb2060"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2060-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2060-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit20<span class="fl">.3</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Yield ~ 1 + (1 | Till) + (1 | Fert) + (1 | Field) + (1 | Till:Fert) 
##    Data: my_data (Number of observations: 99) 
##   Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
##          total post-warmup draws = 8000
## 
## Group-Level Effects: 
## ~Fert (Number of levels: 3) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)    15.04     13.33     1.26    49.92 1.00     2296     2927
## 
## ~Field (Number of levels: 33) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)    11.72      1.72     8.88    15.67 1.00     2177     3858
## 
## ~Till (Number of levels: 3) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)    15.58     13.49     1.25    52.11 1.00     2103     2801
## 
## ~Till:Fert (Number of levels: 9) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)     8.74      4.03     3.66    18.96 1.00     2082     4413
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept   140.48     15.77   107.14   173.14 1.00     3268     3595
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     5.70      0.54     4.77     6.88 1.00     3601     5000
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>We might compare the <span class="math inline">\(\sigma\)</span> posteriors with a plot.</p>
<div class="sourceCode" id="cb2062"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2062-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2062-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit20<span class="fl">.3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2062-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2062-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(sigma, <span class="fu">starts_with</span>(<span class="st">&quot;sd&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb2062-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2062-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2062-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2062-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> name)) <span class="sc">+</span></span>
<span id="cb2062-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2062-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_beedrill</span>(<span class="at">slab_color =</span> bd[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">point_size =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2062-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2062-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb2062-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2062-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2062-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2062-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>),</span>
<span id="cb2062-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2062-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb2062-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2062-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb2062-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2062-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-61-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Now we have the results of <code>fit20.3</code>, we are ready to make our version if Figure 20.10. Note that how within <code>add_fitted_draws()</code>, we used the <code>re_formula</code> argument to average over the random effects of <code>Field</code> (i.e., we left <code>(1 | Field)</code> out of the formula). That’s our equivalent to when Kruschke wrote “The predictive normal distributions are plotted with means at <span class="math inline">\(\beta_0 + \beta_B + \beta_W + \beta_{B \times W}\)</span> (collapsed across <span class="math inline">\(\beta_S\)</span>) and with standard deviation <span class="math inline">\(\sigma\)</span>” (pp. 614–615).</p>
<div class="sourceCode" id="cb2063"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2063-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb2063-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-2" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb2063-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Till, Fert) <span class="sc">%&gt;%</span> </span>
<span id="cb2063-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_epred_draws</span>(fit20<span class="fl">.3</span>, </span>
<span id="cb2063-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ndraws =</span> <span class="dv">20</span>,</span>
<span id="cb2063-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">re_formula =</span> Yield <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Till) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Fert) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Till<span class="sc">:</span>Fert),</span>
<span id="cb2063-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dpar =</span> <span class="fu">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2063-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ll =</span> <span class="fu">qnorm</span>(.<span class="dv">025</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma),</span>
<span id="cb2063-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">ul =</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb2063-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Yield =</span> <span class="fu">map2</span>(ll, ul, seq, <span class="at">length.out =</span> <span class="dv">100</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2063-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(Yield) <span class="sc">%&gt;%</span> </span>
<span id="cb2063-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dnorm</span>(Yield, mu, sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb2063-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.draw) <span class="sc">%&gt;%</span> </span>
<span id="cb2063-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> density <span class="sc">/</span> <span class="fu">max</span>(density)) <span class="sc">%&gt;%</span> </span>
<span id="cb2063-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2063-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb2063-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Yield, <span class="at">y =</span> Fert)) <span class="sc">+</span></span>
<span id="cb2063-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> my_data,</span>
<span id="cb2063-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">group =</span> Field <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>()),</span>
<span id="cb2063-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span> bd[<span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb2063-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ridgeline</span>(<span class="fu">aes</span>(<span class="at">height =</span> <span class="sc">-</span>density, <span class="at">group =</span> <span class="fu">interaction</span>(Fert, .draw), <span class="at">color =</span> Fert),</span>
<span id="cb2063-22"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">scale =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>,</span>
<span id="cb2063-23"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">min_height =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb2063-24"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> my_data,</span>
<span id="cb2063-25"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">height =</span> .<span class="dv">025</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">color =</span> bd[<span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb2063-26"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> bd[<span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">12</span>)]) <span class="sc">+</span></span>
<span id="cb2063-27"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">100</span>, <span class="at">to =</span> <span class="dv">180</span>, <span class="at">by =</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb2063-28"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">190</span>),</span>
<span id="cb2063-29"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">2.75</span>)) <span class="sc">+</span></span>
<span id="cb2063-30"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Data with Posterior Predictive Distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb2063-31"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2063-32"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb2063-33"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2063-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Till, <span class="at">labeller =</span> label_both)</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-62-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Now let’s make our Figure 20.11 contrasts.</p>
<div class="sourceCode" id="cb2064"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2064-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span></span>
<span id="cb2064-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-2" aria-hidden="true" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span> </span>
<span id="cb2064-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Till, Fert) <span class="sc">%&gt;%</span> </span>
<span id="cb2064-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we&#39;ll need to update our column names</span></span>
<span id="cb2064-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col_names =</span> <span class="fu">str_c</span>(Till, <span class="st">&quot;_&quot;</span>, Fert))</span>
<span id="cb2064-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2064-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit20<span class="fl">.3</span>,</span>
<span id="cb2064-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd,</span>
<span id="cb2064-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">summary =</span> F,</span>
<span id="cb2064-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">re_formula =</span> Yield <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Till) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Fert) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Till<span class="sc">:</span>Fert)) <span class="sc">%&gt;%</span> </span>
<span id="cb2064-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2064-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(nd <span class="sc">%&gt;%</span> <span class="fu">pull</span>(col_names)) <span class="sc">%&gt;%</span> </span>
<span id="cb2064-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb2064-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Moldbrd</span><span class="sc">\n</span><span class="at">vs</span><span class="sc">\n</span><span class="at">Ridge</span><span class="st">`</span> <span class="ot">=</span> ((Moldbrd_Broad <span class="sc">+</span> Moldbrd_Deep <span class="sc">+</span> Moldbrd_Surface) <span class="sc">/</span> <span class="dv">3</span>) <span class="sc">-</span> ((Ridge_Broad <span class="sc">+</span> Ridge_Deep <span class="sc">+</span> Ridge_Surface) <span class="sc">/</span> <span class="dv">3</span>),</span>
<span id="cb2064-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-15" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2064-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Moldbrd.Ridge</span><span class="sc">\n</span><span class="at">vs</span><span class="sc">\n</span><span class="at">Chisel</span><span class="st">`</span> <span class="ot">=</span> ((Moldbrd_Broad <span class="sc">+</span> Moldbrd_Deep <span class="sc">+</span> Moldbrd_Surface <span class="sc">+</span> Ridge_Broad <span class="sc">+</span> Ridge_Deep <span class="sc">+</span> Ridge_Surface) <span class="sc">/</span> <span class="dv">6</span>) <span class="sc">-</span> ((Chisel_Broad <span class="sc">+</span> Chisel_Deep <span class="sc">+</span> Chisel_Surface) <span class="sc">/</span> <span class="dv">3</span>),</span>
<span id="cb2064-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2064-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Deep.Surface</span><span class="sc">\n</span><span class="at">vs</span><span class="sc">\n</span><span class="at">Broad</span><span class="st">`</span> <span class="ot">=</span> ((Chisel_Deep <span class="sc">+</span> Moldbrd_Deep <span class="sc">+</span> Ridge_Deep <span class="sc">+</span> Chisel_Surface <span class="sc">+</span> Moldbrd_Surface <span class="sc">+</span> Ridge_Surface) <span class="sc">/</span> <span class="dv">6</span>) <span class="sc">-</span> ((Chisel_Broad <span class="sc">+</span> Moldbrd_Broad <span class="sc">+</span> Ridge_Broad) <span class="sc">/</span> <span class="dv">3</span>),</span>
<span id="cb2064-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2064-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Chisel.Moldbrd.v.Ridge</span><span class="sc">\n</span><span class="at">(x)</span><span class="sc">\n</span><span class="at">Broad.v.Deep.Surface</span><span class="st">`</span> <span class="ot">=</span> (((Chisel_Broad <span class="sc">+</span> Chisel_Deep <span class="sc">+</span> Chisel_Surface <span class="sc">+</span> Moldbrd_Broad <span class="sc">+</span> Moldbrd_Deep <span class="sc">+</span> Moldbrd_Surface) <span class="sc">/</span> <span class="dv">6</span>) <span class="sc">-</span> ((Ridge_Broad <span class="sc">+</span> Ridge_Deep <span class="sc">+</span> Ridge_Surface) <span class="sc">/</span> <span class="dv">3</span>)) <span class="sc">-</span> (((Chisel_Broad <span class="sc">+</span> Moldbrd_Broad <span class="sc">+</span> Ridge_Broad) <span class="sc">/</span> <span class="dv">3</span>) <span class="sc">-</span> ((Chisel_Deep <span class="sc">+</span> Moldbrd_Deep <span class="sc">+</span> Ridge_Deep <span class="sc">+</span> Chisel_Surface <span class="sc">+</span> Moldbrd_Surface <span class="sc">+</span> Ridge_Surface) <span class="sc">/</span> <span class="dv">6</span>))</span>
<span id="cb2064-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-21" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb2064-22"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2064-23"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Moldbrd</span><span class="sc">\n</span><span class="st">vs</span><span class="sc">\n</span><span class="st">Ridge&quot;</span>, <span class="st">&quot;Moldbrd.Ridge</span><span class="sc">\n</span><span class="st">vs</span><span class="sc">\n</span><span class="st">Chisel&quot;</span>, <span class="st">&quot;Deep.Surface</span><span class="sc">\n</span><span class="st">vs</span><span class="sc">\n</span><span class="st">Broad&quot;</span>, <span class="st">&quot;Chisel.Moldbrd.v.Ridge</span><span class="sc">\n</span><span class="st">(x)</span><span class="sc">\n</span><span class="st">Broad.v.Deep.Surface&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb2064-24"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2064-25"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2064-26"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">xmax =</span> <span class="dv">5</span>,</span>
<span id="cb2064-27"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb2064-28"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">fill =</span> bd[<span class="dv">7</span>]) <span class="sc">+</span></span>
<span id="cb2064-29"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_beedrill</span>() <span class="sc">+</span></span>
<span id="cb2064-30"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2064-31"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Difference&quot;</span>) <span class="sc">+</span></span>
<span id="cb2064-32"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb2064-33"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb2064-34"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2064-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-63-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>As far as I can tell, it appears that our contrasts indicate our variance parameter for <code>Till</code> ended up larger than Kruschke’s.</p>
<p>Kruschke then posed a model “with field/subject coding suppressed, hence no lines connecting data from the same field/subject” (p. 616). Here’s how to fit that model.</p>
<div class="sourceCode" id="cb2065"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2065-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2065-1" aria-hidden="true" tabindex="-1"></a>fit20<span class="fl">.4</span> <span class="ot">&lt;-</span></span>
<span id="cb2065-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2065-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> my_data,</span>
<span id="cb2065-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2065-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb2065-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2065-4" aria-hidden="true" tabindex="-1"></a>      Yield <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Till) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Fert) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Till<span class="sc">:</span>Fert),</span>
<span id="cb2065-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2065-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb2065-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2065-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">gamma</span>(alpha, beta), <span class="at">class =</span> sd),</span>
<span id="cb2065-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2065-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb2065-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2065-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">2000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb2065-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2065-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">20</span>,</span>
<span id="cb2065-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2065-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>,</span>
<span id="cb2065-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2065-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">max_treedepth =</span> <span class="dv">12</span>),</span>
<span id="cb2065-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2065-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars,</span>
<span id="cb2065-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2065-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit20.04&quot;</span>)</span></code></pre></div>
<p>Behold the summary.</p>
<div class="sourceCode" id="cb2066"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2066-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2066-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit20<span class="fl">.4</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Yield ~ 1 + (1 | Till) + (1 | Fert) + (1 | Till:Fert) 
##    Data: my_data (Number of observations: 99) 
##   Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
##          total post-warmup draws = 8000
## 
## Group-Level Effects: 
## ~Fert (Number of levels: 3) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)    15.24     13.45     1.63    51.89 1.00     2717     3524
## 
## ~Till (Number of levels: 3) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)    16.53     13.94     1.65    54.71 1.00     2829     2727
## 
## ~Till:Fert (Number of levels: 9) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)     7.71      4.59     1.39    19.08 1.00     2407     3364
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept   140.26     16.36   105.61   174.11 1.00     3784     3478
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    12.69      0.96    11.01    14.72 1.00     8328     5053
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Look at how much larger the posterior is for <span class="math inline">\(\sigma_y\)</span> in this model compared to <code>fit20.3</code>.</p>
<div class="sourceCode" id="cb2068"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2068-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2068-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit20<span class="fl">.3</span>)[<span class="st">&quot;sigma&quot;</span>, ]</span></code></pre></div>
<pre><code>##  Estimate Est.Error      Q2.5     Q97.5 
## 5.6954319 0.5374253 4.7675016 6.8752696</code></pre>
<div class="sourceCode" id="cb2070"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2070-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2070-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit20<span class="fl">.4</span>)[<span class="st">&quot;sigma&quot;</span>, ]</span></code></pre></div>
<pre><code>##   Estimate  Est.Error       Q2.5      Q97.5 
## 12.6915001  0.9599149 11.0083386 14.7192597</code></pre>
<p>Here’s the top portion of Figure 20.12.</p>
<div class="sourceCode" id="cb2072"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2072-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb2072-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-2" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">%&gt;%</span> </span>
<span id="cb2072-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Till, Fert) <span class="sc">%&gt;%</span> </span>
<span id="cb2072-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_epred_draws</span>(fit20<span class="fl">.4</span>, </span>
<span id="cb2072-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ndraws =</span> <span class="dv">20</span>,</span>
<span id="cb2072-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">re_formula =</span> Yield <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Till) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Fert) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Till<span class="sc">:</span>Fert),</span>
<span id="cb2072-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dpar =</span> <span class="fu">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2072-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ll =</span> <span class="fu">qnorm</span>(.<span class="dv">025</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma),</span>
<span id="cb2072-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">ul =</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb2072-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Yield =</span> <span class="fu">map2</span>(ll, ul, seq, <span class="at">length.out =</span> <span class="dv">200</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2072-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(Yield) <span class="sc">%&gt;%</span> </span>
<span id="cb2072-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dnorm</span>(Yield, mu, sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb2072-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.draw) <span class="sc">%&gt;%</span> </span>
<span id="cb2072-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> density <span class="sc">/</span> <span class="fu">max</span>(density)) <span class="sc">%&gt;%</span> </span>
<span id="cb2072-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2072-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb2072-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Yield, <span class="at">y =</span> Fert)) <span class="sc">+</span></span>
<span id="cb2072-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ridgeline</span>(<span class="fu">aes</span>(<span class="at">height =</span> <span class="sc">-</span>density, <span class="at">group =</span> <span class="fu">interaction</span>(Fert, .draw), <span class="at">color =</span> Fert),</span>
<span id="cb2072-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">scale =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>,</span>
<span id="cb2072-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">min_height =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb2072-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> my_data,</span>
<span id="cb2072-22"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">height =</span> .<span class="dv">025</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">color =</span> bd[<span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb2072-23"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> bd[<span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">12</span>)]) <span class="sc">+</span></span>
<span id="cb2072-24"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">100</span>, <span class="at">to =</span> <span class="dv">180</span>, <span class="at">by =</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb2072-25"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">190</span>),</span>
<span id="cb2072-26"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">2.75</span>)) <span class="sc">+</span></span>
<span id="cb2072-27"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Data with Posterior Predictive Distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb2072-28"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2072-29"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb2072-30"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2072-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Till, <span class="at">labeller =</span> label_both)</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-66-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Now make the plots for the contrast distributions.</p>
<div class="sourceCode" id="cb2073"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2073-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit20<span class="fl">.4</span>,</span>
<span id="cb2073-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd,</span>
<span id="cb2073-3"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">summary =</span> F,</span>
<span id="cb2073-4"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">re_formula =</span> Yield <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Till) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Fert) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Till<span class="sc">:</span>Fert)) <span class="sc">%&gt;%</span> </span>
<span id="cb2073-5"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2073-6"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(nd <span class="sc">%&gt;%</span> <span class="fu">pull</span>(col_names)) <span class="sc">%&gt;%</span> </span>
<span id="cb2073-7"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb2073-8"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Moldbrd</span><span class="sc">\n</span><span class="at">vs</span><span class="sc">\n</span><span class="at">Ridge</span><span class="st">`</span> <span class="ot">=</span> ((Moldbrd_Broad <span class="sc">+</span> Moldbrd_Deep <span class="sc">+</span> Moldbrd_Surface) <span class="sc">/</span> <span class="dv">3</span>) <span class="sc">-</span> ((Ridge_Broad <span class="sc">+</span> Ridge_Deep <span class="sc">+</span> Ridge_Surface) <span class="sc">/</span> <span class="dv">3</span>),</span>
<span id="cb2073-9"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-9" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2073-10"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Moldbrd.Ridge</span><span class="sc">\n</span><span class="at">vs</span><span class="sc">\n</span><span class="at">Chisel</span><span class="st">`</span> <span class="ot">=</span> ((Moldbrd_Broad <span class="sc">+</span> Moldbrd_Deep <span class="sc">+</span> Moldbrd_Surface <span class="sc">+</span> Ridge_Broad <span class="sc">+</span> Ridge_Deep <span class="sc">+</span> Ridge_Surface) <span class="sc">/</span> <span class="dv">6</span>) <span class="sc">-</span> ((Chisel_Broad <span class="sc">+</span> Chisel_Deep <span class="sc">+</span> Chisel_Surface) <span class="sc">/</span> <span class="dv">3</span>),</span>
<span id="cb2073-11"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2073-12"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Deep.Surface</span><span class="sc">\n</span><span class="at">vs</span><span class="sc">\n</span><span class="at">Broad</span><span class="st">`</span> <span class="ot">=</span> ((Chisel_Deep <span class="sc">+</span> Moldbrd_Deep <span class="sc">+</span> Ridge_Deep <span class="sc">+</span> Chisel_Surface <span class="sc">+</span> Moldbrd_Surface <span class="sc">+</span> Ridge_Surface) <span class="sc">/</span> <span class="dv">6</span>) <span class="sc">-</span> ((Chisel_Broad <span class="sc">+</span> Moldbrd_Broad <span class="sc">+</span> Ridge_Broad) <span class="sc">/</span> <span class="dv">3</span>),</span>
<span id="cb2073-13"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2073-14"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Chisel.Moldbrd.v.Ridge</span><span class="sc">\n</span><span class="at">(x)</span><span class="sc">\n</span><span class="at">Broad.v.Deep.Surface</span><span class="st">`</span> <span class="ot">=</span> (((Chisel_Broad <span class="sc">+</span> Chisel_Deep <span class="sc">+</span> Chisel_Surface <span class="sc">+</span> Moldbrd_Broad <span class="sc">+</span> Moldbrd_Deep <span class="sc">+</span> Moldbrd_Surface) <span class="sc">/</span> <span class="dv">6</span>) <span class="sc">-</span> ((Ridge_Broad <span class="sc">+</span> Ridge_Deep <span class="sc">+</span> Ridge_Surface) <span class="sc">/</span> <span class="dv">3</span>)) <span class="sc">-</span> (((Chisel_Broad <span class="sc">+</span> Moldbrd_Broad <span class="sc">+</span> Ridge_Broad) <span class="sc">/</span> <span class="dv">3</span>) <span class="sc">-</span> ((Chisel_Deep <span class="sc">+</span> Moldbrd_Deep <span class="sc">+</span> Ridge_Deep <span class="sc">+</span> Chisel_Surface <span class="sc">+</span> Moldbrd_Surface <span class="sc">+</span> Ridge_Surface) <span class="sc">/</span> <span class="dv">6</span>))</span>
<span id="cb2073-15"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb2073-16"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2073-17"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Moldbrd</span><span class="sc">\n</span><span class="st">vs</span><span class="sc">\n</span><span class="st">Ridge&quot;</span>, <span class="st">&quot;Moldbrd.Ridge</span><span class="sc">\n</span><span class="st">vs</span><span class="sc">\n</span><span class="st">Chisel&quot;</span>, <span class="st">&quot;Deep.Surface</span><span class="sc">\n</span><span class="st">vs</span><span class="sc">\n</span><span class="st">Broad&quot;</span>, <span class="st">&quot;Chisel.Moldbrd.v.Ridge</span><span class="sc">\n</span><span class="st">(x)</span><span class="sc">\n</span><span class="st">Broad.v.Deep.Surface&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb2073-18"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2073-19"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb2073-20"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">xmax =</span> <span class="dv">5</span>,</span>
<span id="cb2073-21"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb2073-22"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">fill =</span> bd[<span class="dv">7</span>]) <span class="sc">+</span></span>
<span id="cb2073-23"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_beedrill</span>() <span class="sc">+</span></span>
<span id="cb2073-24"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2073-25"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Difference&quot;</span>) <span class="sc">+</span></span>
<span id="cb2073-26"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb2073-27"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb2073-28"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2073-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="20_files/figure-html/unnamed-chunk-67-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Though not identical, these were closer to those Kruschke displayed in the text.</p>
</div>
<div id="model-comparison-approach." class="section level4 hasAnchor" number="20.5.2.5">
<h4><span class="header-section-number">20.5.2.5</span> Model comparison approach.<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#model-comparison-approach." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Like we covered in Chapter 10, I’m not aware that Stan/<strong>brms</strong> will allow for <span class="math inline">\(\delta\)</span> factor-inclusion parameters the way JAGS allows. However, if you’d like to compare models with different parameters, you can always use information criteria.</p>
<div class="sourceCode" id="cb2074"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2074-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2074-1" aria-hidden="true" tabindex="-1"></a>fit20<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit20<span class="fl">.3</span>, <span class="st">&quot;loo&quot;</span>)</span>
<span id="cb2074-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2074-2" aria-hidden="true" tabindex="-1"></a>fit20<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit20<span class="fl">.4</span>, <span class="st">&quot;loo&quot;</span>)</span></code></pre></div>
<p>Executing that yielded the following warning message:</p>
<blockquote>
<p>Found 4 observations with a pareto_k &gt; 0.7 in model ‘fit20.3.’ It is recommended to set ‘moment_match = TRUE’ in order to perform moment matching for problematic observations.</p>
</blockquote>
<p>To use the <code>moment_match</code> approach, the model in question must have been fit with the setting <code>save_pars = save_pars(all = TRUE)</code> within the <code>brm()</code> call. The default is <code>save_pars = NULL</code> and we used the default settings, above. If you go through the trouble of refitting the model with those updated settings, you’ll find that the <code>moment_match</code> approach didn’t help in this case. For the sake of reducing clutter, I’m not going to show the code for refitting the model. However, the next warning message I got after executing <code>fit20.3 &lt;- add_criterion(fit20.3, "loo", moment_match = T)</code> was:</p>
<blockquote>
<p>Warning: Found 1 observations with a pareto_k &gt; 0.7 in model ‘fit20.3.’ It is recommended to set ‘reloo = TRUE’ in order to calculate the ELPD without the assumption that these observations are negligible. This will refit the model 1 times to compute the ELPDs for the problematic observations directly.</p>
</blockquote>
<p>So it’s time to bring in the big guns. Let’s use <code>reloo</code>. Be warned that, because this requires refitting the model multiple times, this will take a few minutes.</p>
<div class="sourceCode" id="cb2075"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2075-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2075-1" aria-hidden="true" tabindex="-1"></a>fit20<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(fit20<span class="fl">.3</span>, <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>, <span class="at">reloo =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Okay, we’re <em>finally</em> ready for the LOO comparison.</p>
<div class="sourceCode" id="cb2076"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2076-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2076-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit20<span class="fl">.3</span>, fit20<span class="fl">.4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2076-2"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2076-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic  se_looic
## fit20.3    0.0       0.0  -334.5      8.0        34.0    4.4    668.9   16.1  
## fit20.4  -61.8       7.9  -396.3      5.7         8.6    1.0    792.6   11.4</code></pre>
<p>All good. Based on the LOO values, we should prefer the fuller model. This, of course, should be no surprise. The posterior for <span class="math inline">\(\sigma_\text{Field}\)</span> was a far cry from zero.</p>
<div class="sourceCode" id="cb2078"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2078-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2078-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit20<span class="fl">.3</span>)[<span class="st">&quot;sd_Field__Intercept&quot;</span>, ]</span></code></pre></div>
<pre><code>##  Estimate Est.Error      Q2.5     Q97.5 
## 11.720783  1.724052  8.876385 15.671784</code></pre>
<p>Kruschke ended this chapter by mentioning Bayes’ factors:</p>
<blockquote>
<p>Bayes’ factor approaches to hypothesis tests in ANOVA were presented by <span class="citation"><a href="#ref-rouderDefaultBayesFactors2012" role="doc-biblioref">Rouder et al.</a> (<a href="#ref-rouderDefaultBayesFactors2012" role="doc-biblioref">2012</a>)</span> and Wetzels, Grasman, and Wagenmakers <span class="citation">(<a href="#ref-wetzelsDefaultBayesianHypothesis2012" role="doc-biblioref">2012</a>)</span>. Morey and Rouder’s BayesFactor package for R is available at the Web site <a href="http://bayesfactorpcl.r-forge.r-project.org/">http://bayesfactorpcl.r-forge.r-project.org/</a>. (p. 618)</p>
</blockquote>
<p>If you wanna go that route, you’re on your own.</p>
</div>
</div>
</div>
<div id="session-info-19" class="section level2 unnumbered hasAnchor">
<h2>Session info<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#session-info-19" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb2080"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2080-1"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#cb2080-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.1.2 (2021-11-01)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Catalina 10.15.7
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] directlabels_2021.1.13 posterior_1.1.0.9000   ggridges_0.5.3         tidybayes_3.0.2       
##  [5] brms_2.17.0            Rcpp_1.0.8             patchwork_1.1.1        palettetown_0.1.1     
##  [9] forcats_0.5.1          stringr_1.4.0          dplyr_1.0.8            purrr_0.3.4           
## [13] readr_2.0.1            tidyr_1.2.0            tibble_3.1.6           ggplot2_3.3.5         
## [17] tidyverse_1.3.1       
## 
## loaded via a namespace (and not attached):
##   [1] readxl_1.3.1         backports_1.4.1      plyr_1.8.6           igraph_1.2.6        
##   [5] svUnit_1.0.6         splines_4.1.2        crosstalk_1.1.1      TH.data_1.0-10      
##   [9] rstantools_2.1.1     inline_0.3.19        digest_0.6.29        htmltools_0.5.2     
##  [13] rsconnect_0.8.24     fansi_1.0.3          magrittr_2.0.3       checkmate_2.0.0     
##  [17] tzdb_0.1.2           modelr_0.1.8         RcppParallel_5.1.4   matrixStats_0.61.0  
##  [21] vroom_1.5.4          xts_0.12.1           sandwich_3.0-1       prettyunits_1.1.1   
##  [25] colorspace_2.0-3     rvest_1.0.1          ggdist_3.1.1         haven_2.4.3         
##  [29] xfun_0.30            callr_3.7.0          crayon_1.5.1         jsonlite_1.8.0      
##  [33] lme4_1.1-27.1        survival_3.2-13      zoo_1.8-9            glue_1.6.2          
##  [37] gtable_0.3.0         emmeans_1.7.1-1      distributional_0.3.0 pkgbuild_1.2.0      
##  [41] rstan_2.21.5         abind_1.4-5          scales_1.1.1         mvtnorm_1.1-2       
##  [45] emo_0.0.0.9000       DBI_1.1.1            miniUI_0.1.1.1       xtable_1.8-4        
##  [49] HDInterval_0.2.2     bit_4.0.4            stats4_4.1.2         StanHeaders_2.21.0-7
##  [53] DT_0.19              htmlwidgets_1.5.3    httr_1.4.2           threejs_0.3.3       
##  [57] arrayhelpers_1.1-0   ellipsis_0.3.2       pkgconfig_2.0.3      loo_2.5.1           
##  [61] farver_2.1.0         sass_0.4.1           dbplyr_2.1.1         utf8_1.2.2          
##  [65] tidyselect_1.1.2     labeling_0.4.2       rlang_1.0.2          reshape2_1.4.4      
##  [69] later_1.3.0          munsell_0.5.0        cellranger_1.1.0     tools_4.1.2         
##  [73] cli_3.2.0            generics_0.1.2       broom_0.7.12         evaluate_0.15       
##  [77] fastmap_1.1.0        processx_3.5.2       knitr_1.38           bit64_4.0.5         
##  [81] fs_1.5.2             nlme_3.1-153         projpred_2.0.2       mime_0.11           
##  [85] xml2_1.3.2           compiler_4.1.2       bayesplot_1.9.0      shinythemes_1.2.0   
##  [89] rstudioapi_0.13      gamm4_0.2-6          reprex_2.0.1         bslib_0.3.1         
##  [93] stringi_1.7.6        highr_0.9            ps_1.6.0             Brobdingnag_1.2-6   
##  [97] lattice_0.20-45      Matrix_1.3-4         nloptr_1.2.2.2       markdown_1.1        
## [101] shinyjs_2.0.0        tensorA_0.36.2       vctrs_0.4.0          pillar_1.7.0        
## [105] lifecycle_1.0.1      jquerylib_0.1.4      bridgesampling_1.1-2 estimability_1.3    
## [109] httpuv_1.6.2         R6_2.5.1             bookdown_0.26        promises_1.2.0.1    
## [113] gridExtra_2.3        codetools_0.2-18     boot_1.3-28          MASS_7.3-54         
## [117] colourpicker_1.1.0   gtools_3.9.2         assertthat_0.2.1     withr_2.5.0         
## [121] shinystan_2.5.0      multcomp_1.4-17      mgcv_1.8-38          parallel_4.1.2      
## [125] hms_1.1.0            quadprog_1.5-8       grid_4.1.2           minqa_1.2.4         
## [129] coda_0.19-4          rmarkdown_2.13       shiny_1.6.0          lubridate_1.7.10    
## [133] base64enc_0.1-3      dygraphs_1.1.1.6</code></pre>
<pre><code>## Warning in rm(grand_mean, deflection_1, deflection_2, nonadditive_component, : object &#39;col_names&#39;
## not found</code></pre>
</div>
<div id="footnote-6" class="section level2 unnumbered hasAnchor">
<h2>Footnote<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#footnote-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-bolgerCausalProcessesPsychology2019" class="csl-entry">
Bolger, N., Zee, K. S., Rossignac-Milon, M., &amp; Hassin, R. R. (2019). Causal processes in psychology are heterogeneous. <em>Journal of Experimental Psychology: General</em>, <em>148</em>(4), 601–618. <a href="https://doi.org/10.1037/xge0000558">https://doi.org/10.1037/xge0000558</a>
</div>
<div id="ref-R-posterior" class="csl-entry">
Bürkner, P.-C., Gabry, J., Kay, M., &amp; Vehtari, A. (2021). <em><span class="nocase">posterior</span>: <span>Tools</span> for working with posterior distributions</em> [Manual].
</div>
<div id="ref-fisherStatisticalMethodsResearch1925" class="csl-entry">
Fisher, R. A. (1925). <em>Statistical methods for research workers, 11th ed. rev</em>. <span>Edinburgh</span>. <a href="https://psycnet.apa.org/record/1925-15003-000">https://psycnet.apa.org/record/1925-15003-000</a>
</div>
<div id="ref-hamakerWhyResearchersShould2012" class="csl-entry">
Hamaker, E. L. (2012). Why researchers should think "within-person": <span>A</span> paradigmatic rationale. In <em>Handbook of research methods for studying daily life</em> (pp. 43–61). <span>The Guilford Press</span>. <a href="https://www.guilford.com/books/Handbook-of-Research-Methods-for-Studying-Daily-Life/Mehl-Conner/9781462513055">https://www.guilford.com/books/Handbook-of-Research-Methods-for-Studying-Daily-Life/Mehl-Conner/9781462513055</a>
</div>
<div id="ref-R-directlabels" class="csl-entry">
Hocking, T. D. (2021). <em>Directlabels: <span>Direct</span> labels for multicolor plots</em> [Manual]. <a href="https://CRAN.R-project.org/package=directlabels">https://CRAN.R-project.org/package=directlabels</a>
</div>
<div id="ref-kruschkeDoingBayesianData2015" class="csl-entry">
Kruschke, J. K. (2015). <em>Doing <span>Bayesian</span> data analysis: <span>A</span> tutorial with <span>R</span>, <span>JAGS</span>, and <span>Stan</span></em>. <span>Academic Press</span>. <a href="https://sites.google.com/site/doingbayesiandataanalysis/">https://sites.google.com/site/doingbayesiandataanalysis/</a>
</div>
<div id="ref-rouderDefaultBayesFactors2012" class="csl-entry">
Rouder, J. N., Morey, R. D., Speckman, P. L., &amp; Province, J. M. (2012). Default <span>Bayes</span> factors for <span>ANOVA</span> designs. <em>Journal of Mathematical Psychology</em>, <em>56</em>(5), 356–374. <a href="https://doi.org/10.1016/j.jmp.2012.08.001">https://doi.org/10.1016/j.jmp.2012.08.001</a>
</div>
<div id="ref-skinnerCaseHistoryScientific1956" class="csl-entry">
Skinner, B. F. (1956). A case history in scientific method. <em>American Psychologist</em>, <em>11</em>(5), 221–233. <a href="https://doi.org/10.1037/h0047662">https://doi.org/10.1037/h0047662</a>
</div>
<div id="ref-wetzelsDefaultBayesianHypothesis2012" class="csl-entry">
Wetzels, R., Grasman, R. P. P. P., &amp; Wagenmakers, E.-J. (2012). A default <span>Bayesian</span> hypothesis test for <span>ANOVA</span> designs. <em>The American Statistician</em>, <em>66</em>(2), 104–111. <a href="https://doi.org/10.1080/00031305.2012.695956">https://doi.org/10.1080/00031305.2012.695956</a>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="7">
<li id="fn7"><p>It’s not quite clear where these data come from. At the top of page 591, Kruschke wrote “in this section, we will be looking at some real-world salaries.” Further down on the same page, Kruschke added: “The data are annual salaries of 1,080 tenure-track professors at a large-enrollment, small-city, Midwestern-American, research-oriented, state university. (Salaries at big- city and private universities tend to be higher, while salaries at liberal-arts colleges and teaching-oriented state universities tend to be lower.) The data span 60 academic departments that had at least seven members. The data also include the professor’s seniority.” He did not provide a reference.<a href="metric-predicted-variable-with-multiple-nominal-predictors.html#fnref7" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="metric-predicted-variable-with-one-nominal-predictor.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dichotomous-predicted-variable.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
